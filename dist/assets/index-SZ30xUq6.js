const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/NoRolePage-CWUvhIQQ.js","assets/radix-ui-Bi1_13u0.js","assets/react-vendor-BVzrj2YZ.js","assets/refine-core-CTgsLv1J.js","assets/utils-Bf-2CtVq.js","assets/refine-ui-CcbuMDPh.js","assets/forms-eHug1Pu5.js","assets/ui-utils-eXG3sLOU.js","assets/tables-DakfYk2u.js","assets/LoginPage-DI91RSqG.js","assets/NarrowCol-iA_tcVLT.js","assets/RegisterFlow-yoAANJM_.js","assets/ForgotPasswordPage-DG0itvQD.js","assets/UpdatePasswordPage-BFoDs9qY.js"])))=>i.map(i=>d[i]);
var er=Object.defineProperty;var sr=(s,t,r)=>t in s?er(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r;var Ae=(s,t,r)=>sr(s,typeof t!="symbol"?t+"":t,r);import{j as e,R as Fs,I as As,F as Is,S as cs,a as Ts,P as ar,C as Ws,b as Vs,V as rr,c as tr,d as Us,e as ir,T as Os,f as nr,g as Bs,h as Ms,i as lr,k as Ks,l as dr,L as Zs,m as Qs,n as cr,o as or,p as Hs,q as hr,r as xr,s as Gs,t as Ys,u as Xs,v as Js,w as ea,x as ur,y as sa,z as mr,A as jr,B as aa,D as pr,E as gr,G as br,H as yr,J as ra,O as ta,K as wr,M as ia,N as vr,Q as na,U as la,W as da,X as fr}from"./radix-ui-Bi1_13u0.js";import{k as Nr,a as f,N as js,e as je,l as b,d as ca,R as ye,n as oa,o as fe,p as re,O as Se,B as _r}from"./react-vendor-BVzrj2YZ.js";import{T as kr}from"./utils-Bf-2CtVq.js";import{M as zr,d as Cr,n as Me,$ as ge,I as se,e as D,f as ce,i as Sr,j as Lr,X as Ke,l as os,m as ha,o as xa,E as Ne,Q as Rr,p as $r,t as Pr,D as Er}from"./refine-core-CTgsLv1J.js";import{c as Dr,k as Q,_ as Ve,I as qr}from"./refine-ui-CcbuMDPh.js";import{t as Fr,c as Ar,a as Ze,C as hs,b as Ir,d as ua,X as ma,M as ja,L as Tr,B as pa,e as Le,U as _e,S as ga,T as ue,A as We,f as Wr,g as Be,P as ee,E as oe,h as H,i as V,W as Re,j as Vr,k as xs,D as Ur,l as Or,m as ba,n as Br,o as Mr,F as us,p as Kr,q as $e,r as as,s as Zr,u as rs,v as ps,w as Qr,R as gs,x as Ie,y as bs,z as Hr,G as Gr,H as Yr,I as Xr}from"./ui-utils-eXG3sLOU.js";import{R as Jr,A as et,a as st,X as at,Y as rt}from"./tables-DakfYk2u.js";import"./forms-eHug1Pu5.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))n(d);new MutationObserver(d=>{for(const i of d)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(d){const i={};return d.integrity&&(i.integrity=d.integrity),d.referrerPolicy&&(i.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?i.credentials="include":d.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(d){if(d.ep)return;d.ep=!0;const i=r(d);fetch(d.href,i)}})();var Ue={},ys;function tt(){if(ys)return Ue;ys=1;var s=Nr();return Ue.createRoot=s.createRoot,Ue.hydrateRoot=s.hydrateRoot,Ue}var it=tt();const nt="https://bkuvjleqoubzbauczrsf.supabase.co",lt="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJrdXZqbGVxb3ViemJhdWN6cnNmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc3OTg2MzgsImV4cCI6MjA3MzM3NDYzOH0.3C0VTIppXgmVQvZU4oS_uwB7ebZ5bVuKOduKZ0mpmXg",de=Dr(nt,lt,{db:{schema:"public"},auth:{persistSession:!0}}),q=(...s)=>Fr(Ar(s)),dt={invalid_credentials:"Nieprawidłowy email lub hasło.","Invalid login credentials":"Nieprawidłowy email lub hasło.",email_not_confirmed:"Email nie został potwierdzony.","Email not confirmed":"Email nie został potwierdzony.",user_not_found:"Nie znaleziono użytkownika.","User not found":"Nie znaleziono użytkownika.",network_error:"Błąd połączenia z serwerem.","Too many requests":"Zbyt wiele prób. Spróbuj ponownie za chwilę."},ct=s=>{if(!s)return{message:"Nieznany błąd",name:"UnknownError",statusCode:500};const t=s.message||s.error_description||"";for(const[r,n]of Object.entries(dt))if(t.includes(r))return{message:n,name:"LoginError",statusCode:s.code==="invalid_credentials"?401:400};return{message:t||"Błąd logowania",name:"LoginError",statusCode:400}},ya={login:async(s,t)=>{try{if(!s||!t)return{success:!1,error:"Email i hasło są wymagane"};const{data:r,error:n}=await de.auth.signInWithPassword({email:s.trim().toLowerCase(),password:t});return n?{success:!1,error:ct(n).message}:r.session?{success:!0}:{success:!1,error:"Nie udało się utworzyć sesji"}}catch(r){return{success:!1,error:r.message||"Nieznany błąd"}}},loginForRefine:async(s,t)=>{const r=await ya.login(s,t);return r.success?r:{success:!1,error:{message:r.error,name:"LoginError",statusCode:400}}},checkAuth:async()=>{const{data:{session:s}}=await de.auth.getSession();return!!s}},ot={user_already_exists:"Konto z tym adresem email już istnieje","User already registered":"Konto z tym adresem email już istnieje","already exists":"Konto z tym adresem email już istnieje",weak_password:"Hasło musi mieć co najmniej 6 znaków","Password should be at least":"Hasło musi mieć co najmniej 6 znaków","Password cannot be longer than 72":"Hasło nie może być dłuższe niż 72 znaki",invalid_email:"Nieprawidłowy format adresu email","Invalid email":"Nieprawidłowy format adresu email",over_email_send_rate_limit:"Za szybko! Poczekaj 2 sekundy przed ponowną próbą"},ws=s=>{if(!s)return{message:"Nieznany błąd",name:"UnknownError",statusCode:500};const t=s.message||"";for(const[r,n]of Object.entries(ot))if(t.includes(r)){let d=400;return r.includes("already")&&(d=409),r.includes("email_send_rate")&&(d=429),{message:n,name:"RegisterError",statusCode:d}}return{message:t||"Rejestracja nie powiodła się",name:"RegisterError",statusCode:400}},wa={register:async(s,t,r)=>{try{const{data:n,error:d}=await de.auth.signUp({email:s.trim().toLowerCase(),password:t,options:{data:{full_name:r.trim(),role:"student"},emailRedirectTo:`${window.location.origin}/login?verified=true`}});return d?{success:!1,error:ws(d).message}:n.user?{success:!0,needsEmailConfirmation:!n.session}:{success:!1,error:"Rejestracja nie powiodła się"}}catch(n){return{success:!1,error:n.message||"Błąd rejestracji"}}},registerForRefine:async(s,t,r)=>{const n=await wa.register(s,t,r);return n.success?{success:!0,successNotification:n.needsEmailConfirmation?{message:"Rejestracja udana!",description:"Sprawdź email aby potwierdzić konto."}:{message:"Rejestracja udana!",description:"Możesz się teraz zalogować."}}:{success:!1,error:ws({message:n.error})}}},ht={"User not found":"Nie znaleziono użytkownika z tym adresem email","Invalid email":"Nieprawidłowy format adresu email",over_email_send_rate_limit:"Za szybko! Poczekaj chwilę przed kolejną próbą",reset_password_rate_limit:"Zbyt wiele prób. Spróbuj ponownie za kilka minut"},vs=s=>{if(!s)return{message:"Nieznany błąd",name:"UnknownError",statusCode:500};const t=s.message||"";for(const[r,n]of Object.entries(ht))if(t.includes(r))return{message:n,name:"ForgotPasswordError",statusCode:r.includes("rate_limit")?429:400};return{message:t||"Błąd podczas wysyłania emaila",name:"ForgotPasswordError",statusCode:400}},va={sendResetEmail:async s=>{try{const{error:t}=await de.auth.resetPasswordForEmail(s.trim().toLowerCase(),{redirectTo:`${window.location.origin}/update-password`});return t?{success:!1,error:vs(t).message}:{success:!0}}catch(t){return{success:!1,error:t.message||"Błąd podczas wysyłania emaila"}}},sendResetEmailForRefine:async s=>{const t=await va.sendResetEmail(s);return t.success?{success:!0,successNotification:{message:"Email wysłany!",description:"Sprawdź swoją skrzynkę odbiorczą"}}:{success:!1,error:vs({message:t.error})}}},xt={"New password should be different":"Nowe hasło musi być inne niż obecne","Password should be at least":"Hasło musi mieć co najmniej 6 znaków","Invalid token":"Link wygasł lub jest nieprawidłowy",session_not_found:"Sesja wygasła. Spróbuj ponownie"},fs=s=>{if(!s)return{message:"Nieznany błąd",name:"UnknownError",statusCode:500};const t=s.message||"";for(const[r,n]of Object.entries(xt))if(t.includes(r))return{message:n,name:"UpdatePasswordError",statusCode:r.includes("token")||r.includes("session")?401:400};return{message:t||"Błąd aktualizacji hasła",name:"UpdatePasswordError",statusCode:400}},fa={checkSession:async()=>{try{const{data:s}=await de.auth.getSession(),r=new URLSearchParams(window.location.hash.substring(1)).get("type");return!s.session&&r!=="recovery"?{isValid:!1,error:"Link wygasł lub jest nieprawidłowy"}:{isValid:!0}}catch{return{isValid:!1,error:"Błąd weryfikacji sesji"}}},updatePassword:async s=>{try{const{error:t}=await de.auth.updateUser({password:s});return t?{success:!1,error:fs(t).message}:{success:!0}}catch(t){return{success:!1,error:t.message||"Błąd aktualizacji hasła"}}},updatePasswordForRefine:async s=>{const t=await fa.updatePassword(s);return t.success?{success:!0,redirectTo:"/login?passwordChanged=true"}:{success:!1,error:fs({message:t.error})}}};class ut{constructor(){Ae(this,"cache",null);Ae(this,"lastFetch",0);Ae(this,"CACHE_DURATION",300*1e3);Ae(this,"fetchPromise",null)}async get(t=!1){const r=Date.now();if(!t&&this.cache&&r-this.lastFetch<this.CACHE_DURATION)return this.cache;if(this.fetchPromise)return this.fetchPromise;this.fetchPromise=this.fetchUser();const n=await this.fetchPromise;return this.fetchPromise=null,n}async fetchUser(){try{const{data:{session:t}}=await de.auth.getSession();if(!t?.user)return this.clear(),null;const{data:r,error:n}=await de.from("users").select("*").eq("id",t.user.id).single();if(n||!r){console.error("Error fetching user data:",n);const i={id:t.user.id,email:t.user.email||"",full_name:t.user.user_metadata?.full_name||t.user.email?.split("@")[0]||"User",vendor_id:1,role:"student"};return this.set(i),i}const d={id:r.id,email:r.email,full_name:r.full_name,vendor_id:r.vendor_id,role:r.role,is_active:r.is_active,created_at:r.created_at};return this.set(d),d}catch(t){return console.error("Error in fetchUser:",t),this.clear(),null}}set(t){this.cache=t,this.lastFetch=Date.now()}clear(){this.cache=null,this.lastFetch=0,this.fetchPromise=null}async refresh(){return this.get(!0)}}const we=new ut;de.auth.onAuthStateChange((s,t)=>{s==="SIGNED_OUT"||!t?we.clear():(s==="SIGNED_IN"||s==="TOKEN_REFRESHED")&&we.get(!0)});const Ge={logout:async()=>{try{we.clear();const{error:s}=await de.auth.signOut();return s?{success:!1,error:{message:"Błąd podczas wylogowania",name:"LogoutError",statusCode:500}}:{success:!0,redirectTo:"/login"}}catch{return{success:!1,error:{message:"Nieoczekiwany błąd podczas wylogowania",name:"LogoutError",statusCode:500}}}},check:async()=>{try{const{data:{session:s}}=await de.auth.getSession();if(!s)return{authenticated:!1,redirectTo:"/login"};const t=s.expires_at;return t&&t*1e3<Date.now()?{authenticated:!1,redirectTo:"/login"}:{authenticated:!0}}catch{return{authenticated:!1,redirectTo:"/login"}}},handleError:async s=>(console.error("Auth error:",s),s?.statusCode===401?(we.clear(),{redirectTo:"/login",logout:!0,error:s}):{error:s})},mt={login:async({email:s,password:t})=>{const r=await ya.login(s,t);return r.success&&await we.refresh(),r},logout:async()=>await Ge.logout(),check:async()=>await Ge.check(),getIdentity:async()=>await we.get(),getPermissions:async()=>(await we.get())?.role||null,register:async({email:s,password:t,name:r})=>await wa.registerForRefine(s,t,r),forgotPassword:async({email:s})=>await va.sendResetEmailForRefine(s),updatePassword:async({password:s})=>{const t=await fa.updatePasswordForRefine(s);return t.success&&await we.clear(),t},onError:async s=>await Ge.handleError(s)},I=({isLoading:s,isError:t,loadingText:r="Loading...",errorMsg:n="Error loading data"})=>s?e.jsx("div",{className:"p-6 text-gray-600 animate-reverse-pulse",children:r}):t?e.jsx("div",{className:"p-6 text-red-500",children:n}):null,jt=Ze("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-3.5 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),pt=f.forwardRef(({className:s,variant:t,...r},n)=>e.jsx("div",{ref:n,role:"alert",className:q(jt({variant:t}),s),...r}));pt.displayName="Alert";const gt=f.forwardRef(({className:s,...t},r)=>e.jsx("h5",{ref:r,className:q("mb-1 font-medium leading-none tracking-tight",s),...t}));gt.displayName="AlertTitle";const bt=f.forwardRef(({className:s,...t},r)=>e.jsx("div",{ref:r,className:q("text-sm [&_p]:leading-relaxed",s),...t}));bt.displayName="AlertDescription";const yt=f.forwardRef(({className:s,...t},r)=>e.jsx(Fs,{ref:r,className:q("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",s),...t}));yt.displayName=Fs.displayName;const wt=f.forwardRef(({className:s,...t},r)=>e.jsx(As,{ref:r,className:q("aspect-square h-full w-full object-cover",s),...t}));wt.displayName=As.displayName;const vt=f.forwardRef(({className:s,...t},r)=>e.jsx(Is,{ref:r,className:q("flex h-full w-full items-center justify-center rounded-full bg-muted",s),...t}));vt.displayName=Is.displayName;const ft=Ze("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function y({className:s,variant:t,asChild:r=!1,...n}){const d=r?cs:"span";return e.jsx(d,{"data-slot":"badge",className:q(ft({variant:t}),s),...n})}const Nt=f.forwardRef(({...s},t)=>e.jsx("nav",{ref:t,"aria-label":"breadcrumb",...s}));Nt.displayName="Breadcrumb";const _t=f.forwardRef(({className:s,...t},r)=>e.jsx("ol",{ref:r,className:q("flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5",s),...t}));_t.displayName="BreadcrumbList";const kt=f.forwardRef(({className:s,...t},r)=>e.jsx("li",{ref:r,className:q("inline-flex items-center gap-1.5",s),...t}));kt.displayName="BreadcrumbItem";const zt=f.forwardRef(({asChild:s,className:t,...r},n)=>{const d=s?cs:"a";return e.jsx(d,{ref:n,className:q("transition-colors hover:text-foreground",t),...r})});zt.displayName="BreadcrumbLink";const Ct=f.forwardRef(({className:s,...t},r)=>e.jsx("span",{ref:r,role:"link","aria-disabled":"true","aria-current":"page",className:q("font-normal text-foreground",s),...t}));Ct.displayName="BreadcrumbPage";const St=Ze("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),u=f.forwardRef(({className:s,variant:t,size:r,asChild:n=!1,...d},i)=>{const l=n?cs:"button";return e.jsx(l,{className:q(St({variant:t,size:r,className:s})),ref:i,...d})});u.displayName="Button";const z=f.forwardRef(({className:s,...t},r)=>e.jsx("div",{ref:r,className:q("rounded-xl border bg-card text-card-foreground shadow flex flex-col overflow-hidden",s),...t}));z.displayName="Card";const C=f.forwardRef(({className:s,...t},r)=>e.jsx("div",{ref:r,className:q("flex flex-col space-y-1.5 p-6 pb-3 bg-pink-200/25",s),...t}));C.displayName="CardHeader";const $=f.forwardRef(({className:s,...t},r)=>e.jsx("div",{ref:r,className:q("text-lg font-semibold leading-tight tracking-tight pt-3",s),...t}));$.displayName="CardTitle";const Na=f.forwardRef(({className:s,...t},r)=>e.jsx("div",{ref:r,className:q("text-sm text-muted-foreground",s),...t}));Na.displayName="CardDescription";const S=f.forwardRef(({className:s,...t},r)=>e.jsx("div",{ref:r,className:q("p-3 lg:p-6 pt-3 space-y-3 flex-1 bg-background",s),...t}));S.displayName="CardContent";const ne=f.forwardRef(({className:s,...t},r)=>e.jsx("div",{ref:r,className:q("flex items-center justify-between p-6 pt-0",s),...t}));ne.displayName="CardFooter";const Lt=Ze("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),ts=f.forwardRef(({className:s,...t},r)=>e.jsx(Ts,{ref:r,className:q(Lt(),s),...t}));ts.displayName=Ts.displayName;f.createContext({});f.createContext({});const w=f.forwardRef(({className:s,type:t,...r},n)=>e.jsx("input",{type:t,className:q("flex h-9 w-full rounded-md border border-input bg-background px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:n,...r}));w.displayName="Input";const Rt=f.forwardRef(({className:s,align:t="center",sideOffset:r=4,...n},d)=>e.jsx(ar,{children:e.jsx(Ws,{ref:d,align:t,sideOffset:r,className:q("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]",s),...n})}));Rt.displayName=Ws.displayName;const _a=f.forwardRef(({className:s,children:t,...r},n)=>e.jsxs(Vs,{ref:n,className:q("relative overflow-hidden",s),...r,children:[e.jsx(rr,{className:"h-full w-full rounded-[inherit]",children:t}),e.jsx(ka,{}),e.jsx(tr,{})]}));_a.displayName=Vs.displayName;const ka=f.forwardRef(({className:s,orientation:t="vertical",...r},n)=>e.jsx(Us,{ref:n,orientation:t,className:q("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s),...r,children:e.jsx(ir,{className:"relative flex-1 rounded-full bg-border"})}));ka.displayName=Us.displayName;const U=hr,O=xr,T=f.forwardRef(({className:s,children:t,...r},n)=>e.jsxs(Os,{ref:n,className:q("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-background px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...r,children:[t,e.jsx(nr,{asChild:!0,children:e.jsx(hs,{className:"h-4 w-4 opacity-50"})})]}));T.displayName=Os.displayName;const za=f.forwardRef(({className:s,...t},r)=>e.jsx(Bs,{ref:r,className:q("flex cursor-default items-center justify-center py-1",s),...t,children:e.jsx(Ir,{className:"h-4 w-4"})}));za.displayName=Bs.displayName;const Ca=f.forwardRef(({className:s,...t},r)=>e.jsx(Ms,{ref:r,className:q("flex cursor-default items-center justify-center py-1",s),...t,children:e.jsx(hs,{className:"h-4 w-4"})}));Ca.displayName=Ms.displayName;const W=f.forwardRef(({className:s,children:t,position:r="popper",...n},d)=>e.jsx(lr,{children:e.jsxs(Ks,{ref:d,className:q("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:r,...n,children:[e.jsx(za,{}),e.jsx(dr,{className:q("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),e.jsx(Ca,{})]})}));W.displayName=Ks.displayName;const $t=f.forwardRef(({className:s,...t},r)=>e.jsx(Zs,{ref:r,className:q("px-2 py-1.5 text-sm font-semibold",s),...t}));$t.displayName=Zs.displayName;const E=f.forwardRef(({className:s,children:t,...r},n)=>e.jsxs(Qs,{ref:n,className:q("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...r,children:[e.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(cr,{children:e.jsx(ua,{className:"h-4 w-4"})})}),e.jsx(or,{children:t})]}));E.displayName=Qs.displayName;const Pt=f.forwardRef(({className:s,...t},r)=>e.jsx(Hs,{ref:r,className:q("-mx-1 my-1 h-px bg-muted",s),...t}));Pt.displayName=Hs.displayName;const K=f.forwardRef(({className:s,orientation:t="horizontal",decorative:r=!0,...n},d)=>e.jsx(Gs,{ref:d,decorative:r,orientation:t,className:q("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",s),...n}));K.displayName=Gs.displayName;const ie=f.forwardRef(({className:s,...t},r)=>e.jsx("textarea",{className:q("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:r,...t}));ie.displayName="Textarea";const Et=f.forwardRef(({className:s,...t},r)=>e.jsx(Ys,{ref:r,className:q("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",s),...t}));Et.displayName=Ys.displayName;const Dt=f.forwardRef(({className:s,...t},r)=>e.jsx(Xs,{ref:r,className:q("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",s),...t}));Dt.displayName=Xs.displayName;const qt=f.forwardRef(({className:s,...t},r)=>e.jsx(Js,{ref:r,className:q("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...t}));qt.displayName=Js.displayName;const Ft=f.forwardRef(({className:s,...t},r)=>e.jsx(ea,{ref:r,className:q("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...t,children:e.jsx(ur,{className:q("flex items-center justify-center text-current"),children:e.jsx(ua,{className:"h-4 w-4"})})}));Ft.displayName=ea.displayName;var Qe="Switch",[At,Zl]=jr(Qe),[It,Tt]=At(Qe),Sa=f.forwardRef((s,t)=>{const{__scopeSwitch:r,name:n,checked:d,defaultChecked:i,required:l,disabled:m,value:c="on",onCheckedChange:x,form:h,...o}=s,[j,a]=f.useState(null),g=sa(t,xe=>a(xe)),v=f.useRef(!1),F=j?h||!!j.closest("form"):!0,[R,B]=mr({prop:d,defaultProp:i??!1,onChange:x,caller:Qe});return e.jsxs(It,{scope:r,checked:R,disabled:m,children:[e.jsx(aa.button,{type:"button",role:"switch","aria-checked":R,"aria-required":l,"data-state":Pa(R),"data-disabled":m?"":void 0,disabled:m,value:c,...o,ref:g,onClick:pr(s.onClick,xe=>{B(be=>!be),F&&(v.current=xe.isPropagationStopped(),v.current||xe.stopPropagation())})}),F&&e.jsx($a,{control:j,bubbles:!v.current,name:n,value:c,checked:R,required:l,disabled:m,form:h,style:{transform:"translateX(-100%)"}})]})});Sa.displayName=Qe;var La="SwitchThumb",Ra=f.forwardRef((s,t)=>{const{__scopeSwitch:r,...n}=s,d=Tt(La,r);return e.jsx(aa.span,{"data-state":Pa(d.checked),"data-disabled":d.disabled?"":void 0,...n,ref:t})});Ra.displayName=La;var Wt="SwitchBubbleInput",$a=f.forwardRef(({__scopeSwitch:s,control:t,checked:r,bubbles:n=!0,...d},i)=>{const l=f.useRef(null),m=sa(l,i),c=gr(r),x=br(t);return f.useEffect(()=>{const h=l.current;if(!h)return;const o=window.HTMLInputElement.prototype,a=Object.getOwnPropertyDescriptor(o,"checked").set;if(c!==r&&a){const g=new Event("click",{bubbles:n});a.call(h,r),h.dispatchEvent(g)}},[c,r,n]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...d,tabIndex:-1,ref:m,style:{...d.style,...x,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});$a.displayName=Wt;function Pa(s){return s?"checked":"unchecked"}var Ea=Sa,Vt=Ra;const Ut=f.forwardRef(({className:s,...t},r)=>e.jsx(Ea,{className:q("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s),...t,ref:r,children:e.jsx(Vt,{className:q("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));Ut.displayName=Ea.displayName;const Ot=f.forwardRef(({className:s,sideOffset:t=4,...r},n)=>e.jsx(yr,{children:e.jsx(ra,{ref:n,sideOffset:t,className:q("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",s),...r})}));Ot.displayName=ra.displayName;const Bt=wr,Da=f.forwardRef(({className:s,...t},r)=>e.jsx(ta,{ref:r,className:q("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...t}));Da.displayName=ta.displayName;const Mt=f.forwardRef(({className:s,children:t,...r},n)=>e.jsxs(Bt,{children:[e.jsx(Da,{}),e.jsxs(ia,{ref:n,className:q("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...r,children:[t,e.jsxs(vr,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(ma,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Mt.displayName=ia.displayName;const Kt=f.forwardRef(({className:s,...t},r)=>e.jsx(na,{ref:r,className:q("text-lg font-semibold leading-none tracking-tight",s),...t}));Kt.displayName=na.displayName;const Zt=f.forwardRef(({className:s,...t},r)=>e.jsx(la,{ref:r,className:q("text-sm text-muted-foreground",s),...t}));Zt.displayName=la.displayName;const Qt=f.forwardRef(({className:s,value:t,...r},n)=>e.jsx(da,{ref:n,className:q("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",s),...r,children:e.jsx(fr,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));Qt.displayName=da.displayName;const Ht=({onClose:s,brand:t="ScrapYard Manager"})=>{const{mutate:r}=zr(),{menuItems:n}=Cr(),{data:d}=Me();return e.jsxs("div",{className:"flex h-full w-64 flex-col border-r bg-background",children:[e.jsxs("div",{className:"flex h-16 items-center justify-between border-b px-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ja,{className:"h-6 w-6 mr-2"}),e.jsx("span",{className:"font-semibold",children:t})]}),s&&e.jsx(u,{variant:"ghost",size:"sm",onClick:s,className:"lg:hidden",children:e.jsx(ma,{className:"h-4 w-4"})})]}),e.jsx(_a,{className:"flex-1 px-3 py-4",children:e.jsx("nav",{className:"space-y-3",children:n.map(i=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs(js,{to:i.route??"/",className:({isActive:l})=>q("flex items-center justify-between rounded-md px-3 py-2 text-sm font-semibold transition-colors hover:bg-accent hover:text-accent-foreground",l?"bg-accent text-accent-foreground":"text-foreground"),onClick:s,children:[e.jsxs("span",{className:"flex items-center",children:[i.icon&&e.jsx("span",{className:"mr-3",children:i.icon}),i.label]}),i.children&&i.children.length>0&&e.jsx(hs,{className:"h-4 w-4 opacity-60"})]}),i.children&&i.children.length>0&&e.jsx("div",{className:"ml-3 border-l pl-3 space-y-1",children:i.children.map(l=>e.jsxs(js,{to:l.route??"/",className:({isActive:m})=>q("flex items-center rounded-md px-3 py-2 text-sm transition-colors hover:bg-accent hover:text-accent-foreground",m?"bg-accent text-accent-foreground":"text-muted-foreground"),onClick:s,children:[l.icon&&e.jsx("span",{className:"mr-3",children:l.icon}),l.label]},l.key))})]},i.key))})}),e.jsx(K,{}),e.jsxs("div",{className:"p-4 text-xs text-muted-foreground",children:["Zalogowano jako: ",e.jsx("span",{className:"font-medium",children:d?.email})]}),e.jsx("div",{className:"p-4",children:e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>{r(),s?.()},className:"w-full justify-start",children:[e.jsx(Tr,{className:"mr-2 h-4 w-4"})," Wyloguj"]})})]})},Pe=({children:s,brand:t="ScrapYard Manager"})=>{const[r,n]=f.useState(!1);return e.jsx("div",{className:"min-h-screen bg-stone-200 relative overflow-x-hidden",children:e.jsxs("div",{className:"flex relative",children:[r&&e.jsx("div",{className:"fixed inset-0 z-40 bg-purple-900/20 backdrop-blur-sm lg:hidden",onClick:()=>n(!1)}),e.jsx("aside",{className:`h-screen w-64 transform transition-transform duration-300 ease-in-out fixed left-0 top-0 z-50 ${r?"translate-x-0":"-translate-x-full"} lg:translate-x-0 bg-background/95 backdrop-blur-md border-r border-purple-200/20`,children:e.jsx(Ht,{onClose:()=>n(!1),brand:t})}),e.jsxs("main",{className:"flex-1 lg:ml-64 min-w-0 relative z-10",children:[e.jsxs("div",{className:"sticky top-0 z-30 flex h-16 items-center border-b border-purple-200/20 bg-background/80 backdrop-blur-md px-4 lg:hidden",children:[e.jsx(u,{variant:"ghost",size:"sm",onClick:()=>n(d=>!d),className:"mr-2 hover:bg-purple-100/20 hover:text-purple-700",children:e.jsx(ja,{className:"h-6 w-6"})}),e.jsx("span",{className:"font-semibold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent",children:t})]}),s]})]})})},is=s=>{const t=(s??"").toLowerCase();if(t==="administrator"||t==="admin")return"administrator";if(t==="biuro")return"biuro";if(t==="logistyk")return"logistyk";if(t==="handlowiec")return"handlowiec";if(t==="operator")return"operator";if(t==="kierowca"||t==="kierowca_krotko"||t==="kierowca_dlugo")return"kierowca"},Ee=({expected:s,branchId:t,fallback:r=null,children:n})=>{const d=(Array.isArray(s)?s:[s]).map(is).filter(Boolean),{data:i,isLoading:l,isError:m}=ge({resource:"v_user_effective_roles",pagination:{pageSize:200,current:1}});return l?e.jsx("div",{className:"p-6",children:"Ładowanie…"}):m?e.jsx("div",{className:"p-6 text-red-600",children:"Błąd ładowania ról."}):(i?.data??[]).some(h=>{const o=is(h.role);if(!o)return!1;const j=d.includes(o),a=t?h.branch_id===t||h.branch_id===null:!0;return j&&a})?e.jsx(e.Fragment,{children:n}):e.jsx(e.Fragment,{children:r})},Gt=s=>{const r=(Array.isArray(s)?s:[s]).map(is).filter(Boolean),n=["administrator","biuro","logistyk","handlowiec","operator","kierowca"],d={administrator:"/admin/dashboard/overview",biuro:"/biuro/dashboard/overview",logistyk:"/logistyk/dashboard/overview",handlowiec:"/handlowiec/dashboard/overview",operator:"/operator/dashboard/overview",kierowca:"/kierowca/dashboard/overview"},i=n.find(l=>r.includes(l));return i?d[i]:"/admin/dashboard/overview"},De=({text:s,colorClass:t})=>e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-background",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`inline-block h-12 w-12 animate-spin rounded-full border-4 border-current border-r-transparent ${t}`}),e.jsx("p",{className:"mt-4 text-muted-foreground",children:s})]})}),P=({children:s})=>e.jsx("div",{className:"p-2 md:p-12 space-y-6 max-w-7xl mx-auto",children:s}),Yt={card:{wrap:"space-y-0",title:"font-medium",description:"text-muted-foreground"},lg:{wrap:"space-y-0",title:"text-3xl font-bold tracking-tight",description:"text-muted-foreground"},md:{wrap:"space-y-0",title:"font-medium",description:"text-muted-foreground"},sm:{wrap:"space-y-1",title:"font-medium text-sm text-muted-foreground mb-1",description:"text-sm"}},L=({title:s,description:t,variant:r="lg"})=>{const n=Yt[r],d=()=>{switch(r){case"lg":return e.jsx("h1",{className:n.title,children:s});case"md":return e.jsx("h2",{className:n.title,children:s});case"sm":return e.jsx("h3",{className:n.title,children:s});default:return e.jsx("h1",{className:n.title,children:s})}};return r==="card"?e.jsxs(e.Fragment,{children:[e.jsx($,{className:"text-lg font-semibold leading-tight flex items-center gap-2",children:s}),e.jsx(Na,{className:"text-sm text-muted-foreground mt-2",children:t})]}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:n.wrap,children:[d(),e.jsx("p",{className:`prose ${n.description}`,children:t})]})})},Xt={"between-center":"flex justify-between items-center gap-2",center:"flex justify-center items-center gap-2",start:"flex justify-start items-center gap-2",end:"flex justify-end items-center gap-2"},N=({children:s,variant:t="between-center",className:r=""})=>{const n=Xt[t],d=r?`${n} ${r}`:n;return e.jsx("div",{className:d,children:s})},Jt={"1-2-3":"grid gap-6 md:grid-cols-2 lg:grid-cols-3","1-2-2":"grid gap-6 md:grid-cols-2","1-1-1":"grid gap-6","2-2-4":"grid gap-6 grid-cols-2 lg:grid-cols-4"},k=({children:s,variant:t="1-2-3",className:r=""})=>{const n=Jt[t],d=r?`${n} ${r}`:n;return e.jsx("div",{className:d,children:s})},Ye=(s,t=[])=>{const{tableQuery:r}=se({resource:s,filters:t.length?{initial:t}:void 0,pagination:{current:1,pageSize:1}}),n=r.isLoading,d=typeof r.data?.total=="number"?r.data.total:void 0;return{loading:n,total:d}},Xe=({label:s,value:t,loading:r})=>e.jsxs(z,{children:[e.jsx(C,{className:"pb-2",children:e.jsx($,{className:"text-sm text-muted-foreground",children:s})}),e.jsx(S,{children:e.jsx("div",{className:"text-3xl font-bold",children:r?"…":t??"—"})})]}),ei=({role:s,label:t,Icon:r})=>{const n=je();return e.jsxs(z,{className:"hover:shadow-md transition",children:[e.jsx(C,{className:"pb-2",children:e.jsxs($,{className:"flex items-center gap-2",children:[e.jsx(r,{className:"h-5 w-5 opacity-70"}),t]})}),e.jsxs(S,{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Szybkie wejście do modułu"}),e.jsxs(u,{variant:"outline",size:"sm",className:"mt-3",onClick:()=>n(Gt(s)),children:["Wejdź",e.jsx(We,{className:"ml-2 h-4 w-4"})]})]})]})},si=()=>{const s=Ye("users"),t=Ye("branches"),r=Ye("tasks",[{field:"is_overdue_listed",operator:"eq",value:!0}]),n=[{role:"biuro",label:"Biuro",Icon:pa},{role:"logistyk",label:"Logistyk",Icon:Le},{role:"handlowiec",label:"Handlowiec",Icon:_e},{role:"operator",label:"Operator",Icon:ga},{role:"kierowca",label:"Kierowca",Icon:ue}];return e.jsxs(P,{children:[e.jsx(N,{children:e.jsx(L,{title:"Dashboard – Administrator",description:"Podsumowanie i skróty"})}),e.jsxs(k,{children:[e.jsx(Xe,{label:"Użytkownicy",value:s.total,loading:s.loading}),e.jsx(Xe,{label:"Oddziały",value:t.total,loading:t.loading}),e.jsx(Xe,{label:"Zadania overdue",value:r.total,loading:r.loading})]}),e.jsxs("div",{className:"mt-6 space-y-2",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Skróty do modułów ról"}),e.jsx(k,{children:n.map(({role:d,label:i,Icon:l})=>e.jsx(ei,{role:d,label:i,Icon:l},d))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Dostęp zostanie ostatecznie zweryfikowany przez RoleGuard w danym module."})]})]})},he=({current:s,pageSize:t,total:r,setCurrent:n,setPageSize:d,itemName:i="elementów",pageSizeOptions:l=[10,20,50]})=>{const m=Math.ceil(r/t),c=(s-1)*t+1,x=Math.min(s*t,r),h=s>1,o=s<m,j=()=>{const a=[];if(m<=5)for(let v=1;v<=m;v++)a.push(v);else{a.push(1),s>3&&a.push("...");const v=Math.max(2,s-1),F=Math.min(m-1,s+1);for(let R=v;R<=F;R++)a.push(R);s<m-2&&a.push("..."),a.push(m)}return a};return r===0?null:e.jsxs(N,{className:"mt-6",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Pokazuje ",c,"-",x," z ",r," ",i]}),e.jsxs(N,{className:"gap-2",children:[d&&e.jsxs(U,{value:t.toString(),onValueChange:a=>{d(parseInt(a)),n(1)},children:[e.jsx(T,{className:"w-[100px]",children:e.jsx(O,{})}),e.jsx(W,{children:l.map(a=>e.jsxs(E,{value:a.toString(),children:[a," / str."]},a))})]}),e.jsx(u,{variant:"outline",size:"sm",onClick:()=>n(s-1),disabled:!h,children:e.jsx(Wr,{className:"w-4 h-4"})}),e.jsx("div",{className:"hidden sm:flex gap-1",children:j().map((a,g)=>a==="..."?e.jsx("span",{className:"px-3 py-1 text-sm text-muted-foreground",children:"..."},`ellipsis-${g}`):e.jsx(u,{variant:s===a?"default":"outline",size:"sm",onClick:()=>n(a),className:"min-w-[40px]",children:a},a))}),e.jsxs("div",{className:"flex sm:hidden items-center px-3 text-sm",children:[s," / ",m]}),e.jsx(u,{variant:"outline",size:"sm",onClick:()=>n(s+1),disabled:!o,children:e.jsx(Be,{className:"w-4 h-4"})})]})]})},qa=()=>{const{tableQuery:{data:s,isLoading:t,isError:r},current:n,setCurrent:d,pageSize:i,setFilters:l}=se({resource:"tasks",sorters:{initial:[{field:"start_at",order:"desc"}]}}),{create:m,edit:c,show:x}=D(),h=I({isLoading:t,isError:r});return h||e.jsxs(P,{children:[e.jsxs(N,{children:[e.jsx(L,{title:"Zadania",description:"Lista zadań (kalendarz/plan)"}),e.jsxs(u,{onClick:()=>m("tasks"),children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Dodaj zadanie"]})]}),e.jsx(N,{children:e.jsx(w,{placeholder:"Szukaj po tytule...",className:"max-w-sm",onChange:o=>l([{field:"title",operator:"contains",value:o.target.value}])})}),e.jsx(k,{children:s?.data?.map(o=>e.jsxs(z,{children:[e.jsx(C,{children:e.jsx(L,{title:o.title,description:`Oddział #${o.branch_id} • ${new Date(o.start_at).toLocaleString()}`,variant:"card"})}),e.jsx(S,{children:e.jsxs(N,{variant:"start",className:"gap-2",children:[e.jsx(y,{variant:"secondary",children:o.type}),e.jsx(y,{variant:"outline",children:o.status}),o.assigned_vehicle_id&&e.jsxs(y,{variant:"outline",className:"text-xs",children:["pojazd #",o.assigned_vehicle_id]}),o.assigned_container_id&&e.jsxs(y,{variant:"outline",className:"text-xs",children:["kontener #",o.assigned_container_id]})]})}),e.jsx(ne,{children:e.jsxs(N,{variant:"start",className:"gap-2",children:[e.jsx(u,{variant:"outline",size:"sm",onClick:()=>x("tasks",o.id),children:e.jsx(oe,{className:"w-4 h-4"})}),e.jsx(u,{variant:"outline",size:"sm",onClick:()=>c("tasks",o.id),children:e.jsx(H,{className:"w-4 h-4"})})]})})]},o.id))}),e.jsx(he,{current:n,pageSize:i,total:s?.total||0,setCurrent:d,itemName:"zadania"})]})},G=({children:s,onSubmit:t,className:r="",...n})=>{const d="space-y-6",i=r?`${d} ${r}`:d;return e.jsx("form",{onSubmit:t,className:i,...n,children:s})},p=({children:s,label:t,htmlFor:r,error:n,required:d=!1,className:i="",hint:l})=>{const m="space-y-2",c=i?`${m} ${i}`:m,x=()=>t?typeof t=="string"?e.jsxs(ts,{htmlFor:r,children:[t,d&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}):e.jsxs(ts,{htmlFor:r,className:"flex items-center",children:[t,d&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}):null,h=f.isValidElement(s)?f.cloneElement(s,{className:`${s.props.className||""} ${n?"border-red-500 ring-1 ring-red-500":""}`.trim()}):s;return e.jsxs("div",{className:c,children:[x(),h,l&&!n&&e.jsx("p",{className:"text-sm text-muted-foreground",children:l}),n&&e.jsx("p",{className:"text-sm text-red-500",children:n})]})},Z=({children:s,className:t=""})=>{const r="flex justify-end items-center gap-4 pt-6 border-t",n=t?`${r} ${t}`:r;return e.jsx("div",{className:n,children:s})},A=({resource:s,value:t,onChange:r,valueField:n="id",labelField:d,renderLabel:i,placeholder:l="Wybierz…",pageSize:m=100,filters:c})=>{const x=[{field:String(d??n),order:"asc"}],{data:h,isLoading:o,isError:j}=ge({resource:s,filters:c,sorters:x,pagination:{current:1,pageSize:m}}),a=h?.data??[],g=f.useMemo(()=>a.map(F=>{const R=String(F[n]),B=i?i(F):d?String(F[d]??R):R;return{id:R,label:B}}),[a,n,d,i]),v=o||j||g.length===0;return e.jsxs(U,{value:t!=null?String(t):void 0,onValueChange:r,disabled:v,children:[e.jsx(T,{children:e.jsx(O,{placeholder:o?"Ładowanie…":j?"Błąd ładowania":l})}),e.jsx(W,{children:g.map(F=>e.jsx(E,{value:F.id,children:F.label},F.id))})]})},ai=["transport","plac"],ri=["nowe","w_realizacji","zakonczone","anulowane"],Fa=()=>{const{list:s}=D(),{data:t}=Me(),{refineCore:{onFinish:r},register:n,handleSubmit:d,setValue:i,watch:l,formState:{errors:m,isSubmitting:c}}=Q({refineCoreProps:{resource:"tasks"}}),x=v=>r({...v,created_by:t?.id}),h=l("branch_id"),o=v=>i("branch_id",Number(v),{shouldValidate:!0}),j=v=>i("assigned_vehicle_id",Number(v)),a=v=>i("assigned_container_id",Number(v)),g=v=>i("assigned_driver",v);return e.jsxs(P,{children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>s("tasks"),children:[e.jsx(V,{className:"w-4 h-4 mr-2"})," Powrót do listy"]}),e.jsx(N,{children:e.jsx(L,{title:"Nowe zadanie",description:"Utwórz nowe zadanie"})}),e.jsxs(z,{children:[e.jsx(C,{children:e.jsx($,{children:"Parametry"})}),e.jsx(S,{children:e.jsxs(G,{onSubmit:d(x),children:[e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Tytuł",htmlFor:"title",error:m.title?.message,required:!0,children:e.jsx(w,{id:"title",...n("title",{required:"Wymagane"})})}),e.jsx(p,{label:"Typ",error:m.type?.message,required:!0,children:e.jsxs(U,{onValueChange:v=>i("type",v),children:[e.jsx(T,{children:e.jsx(O,{placeholder:"Wybierz typ"})}),e.jsx(W,{children:ai.map(v=>e.jsx(E,{value:v,children:v},v))})]})})]}),e.jsx(p,{label:"Opis",children:e.jsx(ie,{rows:3,...n("description")})}),e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Oddział (branch_id)",required:!0,error:m.branch_id?.message,children:e.jsx(A,{resource:"branches",value:h,onChange:o,renderLabel:v=>`${v.name}${v.city?" — "+v.city:""} (#${v.id})`,placeholder:"Wybierz oddział"})}),e.jsx(p,{label:"Status",required:!0,children:e.jsxs(U,{defaultValue:"nowe",onValueChange:v=>i("status",v),children:[e.jsx(T,{children:e.jsx(O,{placeholder:"Wybierz status"})}),e.jsx(W,{children:ri.map(v=>e.jsx(E,{value:v,children:v},v))})]})})]}),e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Start (start_at)",htmlFor:"start_at",required:!0,children:e.jsx(w,{id:"start_at",type:"datetime-local",...n("start_at",{required:"Wymagane"})})}),e.jsx(p,{label:"Koniec (end_at)",htmlFor:"end_at",children:e.jsx(w,{id:"end_at",type:"datetime-local",...n("end_at")})})]}),e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Kierowca (UUID)",children:e.jsx(A,{resource:"users",value:l("assigned_driver"),onChange:g,renderLabel:v=>`${v.full_name||v.email} (#${String(v.id).slice(0,8)})`,placeholder:"Wybierz kierowcę (opcjonalnie)"})}),e.jsx(p,{label:"Pojazd (assigned_vehicle_id)",children:e.jsx(A,{resource:"vehicles",value:l("assigned_vehicle_id"),onChange:j,renderLabel:v=>`${v.name}${v.reg_plate?" / "+v.reg_plate:""} (#${v.id})`,placeholder:"Wybierz pojazd (opcjonalnie)"})}),e.jsx(p,{label:"Kontener (assigned_container_id)",children:e.jsx(A,{resource:"containers",value:l("assigned_container_id"),onChange:a,renderLabel:v=>`${v.code} [${v.status}]${v.category?" / "+v.category:""} (#${v.id})`,placeholder:"Wybierz kontener (opcjonalnie)"})})]}),e.jsxs(Z,{children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>s("tasks"),children:"Anuluj"}),e.jsx(u,{type:"submit",disabled:c||!t?.id,children:c?"Tworzenie...":"Utwórz"})]})]})})]})]})},ti=["transport","plac"],ii=["nowe","w_realizacji","zakonczone","anulowane"],Aa=()=>{const{show:s}=D(),{refineCore:{onFinish:t,queryResult:r},register:n,handleSubmit:d,setValue:i,watch:l,formState:{errors:m,isSubmitting:c}}=Q({refineCoreProps:{resource:"tasks",action:"edit"}}),x=r?.isLoading??!0,h=r?.isError??!1,o=r?.data?.data,j=I({isLoading:x,isError:h});if(j)return j;if(!o)return null;const a=R=>i("branch_id",Number(R),{shouldValidate:!0}),g=R=>i("assigned_vehicle_id",Number(R)),v=R=>i("assigned_container_id",Number(R)),F=R=>i("assigned_driver",R);return e.jsxs(P,{children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>s("tasks",o.id),children:[e.jsx(V,{className:"w-4 h-4 mr-2"})," Powrót do szczegółów"]}),e.jsx(N,{children:e.jsx(L,{title:"Edycja zadania",description:`ID: #${String(o.id).slice(0,8)}`})}),e.jsxs(z,{children:[e.jsx(C,{children:e.jsx($,{children:"Parametry"})}),e.jsx(S,{children:e.jsxs(G,{onSubmit:d(t),children:[e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Tytuł",htmlFor:"title",error:m.title?.message,required:!0,children:e.jsx(w,{id:"title",...n("title",{required:"Wymagane"})})}),e.jsx(p,{label:"Typ",required:!0,children:e.jsxs(U,{defaultValue:o.type,onValueChange:R=>i("type",R),children:[e.jsx(T,{children:e.jsx(O,{placeholder:"Wybierz typ"})}),e.jsx(W,{children:ti.map(R=>e.jsx(E,{value:R,children:R},R))})]})})]}),e.jsx(p,{label:"Opis",children:e.jsx(ie,{rows:3,...n("description")})}),e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Oddział (branch_id)",required:!0,error:m.branch_id?.message,children:e.jsx(A,{resource:"branches",value:l("branch_id")??o.branch_id,onChange:a,renderLabel:R=>`${R.name}${R.city?" — "+R.city:""} (#${R.id})`,placeholder:"Wybierz oddział"})}),e.jsx(p,{label:"Status",required:!0,children:e.jsxs(U,{defaultValue:o.status,onValueChange:R=>i("status",R),children:[e.jsx(T,{children:e.jsx(O,{placeholder:"Wybierz status"})}),e.jsx(W,{children:ii.map(R=>e.jsx(E,{value:R,children:R},R))})]})})]}),e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Start (start_at)",htmlFor:"start_at",required:!0,children:e.jsx(w,{id:"start_at",type:"datetime-local",...n("start_at",{required:"Wymagane"})})}),e.jsx(p,{label:"Koniec (end_at)",htmlFor:"end_at",children:e.jsx(w,{id:"end_at",type:"datetime-local",...n("end_at")})})]}),e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Kierowca (UUID)",children:e.jsx(A,{resource:"users",value:l("assigned_driver")??o.assigned_driver,onChange:F,renderLabel:R=>`${R.full_name||R.email} (#${String(R.id).slice(0,8)})`,placeholder:"Wybierz kierowcę (opcjonalnie)"})}),e.jsx(p,{label:"Pojazd (assigned_vehicle_id)",children:e.jsx(A,{resource:"vehicles",value:l("assigned_vehicle_id")??o.assigned_vehicle_id,onChange:g,renderLabel:R=>`${R.name}${R.reg_plate?" / "+R.reg_plate:""} (#${R.id})`,placeholder:"Wybierz pojazd (opcjonalnie)"})}),e.jsx(p,{label:"Kontener (assigned_container_id)",children:e.jsx(A,{resource:"containers",value:l("assigned_container_id")??o.assigned_container_id,onChange:v,renderLabel:R=>`${R.code} [${R.status}]${R.category?" / "+R.category:""} (#${R.id})`,placeholder:"Wybierz kontener (opcjonalnie)"})})]}),e.jsxs(Z,{children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>s("tasks",o.id),children:"Anuluj"}),e.jsx(u,{type:"submit",disabled:c,children:c?"Zapisywanie...":"Zapisz"})]})]})})]})]})},Ia=()=>{const{queryResult:s}=ce({resource:"tasks"}),{list:t,edit:r}=D(),n=s?.isLoading??!0,d=s?.isError??!1,i=s?.data?.data,l=I({isLoading:n,isError:d});return l||(i?e.jsxs(P,{children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>t("tasks"),children:[e.jsx(V,{className:"w-4 h-4 mr-2"})," Powrót do listy"]}),e.jsxs(N,{children:[e.jsx(L,{title:i.title,description:`ID: #${String(i.id).slice(0,8)}`}),e.jsxs(u,{variant:"outline",onClick:()=>r("tasks",i.id),children:[e.jsx(H,{className:"w-4 h-4 mr-2"})," Edytuj"]})]}),e.jsxs(z,{children:[e.jsx(C,{children:e.jsx($,{children:"Szczegóły"})}),e.jsxs(S,{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(y,{variant:"secondary",children:i.type}),e.jsx(y,{variant:"outline",children:i.status})]}),e.jsx(K,{}),e.jsxs("div",{className:"text-sm",children:[e.jsxs("div",{children:[e.jsx("b",{children:"Oddział:"})," ",i.branch_id]}),e.jsxs("div",{children:[e.jsx("b",{children:"Start:"})," ",new Date(i.start_at).toLocaleString()]}),i.end_at&&e.jsxs("div",{children:[e.jsx("b",{children:"Koniec:"})," ",new Date(i.end_at).toLocaleString()]}),i.assigned_driver&&e.jsxs("div",{children:[e.jsx("b",{children:"Kierowca (UUID):"})," ",i.assigned_driver]}),i.assigned_vehicle_id&&e.jsxs("div",{children:[e.jsx("b",{children:"Pojazd:"})," #",i.assigned_vehicle_id]}),i.assigned_container_id&&e.jsxs("div",{children:[e.jsx("b",{children:"Kontener:"})," #",i.assigned_container_id]})]})]})]})]}):null)},ns={name:"tasks",list:"/admin/tasks",create:"/admin/tasks/create",edit:"/admin/tasks/edit/:id",show:"/admin/tasks/show/:id",meta:{label:"Zadania"}},Ta=[e.jsx(b,{index:!0,element:e.jsx(qa,{})},"tasks-index"),e.jsx(b,{path:"create",element:e.jsx(Fa,{})},"tasks-create"),e.jsx(b,{path:"edit/:id",element:e.jsx(Aa,{})},"tasks-edit"),e.jsx(b,{path:"show/:id",element:e.jsx(Ia,{})},"tasks-show")],Wa=()=>{const{tableQuery:{data:s,isLoading:t,isError:r},current:n,setCurrent:d,pageSize:i,setFilters:l}=se({resource:"vehicles",sorters:{initial:[{field:"created_at",order:"desc"}]}}),{create:m,edit:c,show:x}=D(),h=je(),o=I({isLoading:t,isError:r});return o||e.jsxs(P,{children:[e.jsxs(N,{children:[e.jsx(L,{title:"Flota",description:"Pojazdy w systemie"}),e.jsxs(u,{onClick:()=>m("vehicles"),children:[e.jsx(ee,{className:"w-4 h-4 mr-2"})," Dodaj pojazd"]})]}),e.jsx(N,{children:e.jsx(w,{placeholder:"Szukaj po nazwie...",className:"max-w-sm",onChange:j=>l([{field:"name",operator:"contains",value:j.target.value}])})}),e.jsx(k,{children:s?.data?.map(j=>e.jsxs(z,{children:[e.jsx(C,{children:e.jsx(L,{title:j.name,description:`Oddział #${j.branch_id}`,variant:"card"})}),e.jsx(S,{children:e.jsxs(N,{variant:"start",className:"gap-2",children:[e.jsx(y,{variant:"secondary",children:j.type}),j.reg_plate&&e.jsx(y,{variant:"outline",children:j.reg_plate}),j.is_archived&&e.jsx(y,{variant:"destructive",children:"archiwum"})]})}),e.jsx(ne,{children:e.jsxs(N,{variant:"start",className:"gap-2",children:[e.jsx(u,{variant:"outline",size:"sm",onClick:()=>x("vehicles",j.id),children:e.jsx(oe,{className:"w-4 h-4"})}),e.jsx(u,{variant:"outline",size:"sm",onClick:()=>c("vehicles",j.id),children:e.jsx(H,{className:"w-4 h-4"})}),j.asset_id&&e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>h(`/admin/maintenances/create?asset_id=${j.asset_id}&kind=usterka`),children:[e.jsx(Re,{className:"w-4 h-4 mr-1"})," Zgłoś usterkę"]})]})})]},j.id))}),e.jsx(he,{current:n,pageSize:i,total:s?.total||0,setCurrent:d,itemName:"pojazdy"})]})},ni=["ciezarowe","osobowe","przyczepa","naczepa"],Va=()=>{const{list:s}=D(),{refineCore:{onFinish:t},register:r,handleSubmit:n,setValue:d,watch:i,formState:{errors:l,isSubmitting:m}}=Q({refineCoreProps:{resource:"vehicles"}});return e.jsxs(P,{children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>s("vehicles"),children:[e.jsx(V,{className:"w-4 h-4 mr-2"})," Powrót do listy"]}),e.jsx(N,{children:e.jsx(L,{title:"Nowy pojazd",description:"Dodaj pojazd"})}),e.jsxs(z,{children:[e.jsx(C,{children:e.jsx($,{children:"Parametry"})}),e.jsx(S,{children:e.jsxs(G,{onSubmit:n(t),children:[e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Nazwa",htmlFor:"name",error:l.name?.message,required:!0,children:e.jsx(w,{id:"name",...r("name",{required:"Wymagane"})})}),e.jsx(p,{label:"Typ",required:!0,children:e.jsxs(U,{onValueChange:c=>d("type",c),children:[e.jsx(T,{children:e.jsx(O,{placeholder:"Wybierz typ"})}),e.jsx(W,{children:ni.map(c=>e.jsx(E,{value:c,children:c},c))})]})})]}),e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Oddział (branch_id)",required:!0,error:l.branch_id?.message,children:e.jsx(A,{resource:"branches",value:i("branch_id"),onChange:c=>d("branch_id",Number(c),{shouldValidate:!0}),renderLabel:c=>`${c.name}${c.city?" — "+c.city:""} (#${c.id})`,placeholder:"Wybierz oddział"})}),e.jsx(p,{label:"Rejestracja",htmlFor:"reg_plate",children:e.jsx(w,{id:"reg_plate",...r("reg_plate")})})]}),e.jsx(p,{label:"VIN",htmlFor:"vin",children:e.jsx(w,{id:"vin",...r("vin")})}),e.jsxs(Z,{children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>s("vehicles"),children:"Anuluj"}),e.jsx(u,{type:"submit",disabled:m,children:m?"Tworzenie...":"Utwórz"})]})]})})]})]})},li=["ciezarowe","osobowe","przyczepa","naczepa"],Ua=()=>{const{show:s}=D(),{refineCore:{onFinish:t,queryResult:r},register:n,handleSubmit:d,setValue:i,watch:l,formState:{errors:m,isSubmitting:c}}=Q({refineCoreProps:{resource:"vehicles",action:"edit"}}),x=r?.isLoading??!0,h=r?.isError??!1,o=r?.data?.data,j=I({isLoading:x,isError:h});return j||(o?e.jsxs(P,{children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>s("vehicles",o.id),children:[e.jsx(V,{className:"w-4 h-4 mr-2"})," Powrót do szczegółów"]}),e.jsx(N,{children:e.jsx(L,{title:"Edycja pojazdu",description:`ID: #${String(o.id).slice(0,8)}`})}),e.jsxs(z,{children:[e.jsx(C,{children:e.jsx($,{children:"Parametry"})}),e.jsx(S,{children:e.jsxs(G,{onSubmit:d(t),children:[e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Nazwa",htmlFor:"name",error:m.name?.message,required:!0,children:e.jsx(w,{id:"name",...n("name",{required:"Wymagane"})})}),e.jsx(p,{label:"Typ",required:!0,children:e.jsxs(U,{defaultValue:o.type,onValueChange:a=>i("type",a),children:[e.jsx(T,{children:e.jsx(O,{placeholder:"Wybierz typ"})}),e.jsx(W,{children:li.map(a=>e.jsx(E,{value:a,children:a},a))})]})})]}),e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Oddział (branch_id)",required:!0,error:m.branch_id?.message,children:e.jsx(A,{resource:"branches",value:l("branch_id")??o.branch_id,onChange:a=>i("branch_id",Number(a),{shouldValidate:!0}),renderLabel:a=>`${a.name}${a.city?" — "+a.city:""} (#${a.id})`,placeholder:"Wybierz oddział"})}),e.jsx(p,{label:"Rejestracja",htmlFor:"reg_plate",children:e.jsx(w,{id:"reg_plate",...n("reg_plate")})})]}),e.jsx(p,{label:"VIN",htmlFor:"vin",children:e.jsx(w,{id:"vin",...n("vin")})}),e.jsxs(Z,{children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>s("vehicles",o.id),children:"Anuluj"}),e.jsx(u,{type:"submit",disabled:c,children:c?"Zapisywanie...":"Zapisz"})]})]})})]})]}):null)},di=["vehicle","container","equipment"],ms=["przeglad","oc","tacho","naprawa","usterka","inne"],ci=()=>{const{tableQuery:{data:s,isLoading:t,isError:r},current:n,setCurrent:d,pageSize:i,setFilters:l}=se({resource:le,sorters:{initial:[{field:"due_at",order:"asc"}]}}),{create:m,edit:c,show:x}=D(),h=I({isLoading:t,isError:r});if(h)return h;const o=g=>l([{field:"asset_label",operator:"contains",value:g}]),j=g=>l(v=>{const F=(v||[]).filter(R=>R.field!=="service_kind");return g?[...F,{field:"service_kind",operator:"eq",value:g}]:F}),a=g=>l(v=>{const F=(v||[]).filter(R=>R.field!=="asset_kind");return g?[...F,{field:"asset_kind",operator:"eq",value:g}]:F});return e.jsxs(P,{children:[e.jsxs(N,{children:[e.jsx(L,{title:"Serwis / Utrzymanie",description:"Terminy i historia"}),e.jsxs(u,{onClick:()=>m(le),children:[e.jsx(ee,{className:"w-4 h-4 mr-2"})," Dodaj wpis"]})]}),e.jsxs(N,{className:"gap-3",children:[e.jsx(w,{placeholder:"Szukaj po zasobie…",className:"max-w-sm",onChange:g=>o(g.target.value)}),e.jsxs(U,{onValueChange:g=>j(g==="__clear__"?void 0:g),children:[e.jsx(T,{className:"w-56",children:e.jsx(O,{placeholder:"Filtr: typ serwisu"})}),e.jsxs(W,{children:[ms.map(g=>e.jsx(E,{value:g,children:g},g)),e.jsx(E,{value:"__clear__",children:"Wyczyść"})]})]}),e.jsxs(U,{onValueChange:g=>a(g==="__clear__"?void 0:g),children:[e.jsx(T,{className:"w-56",children:e.jsx(O,{placeholder:"Filtr: zasób"})}),e.jsxs(W,{children:[di.map(g=>e.jsx(E,{value:g,children:g},g)),e.jsx(E,{value:"__clear__",children:"Wyczyść"})]})]})]}),e.jsx(k,{children:s?.data?.map(g=>e.jsxs(z,{children:[e.jsx(C,{children:e.jsx(L,{title:`${g.asset_label}`,description:g.service_kind,variant:"card"})}),e.jsx(S,{children:e.jsxs(N,{variant:"start",className:"gap-2",children:[e.jsxs(y,{variant:"outline",children:["SID #",g.service_id]}),e.jsxs(y,{variant:"secondary",children:[g.asset_kind," #",g.asset_id]}),g.branch_id&&e.jsxs(y,{variant:"outline",children:["oddział #",g.branch_id]}),g.done_at?e.jsxs(y,{variant:"outline",children:["zakończono ",new Date(g.done_at).toLocaleDateString()]}):e.jsxs(y,{variant:"destructive",children:[e.jsx(Vr,{className:"w-3 h-3 mr-1"})," termin: ",g.due_at?new Date(g.due_at).toLocaleDateString():"—"]})]})}),e.jsx(ne,{children:e.jsxs(N,{variant:"start",className:"gap-2",children:[e.jsx(u,{variant:"outline",size:"sm",onClick:()=>x(le,g.service_id),children:e.jsx(oe,{className:"w-4 h-4"})}),e.jsx(u,{variant:"outline",size:"sm",onClick:()=>c(le,g.service_id),children:e.jsx(H,{className:"w-4 h-4"})})]})})]},g.service_id))}),e.jsx(he,{current:n,pageSize:i,total:s?.total||0,setCurrent:d,itemName:"wpisy"})]})},oi=()=>{const{list:s}=D(),t=ca(),{refineCore:{onFinish:r},register:n,handleSubmit:d,setValue:i,watch:l,formState:{errors:m,isSubmitting:c}}=Q({refineCoreProps:{resource:Oa}});return ye.useEffect(()=>{const x=new URLSearchParams(t.search),h=x.get("asset_id"),o=x.get("kind");h&&i("asset_id",Number(h),{shouldValidate:!0}),o&&i("kind",o,{shouldValidate:!0})},[t.search,i]),e.jsxs(P,{children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>s(le),children:[e.jsx(V,{className:"w-4 h-4 mr-2"})," Powrót do listy"]}),e.jsx(N,{children:e.jsx(L,{title:"Nowy wpis serwisowy",description:"Termin/wykonanie dla zasobu"})}),e.jsxs(z,{children:[e.jsx(C,{children:e.jsx($,{children:"Parametry"})}),e.jsx(S,{children:e.jsxs(G,{onSubmit:d(r),children:[e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Zasób (assets)",required:!0,error:m.asset_id?.message,children:e.jsx(A,{resource:"assets",value:l("asset_id"),onChange:x=>i("asset_id",Number(x),{shouldValidate:!0}),renderLabel:x=>`${x.label} [${x.kind}] (#${x.id})`,placeholder:"Wybierz zasób"})}),e.jsx(p,{label:"Typ serwisu",required:!0,error:m.kind?.message,children:e.jsxs(U,{defaultValue:l("kind"),onValueChange:x=>i("kind",x,{shouldValidate:!0}),children:[e.jsx(T,{children:e.jsx(O,{placeholder:"Wybierz typ"})}),e.jsx(W,{children:ms.map(x=>e.jsx(E,{value:x,children:x},x))})]})})]}),e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Termin (due_at)",htmlFor:"due_at",children:e.jsx(w,{id:"due_at",type:"date",...n("due_at")})}),e.jsx(p,{label:"Wykonano (done_at)",htmlFor:"done_at",children:e.jsx(w,{id:"done_at",type:"date",...n("done_at")})})]}),e.jsx(p,{label:"Notatki",children:e.jsx(ie,{rows:3,...n("notes")})}),e.jsxs(Z,{children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>s(le),children:"Anuluj"}),e.jsx(u,{type:"submit",disabled:c,children:c?"Tworzenie...":"Utwórz"})]})]})})]})]})},hi=()=>{const{show:s}=D(),{refineCore:{onFinish:t,queryResult:r},register:n,handleSubmit:d,setValue:i,watch:l,formState:{errors:m,isSubmitting:c}}=Q({refineCoreProps:{resource:Oa,action:"edit"}}),x=r?.isLoading??!0,h=r?.isError??!1,o=r?.data?.data,j=I({isLoading:x,isError:h});return j||(o?e.jsxs(P,{children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>s(le,o.id),children:[e.jsx(V,{className:"w-4 h-4 mr-2"})," Powrót do szczegółów"]}),e.jsx(N,{children:e.jsx(L,{title:"Edycja wpisu serwisowego",description:`SID: #${o.id}`})}),e.jsxs(z,{children:[e.jsx(C,{children:e.jsx($,{children:"Parametry"})}),e.jsx(S,{children:e.jsxs(G,{onSubmit:d(t),children:[e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Zasób (assets)",required:!0,error:m.asset_id?.message,children:e.jsx(A,{resource:"assets",value:l("asset_id")??o.asset_id,onChange:a=>i("asset_id",Number(a),{shouldValidate:!0}),renderLabel:a=>`${a.label} [${a.kind}] (#${a.id})`,placeholder:"Wybierz zasób"})}),e.jsx(p,{label:"Typ serwisu",required:!0,error:m.kind?.message,children:e.jsxs(U,{defaultValue:o.kind,onValueChange:a=>i("kind",a,{shouldValidate:!0}),children:[e.jsx(T,{children:e.jsx(O,{placeholder:"Wybierz typ"})}),e.jsx(W,{children:ms.map(a=>e.jsx(E,{value:a,children:a},a))})]})})]}),e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Termin (due_at)",htmlFor:"due_at",children:e.jsx(w,{id:"due_at",type:"date",...n("due_at")})}),e.jsx(p,{label:"Wykonano (done_at)",htmlFor:"done_at",children:e.jsx(w,{id:"done_at",type:"date",...n("done_at")})})]}),e.jsx(p,{label:"Notatki",children:e.jsx(ie,{rows:3,...n("notes")})}),e.jsxs(Z,{children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>s(le,o.id),children:"Anuluj"}),e.jsx(u,{type:"submit",disabled:c,children:c?"Zapisywanie...":"Zapisz"})]})]})})]})]}):null)},xi=()=>{const{queryResult:s}=ce({resource:le}),{list:t,edit:r}=D(),n=s?.isLoading??!0,d=s?.isError??!1,i=s?.data?.data,l=I({isLoading:n,isError:d});return l||(i?e.jsxs(P,{children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>t(le),children:[e.jsx(V,{className:"w-4 h-4 mr-2"})," Powrót do listy"]}),e.jsxs(N,{children:[e.jsx(L,{title:`${i.asset_label}`,description:`SID: #${i.service_id}`}),e.jsxs(u,{variant:"outline",onClick:()=>r(le,i.service_id),children:[e.jsx(H,{className:"w-4 h-4 mr-2"})," Edytuj"]})]}),e.jsxs(z,{children:[e.jsx(C,{children:e.jsx($,{children:"Szczegóły"})}),e.jsxs(S,{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(y,{variant:"secondary",children:i.service_kind}),e.jsxs(y,{variant:"outline",children:[i.asset_kind," #",i.asset_id]}),i.branch_id&&e.jsxs(y,{variant:"outline",children:["oddział #",i.branch_id]}),i.done_at?e.jsx(y,{variant:"outline",children:"wykonano"}):e.jsxs(y,{variant:"destructive",children:["do: ",i.due_at?new Date(i.due_at).toLocaleDateString():"—"]})]}),e.jsx(K,{}),e.jsxs("div",{className:"text-sm space-y-1",children:[i.notes&&e.jsxs("div",{children:[e.jsx("b",{children:"Notatki:"})," ",i.notes]}),i.created_at&&e.jsxs("div",{children:[e.jsx("b",{children:"Utworzono:"})," ",new Date(i.created_at).toLocaleString()]}),i.done_at&&e.jsxs("div",{children:[e.jsx("b",{children:"Zakończono:"})," ",new Date(i.done_at).toLocaleString()]})]})]})]})]}):null)},le="asset_maintenances",Oa="asset_service",Ns={name:le,list:"/admin/maintenances",create:"/admin/maintenances/create",edit:"/admin/maintenances/edit/:id",show:"/admin/maintenances/show/:id",meta:{label:"Serwis / Utrzymanie"}},ui=[e.jsx(b,{index:!0,element:e.jsx(ci,{})},"maint-index"),e.jsx(b,{path:"create",element:e.jsx(oi,{})},"maint-create"),e.jsx(b,{path:"edit/:id",element:e.jsx(hi,{})},"maint-edit"),e.jsx(b,{path:"show/:id",element:e.jsx(xi,{})},"maint-show")],Ba=()=>{const{queryResult:s}=ce({resource:"vehicles"}),{list:t,edit:r}=D(),n=je(),d=s?.isLoading??!0,i=s?.isError??!1,l=s?.data?.data?.asset_id,m=ge({resource:le,filters:l?[{field:"asset_id",operator:"eq",value:l}]:[],sorters:[{field:"due_at",order:"asc"}],pagination:{current:1,pageSize:100},queryOptions:{enabled:!!l}}),c=I({isLoading:d,isError:i});if(c)return c;const x=s?.data?.data;if(!x)return null;const h=m.data?.data??[],o=h.filter(g=>!g.done_at&&g.due_at).sort((g,v)=>+new Date(g.due_at)-+new Date(v.due_at))[0],j=h.filter(g=>g.service_kind==="usterka"&&!g.done_at),a=h.filter(g=>g.done_at&&["naprawa","usterka","inne"].includes(g.service_kind)).sort((g,v)=>+new Date(v.done_at)-+new Date(g.done_at));return e.jsxs(P,{children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>t("vehicles"),children:[e.jsx(V,{className:"w-4 h-4 mr-2"})," Powrót do listy"]}),e.jsxs(N,{children:[e.jsx(L,{title:x.name,description:`ID: #${x.id}`}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(u,{variant:"outline",onClick:()=>r("vehicles",x.id),children:[e.jsx(H,{className:"w-4 h-4 mr-2"})," Edytuj"]}),e.jsxs(u,{variant:"outline",onClick:()=>n(`/admin/maintenances/create?asset_id=${x.asset_id}&kind=usterka`),children:[e.jsx(Re,{className:"w-4 h-4 mr-2"})," Zgłoś usterkę"]}),e.jsxs(u,{variant:"outline",onClick:()=>n(`/admin/maintenances/create?asset_id=${x.asset_id}`),children:[e.jsx(ee,{className:"w-4 h-4 mr-2"})," Dodaj wpis"]})]})]}),e.jsxs(z,{children:[e.jsx(C,{children:e.jsx($,{children:"Szczegóły"})}),e.jsxs(S,{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(y,{variant:"secondary",children:x.type}),x.reg_plate&&e.jsx(y,{variant:"outline",children:x.reg_plate}),e.jsxs(y,{variant:"outline",children:["oddział #",x.branch_id]}),x.is_archived&&e.jsx(y,{variant:"destructive",children:"archiwum"})]}),e.jsx(K,{}),e.jsxs("div",{className:"text-sm space-y-1",children:[x.vin&&e.jsxs("div",{children:[e.jsx("b",{children:"VIN:"})," ",x.vin]}),x.created_at&&e.jsxs("div",{children:[e.jsx("b",{children:"Utworzono:"})," ",new Date(x.created_at).toLocaleString()]}),x.updated_at&&e.jsxs("div",{children:[e.jsx("b",{children:"Aktualizacja:"})," ",new Date(x.updated_at).toLocaleString()]})]})]})]}),e.jsxs(z,{className:"mt-4",children:[e.jsx(C,{children:e.jsx($,{children:"Książka serwisowa"})}),e.jsxs(S,{className:"space-y-4",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("b",{children:"Następny przegląd:"})," ",o?.due_at?new Date(o.due_at).toLocaleDateString():"—"]}),e.jsx(K,{}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium mb-2",children:"Aktywne zgłoszenia usterek"}),j.length===0?e.jsx("div",{className:"text-sm text-muted-foreground",children:"Brak aktywnych zgłoszeń."}):e.jsx("div",{className:"space-y-3",children:j.map(g=>e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"font-medium",children:g.service_kind}),e.jsxs(u,{size:"sm",variant:"outline",onClick:()=>n(`/admin/maintenances/edit/${g.service_id}`),children:[e.jsx(xs,{className:"w-4 h-4 mr-2"})," Zakończ"]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Zgłoszono:"," ",g.created_at?new Date(g.created_at).toLocaleString():"—"]}),g.notes&&e.jsx("div",{className:"text-sm mt-2",children:g.notes})]},g.service_id))})]}),e.jsx(K,{}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"font-medium",children:"Historia napraw"}),e.jsxs(u,{size:"sm",variant:"outline",onClick:()=>n(`/admin/maintenances/create?asset_id=${x.asset_id}&kind=naprawa`),children:[e.jsx(ee,{className:"w-4 h-4 mr-2"})," Dodaj wpis"]})]}),a.length===0?e.jsx("div",{className:"text-sm text-muted-foreground mt-2",children:"Brak zakończonych napraw."}):e.jsx("div",{className:"space-y-3 mt-2",children:a.map(g=>e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsx("div",{className:"font-medium",children:g.service_kind}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:g.done_at?new Date(g.done_at).toLocaleDateString():"—"}),g.notes&&e.jsx("div",{className:"text-sm mt-2",children:g.notes})]},g.service_id))})]})]})]})]})},ls={name:"vehicles",list:"/admin/vehicles",create:"/admin/vehicles/create",edit:"/admin/vehicles/edit/:id",show:"/admin/vehicles/show/:id",meta:{label:"Flota"}},Ma=[e.jsx(b,{index:!0,element:e.jsx(Wa,{})},"vehicles-index"),e.jsx(b,{path:"create",element:e.jsx(Va,{})},"vehicles-create"),e.jsx(b,{path:"edit/:id",element:e.jsx(Ua,{})},"vehicles-edit"),e.jsx(b,{path:"show/:id",element:e.jsx(Ba,{})},"vehicles-show")],mi=()=>{const{tableQuery:{data:s,isLoading:t,isError:r},current:n,setCurrent:d,pageSize:i,setFilters:l}=se({resource:"branches",sorters:{initial:[{field:"created_at",order:"desc"}]}}),{create:m,edit:c,show:x}=D(),h=I({isLoading:t,isError:r});return h||e.jsxs(P,{children:[e.jsxs(N,{children:[e.jsx(L,{title:"Oddziały",description:"Lista placówek"}),e.jsxs(u,{onClick:()=>m("branches"),children:[e.jsx(ee,{className:"w-4 h-4 mr-2"})," Dodaj oddział"]})]}),e.jsx(N,{children:e.jsx(w,{placeholder:"Szukaj po nazwie...",className:"max-w-sm",onChange:o=>l([{field:"name",operator:"contains",value:o.target.value}])})}),e.jsx(k,{children:s?.data?.map(o=>e.jsxs(z,{children:[e.jsx(C,{children:e.jsx(L,{title:o.name,description:o.city||"—",variant:"card"})}),e.jsx(S,{children:e.jsxs(N,{variant:"start",className:"gap-2",children:[e.jsxs(y,{variant:"outline",children:["ID #",o.id]}),o.is_archived&&e.jsx(y,{variant:"destructive",children:"archiwum"})]})}),e.jsx(ne,{children:e.jsxs(N,{variant:"start",className:"gap-2",children:[e.jsx(u,{variant:"outline",size:"sm",onClick:()=>x("branches",o.id),children:e.jsx(oe,{className:"w-4 h-4"})}),e.jsx(u,{variant:"outline",size:"sm",onClick:()=>c("branches",o.id),children:e.jsx(H,{className:"w-4 h-4"})})]})})]},o.id))}),e.jsx(he,{current:n,pageSize:i,total:s?.total||0,setCurrent:d,itemName:"oddziały"})]})},ji=()=>{const{list:s}=D(),{refineCore:{onFinish:t},register:r,handleSubmit:n,formState:{errors:d,isSubmitting:i}}=Q({refineCoreProps:{resource:"branches"}});return e.jsxs(P,{children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>s("branches"),children:[e.jsx(V,{className:"w-4 h-4 mr-2"})," Powrót do listy"]}),e.jsx(N,{children:e.jsx(L,{title:"Nowy oddział",description:"Dodaj placówkę"})}),e.jsxs(z,{children:[e.jsx(C,{children:e.jsx($,{children:"Parametry"})}),e.jsx(S,{children:e.jsxs(G,{onSubmit:n(t),children:[e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Nazwa",htmlFor:"name",error:d.name?.message,required:!0,children:e.jsx(w,{id:"name",...r("name",{required:"Wymagane"})})}),e.jsx(p,{label:"Miasto",htmlFor:"city",children:e.jsx(w,{id:"city",...r("city")})})]}),e.jsx(p,{label:"Archiwum",children:e.jsx("input",{type:"checkbox",...r("is_archived")})}),e.jsxs(Z,{children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>s("branches"),children:"Anuluj"}),e.jsx(u,{type:"submit",disabled:i,children:i?"Tworzenie...":"Utwórz"})]})]})})]})]})},pi=()=>{const{show:s}=D(),{refineCore:{onFinish:t,queryResult:r},register:n,handleSubmit:d,formState:{errors:i,isSubmitting:l}}=Q({refineCoreProps:{resource:"branches",action:"edit"}}),m=r?.isLoading??!0,c=r?.isError??!1,x=r?.data?.data,h=I({isLoading:m,isError:c});return h||(x?e.jsxs(P,{children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>s("branches",x.id),children:[e.jsx(V,{className:"w-4 h-4 mr-2"})," Powrót do szczegółów"]}),e.jsx(N,{children:e.jsx(L,{title:"Edycja oddziału",description:`ID: #${x.id}`})}),e.jsxs(z,{children:[e.jsx(C,{children:e.jsx($,{children:"Parametry"})}),e.jsx(S,{children:e.jsxs(G,{onSubmit:d(t),children:[e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Nazwa",htmlFor:"name",error:i.name?.message,required:!0,children:e.jsx(w,{id:"name",...n("name",{required:"Wymagane"})})}),e.jsx(p,{label:"Miasto",htmlFor:"city",children:e.jsx(w,{id:"city",...n("city")})})]}),e.jsx(p,{label:"Archiwum",children:e.jsx("input",{type:"checkbox",...n("is_archived")})}),e.jsxs(Z,{children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>s("branches",x.id),children:"Anuluj"}),e.jsx(u,{type:"submit",disabled:l,children:l?"Zapisywanie...":"Zapisz"})]})]})})]})]}):null)},gi=()=>{const{queryResult:s}=ce({resource:"branches"}),{list:t,edit:r}=D(),n=s?.isLoading??!0,d=s?.isError??!1,i=s?.data?.data,l=I({isLoading:n,isError:d});return l||(i?e.jsxs(e.Fragment,{children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>t("branches"),children:[e.jsx(V,{className:"w-4 h-4 mr-2"})," Powrót do listy"]}),e.jsxs(N,{children:[e.jsx(L,{title:i.name,description:`ID: #${i.id}`}),e.jsxs(u,{variant:"outline",onClick:()=>r("branches",i.id),children:[e.jsx(H,{className:"w-4 h-4 mr-2"})," Edytuj"]})]}),e.jsxs(z,{children:[e.jsx(C,{children:e.jsx($,{children:"Szczegóły"})}),e.jsxs(S,{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[i.city&&e.jsx(y,{variant:"outline",children:i.city}),i.is_archived&&e.jsx(y,{variant:"destructive",children:"archiwum"})]}),e.jsx(K,{}),e.jsxs("div",{className:"text-sm",children:[e.jsxs("div",{children:[e.jsx("b",{children:"Utworzono:"})," ",new Date(i.created_at).toLocaleString()]}),e.jsxs("div",{children:[e.jsx("b",{children:"Aktualizacja:"})," ",new Date(i.updated_at).toLocaleString()]})]})]})]})]}):null)},_s={name:"branches",list:"/admin/branches",create:"/admin/branches/create",edit:"/admin/branches/edit/:id",show:"/admin/branches/show/:id",meta:{label:"Oddziały"}},bi=[e.jsx(b,{index:!0,element:e.jsx(mi,{})},"branches-index"),e.jsx(b,{path:"create",element:e.jsx(ji,{})},"branches-create"),e.jsx(b,{path:"edit/:id",element:e.jsx(pi,{})},"branches-edit"),e.jsx(b,{path:"show/:id",element:e.jsx(gi,{})},"branches-show")],yi=["zakupy","sprzedaz","firmy_transportowe","inne"],wi=["skupy złomu","autokasacja","zakład produkcyjny","spalarnia","huta","port","pośrednik","kontenery","odlewnia","inne"],ze="__clear__",Ka=()=>{const{tableQuery:{data:s,isLoading:t,isError:r},current:n,setCurrent:d,pageSize:i,setFilters:l,sorters:m,setSorters:c}=se({resource:"clients",sorters:{initial:[{field:"created_at",order:"desc"}]},filters:{initial:[]},syncWithLocation:!0}),{create:x,edit:h,show:o}=D(),j=I({isLoading:t,isError:r}),[a,g]=ye.useState([]),{mutate:v,isLoading:F}=Sr(),{triggerExport:R,isLoading:B}=Lr({resource:"clients",mapData:_=>({id:_.id,name:_.name,section:_.section,category:_.category,branch_id:_.branch_id,email:_.email,phone:_.phone,website:_.website,created_at:_.created_at,updated_at:_.updated_at}),pageSize:1e3,maxItemCount:1e5,exportOptions:{filename:"clients.csv"}});if(j)return j;const xe=_=>l(X=>[...(X||[]).filter(J=>J.field!=="name"),_?{field:"name",operator:"contains",value:_}:void 0].filter(Boolean)),be=_=>l(X=>{const J=(X||[]).filter(pe=>pe.field!=="section");return _?[...J,{field:"section",operator:"eq",value:_}]:J}),ke=_=>l(X=>{const J=(X||[]).filter(pe=>pe.field!=="category");return _?[...J,{field:"category",operator:"eq",value:_}]:J}),Y=_=>l(X=>{const J=(X||[]).filter(pe=>pe.field!=="branch_id");return _?[...J,{field:"branch_id",operator:"eq",value:Number(_)}]:J}),ve=_=>l(X=>{const J=(X||[]).filter(pe=>pe.field!=="is_archived");return _==="true"?[...J,{field:"is_archived",operator:"eq",value:!0}]:_==="false"?[...J,{field:"is_archived",operator:"eq",value:!1}]:J}),qe=_=>g(X=>X.includes(_)?X.filter(J=>J!==_):[...X,_]),te=()=>{a.length!==0&&v({resource:"clients",ids:a,values:{is_archived:!0}},{onSuccess:()=>g([])})};return e.jsxs(P,{children:[e.jsxs(N,{children:[e.jsx(L,{title:"Klienci",description:"Baza klientów"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(u,{variant:"outline",onClick:()=>R(),disabled:B,children:[e.jsx(Ur,{className:"w-4 h-4 mr-2"})," ",B?"Eksport...":"Eksport CSV"]}),e.jsxs(u,{variant:"outline",onClick:te,disabled:F||a.length===0,children:[e.jsx(Or,{className:"w-4 h-4 mr-2"})," Archiwizuj zaznaczonych"]}),e.jsxs(u,{onClick:()=>x("clients"),children:[e.jsx(ee,{className:"w-4 h-4 mr-2"})," Dodaj klienta"]})]})]}),e.jsxs(N,{className:"gap-3 flex-wrap",children:[e.jsx(w,{placeholder:"Szukaj po nazwie...",className:"max-w-sm",onChange:_=>xe(_.target.value)}),e.jsxs(U,{onValueChange:_=>be(_===ze?void 0:_),children:[e.jsx(T,{className:"w-56",children:e.jsx(O,{placeholder:"Filtr: sekcja"})}),e.jsxs(W,{children:[yi.map(_=>e.jsx(E,{value:_,children:_},_)),e.jsx(E,{value:ze,children:"Wyczyść filtr"})]})]}),e.jsxs(U,{onValueChange:_=>ke(_===ze?void 0:_),children:[e.jsx(T,{className:"w-56",children:e.jsx(O,{placeholder:"Filtr: kategoria"})}),e.jsxs(W,{children:[wi.map(_=>e.jsx(E,{value:_,children:_},_)),e.jsx(E,{value:ze,children:"Wyczyść filtr"})]})]}),e.jsx(w,{placeholder:"Filtr: oddział (ID)",className:"w-40",onChange:_=>Y(_.target.value||void 0)}),e.jsxs(U,{onValueChange:_=>ve(_===ze?void 0:_),children:[e.jsx(T,{className:"w-56",children:e.jsx(O,{placeholder:"Filtr: archiwum"})}),e.jsxs(W,{children:[e.jsx(E,{value:"false",children:"Tylko aktywne"}),e.jsx(E,{value:"true",children:"Tylko archiwalne"}),e.jsx(E,{value:ze,children:"Wyczyść filtr"})]})]}),e.jsx(K,{orientation:"vertical",className:"h-8"}),e.jsxs(U,{onValueChange:_=>c([{field:_.replace("-",""),order:_.startsWith("-")?"desc":"asc"}]),children:[e.jsx(T,{className:"w-56",children:e.jsx(O,{placeholder:"Sortuj według"})}),e.jsxs(W,{children:[e.jsx(E,{value:"name",children:"Nazwa A→Z"}),e.jsx(E,{value:"-name",children:"Nazwa Z→A"}),e.jsx(E,{value:"-created_at",children:"Najnowsze"}),e.jsx(E,{value:"-updated_at",children:"Ostatnia aktualizacja"})]})]})]}),e.jsx(k,{children:s?.data?.map(_=>{const X=a.includes(_.id);return e.jsxs(z,{className:X?"ring-2 ring-primary":"",children:[e.jsxs(C,{className:"flex flex-row items-start justify-between gap-4",children:[e.jsx(L,{title:_.name,description:_.email||_.phone||_.website||"—",variant:"card"}),e.jsx("input",{type:"checkbox","aria-label":"Zaznacz klienta",checked:X,onChange:()=>qe(_.id)})]}),e.jsx(S,{children:e.jsxs(N,{variant:"start",className:"gap-2 flex-wrap",children:[e.jsxs(y,{variant:"outline",children:["ID #",_.id]}),_.section&&e.jsx(y,{variant:"secondary",children:_.section}),_.category&&e.jsx(y,{variant:"outline",children:_.category}),_.branch_id&&e.jsxs(y,{variant:"outline",children:["oddział #",_.branch_id]}),_.is_archived&&e.jsx(y,{variant:"destructive",children:"archiwum"})]})}),e.jsx(ne,{children:e.jsxs(N,{variant:"start",className:"gap-2",children:[e.jsx(u,{variant:"outline",size:"sm",onClick:()=>o("clients",_.id),children:e.jsx(oe,{className:"w-4 h-4"})}),e.jsx(u,{variant:"outline",size:"sm",onClick:()=>h("clients",_.id),children:e.jsx(H,{className:"w-4 h-4"})})]})})]},_.id)})}),e.jsx(he,{current:n,pageSize:i,total:s?.total||0,setCurrent:d,itemName:"klienci"})]})},Za=({clientId:s,onLinked:t})=>{const{mutate:r,isLoading:n}=Ke(),[d,i]=f.useState(),[l,m]=f.useState("Siedziba"),c=h=>i(h?Number(h):void 0),x=()=>{d&&r({resource:"client_addresses",values:{client_id:s,address_id:d,kind:l||null}},{onSuccess:()=>t?.()})};return e.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:items-center",children:[e.jsx(A,{resource:"addresses",value:d,onChange:c,renderLabel:h=>`${h.line1}${h.city?" — "+h.city:""} (#${h.id})`,placeholder:"Wybierz istniejący adres"}),e.jsx(w,{placeholder:'Etykieta (np. "Siedziba", "Magazyn")',value:l,onChange:h=>m(h.target.value),className:"md:w-56"}),e.jsx(N,{variant:"start",className:"gap-2",children:e.jsxs(u,{variant:"outline",onClick:x,disabled:n||!d,children:[e.jsx(ba,{className:"w-4 h-4 mr-2"})," Powiąż adres"]})})]})},vi=["zakupy","sprzedaz","firmy_transportowe","inne"],Te=s=>s?.message,Qa=()=>{const s=je(),{list:t,show:r}=D(),[n,d]=oa(),i=Number(n.get("step")||"1"),l=n.get("client"),[m,c]=f.useState(i),[x,h]=f.useState(l?Number(l):null),{refineCore:{onFinish:o},register:j,handleSubmit:a,setValue:g,watch:v,formState:{errors:F,isSubmitting:R}}=Q({refineCoreProps:{resource:"clients",redirect:!1},defaultValues:{is_archived:!1}}),B=j("section",{required:"Wymagane"}),xe=M=>g("section",M,{shouldValidate:!0}),be=M=>g("branch_id",M?Number(M):void 0),ke=j("phone",{pattern:{value:/^[\d+\-\s()]{5,}$/,message:"Nieprawidłowy numer telefonu"}}),Y=j("email",{pattern:{value:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:"Nieprawidłowy adres e-mail"}}),ve=j("website",{pattern:{value:/^https?:\/\/.+$/i,message:"URL musi zaczynać się od http(s)://"}}),qe=a(async M=>{const ae=await o(M),Fe=ae?.data?.id??ae?.id;if(Fe){h(Fe),c(2);const He=new URLSearchParams(n);He.set("step","2"),He.set("client",String(Fe)),d(He,{replace:!0});return}t("clients")}),te=x??(l?Number(l):void 0),_=ge({resource:"client_addresses",filters:te?[{field:"client_id",operator:"eq",value:te}]:[],pagination:{pageSize:100},queryOptions:{enabled:m===2&&!!te}}),X=(_.data?.data||[]).map(M=>M.address_id),J=os({resource:"addresses",ids:X,queryOptions:{enabled:m===2&&X.length>0}}),pe=(M="Siedziba")=>{const ae=new URLSearchParams;te&&ae.set("client",String(te)),ae.set("kind",M),ae.set("return",`/admin/clients/create?step=2&client=${te}`),s(`/admin/addresses/create?${ae.toString()}`)},Ja=()=>{if(te)return r("clients",te);t("clients")};return e.jsxs(P,{children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>t("clients"),children:[e.jsx(V,{className:"w-4 h-4 mr-2"})," Powrót do listy"]}),e.jsxs(N,{className:"items-center gap-3",children:[e.jsx(L,{title:"Nowy klient — kreator",description:m===1?"Krok 1/2: Dane klienta":`Krok 2/2: Adresy dla #${te}`}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(y,{variant:m>=1?"secondary":"outline",children:"1. Klient"}),e.jsx(Be,{className:"w-4 h-4"}),e.jsx(y,{variant:m>=2?"secondary":"outline",children:"2. Adresy"})]})]}),m===1&&e.jsxs(z,{className:"mt-2",children:[e.jsx(C,{children:e.jsx($,{children:"Parametry klienta"})}),e.jsx(S,{children:e.jsxs(G,{onSubmit:qe,children:[e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Nazwa",htmlFor:"name",error:Te(F.name),required:!0,children:e.jsx(w,{id:"name",...j("name",{required:"Wymagane"})})}),e.jsxs(p,{label:"Sekcja",error:Te(F.section),required:!0,children:[e.jsx("input",{type:"hidden",...B}),e.jsxs(U,{onValueChange:xe,children:[e.jsx(T,{children:e.jsx(O,{placeholder:"Wybierz sekcję"})}),e.jsx(W,{children:vi.map(M=>e.jsx(E,{value:M,children:M},M))})]})]})]}),e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Kategoria",htmlFor:"category",children:e.jsx(w,{id:"category",...j("category")})}),e.jsx(p,{label:"Oddział (branch_id)",htmlFor:"branch_id",children:e.jsx(A,{resource:"branches",value:v("branch_id"),onChange:be,renderLabel:M=>`${M.name}${M.city?" — "+M.city:""} (#${M.id})`,placeholder:"Wybierz oddział (opcjonalnie)"})})]}),e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Opiekun (account_owner)",htmlFor:"account_owner",children:e.jsx(A,{resource:"users",value:v("account_owner"),onChange:M=>g("account_owner",M||void 0),renderLabel:M=>`${M.full_name} <${M.email}>`,placeholder:"Wybierz opiekuna (opcjonalnie)"})}),e.jsx("div",{})]}),e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Telefon",htmlFor:"phone",error:Te(F.phone),children:e.jsx(w,{id:"phone",...ke})}),e.jsx(p,{label:"Email",htmlFor:"email",error:Te(F.email),children:e.jsx(w,{id:"email",type:"email",...Y})}),e.jsx(p,{label:"WWW",htmlFor:"website",error:Te(F.website),children:e.jsx(w,{id:"website",type:"url",...ve})})]}),e.jsx(p,{label:"Opis",children:e.jsx(ie,{rows:3,...j("description")})}),e.jsx(p,{label:"Archiwum",children:e.jsx("input",{type:"checkbox",...j("is_archived")})}),e.jsxs(Z,{children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>t("clients"),children:"Anuluj"}),e.jsx(u,{type:"submit",disabled:R,children:R?"Tworzenie...":"Dalej: Adresy"})]})]})})]}),m===2&&te&&e.jsxs(z,{className:"mt-2",children:[e.jsx(C,{children:e.jsxs($,{children:["Adresy klienta (ID #",te,")"]})}),e.jsxs(S,{className:"space-y-4",children:[e.jsx(Za,{clientId:te,onLinked:()=>_.refetch()}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{onClick:()=>pe("Siedziba"),children:"Dodaj nowy adres (Siedziba)"}),e.jsx(u,{variant:"outline",onClick:()=>pe("Magazyn"),children:"Dodaj nowy adres (Magazyn)"})]}),e.jsx(K,{}),(_.isLoading||J.isLoading)&&e.jsx("div",{children:"Ładowanie adresów..."}),!_.isLoading&&X.length===0&&e.jsx("div",{className:"text-sm text-muted-foreground",children:"Brak powiązanych adresów."}),X.length>0&&e.jsx("div",{className:"space-y-3",children:(_.data?.data||[]).map(M=>{const ae=J.data?.data?.find(Fe=>Fe.id===M.address_id);return e.jsxs("div",{className:"rounded border p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(y,{variant:"outline",children:M.kind||"adres"}),e.jsxs(y,{variant:"secondary",children:["ID #",M.address_id]})]}),ae?e.jsxs("div",{className:"text-sm leading-6",children:[e.jsxs("div",{children:[ae.line1,ae.line2?`, ${ae.line2}`:""]}),e.jsx("div",{children:[ae.postal_code,ae.city].filter(Boolean).join(" ")}),e.jsx("div",{children:ae.country||"PL"}),ae.notes&&e.jsx("div",{className:"text-muted-foreground mt-1",children:ae.notes})]}):e.jsx("div",{className:"text-sm text-muted-foreground",children:"Nie udało się pobrać szczegółów adresu."})]},M.id)})}),e.jsx(K,{}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Br,{className:"w-4 h-4 text-green-600"}),e.jsx("div",{className:"text-sm",children:"Klient został utworzony. Dodaj adresy lub zakończ."})]}),e.jsxs(Z,{children:[e.jsx(u,{variant:"outline",onClick:()=>r("clients",te),children:"Przejdź do szczegółów klienta"}),e.jsx(u,{onClick:Ja,children:"Zakończ"})]})]})]})]})},fi=["zakupy","sprzedaz","firmy_transportowe","inne"],Ni=["skupy złomu","autokasacja","zakład produkcyjny","spalarnia","huta","port","pośrednik","kontenery","odlewnia","inne"],Ha=()=>{const{show:s}=D(),{refineCore:{onFinish:t,queryResult:r},register:n,handleSubmit:d,setValue:i,watch:l,formState:{errors:m,isSubmitting:c}}=Q({refineCoreProps:{resource:"clients",action:"edit"}}),x=r?.isLoading??!0,h=r?.isError??!1,o=r?.data?.data,j=I({isLoading:x,isError:h});if(j)return j;if(!o)return null;const a=B=>i("branch_id",Number(B)),g=B=>i("account_owner",B),v=n("email",{pattern:{value:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:"Nieprawidłowy adres e-mail"}}),F=n("website",{pattern:{value:/^https?:\/\/.+$/i,message:"URL musi zaczynać się od http(s)://"}}),R=n("phone",{value:o.phone,pattern:{value:/^[\d+\-\s()]{5,}$/,message:"Nieprawidłowy numer telefonu"}});return e.jsxs(P,{children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>s("clients",o.id),children:[e.jsx(V,{className:"w-4 h-4 mr-2"})," Powrót do szczegółów"]}),e.jsx(N,{children:e.jsx(L,{title:"Edycja klienta",description:e.jsxs("span",{className:"inline-flex items-center gap-2",children:["ID: #",o.id," ",e.jsx(y,{variant:"secondary",children:"CRM"})]})})}),e.jsxs(z,{children:[e.jsx(C,{children:e.jsx($,{children:"Parametry"})}),e.jsx(S,{children:e.jsxs(G,{onSubmit:d(t),children:[e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Nazwa",htmlFor:"name",error:m.name?.message,required:!0,children:e.jsx(w,{id:"name",...n("name",{required:"Wymagane"})})}),e.jsx(p,{label:"Sekcja",required:!0,children:e.jsxs(U,{defaultValue:o.section,onValueChange:B=>i("section",B),children:[e.jsx(T,{children:e.jsx(O,{placeholder:"Wybierz sekcję"})}),e.jsx(W,{children:fi.map(B=>e.jsx(E,{value:B,children:B},B))})]})})]}),e.jsxs(k,{variant:"1-2-2",children:[e.jsxs(p,{label:"Kategoria",htmlFor:"category",children:[e.jsxs(U,{defaultValue:o.category??void 0,onValueChange:B=>i("category",B),children:[e.jsx(T,{children:e.jsx(O,{placeholder:"Wybierz kategorię (opcjonalnie)"})}),e.jsx(W,{children:Ni.map(B=>e.jsx(E,{value:B,children:B},B))})]}),e.jsx(w,{id:"category",className:"mt-2",placeholder:"...lub wpisz własną",...n("category")})]}),e.jsx(p,{label:"Oddział (branch_id)",htmlFor:"branch_id",children:e.jsx(A,{resource:"branches",value:l("branch_id")??o.branch_id,onChange:a,renderLabel:B=>`${B.name}${B.city?" — "+B.city:""} (#${B.id})`,placeholder:"Wybierz oddział (opcjonalnie)"})})]}),e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Opiekun (account_owner)",htmlFor:"account_owner",children:e.jsx(A,{resource:"users",value:l("account_owner")??o.account_owner,onChange:g,renderLabel:B=>`${B.full_name} <${B.email}>`,placeholder:"Wybierz opiekuna (opcjonalnie)"})}),e.jsx("div",{})]}),e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Telefon",htmlFor:"phone",error:m.phone?.message,children:e.jsx(w,{id:"phone",...R})}),e.jsx(p,{label:"Email",htmlFor:"email",error:m.email?.message,children:e.jsx(w,{id:"email",type:"email",...v})}),e.jsx(p,{label:"WWW",htmlFor:"website",error:m.website?.message,children:e.jsx(w,{id:"website",type:"url",...F})})]}),e.jsx(p,{label:"Opis",children:e.jsx(ie,{rows:3,...n("description")})}),e.jsx(p,{label:"Archiwum",children:e.jsx("input",{type:"checkbox",...n("is_archived")})}),e.jsxs(Z,{children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>s("clients",o.id),children:"Anuluj"}),e.jsx(u,{type:"submit",disabled:c,children:c?"Zapisywanie...":"Zapisz"})]})]})})]})]})},Ga=()=>{const{queryResult:s}=ce({resource:"clients"}),{list:t,edit:r}=D(),n=s?.isLoading??!0,d=s?.isError??!1,i=s?.data?.data,l=i?.id,m=ge({resource:"client_addresses",filters:l?[{field:"client_id",operator:"eq",value:l}]:[],pagination:{pageSize:100},queryOptions:{enabled:!!l}}),c=(m.data?.data||[]).map(o=>o.address_id),x=os({resource:"addresses",ids:c,queryOptions:{enabled:!!l&&c.length>0}}),h=I({isLoading:n,isError:d});return h||(i?e.jsxs(P,{children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>t("clients"),children:[e.jsx(V,{className:"w-4 h-4 mr-2"})," Powrót do listy"]}),e.jsxs(N,{children:[e.jsx(L,{title:i.name,description:`ID: #${i.id}`}),e.jsxs(u,{variant:"outline",onClick:()=>r("clients",i.id),children:[e.jsx(H,{className:"w-4 h-4 mr-2"})," Edytuj"]})]}),e.jsxs(z,{children:[e.jsx(C,{children:e.jsx($,{children:"Szczegóły"})}),e.jsxs(S,{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[i.section&&e.jsx(y,{variant:"secondary",children:i.section}),i.category&&e.jsx(y,{variant:"outline",children:i.category}),i.branch_id&&e.jsxs(y,{variant:"outline",children:["oddział #",i.branch_id]}),i.is_archived&&e.jsx(y,{variant:"destructive",children:"archiwum"})]}),e.jsx(K,{}),e.jsxs("div",{className:"text-sm space-y-1",children:[i.phone&&e.jsxs("div",{children:[e.jsx("b",{children:"Telefon:"})," ",i.phone]}),i.email&&e.jsxs("div",{children:[e.jsx("b",{children:"Email:"})," ",i.email]}),i.website&&e.jsxs("div",{children:[e.jsx("b",{children:"WWW:"})," ",i.website]}),i.description&&e.jsxs("div",{children:[e.jsx("b",{children:"Opis:"})," ",i.description]}),e.jsxs("div",{children:[e.jsx("b",{children:"Utworzono:"})," ",new Date(i.created_at).toLocaleString()]}),e.jsxs("div",{children:[e.jsx("b",{children:"Aktualizacja:"})," ",new Date(i.updated_at).toLocaleString()]})]})]})]}),e.jsxs(z,{className:"mt-4",children:[e.jsx(C,{children:e.jsx($,{children:"Adresy klienta"})}),e.jsxs(S,{className:"space-y-4",children:[e.jsx(Za,{clientId:i.id,onLinked:()=>m.refetch()}),e.jsx(K,{}),(m.isLoading||x.isLoading)&&e.jsx("div",{children:"Ładowanie adresów..."}),!m.isLoading&&c.length===0&&e.jsx("div",{className:"text-sm text-muted-foreground",children:"Brak powiązanych adresów."}),c.length>0&&e.jsx("div",{className:"space-y-3",children:(m.data?.data||[]).map(o=>{const j=x.data?.data?.find(a=>a.id===o.address_id);return e.jsxs("div",{className:"rounded border p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(y,{variant:"outline",children:o.kind||"adres"}),e.jsxs(y,{variant:"secondary",children:["ID #",o.address_id]})]}),j?e.jsxs("div",{className:"text-sm leading-6",children:[e.jsxs("div",{children:[j.line1,j.line2?`, ${j.line2}`:""]}),e.jsx("div",{children:[j.postal_code,j.city].filter(Boolean).join(" ")}),e.jsx("div",{children:j.country||"PL"}),j.notes&&e.jsx("div",{className:"text-muted-foreground mt-1",children:j.notes})]}):e.jsx("div",{className:"text-sm text-muted-foreground",children:"Nie udało się pobrać szczegółów adresu."})]},o.id)})})]})]})]}):null)},ds={name:"clients",list:"/admin/clients",create:"/admin/clients/create",edit:"/admin/clients/edit/:id",show:"/admin/clients/show/:id",meta:{label:"Klienci"}},Ya=[e.jsx(b,{index:!0,element:e.jsx(Ka,{})},"clients-index"),e.jsx(b,{path:"create",element:e.jsx(Qa,{})},"clients-create"),e.jsx(b,{path:"edit/:id",element:e.jsx(Ha,{})},"clients-edit"),e.jsx(b,{path:"show/:id",element:e.jsx(Ga,{})},"clients-show")],_i=()=>{const{tableQuery:{data:s,isLoading:t,isError:r},current:n,setCurrent:d,pageSize:i,setFilters:l}=se({resource:"users",sorters:{initial:[{field:"created_at",order:"desc"}]}}),{create:m,edit:c,show:x}=D(),h=I({isLoading:t,isError:r});return h||e.jsxs(P,{children:[e.jsxs(N,{children:[e.jsx(L,{title:"Użytkownicy",description:"Konta i role"}),e.jsxs(u,{onClick:()=>m("users"),children:[e.jsx(ee,{className:"w-4 h-4 mr-2"})," Dodaj użytkownika"]})]}),e.jsx(N,{children:e.jsx(w,{placeholder:"Szukaj po e-mailu lub nazwie…",className:"max-w-sm",onChange:o=>l([{field:"email",operator:"contains",value:o.target.value}])})}),e.jsx(k,{children:s?.data?.map(o=>e.jsxs(z,{children:[e.jsx(C,{children:e.jsx(L,{title:o.full_name,description:o.email,variant:"card"})}),e.jsx(S,{children:e.jsxs(N,{variant:"start",className:"gap-2",children:[o.role&&e.jsx(y,{variant:"secondary",children:o.role}),o.branch_id&&e.jsxs(y,{variant:"outline",children:["oddział #",o.branch_id]}),o.branch_name&&e.jsx(y,{variant:"outline",children:o.branch_name})]})}),e.jsx(ne,{children:e.jsxs(N,{variant:"start",className:"gap-2",children:[e.jsx(u,{variant:"outline",size:"sm",onClick:()=>x("users",o.id),children:e.jsx(oe,{className:"w-4 h-4"})}),e.jsx(u,{variant:"outline",size:"sm",onClick:()=>c("users",o.id),children:e.jsx(H,{className:"w-4 h-4"})})]})})]},o.id))}),e.jsx(he,{current:n,pageSize:i,total:s?.total||0,setCurrent:d,itemName:"użytkownicy"})]})},ki=()=>{const{list:s}=D(),{refineCore:{onFinish:t},register:r,handleSubmit:n,formState:{errors:d,isSubmitting:i}}=Q({refineCoreProps:{resource:"users"}});return e.jsxs(P,{children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>s("users"),children:[e.jsx(V,{className:"w-4 h-4 mr-2"})," Powrót do listy"]}),e.jsx(N,{children:e.jsx(L,{title:"Nowy użytkownik",description:"Załóż konto (role dodasz po zapisaniu)"})}),e.jsxs(z,{children:[e.jsx(C,{children:e.jsx($,{children:"Dane podstawowe"})}),e.jsx(S,{children:e.jsxs(G,{onSubmit:n(t),children:[e.jsx(p,{label:"E-mail",htmlFor:"email",error:d.email?.message,required:!0,children:e.jsx(w,{id:"email",type:"email",...r("email",{required:"Wymagane"})})}),e.jsx(p,{label:"Imię i nazwisko",htmlFor:"full_name",children:e.jsx(w,{id:"full_name",...r("full_name")})}),e.jsx(p,{label:"Telefon",htmlFor:"phone",children:e.jsx(w,{id:"phone",...r("phone")})}),e.jsxs(Z,{children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>s("users"),children:"Anuluj"}),e.jsx(u,{type:"submit",disabled:i,children:i?"Tworzenie...":"Utwórz"})]})]})})]})]})},zi=["administrator","biuro","logistyk","handlowiec","kierowca_krotko","kierowca_dlugo","operator"],Ci=({userId:s})=>{const{tableQuery:t}=se({resource:"user_roles",filters:{permanent:[{field:"user_id",operator:"eq",value:s}]},pagination:{current:1,pageSize:100},sorters:{initial:[{field:"assigned_at",order:"desc"}]}}),{mutate:r,isLoading:n}=Ke(),{mutate:d}=ha(),[i,l]=f.useState(),[m,c]=f.useState(""),x=t.data?.data??[],h=f.useMemo(()=>!!i,[i]),o=()=>{i&&r({resource:"user_roles",values:{user_id:s,role:i,branch_id:m?Number(m):null},invalidates:["list","many","detail"]})};return e.jsxs(z,{children:[e.jsx(C,{children:e.jsx($,{children:"Role użytkownika"})}),e.jsxs(S,{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[x.map(j=>e.jsxs("div",{className:"flex items-center gap-2 border rounded-xl px-2 py-1",children:[e.jsx(y,{variant:j.branch_id?"secondary":"outline",children:j.role}),j.branch_id&&e.jsxs(y,{variant:"outline",children:["oddział #",j.branch_id]}),e.jsx(u,{size:"sm",variant:"ghost",onClick:()=>d({resource:"user_roles",id:j.id,invalidates:["list","many","detail"]}),children:e.jsx(Mr,{className:"w-4 h-4"})})]},j.id)),!x.length&&e.jsx("span",{className:"text-muted-foreground text-sm",children:"Brak ról"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-2",children:[e.jsxs(U,{onValueChange:l,children:[e.jsx(T,{className:"w-56",children:e.jsx(O,{placeholder:"Wybierz rolę"})}),e.jsx(W,{children:zi.map(j=>e.jsx(E,{value:j,children:j},j))})]}),e.jsx(w,{type:"number",placeholder:"Oddział (opcjonalnie, puste = global)",value:m,onChange:j=>c(j.target.value),className:"w-64"}),e.jsxs(u,{onClick:o,disabled:!h||n,children:[e.jsx(ee,{className:"w-4 h-4 mr-2"})," Dodaj"]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["• Rola z ",e.jsx("i",{children:"pustym"})," oddziałem działa globalnie. • Można łączyć wiele ról (różne oddziały). • Administrator ma pełny dostęp."]})]})]})},Si=()=>{const{show:s}=D(),{refineCore:{onFinish:t,queryResult:r},register:n,handleSubmit:d,formState:{errors:i,isSubmitting:l}}=Q({refineCoreProps:{resource:"users",action:"edit"}}),m=r?.isLoading??!0,c=r?.isError??!1,x=r?.data?.data,h=I({isLoading:m,isError:c});return h||(x?e.jsxs(P,{children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>s("users",x.id),children:[e.jsx(V,{className:"w-4 h-4 mr-2"})," Powrót do szczegółów"]}),e.jsx(N,{children:e.jsx(L,{title:"Edycja użytkownika",description:x.email})}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs(z,{children:[e.jsx(C,{children:e.jsx($,{children:"Dane podstawowe"})}),e.jsx(S,{children:e.jsxs(G,{onSubmit:d(t),children:[e.jsx(p,{label:"Imię i nazwisko",htmlFor:"full_name",children:e.jsx(w,{id:"full_name",...n("full_name")})}),e.jsx(p,{label:"Telefon",htmlFor:"phone",children:e.jsx(w,{id:"phone",...n("phone")})}),e.jsxs(Z,{children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>s("users",x.id),children:"Anuluj"}),e.jsx(u,{type:"submit",disabled:l,children:l?"Zapisywanie...":"Zapisz"})]})]})})]}),e.jsx(Ci,{userId:x.id})]})]}):null)},Li=()=>{const{queryResult:s}=ce({resource:"users"}),{list:t,edit:r}=D(),n=s?.isLoading??!0,d=s?.isError??!1,i=s?.data?.data,l=se({resource:"v_user_effective_roles",filters:{permanent:i?[{field:"user_id",operator:"eq",value:i.id}]:[]},pagination:{current:1,pageSize:100}}),m=I({isLoading:n,isError:d});if(m)return m;if(!i)return null;const c=l.tableQuery.data?.data??[];return e.jsxs(P,{children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>t("users"),children:[e.jsx(V,{className:"w-4 h-4 mr-2"})," Powrót do listy"]}),e.jsxs(N,{children:[e.jsx(L,{title:i.full_name||i.email,description:i.email}),e.jsxs(u,{variant:"outline",onClick:()=>r("users",i.id),children:[e.jsx(H,{className:"w-4 h-4 mr-2"})," Edytuj"]})]}),e.jsxs(z,{children:[e.jsx(C,{children:e.jsx($,{children:"Szczegóły"})}),e.jsxs(S,{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[i.role&&e.jsxs(y,{variant:"secondary",children:["domyślna: ",i.role]}),i.branch_name&&e.jsx(y,{variant:"outline",children:i.branch_name}),i.branch_id&&e.jsxs(y,{variant:"outline",children:["oddział #",i.branch_id]})]}),e.jsx(K,{}),e.jsxs("div",{className:"text-sm space-y-1",children:[i.phone&&e.jsxs("div",{children:[e.jsx("b",{children:"Telefon:"})," ",i.phone]}),e.jsxs("div",{children:[e.jsx("b",{children:"Utworzono:"})," ",new Date(i.created_at).toLocaleString()]}),e.jsxs("div",{children:[e.jsx("b",{children:"Aktualizacja:"})," ",new Date(i.updated_at).toLocaleString()]})]})]})]}),e.jsxs(z,{className:"mt-4",children:[e.jsx(C,{children:e.jsx($,{children:"Wszystkie role (widok v_user_effective_roles)"})}),e.jsx(S,{className:"flex flex-wrap gap-2",children:c.length?c.map(x=>e.jsxs(y,{variant:x.branch_id?"secondary":"outline",children:[x.role,x.branch_id?` @#${x.branch_id}`:" (global)"]},`${x.role}-${x.branch_id??"global"}`)):e.jsx("span",{className:"text-sm text-muted-foreground",children:"Brak"})})]})]})},ks={name:"users",list:"/admin/users",create:"/admin/users/create",edit:"/admin/users/edit/:id",show:"/admin/users/show/:id",meta:{label:"Użytkownicy"}},Ri=[e.jsx(b,{index:!0,element:e.jsx(_i,{})},"users-index"),e.jsx(b,{path:"create",element:e.jsx(ki,{})},"users-create"),e.jsx(b,{path:"edit/:id",element:e.jsx(Si,{})},"users-edit"),e.jsx(b,{path:"show/:id",element:e.jsx(Li,{})},"users-show")],$i=["na_placu","u_klienta","na_pojezdzie","serwis","inne"],Pi=()=>{const{tableQuery:{data:s,isLoading:t,isError:r},current:n,setCurrent:d,pageSize:i,setFilters:l}=se({resource:"containers",sorters:{initial:[{field:"created_at",order:"desc"}]}}),{create:m,edit:c,show:x}=D(),h=I({isLoading:t,isError:r});if(h)return h;const o=a=>l(g=>[...(g||[]).filter(v=>v.field!=="code"),{field:"code",operator:"contains",value:a}]),j=a=>l(g=>{const v=(g||[]).filter(F=>F.field!=="status");return a?[...v,{field:"status",operator:"eq",value:a}]:v});return e.jsxs(P,{children:[e.jsxs(N,{children:[e.jsx(L,{title:"Kontenery",description:"Ewidencja i statusy"}),e.jsxs(u,{onClick:()=>m("containers"),children:[e.jsx(ee,{className:"w-4 h-4 mr-2"})," Dodaj kontener"]})]}),e.jsxs(N,{className:"gap-3",children:[e.jsx(w,{placeholder:"Szukaj po kodzie...",className:"max-w-sm",onChange:a=>o(a.target.value)}),e.jsxs(U,{onValueChange:a=>j(a==="__clear__"?void 0:a),children:[e.jsx(T,{className:"w-56",children:e.jsx(O,{placeholder:"Filtr: status (opcjonalnie)"})}),e.jsxs(W,{children:[$i.map(a=>e.jsx(E,{value:a,children:a},a)),e.jsx(E,{value:"__clear__",children:"Wyczyść filtr"})]})]})]}),e.jsx(k,{children:s?.data?.map(a=>e.jsxs(z,{children:[e.jsx(C,{children:e.jsx(L,{title:a.code,description:a.category||"—",variant:"card"})}),e.jsx(S,{children:e.jsxs(N,{variant:"start",className:"gap-2",children:[e.jsxs(y,{variant:"outline",children:["ID #",a.id]}),a.status&&e.jsx(y,{variant:"secondary",children:a.status}),typeof a.tara_kg=="number"&&e.jsxs(y,{variant:"outline",children:[a.tara_kg," kg tara"]}),a.branch_id&&e.jsxs(y,{variant:"outline",children:["oddział #",a.branch_id]}),a.is_archived&&e.jsx(y,{variant:"destructive",children:"archiwum"})]})}),e.jsx(ne,{children:e.jsxs(N,{variant:"start",className:"gap-2",children:[e.jsx(u,{variant:"outline",size:"sm",onClick:()=>x("containers",a.id),children:e.jsx(oe,{className:"w-4 h-4"})}),e.jsx(u,{variant:"outline",size:"sm",onClick:()=>c("containers",a.id),children:e.jsx(H,{className:"w-4 h-4"})})]})})]},a.id))}),e.jsx(he,{current:n,pageSize:i,total:s?.total||0,setCurrent:d,itemName:"kontenery"})]})},Ei=["na_placu","u_klienta","na_pojezdzie","serwis","inne"],Di=()=>{const{list:s}=D(),{refineCore:{onFinish:t},register:r,handleSubmit:n,setValue:d,watch:i,formState:{errors:l,isSubmitting:m}}=Q({refineCoreProps:{resource:"containers"}});return e.jsxs(P,{children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>s("containers"),children:[e.jsx(V,{className:"w-4 h-4 mr-2"})," Powrót do listy"]}),e.jsx(N,{children:e.jsx(L,{title:"Nowy kontener",description:"Dodaj kontener"})}),e.jsxs(z,{children:[e.jsx(C,{children:e.jsx($,{children:"Parametry"})}),e.jsx(S,{children:e.jsxs(G,{onSubmit:n(t),children:[e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Kod / numer",htmlFor:"code",error:l.code?.message,required:!0,children:e.jsx(w,{id:"code",...r("code",{required:"Wymagane"})})}),e.jsx(p,{label:"Kategoria",htmlFor:"category",children:e.jsx(w,{id:"category",...r("category")})})]}),e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Oddział (branch_id)",required:!0,error:l.branch_id?.message,children:e.jsx(A,{resource:"branches",value:i("branch_id"),onChange:c=>d("branch_id",Number(c),{shouldValidate:!0}),renderLabel:c=>`${c.name}${c.city?" — "+c.city:""} (#${c.id})`,placeholder:"Wybierz oddział"})}),e.jsx(p,{label:"Tara [kg]",htmlFor:"tara_kg",children:e.jsx(w,{id:"tara_kg",type:"number",step:"1",...r("tara_kg",{valueAsNumber:!0})})})]}),e.jsx(p,{label:"Status",children:e.jsxs(U,{onValueChange:c=>d("status",c),children:[e.jsx(T,{children:e.jsx(O,{placeholder:"Wybierz status"})}),e.jsx(W,{children:Ei.map(c=>e.jsx(E,{value:c,children:c},c))})]})}),e.jsx(p,{label:"Archiwum",children:e.jsx("input",{type:"checkbox",...r("is_archived")})}),e.jsxs(Z,{children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>s("containers"),children:"Anuluj"}),e.jsx(u,{type:"submit",disabled:m,children:m?"Tworzenie...":"Utwórz"})]})]})})]})]})},qi=["na_placu","u_klienta","na_pojezdzie","serwis","inne"],Fi=()=>{const{show:s}=D(),{refineCore:{onFinish:t,queryResult:r},register:n,handleSubmit:d,setValue:i,watch:l,formState:{errors:m,isSubmitting:c}}=Q({refineCoreProps:{resource:"containers",action:"edit"}}),x=r?.isLoading??!0,h=r?.isError??!1,o=r?.data?.data,j=I({isLoading:x,isError:h});return j||(o?e.jsxs(P,{children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>s("containers",o.id),children:[e.jsx(V,{className:"w-4 h-4 mr-2"})," Powrót do szczegółów"]}),e.jsx(N,{children:e.jsx(L,{title:"Edycja kontenera",description:`ID: #${o.id}`})}),e.jsxs(z,{children:[e.jsx(C,{children:e.jsx($,{children:"Parametry"})}),e.jsx(S,{children:e.jsxs(G,{onSubmit:d(t),children:[e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Kod / numer",htmlFor:"code",error:m.code?.message,required:!0,children:e.jsx(w,{id:"code",...n("code",{required:"Wymagane"})})}),e.jsx(p,{label:"Kategoria",htmlFor:"category",children:e.jsx(w,{id:"category",...n("category")})})]}),e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Oddział (branch_id)",required:!0,error:m.branch_id?.message,children:e.jsx(A,{resource:"branches",value:l("branch_id")??o.branch_id,onChange:a=>i("branch_id",Number(a),{shouldValidate:!0}),renderLabel:a=>`${a.name}${a.city?" — "+a.city:""} (#${a.id})`,placeholder:"Wybierz oddział"})}),e.jsx(p,{label:"Tara [kg]",htmlFor:"tara_kg",children:e.jsx(w,{id:"tara_kg",type:"number",step:"1",...n("tara_kg",{valueAsNumber:!0})})})]}),e.jsx(p,{label:"Status",children:e.jsxs(U,{defaultValue:o.status,onValueChange:a=>i("status",a),children:[e.jsx(T,{children:e.jsx(O,{placeholder:"Wybierz status"})}),e.jsx(W,{children:qi.map(a=>e.jsx(E,{value:a,children:a},a))})]})}),e.jsx(p,{label:"Archiwum",children:e.jsx("input",{type:"checkbox",...n("is_archived")})}),e.jsxs(Z,{children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>s("containers",o.id),children:"Anuluj"}),e.jsx(u,{type:"submit",disabled:c,children:c?"Zapisywanie...":"Zapisz"})]})]})})]})]}):null)},Ai="asset_maintenances",Ii=()=>{const{queryResult:s}=ce({resource:"containers"}),{list:t,edit:r}=D(),n=je(),d=s?.isLoading??!0,i=s?.isError??!1,l=s?.data?.data,m=ge({resource:Ai,filters:l?[{field:"asset_id",operator:"eq",value:l.asset_id}]:[],sorters:[{field:"due_at",order:"asc"}],pagination:{current:1,pageSize:100},queryOptions:{enabled:!!l}}),c=I({isLoading:d,isError:i});if(c)return c;if(!l)return null;const x=m.data?.data??[],h=x.filter(a=>!a.done_at&&a.due_at).sort((a,g)=>+new Date(a.due_at)-+new Date(g.due_at))[0],o=x.filter(a=>a.service_kind==="usterka"&&!a.done_at),j=x.filter(a=>a.done_at&&["naprawa","usterka","inne"].includes(a.service_kind)).sort((a,g)=>+new Date(g.done_at)-+new Date(a.done_at));return e.jsxs(P,{children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>t("containers"),children:[e.jsx(V,{className:"w-4 h-4 mr-2"})," Powrót do listy"]}),e.jsxs(N,{children:[e.jsx(L,{title:l.code,description:`ID: #${l.id}`}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(u,{variant:"outline",onClick:()=>r("containers",l.id),children:[e.jsx(H,{className:"w-4 h-4 mr-2"})," Edytuj"]}),e.jsxs(u,{variant:"outline",onClick:()=>n(`/admin/maintenances/create?asset_type=container&asset_id=${l.asset_id}&type=usterka&title=${encodeURIComponent(`Usterka: ${l.code}`)}`),children:[e.jsx(Re,{className:"w-4 h-4 mr-2"})," Zgłoś usterkę"]}),e.jsxs(u,{variant:"outline",onClick:()=>n(`/admin/maintenances/create?asset_type=container&asset_id=${l.asset_id}&title=${encodeURIComponent(`Wpis serwisowy: ${l.code}`)}`),children:[e.jsx(ee,{className:"w-4 h-4 mr-2"})," Dodaj wpis"]})]})]}),e.jsxs(z,{children:[e.jsx(C,{children:e.jsx($,{children:"Szczegóły"})}),e.jsxs(S,{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[l.category&&e.jsx(y,{variant:"outline",children:l.category}),l.status&&e.jsx(y,{variant:"secondary",children:l.status}),typeof l.tara_kg=="number"&&e.jsxs(y,{variant:"outline",children:[l.tara_kg," kg"]}),e.jsxs(y,{variant:"outline",children:["oddział #",l.branch_id]}),l.is_archived&&e.jsx(y,{variant:"destructive",children:"archiwum"})]}),e.jsx(K,{}),e.jsxs("div",{className:"text-sm space-y-1",children:[l.created_at&&e.jsxs("div",{children:[e.jsx("b",{children:"Utworzono:"})," ",new Date(l.created_at).toLocaleString()]}),l.updated_at&&e.jsxs("div",{children:[e.jsx("b",{children:"Aktualizacja:"})," ",new Date(l.updated_at).toLocaleString()]})]})]})]}),e.jsxs(z,{className:"mt-4",children:[e.jsx(C,{children:e.jsx($,{children:"Książka serwisowa"})}),e.jsxs(S,{className:"space-y-4",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("b",{children:"Następny przegląd:"})," ",h?.due_at?new Date(h.due_at).toLocaleDateString():"—"]}),e.jsx(K,{}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium mb-2",children:"Aktywne zgłoszenia usterek"}),o.length===0?e.jsx("div",{className:"text-sm text-muted-foreground",children:"Brak aktywnych zgłoszeń."}):e.jsx("div",{className:"space-y-3",children:o.map(a=>e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"font-medium",children:a.service_kind}),e.jsxs(u,{size:"sm",variant:"outline",onClick:()=>n(`/admin/maintenances/edit/${a.service_id}`),children:[e.jsx(xs,{className:"w-4 h-4 mr-2"})," Zakończ"]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Zgłoszono: ",a.created_at?new Date(a.created_at).toLocaleString():"—"]}),a.notes&&e.jsx("div",{className:"text-sm mt-2",children:a.notes})]},a.service_id))})]}),e.jsx(K,{}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"font-medium",children:"Historia napraw"}),e.jsxs(u,{size:"sm",variant:"outline",onClick:()=>n(`/admin/maintenances/create?asset_type=container&asset_id=${l.asset_id}&type=naprawa&title=${encodeURIComponent("Naprawa – "+l.code)}`),children:[e.jsx(ee,{className:"w-4 h-4 mr-2"})," Dodaj wpis"]})]}),j.length===0?e.jsx("div",{className:"text-sm text-muted-foreground mt-2",children:"Brak zakończonych napraw."}):e.jsx("div",{className:"space-y-3 mt-2",children:j.map(a=>e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsx("div",{className:"font-medium",children:a.service_kind}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:a.done_at?new Date(a.done_at).toLocaleDateString():"—"}),a.notes&&e.jsx("div",{className:"text-sm mt-2",children:a.notes})]},a.service_id))})]})]})]})]})},zs={name:"containers",list:"/admin/containers",create:"/admin/containers/create",edit:"/admin/containers/edit/:id",show:"/admin/containers/show/:id",meta:{label:"Kontenery"}},Ti=[e.jsx(b,{index:!0,element:e.jsx(Pi,{})},"containers-index"),e.jsx(b,{path:"create",element:e.jsx(Di,{})},"containers-create"),e.jsx(b,{path:"edit/:id",element:e.jsx(Fi,{})},"containers-edit"),e.jsx(b,{path:"show/:id",element:e.jsx(Ii,{})},"containers-show")],Wi=["transport","plac"],Vi=["nowe","w_realizacji","zakonczone","anulowane"],Ui=()=>{const{tableQuery:{data:s,isLoading:t,isError:r},setFilters:n}=se({resource:"tasks",sorters:{initial:[{field:"start_at",order:"desc"}]}}),d=I({isLoading:t,isError:r});if(d)return d;const i=x=>{n(h=>{const o=(h||[]).filter(a=>a.field!=="title");return x?.trim()?[...o,{field:"title",operator:"contains",value:x.trim()}]:o})},l=x=>{n(h=>{const o=(h||[]).filter(a=>a.field!=="branch_id");return x&&x!==""?[...o,{field:"branch_id",operator:"eq",value:Number(x)}]:o})},m=x=>{n(h=>{const o=(h||[]).filter(a=>a.field!=="type");return x&&x!==""?[...o,{field:"type",operator:"eq",value:x}]:o})},c=x=>{n(h=>{const o=(h||[]).filter(a=>a.field!=="status");return x&&x!==""?[...o,{field:"status",operator:"eq",value:x}]:o})};return e.jsxs(P,{children:[e.jsx(N,{children:e.jsx(L,{title:"Kalendarz / Plan",description:"Filtrowanie i przegląd zadań"})}),e.jsxs(N,{className:"gap-3",children:[e.jsx("div",{className:"min-w-[260px]",children:e.jsx(A,{resource:"branches",placeholder:"Filtr: oddział (opcjonalnie)",onChange:l,renderLabel:x=>`${x.name}${x.city?" — "+x.city:""} (#${x.id})`})}),e.jsxs(U,{onValueChange:x=>m(x),children:[e.jsx(T,{className:"w-56",children:e.jsx(O,{placeholder:"Filtr: typ (opcjonalnie)"})}),e.jsxs(W,{children:[Wi.map(x=>e.jsx(E,{value:x,children:x},x)),e.jsx(E,{value:"__clear_type__",children:"Wyczyść filtr typu"})]})]}),e.jsxs(U,{onValueChange:x=>c(x==="__clear_status__"?void 0:x),children:[e.jsx(T,{className:"w-56",children:e.jsx(O,{placeholder:"Filtr: status (opcjonalnie)"})}),e.jsxs(W,{children:[Vi.map(x=>e.jsx(E,{value:x,children:x},x)),e.jsx(E,{value:"__clear_status__",children:"Wyczyść filtr statusu"})]})]}),e.jsx(w,{className:"max-w-sm",placeholder:"Szukaj po tytule…",onChange:x=>i(x.target.value)})]}),e.jsx(k,{children:s?.data?.map(x=>e.jsxs(z,{children:[e.jsx(C,{children:e.jsx($,{className:"text-base",children:x.title})}),e.jsxs(S,{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(y,{variant:"secondary",children:x.type}),e.jsx(y,{variant:"outline",children:x.status}),e.jsxs(y,{variant:"outline",children:["oddział #",x.branch_id]}),x.assigned_vehicle_id&&e.jsxs(y,{variant:"outline",children:["pojazd #",x.assigned_vehicle_id]}),x.assigned_container_id&&e.jsxs(y,{variant:"outline",children:["kontener #",x.assigned_container_id]})]}),e.jsx(K,{}),e.jsxs("div",{className:"text-sm",children:[e.jsxs("div",{children:[e.jsx("b",{children:"Start:"})," ",new Date(x.start_at).toLocaleString()]}),x.end_at&&e.jsxs("div",{children:[e.jsx("b",{children:"Koniec:"})," ",new Date(x.end_at).toLocaleString()]}),x.assigned_driver&&e.jsxs("div",{children:[e.jsx("b",{children:"Kierowca (UUID):"})," ",x.assigned_driver]})]})]})]},x.id))})]})},Oi=Ui,Cs={name:"calendar",list:"/admin/calendar/weekly",meta:{label:"Kalendarz"}},Bi=[e.jsx(b,{path:"weekly",element:e.jsx(Oi,{})},"calendar-weekly")],Mi=()=>{const{tableQuery:{data:s,isLoading:t,isError:r},current:n,setCurrent:d,pageSize:i,setFilters:l}=se({resource:"price_lists",sorters:{initial:[{field:"created_at",order:"desc"}]}}),{create:m,edit:c,show:x}=D(),h=I({isLoading:t,isError:r});return h||e.jsxs(P,{children:[e.jsxs(N,{children:[e.jsx(L,{title:"Cenniki",description:"Wersje cenników"}),e.jsxs(u,{onClick:()=>m("price_lists"),children:[e.jsx(ee,{className:"w-4 h-4 mr-2"})," Nowa wersja"]})]}),e.jsx(N,{children:e.jsx(w,{placeholder:"Szukaj po nazwie...",className:"max-w-sm",onChange:o=>l([{field:"title",operator:"contains",value:o.target.value}])})}),e.jsx(k,{children:s?.data?.map(o=>e.jsxs(z,{children:[e.jsx(C,{children:e.jsx(L,{title:o.title,description:o.version_tag||"—",variant:"card"})}),e.jsx(S,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(y,{variant:"outline",children:["ID #",o.id]}),o.branch_id&&e.jsxs(y,{variant:"outline",children:["oddział #",o.branch_id]})]})}),e.jsx(ne,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{variant:"outline",size:"sm",onClick:()=>x("price_lists",o.id),children:e.jsx(oe,{className:"w-4 h-4"})}),e.jsx(u,{variant:"outline",size:"sm",onClick:()=>c("price_lists",o.id),children:e.jsx(H,{className:"w-4 h-4"})})]})})]},o.id))}),e.jsx(he,{current:n,pageSize:i,total:s?.total||0,setCurrent:d,itemName:"cenniki"})]})},Ki=()=>{const{list:s}=D(),{data:t}=Me(),{refineCore:{onFinish:r},register:n,handleSubmit:d,setValue:i,watch:l,formState:{errors:m,isSubmitting:c}}=Q({refineCoreProps:{resource:"price_lists"}}),x=h=>r({...h,created_by:t?.id});return e.jsxs(P,{children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>s("price_lists"),children:[e.jsx(V,{className:"w-4 h-4 mr-2"})," Powrót do listy"]}),e.jsx(N,{children:e.jsx(L,{title:"Nowa wersja cennika",description:"Utwórz cennik (rich-text)"})}),e.jsxs(z,{children:[e.jsx(C,{children:e.jsx($,{children:"Parametry"})}),e.jsx(S,{children:e.jsxs(G,{onSubmit:d(x),children:[e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Nazwa",htmlFor:"title",error:m.title?.message,required:!0,children:e.jsx(w,{id:"title",...n("title",{required:"Wymagane"})})}),e.jsx(p,{label:"Oddział (opcjonalnie)",children:e.jsx(A,{resource:"branches",value:l("branch_id"),onChange:h=>i("branch_id",h?Number(h):null),renderLabel:h=>`${h.name}${h.city?" — "+h.city:""} (#${h.id})`,placeholder:"Globalny lub przypisany do oddziału"})})]}),e.jsx(k,{variant:"1-2-2",children:e.jsx(p,{label:"Etykieta wersji",htmlFor:"version_tag",children:e.jsx(w,{id:"version_tag",...n("version_tag")})})}),e.jsx(p,{label:"Treść cennika (rich-text)",error:m.content_rich?.message,required:!0,children:e.jsx(ie,{rows:10,...n("content_rich",{required:"Wymagane"}),placeholder:"Wklej/napisz treść cennika. Obsługa RTE do podmiany w kolejnym kroku."})}),e.jsxs(Z,{children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>s("price_lists"),children:"Anuluj"}),e.jsx(u,{type:"submit",disabled:c||!t?.id,children:c?"Tworzenie...":"Utwórz"})]})]})})]})]})},Zi=()=>{const{show:s}=D(),{refineCore:{onFinish:t,queryResult:r},register:n,handleSubmit:d,setValue:i,watch:l,formState:{errors:m,isSubmitting:c}}=Q({refineCoreProps:{resource:"price_lists",action:"edit"}}),x=r?.isLoading??!0,h=r?.isError??!1,o=r?.data?.data,j=I({isLoading:x,isError:h});return j||(o?e.jsxs(P,{children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>s("price_lists",o.id),children:[e.jsx(V,{className:"w-4 h-4 mr-2"})," Powrót do szczegółów"]}),e.jsx(N,{children:e.jsx(L,{title:"Edycja cennika",description:`ID: #${o.id}`})}),e.jsxs(z,{children:[e.jsx(C,{children:e.jsx($,{children:"Parametry"})}),e.jsx(S,{children:e.jsxs(G,{onSubmit:d(t),children:[e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Nazwa",htmlFor:"title",error:m.title?.message,required:!0,children:e.jsx(w,{id:"title",...n("title",{required:"Wymagane"})})}),e.jsx(p,{label:"Oddział (opcjonalnie)",children:e.jsx(A,{resource:"branches",value:l("branch_id")??o.branch_id,onChange:a=>i("branch_id",a?Number(a):null),renderLabel:a=>`${a.name}${a.city?" — "+a.city:""} (#${a.id})`,placeholder:"Globalny lub przypisany do oddziału"})})]}),e.jsx(k,{variant:"1-2-2",children:e.jsx(p,{label:"Etykieta wersji",htmlFor:"version_tag",children:e.jsx(w,{id:"version_tag",...n("version_tag")})})}),e.jsx(p,{label:"Treść cennika (rich-text)",error:m.content_rich?.message,required:!0,children:e.jsx(ie,{rows:10,...n("content_rich",{required:"Wymagane"})})}),e.jsxs(Z,{children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>s("price_lists",o.id),children:"Anuluj"}),e.jsx(u,{type:"submit",disabled:c,children:c?"Zapisywanie...":"Zapisz"})]})]})})]})]}):null)},Qi=()=>{const{queryResult:s}=ce({resource:"price_lists"}),{list:t,edit:r}=D(),n=s?.isLoading??!0,d=s?.isError??!1,i=s?.data?.data,l=I({isLoading:n,isError:d});return l||(i?e.jsxs(P,{children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>t("price_lists"),children:[e.jsx(V,{className:"w-4 h-4 mr-2"})," Powrót do listy"]}),e.jsxs(N,{children:[e.jsx(L,{title:i.title,description:`ID: #${i.id}`}),e.jsxs(u,{variant:"outline",onClick:()=>r("price_lists",i.id),children:[e.jsx(H,{className:"w-4 h-4 mr-2"})," Edytuj"]})]}),e.jsxs(z,{children:[e.jsx(C,{children:e.jsx($,{children:"Szczegóły"})}),e.jsxs(S,{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[i.version_tag&&e.jsx(y,{variant:"outline",children:i.version_tag}),i.branch_id&&e.jsxs(y,{variant:"outline",children:["oddział #",i.branch_id]})]}),e.jsx(K,{}),i.content_rich?e.jsx("div",{className:"prose max-w-none whitespace-pre-wrap",children:i.content_rich}):e.jsx("div",{className:"text-sm text-muted-foreground",children:"Brak treści"})]})]})]}):null)},Ss={name:"price_lists",list:"/admin/pricelists",create:"/admin/pricelists/create",edit:"/admin/pricelists/edit/:id",show:"/admin/pricelists/show/:id",meta:{label:"Cenniki"}},Hi=[e.jsx(b,{index:!0,element:e.jsx(Mi,{})},"pricelists-index"),e.jsx(b,{path:"create",element:e.jsx(Ki,{})},"pricelists-create"),e.jsx(b,{path:"edit/:id",element:e.jsx(Zi,{})},"pricelists-edit"),e.jsx(b,{path:"show/:id",element:e.jsx(Qi,{})},"pricelists-show")],Gi=()=>{const{tableQuery:{data:s,isLoading:t,isError:r},current:n,setCurrent:d,pageSize:i,setFilters:l}=se({resource:"yard_equipment",sorters:{initial:[{field:"created_at",order:"desc"}]}}),{create:m,edit:c,show:x}=D(),h=je(),o=I({isLoading:t,isError:r});if(o)return o;const j=a=>l((g=[])=>[...g.filter(F=>F.field!=="name"),{field:"name",operator:"contains",value:a}]);return e.jsxs(P,{children:[e.jsxs(N,{children:[e.jsx(L,{title:"Sprzęt placowy",description:"Maszyny / urządzenia na placu"}),e.jsxs(u,{onClick:()=>m("yard_equipment"),children:[e.jsx(ee,{className:"w-4 h-4 mr-2"})," Dodaj sprzęt"]})]}),e.jsx(N,{className:"gap-3",children:e.jsx(w,{placeholder:"Szukaj po nazwie…",className:"max-w-sm",onChange:a=>j(a.target.value)})}),e.jsx(k,{children:s?.data?.map(a=>e.jsxs(z,{children:[e.jsx(C,{children:e.jsx(L,{title:a.name,description:"—",variant:"card"})}),e.jsx(S,{children:e.jsxs(N,{variant:"start",className:"gap-2",children:[e.jsxs(y,{variant:"outline",children:["ID #",a.id]}),a.type&&e.jsx(y,{variant:"secondary",children:a.type}),a.branch_id&&e.jsxs(y,{variant:"outline",children:["oddział #",a.branch_id]}),a.is_archived?e.jsx(y,{variant:"destructive",children:"archiwum"}):e.jsx(y,{variant:"outline",children:"dostępny"})]})}),e.jsx(ne,{children:e.jsxs(N,{variant:"start",className:"gap-2",children:[e.jsx(u,{variant:"outline",size:"sm",onClick:()=>x("yard_equipment",a.id),children:e.jsx(oe,{className:"w-4 h-4"})}),e.jsx(u,{variant:"outline",size:"sm",onClick:()=>c("yard_equipment",a.id),children:e.jsx(H,{className:"w-4 h-4"})}),a.asset_id&&e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>h(`/admin/maintenances/create?asset_id=${a.asset_id}&kind=usterka`),children:[e.jsx(Re,{className:"w-4 h-4 mr-1"})," Zgłoś usterkę"]})]})})]},a.id))}),e.jsx(he,{current:n,pageSize:i,total:s?.total||0,setCurrent:d,itemName:"pozycje"})]})},Yi=["koparka","wozek_widlowy","prasa","inne"],Ls=[{value:"dostepny",label:"Dostępny",archived:!1},{value:"archiwum",label:"Archiwum",archived:!0}],Xi=()=>{const{list:s}=D(),{refineCore:{onFinish:t},register:r,handleSubmit:n,setValue:d,watch:i,formState:{errors:l,isSubmitting:m}}=Q({refineCoreProps:{resource:"yard_equipment"}});return ye.useEffect(()=>d("is_archived",!1),[d]),e.jsxs(P,{children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>s("yard_equipment"),children:[e.jsx(V,{className:"w-4 h-4 mr-2"})," Powrót do listy"]}),e.jsx(N,{children:e.jsx(L,{title:"Nowa maszyna",description:"Dodaj sprzęt placowy"})}),e.jsxs(z,{children:[e.jsx(C,{children:e.jsx($,{children:"Dane podstawowe"})}),e.jsx(S,{children:e.jsxs(G,{onSubmit:n(t),children:[e.jsx("input",{type:"hidden",...r("is_archived")}),e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Nazwa",htmlFor:"name",error:l.name?.message,required:!0,children:e.jsx(w,{id:"name",...r("name",{required:"Wymagane"})})}),e.jsx(p,{label:"Kategoria (type)",required:!0,children:e.jsxs(U,{onValueChange:c=>d("type",c,{shouldValidate:!0}),children:[e.jsx(T,{children:e.jsx(O,{placeholder:"Wybierz typ"})}),e.jsx(W,{children:Yi.map(c=>e.jsx(E,{value:c,children:c},c))})]})})]}),e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Oddział (branch_id)",required:!0,error:l.branch_id?.message,children:e.jsx(A,{resource:"branches",value:i("branch_id"),onChange:c=>d("branch_id",Number(c),{shouldValidate:!0}),renderLabel:c=>`${c.name}${c.city?" — "+c.city:""} (#${c.id})`,placeholder:"Wybierz oddział"})}),e.jsx(p,{label:"Status",children:e.jsxs(U,{defaultValue:"dostepny",onValueChange:c=>{const x=Ls.find(h=>h.value===c);d("is_archived",!!x?.archived,{shouldValidate:!0})},children:[e.jsx(T,{children:e.jsx(O,{placeholder:"Wybierz status"})}),e.jsx(W,{children:Ls.map(c=>e.jsx(E,{value:c.value,children:c.label},c.value))})]})})]}),e.jsxs(Z,{children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>s("yard_equipment"),children:"Anuluj"}),e.jsx(u,{type:"submit",disabled:m,children:m?"Tworzenie...":"Utwórz"})]})]})})]})]})},Ji=["koparka","wozek_widlowy","prasa","inne"],Rs=[{value:"dostepny",label:"Dostępny",archived:!1},{value:"archiwum",label:"Archiwum",archived:!0}],en=()=>{const{show:s}=D(),{refineCore:{onFinish:t,queryResult:r},register:n,handleSubmit:d,setValue:i,watch:l,formState:{errors:m,isSubmitting:c}}=Q({refineCoreProps:{resource:"yard_equipment",action:"edit"}}),x=r?.isLoading??!0,h=r?.isError??!1,o=r?.data?.data,j=I({isLoading:x,isError:h});return j||(o?e.jsxs(P,{children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>s("yard_equipment",o.id),children:[e.jsx(V,{className:"w-4 h-4 mr-2"})," Powrót do szczegółów"]}),e.jsx(N,{children:e.jsx(L,{title:"Edycja maszyny",description:`ID: #${o.id}`})}),e.jsxs(z,{children:[e.jsx(C,{children:e.jsx($,{children:"Dane podstawowe"})}),e.jsx(S,{children:e.jsxs(G,{onSubmit:d(t),children:[e.jsx("input",{type:"hidden",...n("is_archived")}),e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Nazwa",htmlFor:"name",error:m.name?.message,required:!0,children:e.jsx(w,{id:"name",...n("name",{required:"Wymagane"})})}),e.jsx(p,{label:"Kategoria (type)",required:!0,children:e.jsxs(U,{defaultValue:o.type,onValueChange:a=>i("type",a,{shouldValidate:!0}),children:[e.jsx(T,{children:e.jsx(O,{placeholder:"Wybierz typ"})}),e.jsx(W,{children:Ji.map(a=>e.jsx(E,{value:a,children:a},a))})]})})]}),e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Oddział (branch_id)",required:!0,error:m.branch_id?.message,children:e.jsx(A,{resource:"branches",value:l("branch_id")??o.branch_id,onChange:a=>i("branch_id",Number(a),{shouldValidate:!0}),renderLabel:a=>`${a.name}${a.city?" — "+a.city:""} (#${a.id})`,placeholder:"Wybierz oddział"})}),e.jsx(p,{label:"Status",children:e.jsxs(U,{defaultValue:o.is_archived?"archiwum":"dostepny",onValueChange:a=>{const g=Rs.find(v=>v.value===a);i("is_archived",!!g?.archived,{shouldValidate:!0})},children:[e.jsx(T,{children:e.jsx(O,{placeholder:"Wybierz status"})}),e.jsx(W,{children:Rs.map(a=>e.jsx(E,{value:a.value,children:a.label},a.value))})]})})]}),e.jsxs(Z,{children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>s("yard_equipment",o.id),children:"Anuluj"}),e.jsx(u,{type:"submit",disabled:c,children:c?"Zapisywanie...":"Zapisz"})]})]})})]})]}):null)},sn="asset_maintenances",an=()=>{const{queryResult:s}=ce({resource:"yard_equipment"}),{list:t,edit:r}=D(),n=je(),d=s?.isLoading??!0,i=s?.isError??!1,l=s?.data?.data,c=ge({resource:sn,filters:l?[{field:"asset_id",operator:"eq",value:l.asset_id}]:[],sorters:[{field:"due_at",order:"asc"}],pagination:{current:1,pageSize:100},queryOptions:{enabled:!!l}}).data?.data??[],x=c.filter(a=>!a.done_at&&a.due_at).sort((a,g)=>+new Date(a.due_at)-+new Date(g.due_at))[0],h=c.filter(a=>a.service_kind==="usterka"&&!a.done_at),o=c.filter(a=>a.done_at&&["naprawa","usterka","inne"].includes(a.service_kind)).sort((a,g)=>+new Date(g.done_at)-+new Date(a.done_at)),j=I({isLoading:d,isError:i});return j||(l?e.jsxs(P,{children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>t("yard_equipment"),children:[e.jsx(V,{className:"w-4 h-4 mr-2"})," Powrót do listy"]}),e.jsxs(N,{children:[e.jsx(L,{title:l.name,description:`ID: #${l.id}`}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(u,{variant:"outline",onClick:()=>r("yard_equipment",l.id),children:[e.jsx(H,{className:"w-4 h-4 mr-2"})," Edytuj"]}),e.jsxs(u,{variant:"outline",onClick:()=>n(`/admin/maintenances/create?asset_type=equipment&asset_id=${l.asset_id}&type=usterka&title=${encodeURIComponent(`Usterka: ${l.name}`)}`),children:[e.jsx(Re,{className:"w-4 h-4 mr-2"})," Zgłoś usterkę"]}),e.jsxs(u,{variant:"outline",onClick:()=>n(`/admin/maintenances/create?asset_type=equipment&asset_id=${l.asset_id}&title=${encodeURIComponent(`Wpis serwisowy: ${l.name}`)}`),children:[e.jsx(ee,{className:"w-4 h-4 mr-2"})," Dodaj wpis"]})]})]}),e.jsxs(z,{children:[e.jsx(C,{children:e.jsx($,{children:"Szczegóły"})}),e.jsxs(S,{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(y,{variant:"secondary",children:l.type}),e.jsxs(y,{variant:"outline",children:["oddział #",l.branch_id]}),l.is_archived?e.jsx(y,{variant:"destructive",children:"archiwum"}):e.jsx(y,{variant:"outline",children:"dostępny"})]}),e.jsx(K,{}),e.jsxs("div",{className:"text-sm space-y-1",children:[l.created_at&&e.jsxs("div",{children:[e.jsx("b",{children:"Utworzono:"})," ",new Date(l.created_at).toLocaleString()]}),l.updated_at&&e.jsxs("div",{children:[e.jsx("b",{children:"Aktualizacja:"})," ",new Date(l.updated_at).toLocaleString()]})]})]})]}),e.jsxs(z,{className:"mt-4",children:[e.jsx(C,{children:e.jsx($,{children:"Książka serwisowa"})}),e.jsxs(S,{className:"space-y-4",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("b",{children:"Następny przegląd:"})," ",x?.due_at?new Date(x.due_at).toLocaleDateString():"—"]}),e.jsx(K,{}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium mb-2",children:"Aktywne zgłoszenia usterek"}),h.length===0?e.jsx("div",{className:"text-sm text-muted-foreground",children:"Brak aktywnych zgłoszeń."}):e.jsx("div",{className:"space-y-3",children:h.map(a=>e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"font-medium",children:a.service_kind}),e.jsxs(u,{size:"sm",variant:"outline",onClick:()=>n(`/admin/maintenances/edit/${a.service_id}`),children:[e.jsx(xs,{className:"w-4 h-4 mr-2"})," Zakończ"]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Zgłoszono: ",a.created_at?new Date(a.created_at).toLocaleString():"—"]}),a.notes&&e.jsx("div",{className:"text-sm mt-2",children:a.notes})]},a.service_id))})]}),e.jsx(K,{}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"font-medium",children:"Historia napraw"}),e.jsxs(u,{size:"sm",variant:"outline",onClick:()=>n(`/admin/maintenances/create?asset_type=equipment&asset_id=${l.asset_id}&type=naprawa&title=${encodeURIComponent("Naprawa – "+l.name)}`),children:[e.jsx(ee,{className:"w-4 h-4 mr-2"})," Dodaj wpis"]})]}),o.length===0?e.jsx("div",{className:"text-sm text-muted-foreground mt-2",children:"Brak zakończonych napraw."}):e.jsx("div",{className:"space-y-3 mt-2",children:o.map(a=>e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsx("div",{className:"font-medium",children:a.service_kind}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:a.done_at?new Date(a.done_at).toLocaleDateString():"—"}),a.notes&&e.jsx("div",{className:"text-sm mt-2",children:a.notes})]},a.service_id))})]})]})]})]}):null)},$s={name:"yard_equipment",list:"/admin/equipment",create:"/admin/equipment/create",edit:"/admin/equipment/edit/:id",show:"/admin/equipment/show/:id",meta:{label:"Sprzęt placowy"}},rn=[e.jsx(b,{index:!0,element:e.jsx(Gi,{})},"equipment-index"),e.jsx(b,{path:"create",element:e.jsx(Xi,{})},"equipment-create"),e.jsx(b,{path:"edit/:id",element:e.jsx(en,{})},"equipment-edit"),e.jsx(b,{path:"show/:id",element:e.jsx(an,{})},"equipment-show")],tn="dispatches",nn=["plan","w_drodze","zaladowany","rozladowany","zakonczony","anulowany"],ln=()=>{const{tableQuery:{data:s,isLoading:t,isError:r},current:n,setCurrent:d,pageSize:i,setFilters:l}=se({resource:"dispatches",meta:{table:tn},sorters:{initial:[{field:"start_at",order:"desc"}]}}),{create:m,edit:c,show:x}=D(),h=I({isLoading:t,isError:r});if(h)return h;const o=a=>l([{field:"title",operator:"contains",value:a}]),j=a=>l(g=>{const v=(g||[]).filter(F=>F.field!=="status");return a?[...v,{field:"status",operator:"eq",value:a}]:v});return e.jsxs(P,{children:[e.jsxs(N,{children:[e.jsx(L,{title:"Wywozy",description:"Transport długodystansowy"}),e.jsxs(u,{onClick:()=>m("dispatches"),children:[e.jsx(ee,{className:"w-4 h-4 mr-2"})," Nowy wywóz"]})]}),e.jsxs(N,{className:"gap-3",children:[e.jsx(w,{placeholder:"Szukaj po tytule…",className:"max-w-sm",onChange:a=>o(a.target.value)}),e.jsxs(U,{onValueChange:a=>j(a==="__clear__"?void 0:a),children:[e.jsx(T,{className:"w-56",children:e.jsx(O,{placeholder:"Filtr: status (opcjonalnie)"})}),e.jsxs(W,{children:[nn.map(a=>e.jsx(E,{value:a,children:a},a)),e.jsx(E,{value:"__clear__",children:"Wyczyść filtr"})]})]})]}),e.jsx(k,{children:s?.data?.map((a,g)=>{const v=(n-1)*i+g+1;return e.jsxs(z,{children:[e.jsx(C,{children:e.jsx(L,{title:a.title,description:`Start: ${new Date(a.start_at).toLocaleString()}`,variant:"card"})}),e.jsxs(S,{children:[e.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[e.jsxs(y,{variant:"outline",children:["ID #",a.id]}),a.status&&e.jsx(y,{variant:"secondary",children:a.status}),a.vehicle_id&&e.jsxs(y,{variant:"outline",children:["pojazd #",a.vehicle_id]}),a.trailer_id&&e.jsxs(y,{variant:"outline",children:["naczepa #",a.trailer_id]}),a.external_transport_client_id&&e.jsxs(y,{variant:"outline",children:["zewn. transport #",a.external_transport_client_id]})]}),e.jsx(dn,{lp:v,dispatch:a})]}),e.jsx(ne,{children:e.jsxs(N,{variant:"start",className:"gap-2",children:[e.jsx(u,{variant:"outline",size:"sm",onClick:()=>x("dispatches",a.id),children:e.jsx(oe,{className:"w-4 h-4"})}),e.jsx(u,{variant:"outline",size:"sm",onClick:()=>c("dispatches",a.id),children:e.jsx(H,{className:"w-4 h-4"})})]})})]},a.id)})}),e.jsx(he,{current:n,pageSize:i,total:s?.total||0,setCurrent:d,itemName:"wywozy"})]})},dn=({lp:s,dispatch:t})=>e.jsxs("div",{className:"text-sm space-y-2",children:[e.jsx(Ce,{label:"Lp.",children:e.jsx("span",{children:s})}),e.jsx(Ce,{label:"Kierowca",children:t.driver_id?e.jsx(cn,{id:t.driver_id}):e.jsx("span",{children:"—"})}),e.jsx(Ce,{label:"Skąd",children:e.jsx(on,{id:t.branch_id})}),e.jsx(Ce,{label:"Dokąd / Materiał / Powrót / Dokąd (powrót)",children:e.jsx(hn,{dispatchId:t.id})}),e.jsx(Ce,{label:"Notatki",children:e.jsx("span",{children:t.notes||"—"})}),e.jsx(Ce,{label:"Stawka za fracht",children:typeof t.freight_rate=="number"?e.jsxs("span",{children:[t.freight_rate.toFixed(2)," ",t.freight_currency||"PLN"]}):e.jsx("span",{children:"—"})})]}),Ce=({label:s,children:t})=>e.jsxs("div",{className:"grid grid-cols-12 items-start gap-2",children:[e.jsx("div",{className:"col-span-12 md:col-span-3 text-muted-foreground",children:s}),e.jsx("div",{className:"col-span-12 md:col-span-9",children:t}),e.jsx(K,{className:"col-span-12 my-1"})]}),cn=({id:s})=>{const{data:t,isLoading:r}=xa({resource:"users",id:s,meta:{select:"full_name,email,id"},queryOptions:{enabled:!!s}});if(r)return e.jsx("span",{children:"Ładowanie…"});const n=t?.data;if(!n)return e.jsxs("span",{children:["#",String(s).slice(0,8)]});const d=n.full_name||n.email||`#${String(n.id||s).slice(0,8)}`;return e.jsx("span",{children:d})},on=({id:s})=>{const{data:t,isLoading:r}=xa({resource:"branches",id:s,meta:{select:"name,city,id"},queryOptions:{enabled:!!s}});if(r)return e.jsx("span",{children:"Ładowanie…"});const n=t?.data;return n?e.jsxs("span",{children:[n.name,n.city?` — ${n.city}`:""," (#",n.id,")"]}):e.jsxs("span",{children:["oddział #",s]})},hn=({dispatchId:s})=>{const{data:t,isLoading:r}=ge({resource:"dispatch_segments",filters:[{field:"dispatch_id",operator:"eq",value:s}],sorters:[{field:"seq",order:"asc"}],meta:{select:"seq,kind,material_desc,is_return_empty,client:clients(name),address:addresses(city,line1)"}});if(r)return e.jsx("span",{children:"Ładowanie trasy…"});const n=t?.data||[];if(!n.length)return e.jsx("span",{children:"Dokąd: — • Materiał: — • Powrót: — • Dokąd (powrót): —"});n[0];const d=n[n.length-1],l=(a=>a?.client?.name||a?.address?.city||a?.address?.line1||"—")(d),m=n.map(a=>(a.material_desc||"").trim()).filter(Boolean),c=Array.from(new Set(m)),x=c.length>2?`${c.slice(0,2).join(", ")} +${c.length-2}`:c.join(", ")||"—",h=n.some(a=>a.is_return_empty===!0),o=h?"pusto":n.length>1?"ładunek":"—",j=!h&&n.length>1?l:"—";return e.jsxs("span",{children:[e.jsx("b",{children:"Dokąd:"})," ",l," • ",e.jsx("b",{children:"Materiał:"})," ",x," • ",e.jsx("b",{children:"Powrót:"})," ",o," • ",e.jsx("b",{children:"Dokąd (powrót):"})," ",j]})},xn="dispatches",un=["plan","w_drodze","zaladowany","rozladowany","zakonczony","anulowany"],mn=()=>{const{list:s}=D(),{refineCore:{onFinish:t},register:r,handleSubmit:n,setValue:d,watch:i,formState:{errors:l,isSubmitting:m}}=Q({refineCoreProps:{resource:"dispatches",meta:{table:xn}}});return e.jsxs(P,{children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>s("dispatches"),children:[e.jsx(V,{className:"w-4 h-4 mr-2"})," Powrót do listy"]}),e.jsx(N,{children:e.jsx(L,{title:"Nowy wywóz",description:"Trasa wielopunktowa + zasoby"})}),e.jsxs(z,{children:[e.jsx(C,{children:e.jsx($,{children:"Parametry"})}),e.jsx(S,{children:e.jsxs(G,{onSubmit:n(t),children:[e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Tytuł",htmlFor:"title",error:l.title?.message,required:!0,children:e.jsx(w,{id:"title",...r("title",{required:"Wymagane"})})}),e.jsx(p,{label:"Oddział (branch_id)",required:!0,error:l.branch_id?.message,children:e.jsx(A,{resource:"branches",value:i("branch_id"),onChange:c=>d("branch_id",Number(c),{shouldValidate:!0}),renderLabel:c=>`${c.name}${c.city?" — "+c.city:""} (#${c.id})`,placeholder:"Wybierz oddział"})})]}),e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Status",required:!0,children:e.jsxs(U,{defaultValue:"plan",onValueChange:c=>d("status",c),children:[e.jsx(T,{children:e.jsx(O,{placeholder:"Wybierz status"})}),e.jsx(W,{children:un.map(c=>e.jsx(E,{value:c,children:c},c))})]})}),e.jsx(p,{label:"Start",htmlFor:"start_at",required:!0,children:e.jsx(w,{id:"start_at",type:"datetime-local",...r("start_at",{required:"Wymagane"})})})]}),e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Koniec",htmlFor:"end_at",children:e.jsx(w,{id:"end_at",type:"datetime-local",...r("end_at")})}),e.jsx("div",{})]}),e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Kierowca",children:e.jsx(A,{resource:"users",value:i("driver_id"),onChange:c=>d("driver_id",c),renderLabel:c=>`${c.full_name||c.email} (#${String(c.id).slice(0,8)})`,placeholder:"Wybierz kierowcę (opcjonalnie)"})}),e.jsx(p,{label:"Pojazd",children:e.jsx(A,{resource:"vehicles",value:i("vehicle_id"),onChange:c=>d("vehicle_id",Number(c)),renderLabel:c=>`${c.name}${c.reg_plate?" / "+c.reg_plate:""} (#${c.id})`,placeholder:"Wybierz pojazd (opcjonalnie)"})}),e.jsx(p,{label:"Naczepa / przyczepa",children:e.jsx(A,{resource:"vehicles",value:i("trailer_id"),onChange:c=>d("trailer_id",Number(c)),renderLabel:c=>`${c.name}${c.reg_plate?" / "+c.reg_plate:""} (#${c.id})`,placeholder:"Wybierz naczepę (opcjonalnie)"})})]}),e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Transport zewnętrzny (CRM: Firmy transportowe)",children:e.jsx(A,{resource:"clients",value:i("external_transport_client_id"),onChange:c=>d("external_transport_client_id",Number(c)),renderLabel:c=>`${c.name}${c.category?" — "+c.category:""} (#${c.id})`,placeholder:"Wybierz firmę (opcjonalnie)"})}),e.jsx(p,{label:"Stawka za fracht",children:e.jsx(w,{type:"number",step:"0.01",...r("freight_rate",{valueAsNumber:!0})})}),e.jsx(p,{label:"Waluta",children:e.jsx(w,{maxLength:3,defaultValue:"PLN",...r("freight_currency")})})]}),e.jsx(p,{label:"Notatki",children:e.jsx(ie,{rows:4,...r("notes")})}),e.jsxs(Z,{children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>s("dispatches"),children:"Anuluj"}),e.jsx(u,{type:"submit",disabled:m,children:m?"Tworzenie...":"Utwórz"})]})]})})]})]})},jn="dispatches",pn=["plan","w_drodze","zaladowany","rozladowany","zakonczony","anulowany"],gn=()=>{const{show:s}=D(),{refineCore:{onFinish:t,queryResult:r},register:n,handleSubmit:d,setValue:i,watch:l,formState:{errors:m,isSubmitting:c}}=Q({refineCoreProps:{resource:"dispatches",action:"edit",meta:{table:jn}}}),x=r?.isLoading??!0,h=r?.isError??!1,o=r?.data?.data,j=I({isLoading:x,isError:h});return j||(o?e.jsxs(P,{children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>s("dispatches",o.id),children:[e.jsx(V,{className:"w-4 h-4 mr-2"})," Powrót do szczegółów"]}),e.jsx(N,{children:e.jsx(L,{title:"Edycja wywozu",description:`ID: #${o.id}`})}),e.jsxs(z,{children:[e.jsx(C,{children:e.jsx($,{children:"Parametry"})}),e.jsx(S,{children:e.jsxs(G,{onSubmit:d(t),children:[e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Tytuł",htmlFor:"title",error:m.title?.message,required:!0,children:e.jsx(w,{id:"title",defaultValue:o.title,...n("title",{required:"Wymagane"})})}),e.jsx(p,{label:"Oddział (branch_id)",required:!0,error:m.branch_id?.message,children:e.jsx(A,{resource:"branches",value:l("branch_id")??o.branch_id,onChange:a=>i("branch_id",Number(a),{shouldValidate:!0}),renderLabel:a=>`${a.name}${a.city?" — "+a.city:""} (#${a.id})`,placeholder:"Wybierz oddział"})})]}),e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Status",required:!0,children:e.jsxs(U,{defaultValue:o.status,onValueChange:a=>i("status",a),children:[e.jsx(T,{children:e.jsx(O,{placeholder:"Wybierz status"})}),e.jsx(W,{children:pn.map(a=>e.jsx(E,{value:a,children:a},a))})]})}),e.jsx(p,{label:"Start",htmlFor:"start_at",required:!0,children:e.jsx(w,{id:"start_at",type:"datetime-local",defaultValue:o.start_at?.slice(0,16),...n("start_at",{required:"Wymagane"})})})]}),e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Koniec",htmlFor:"end_at",children:e.jsx(w,{id:"end_at",type:"datetime-local",defaultValue:o.end_at?.slice(0,16),...n("end_at")})}),e.jsx("div",{})]}),e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Kierowca",children:e.jsx(A,{resource:"users",value:l("driver_id")??o.driver_id,onChange:a=>i("driver_id",a),renderLabel:a=>`${a.full_name||a.email} (#${String(a.id).slice(0,8)})`,placeholder:"Wybierz kierowcę (opcjonalnie)"})}),e.jsx(p,{label:"Pojazd",children:e.jsx(A,{resource:"vehicles",value:l("vehicle_id")??o.vehicle_id,onChange:a=>i("vehicle_id",Number(a)),renderLabel:a=>`${a.name}${a.reg_plate?" / "+a.reg_plate:""} (#${a.id})`,placeholder:"Wybierz pojazd (opcjonalnie)"})}),e.jsx(p,{label:"Naczepa / przyczepa",children:e.jsx(A,{resource:"vehicles",value:l("trailer_id")??o.trailer_id,onChange:a=>i("trailer_id",Number(a)),renderLabel:a=>`${a.name}${a.reg_plate?" / "+a.reg_plate:""} (#${a.id})`,placeholder:"Wybierz naczepę (opcjonalnie)"})})]}),e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Transport zewnętrzny (CRM: Firmy transportowe)",children:e.jsx(A,{resource:"clients",value:l("external_transport_client_id")??o.external_transport_client_id,onChange:a=>i("external_transport_client_id",Number(a)),renderLabel:a=>`${a.name}${a.category?" — "+a.category:""} (#${a.id})`,placeholder:"Wybierz firmę (opcjonalnie)"})}),e.jsx(p,{label:"Stawka za fracht",children:e.jsx(w,{type:"number",step:"0.01",defaultValue:o.freight_rate??void 0,...n("freight_rate",{valueAsNumber:!0})})}),e.jsx(p,{label:"Waluta",children:e.jsx(w,{maxLength:3,defaultValue:o.freight_currency??"PLN",...n("freight_currency")})})]}),e.jsx(p,{label:"Notatki",children:e.jsx(ie,{rows:4,defaultValue:o.notes??"",...n("notes")})}),e.jsxs(Z,{children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>s("dispatches",o.id),children:"Anuluj"}),e.jsx(u,{type:"submit",disabled:c,children:c?"Zapisywanie...":"Zapisz"})]})]})})]})]}):null)},bn="dispatches",yn=()=>{const{queryResult:s}=ce({resource:"dispatches",meta:{table:bn}}),{list:t,edit:r}=D(),n=s?.isLoading??!0,d=s?.isError??!1,i=s?.data?.data,l=I({isLoading:n,isError:d});return l||(i?e.jsxs(P,{children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>t("dispatches"),children:[e.jsx(V,{className:"w-4 h-4 mr-2"})," Powrót do listy"]}),e.jsxs(N,{children:[e.jsx(L,{title:i.title,description:`ID: #${i.id}`}),e.jsxs(u,{variant:"outline",onClick:()=>r("dispatches",i.id),children:[e.jsx(H,{className:"w-4 h-4 mr-2"})," Edytuj"]})]}),e.jsxs(z,{children:[e.jsx(C,{children:e.jsx($,{children:"Szczegóły"})}),e.jsxs(S,{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(y,{variant:"secondary",children:i.status}),e.jsxs(y,{variant:"outline",children:["oddział #",i.branch_id]}),i.vehicle_id&&e.jsxs(y,{variant:"outline",children:["pojazd #",i.vehicle_id]}),i.trailer_id&&e.jsxs(y,{variant:"outline",children:["naczepa #",i.trailer_id]}),i.external_transport_client_id&&e.jsxs(y,{variant:"outline",children:["zewn. transp. #",i.external_transport_client_id]})]}),e.jsx(K,{}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{children:[e.jsx("b",{children:"Start:"})," ",new Date(i.start_at).toLocaleString()]}),i.end_at&&e.jsxs("div",{children:[e.jsx("b",{children:"Koniec:"})," ",new Date(i.end_at).toLocaleString()]}),i.driver_id&&e.jsxs("div",{children:[e.jsx("b",{children:"Kierowca (UUID):"})," ",i.driver_id]}),typeof i.freight_rate=="number"&&e.jsxs("div",{children:[e.jsx("b",{children:"Stawka frachtu:"})," ",i.freight_rate.toFixed(2)," ",i.freight_currency||"PLN"]}),i.notes&&e.jsxs("div",{children:[e.jsx("b",{children:"Notatki:"})," ",i.notes]}),i.created_at&&e.jsxs("div",{children:[e.jsx("b",{children:"Utworzono:"})," ",new Date(i.created_at).toLocaleString()]}),i.updated_at&&e.jsxs("div",{children:[e.jsx("b",{children:"Aktualizacja:"})," ",new Date(i.updated_at).toLocaleString()]})]})]})]})]}):null)},Ps={name:"dispatches",list:"/admin/hauls",create:"/admin/hauls/create",edit:"/admin/hauls/edit/:id",show:"/admin/hauls/show/:id",meta:{label:"Wywozy"}},wn=[e.jsx(b,{index:!0,element:e.jsx(ln,{})},"hauls-index"),e.jsx(b,{path:"create",element:e.jsx(mn,{})},"hauls-create"),e.jsx(b,{path:"edit/:id",element:e.jsx(gn,{})},"hauls-edit"),e.jsx(b,{path:"show/:id",element:e.jsx(yn,{})},"hauls-show")],vn=["zgloszony","zaakceptowany","odrzucony"],fn=()=>{const{tableQuery:{data:s,isLoading:t,isError:r},current:n,setCurrent:d,pageSize:i,setFilters:l}=se({resource:me,sorters:{initial:[{field:"start_date",order:"desc"}]}}),{create:m,edit:c,show:x}=D(),h=I({isLoading:t,isError:r});if(h)return h;const o=a=>l([{field:"user_email",operator:"contains",value:a}]),j=a=>l(g=>{const v=(g||[]).filter(F=>F.field!=="status");return a?[...v,{field:"status",operator:"eq",value:a}]:v});return e.jsxs(P,{children:[e.jsxs(N,{children:[e.jsx(L,{title:"Urlopy",description:"Wnioski urlopowe użytkowników"}),e.jsxs(u,{onClick:()=>m(me),children:[e.jsx(ee,{className:"w-4 h-4 mr-2"})," Nowy wniosek"]})]}),e.jsxs(N,{className:"gap-3",children:[e.jsx(w,{placeholder:"Szukaj po e-mailu…",className:"max-w-sm",onChange:a=>o(a.target.value)}),e.jsxs(U,{onValueChange:a=>j(a==="__clear__"?void 0:a),children:[e.jsx(T,{className:"w-56",children:e.jsx(O,{placeholder:"Filtr: status"})}),e.jsxs(W,{children:[vn.map(a=>e.jsx(E,{value:a,children:a},a)),e.jsx(E,{value:"__clear__",children:"Wyczyść filtr"})]})]})]}),e.jsx(k,{children:s?.data?.map(a=>e.jsxs(z,{children:[e.jsx(C,{children:e.jsx(L,{title:a.user_email||a.user_id,description:`${a.start_date} → ${a.end_date}`,variant:"card"})}),e.jsx(S,{children:e.jsxs(N,{variant:"start",className:"gap-2",children:[e.jsxs(y,{variant:"outline",children:["ID #",a.id]}),e.jsx(y,{variant:a.status==="zaakceptowany"?"secondary":a.status==="odrzucony"?"destructive":"outline",children:a.status}),a.branch_id&&e.jsxs(y,{variant:"outline",children:["oddział #",a.branch_id]})]})}),e.jsx(ne,{children:e.jsxs(N,{variant:"start",className:"gap-2",children:[e.jsx(u,{variant:"outline",size:"sm",onClick:()=>x(me,a.id),children:e.jsx(oe,{className:"w-4 h-4"})}),e.jsx(u,{variant:"outline",size:"sm",onClick:()=>c(me,a.id),children:e.jsx(H,{className:"w-4 h-4"})})]})})]},a.id))}),e.jsx(he,{current:n,pageSize:i,total:s?.total||0,setCurrent:d,itemName:"wnioski"})]})},Nn=["zgloszony","zaakceptowany","odrzucony"],_n=()=>{const{list:s}=D(),{data:t}=Me(),{refineCore:{onFinish:r},register:n,handleSubmit:d,setValue:i,watch:l,formState:{errors:m,isSubmitting:c}}=Q({refineCoreProps:{resource:me}}),x=h=>r({...h,user_id:h.user_id??t?.id,user_email:h.user_email??t?.email});return e.jsxs(P,{children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>s(me),children:[e.jsx(V,{className:"w-4 h-4 mr-2"})," Powrót do listy"]}),e.jsx(N,{children:e.jsx(L,{title:"Nowy wniosek urlopowy",description:"Utwórz wniosek"})}),e.jsxs(z,{children:[e.jsx(C,{children:e.jsx($,{children:"Parametry"})}),e.jsx(S,{children:e.jsxs(G,{onSubmit:d(x),children:[e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Użytkownik",children:e.jsx(A,{resource:"users",value:l("user_id"),onChange:h=>i("user_id",h),renderLabel:h=>`${h.full_name||h.email} (#${String(h.id).slice(0,8)})`,placeholder:"Wybierz użytkownika (opcjonalnie – domyślnie: ja)"})}),e.jsx(p,{label:"Oddział (opcjonalnie)",children:e.jsx(A,{resource:"branches",value:l("branch_id"),onChange:h=>i("branch_id",Number(h)),renderLabel:h=>`${h.name}${h.city?" — "+h.city:""} (#${h.id})`,placeholder:"Wybierz oddział"})})]}),e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Data od",htmlFor:"start_date",required:!0,children:e.jsx(w,{id:"start_date",type:"date",...n("start_date",{required:"Wymagane"})})}),e.jsx(p,{label:"Data do",htmlFor:"end_date",required:!0,children:e.jsx(w,{id:"end_date",type:"date",...n("end_date",{required:"Wymagane"})})})]}),e.jsx(p,{label:"Status (domyślnie: zgłoszony)",children:e.jsxs(U,{defaultValue:"zgloszony",onValueChange:h=>i("status",h),children:[e.jsx(T,{children:e.jsx(O,{placeholder:"Wybierz status"})}),e.jsx(W,{children:Nn.map(h=>e.jsx(E,{value:h,children:h},h))})]})}),e.jsx(p,{label:"Uwagi",children:e.jsx(ie,{rows:3,...n("notes")})}),e.jsxs(Z,{children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>s(me),children:"Anuluj"}),e.jsx(u,{type:"submit",disabled:c||!t?.id,children:c?"Tworzenie...":"Utwórz"})]})]})})]})]})},kn=["zgloszony","zaakceptowany","odrzucony"],zn=()=>{const{show:s}=D(),{refineCore:{onFinish:t,queryResult:r},register:n,handleSubmit:d,setValue:i,watch:l,formState:{errors:m,isSubmitting:c}}=Q({refineCoreProps:{resource:"vacations",action:"edit"}}),x=r?.isLoading??!0,h=r?.isError??!1,o=r?.data?.data,j=I({isLoading:x,isError:h});return j||(o?e.jsxs(P,{children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>s("vacations",o.id),children:[e.jsx(V,{className:"w-4 h-4 mr-2"})," Powrót do szczegółów"]}),e.jsx(N,{children:e.jsx(L,{title:"Edycja wniosku urlopowego",description:`ID: #${o.id}`})}),e.jsxs(z,{children:[e.jsx(C,{children:e.jsx($,{children:"Parametry"})}),e.jsx(S,{children:e.jsxs(G,{onSubmit:d(t),children:[e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Użytkownik",children:e.jsx(A,{resource:"users",value:l("user_id")??o.user_id,onChange:a=>i("user_id",a),renderLabel:a=>`${a.full_name||a.email} (#${String(a.id).slice(0,8)})`,placeholder:"Wybierz użytkownika"})}),e.jsx(p,{label:"Oddział (opcjonalnie)",children:e.jsx(A,{resource:"branches",value:l("branch_id")??o.branch_id,onChange:a=>i("branch_id",Number(a)),renderLabel:a=>`${a.name}${a.city?" — "+a.city:""} (#${a.id})`,placeholder:"Wybierz oddział"})})]}),e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Data od",htmlFor:"start_date",required:!0,children:e.jsx(w,{id:"start_date",type:"date",defaultValue:o.start_date,...n("start_date",{required:"Wymagane"})})}),e.jsx(p,{label:"Data do",htmlFor:"end_date",required:!0,children:e.jsx(w,{id:"end_date",type:"date",defaultValue:o.end_date,...n("end_date",{required:"Wymagane"})})})]}),e.jsx(p,{label:"Status",children:e.jsxs(U,{defaultValue:o.status,onValueChange:a=>i("status",a),children:[e.jsx(T,{children:e.jsx(O,{placeholder:"Wybierz status"})}),e.jsx(W,{children:kn.map(a=>e.jsx(E,{value:a,children:a},a))})]})}),e.jsx(p,{label:"Uwagi",children:e.jsx(ie,{rows:3,defaultValue:o.notes??"",...n("notes")})}),e.jsxs(Z,{children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>s("vacations",o.id),children:"Anuluj"}),e.jsx(u,{type:"submit",disabled:c,children:c?"Zapisywanie...":"Zapisz"})]})]})})]})]}):null)},Cn=()=>{const{queryResult:s}=ce({resource:me}),{list:t,edit:r}=D(),n=s?.isLoading??!0,d=s?.isError??!1,i=s?.data?.data,l=I({isLoading:n,isError:d});return l||(i?e.jsxs(P,{children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>t(me),children:[e.jsx(V,{className:"w-4 h-4 mr-2"})," Powrót do listy"]}),e.jsxs(N,{children:[e.jsx(L,{title:i.user_email||i.user_id,description:`ID: #${i.id}`}),e.jsxs(u,{variant:"outline",onClick:()=>r(me,i.id),children:[e.jsx(H,{className:"w-4 h-4 mr-2"})," Edytuj"]})]}),e.jsxs(z,{children:[e.jsx(C,{children:e.jsx($,{children:"Szczegóły"})}),e.jsxs(S,{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(y,{variant:i.status==="zaakceptowany"?"secondary":i.status==="odrzucony"?"destructive":"outline",children:i.status}),i.branch_id&&e.jsxs(y,{variant:"outline",children:["oddział #",i.branch_id]})]}),e.jsx(K,{}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{children:[e.jsx("b",{children:"Okres:"})," ",i.start_date," → ",i.end_date]}),i.notes&&e.jsxs("div",{children:[e.jsx("b",{children:"Uwagi:"})," ",i.notes]}),i.created_at&&e.jsxs("div",{children:[e.jsx("b",{children:"Utworzono:"})," ",new Date(i.created_at).toLocaleString()]}),i.updated_at&&e.jsxs("div",{children:[e.jsx("b",{children:"Aktualizacja:"})," ",new Date(i.updated_at).toLocaleString()]})]})]})]})]}):null)},me="hr_vacations",Es={name:me,list:"/admin/vacations",create:"/admin/vacations/create",edit:"/admin/vacations/edit/:id",show:"/admin/vacations/show/:id",meta:{label:"Urlopy"}},Sn=[e.jsx(b,{index:!0,element:e.jsx(fn,{})},"vac-index"),e.jsx(b,{path:"create",element:e.jsx(_n,{})},"vac-create"),e.jsx(b,{path:"edit/:id",element:e.jsx(zn,{})},"vac-edit"),e.jsx(b,{path:"show/:id",element:e.jsx(Cn,{})},"vac-show")],Ln=()=>{const s=je();return e.jsxs(P,{children:[e.jsx(N,{children:e.jsx(L,{title:"Raporty",description:"Proste raporty i eksporty"})}),e.jsx(k,{children:e.jsxs(z,{className:"hover:shadow-md transition",children:[e.jsx(C,{children:e.jsxs($,{className:"flex items-center gap-2",children:[e.jsx(us,{className:"w-4 h-4"})," Aktywność klienta"]})}),e.jsxs(S,{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Wydarzenia/zadania powiązane z wybranym klientem w zakresie dat."}),e.jsx(u,{variant:"outline",className:"mt-3",onClick:()=>s("/admin/reports/client-activity"),children:"Otwórz"})]})]})})]})},Rn=s=>{const t=Object.keys(s[0]||{}),r=n=>`"${String(n??"").replace(/"/g,'""')}"`;return[t.join(","),...s.map(n=>t.map(d=>r(n[d])).join(","))].join(`
`)},$n=()=>{const[s,t]=ye.useState(),[r,n]=ye.useState(""),[d,i]=ye.useState(""),l=ye.useMemo(()=>[...s?[{field:"client_id",operator:"eq",value:s}]:[],...r?[{field:"start_at",operator:"gte",value:r}]:[],...d?[{field:"start_at",operator:"lte",value:d}]:[]],[s,r,d]),{tableQuery:m}=se({resource:"tasks",filters:{permanent:l},pagination:{current:1,pageSize:1e3},sorters:{initial:[{field:"start_at",order:"desc"}]},queryOptions:{enabled:!!s}}),c=m.isLoading,x=m.isError,h=(m.data?.data||[]).map(j=>({id:j.id,title:j.title,type:j.type,status:j.status,branch_id:j.branch_id,start_at:j.start_at,end_at:j.end_at??""})),o=()=>{if(!h.length)return;const j=new Blob([Rn(h)],{type:"text/csv;charset=utf-8"}),a=URL.createObjectURL(j),g=document.createElement("a");g.href=a,g.download=`client-${s}-activity.csv`,g.style.display="none",document.body.appendChild(g),g.click(),URL.revokeObjectURL(a),document.body.removeChild(g)};return e.jsxs(P,{children:[e.jsxs(N,{children:[e.jsx(L,{title:"Raport: Aktywność klienta",description:"Wydarzenia/zadania powiązane z klientem w zakresie dat"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{variant:"outline",onClick:()=>m.refetch?.(),disabled:!s||c,children:"Odśwież"}),e.jsx(u,{onClick:o,disabled:!h.length||c,children:"Eksport CSV"})]})]}),e.jsxs(z,{children:[e.jsx(C,{children:e.jsx($,{children:"Filtry"})}),e.jsxs(S,{children:[e.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[e.jsx(A,{resource:"clients",value:s,onChange:j=>t(j?Number(j):void 0),renderLabel:j=>`${j.name}${j.category?" — "+j.category:""} (#${j.id})`,placeholder:"Wybierz klienta (wymagane)"}),e.jsx(w,{type:"date",value:r,onChange:j=>n(j.target.value),placeholder:"Od"}),e.jsx(w,{type:"date",value:d,onChange:j=>i(j.target.value),placeholder:"Do"})]}),e.jsx("div",{className:"text-xs text-muted-foreground mt-2",children:"Uwaga: raport ładuje się dopiero po wyborze klienta."})]})]}),e.jsxs(z,{className:"mt-4",children:[e.jsx(C,{children:e.jsxs($,{children:["Wyniki ",h.length?`(${h.length})`:""]})}),e.jsxs(S,{children:[x&&e.jsx("div",{className:"text-sm text-red-600",children:"Błąd podczas pobierania danych."}),!c&&!h.length&&s&&e.jsx("div",{className:"text-sm text-muted-foreground",children:"Brak danych dla wybranych filtrów."}),!s&&e.jsx("div",{className:"text-sm text-muted-foreground",children:"Wybierz klienta, aby zobaczyć wyniki."}),c&&e.jsx("div",{className:"text-sm text-muted-foreground",children:"Ładowanie…"}),!!h.length&&e.jsx("div",{className:"w-full overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"text-left border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-2 pr-3",children:"ID"}),e.jsx("th",{className:"py-2 pr-3",children:"Tytuł"}),e.jsx("th",{className:"py-2 pr-3",children:"Typ"}),e.jsx("th",{className:"py-2 pr-3",children:"Status"}),e.jsx("th",{className:"py-2 pr-3",children:"Oddział"}),e.jsx("th",{className:"py-2 pr-3",children:"Start"}),e.jsx("th",{className:"py-2 pr-3",children:"Koniec"})]})}),e.jsx("tbody",{children:h.map(j=>e.jsxs("tr",{className:"border-b last:border-b-0",children:[e.jsx("td",{className:"py-2 pr-3",children:j.id}),e.jsx("td",{className:"py-2 pr-3",children:j.title}),e.jsx("td",{className:"py-2 pr-3",children:j.type}),e.jsx("td",{className:"py-2 pr-3",children:j.status}),e.jsx("td",{className:"py-2 pr-3",children:j.branch_id}),e.jsx("td",{className:"py-2 pr-3",children:j.start_at}),e.jsx("td",{className:"py-2 pr-3",children:j.end_at})]},j.id))})]})})]})]})]})},Ds={name:"reports",list:"/admin/reports",meta:{label:"Raporty"}},Pn=[e.jsx(b,{index:!0,element:e.jsx(Ln,{})},"reports-index"),e.jsx(b,{path:"client-activity",element:e.jsx($n,{})},"reports-client")],En=()=>{const{tableQuery:{data:s,isLoading:t,isError:r},current:n,setCurrent:d,pageSize:i,setFilters:l}=se({resource:"addresses",sorters:{initial:[{field:"id",order:"desc"}]}}),{create:m,edit:c,show:x}=D(),h=I({isLoading:t,isError:r});if(h)return h;const o=a=>{l(a?[{field:"line1",operator:"contains",value:a}]:[])},j=a=>l(g=>{const v=(g||[]).filter(F=>!("field"in F)||F.field!=="city");return a?[...v,{field:"city",operator:"contains",value:a}]:v});return e.jsxs(P,{children:[e.jsxs(N,{children:[e.jsx(L,{title:"Adresy",description:"Baza adresów (globalna)"}),e.jsxs(u,{onClick:()=>m("addresses"),children:[e.jsx(ee,{className:"w-4 h-4 mr-2"})," Dodaj adres"]})]}),e.jsxs(N,{className:"gap-3 flex-wrap",children:[e.jsx(w,{placeholder:"Szukaj (linia 1)...",className:"max-w-sm",onChange:a=>o(a.target.value)}),e.jsx(w,{placeholder:"Filtr: miasto",className:"w-56",onChange:a=>j(a.target.value)})]}),e.jsx(k,{children:s?.data?.map(a=>e.jsxs(z,{children:[e.jsx(C,{children:e.jsx(L,{title:a.line1,description:a.city||a.postal_code||a.country||"—",variant:"card"})}),e.jsx(S,{children:e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs(y,{variant:"outline",children:["ID #",a.id]}),a.city&&e.jsx(y,{variant:"secondary",children:a.city}),a.country&&e.jsx(y,{variant:"outline",children:a.country}),(a.lat||a.lng)&&e.jsx(y,{variant:"outline",children:"geo"}),a.geofence_radius_m&&e.jsxs(y,{variant:"outline",children:["r=",a.geofence_radius_m,"m"]})]})}),e.jsxs(ne,{className:"flex gap-2",children:[e.jsx(u,{variant:"outline",size:"sm",onClick:()=>x("addresses",a.id),children:e.jsx(oe,{className:"w-4 h-4"})}),e.jsx(u,{variant:"outline",size:"sm",onClick:()=>c("addresses",a.id),children:e.jsx(H,{className:"w-4 h-4"})})]})]},a.id))}),e.jsx(he,{current:n,pageSize:i,total:s?.total||0,setCurrent:d,itemName:"adresy"})]})},Dn=s=>s?.message,qn=()=>{const{list:s}=D(),t=je(),[r]=oa(),n=r.get("client"),d=r.get("kind")||"Siedziba",i=r.get("return"),{refineCore:{onFinish:l},register:m,handleSubmit:c,formState:{errors:x,isSubmitting:h}}=Q({refineCoreProps:{resource:"addresses",redirect:!1},defaultValues:{country:"PL"}}),{mutate:o}=Ke(),j=c(async a=>{const g=await l(a),v=g?.data?.id??g?.id??void 0;if(v&&n&&await new Promise(F=>o({resource:"client_addresses",values:{client_id:Number(n),address_id:Number(v),kind:d}},{onSuccess:()=>F()})),i){t(i,{replace:!0});return}s("addresses")});return e.jsxs(P,{children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>s("addresses"),children:[e.jsx(V,{className:"w-4 h-4 mr-2"})," Powrót do listy"]}),e.jsx(N,{children:e.jsx(L,{title:"Nowy adres",description:n?`Po zapisaniu adres zostanie przypięty do klienta #${n} (etykieta: ${d}).`:"Dodaj adres do bazy"})}),e.jsxs(z,{children:[e.jsx(C,{children:e.jsx($,{children:"Parametry"})}),e.jsx(S,{children:e.jsxs(G,{onSubmit:j,children:[e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Adres (linia 1)",htmlFor:"line1",error:Dn(x.line1),required:!0,children:e.jsx(w,{id:"line1",...m("line1",{required:"Wymagane"})})}),e.jsx(p,{label:"Adres (linia 2)",htmlFor:"line2",children:e.jsx(w,{id:"line2",...m("line2")})})]}),e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Kod pocztowy",htmlFor:"postal_code",children:e.jsx(w,{id:"postal_code",...m("postal_code")})}),e.jsx(p,{label:"Miasto",htmlFor:"city",children:e.jsx(w,{id:"city",...m("city")})}),e.jsx(p,{label:"Kraj",htmlFor:"country",children:e.jsx(w,{id:"country",...m("country")})})]}),e.jsx(p,{label:"Notatki",htmlFor:"notes",children:e.jsx(ie,{id:"notes",rows:2,...m("notes")})}),e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Szer. geogr. (lat)",htmlFor:"lat",children:e.jsx(w,{id:"lat",type:"number",step:"any",...m("lat",{valueAsNumber:!0})})}),e.jsx(p,{label:"Dł. geogr. (lng)",htmlFor:"lng",children:e.jsx(w,{id:"lng",type:"number",step:"any",...m("lng",{valueAsNumber:!0})})}),e.jsx(p,{label:"Promień geofencingu (m)",htmlFor:"geo",children:e.jsx(w,{id:"geo",type:"number",...m("geofence_radius_m",{valueAsNumber:!0})})})]}),e.jsxs(Z,{children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>s("addresses"),children:"Anuluj"}),e.jsx(u,{type:"submit",disabled:h,children:h?"Tworzenie...":"Utwórz"})]})]})})]})]})},Fn=s=>s?.message,An=()=>{const{show:s}=D(),{refineCore:{onFinish:t,queryResult:r},register:n,handleSubmit:d,formState:{errors:i,isSubmitting:l}}=Q({refineCoreProps:{resource:"addresses",action:"edit"}}),m=r?.isLoading??!0,c=r?.isError??!1,x=r?.data?.data,h=I({isLoading:m,isError:c});return h||(x?e.jsxs(P,{children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>s("addresses",x.id),children:[e.jsx(V,{className:"w-4 h-4 mr-2"})," Powrót do szczegółów"]}),e.jsx(N,{children:e.jsx(L,{title:"Edycja adresu",description:`ID: #${x.id}`})}),e.jsxs(z,{children:[e.jsx(C,{children:e.jsx($,{children:"Parametry"})}),e.jsx(S,{children:e.jsxs(G,{onSubmit:d(t),children:[e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Adres (linia 1)",htmlFor:"line1",error:Fn(i.line1),required:!0,children:e.jsx(w,{id:"line1",...n("line1",{required:"Wymagane"})})}),e.jsx(p,{label:"Adres (linia 2)",htmlFor:"line2",children:e.jsx(w,{id:"line2",...n("line2")})})]}),e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Kod pocztowy",htmlFor:"postal_code",children:e.jsx(w,{id:"postal_code",...n("postal_code")})}),e.jsx(p,{label:"Miasto",htmlFor:"city",children:e.jsx(w,{id:"city",...n("city")})}),e.jsx(p,{label:"Kraj",htmlFor:"country",children:e.jsx(w,{id:"country",...n("country")})})]}),e.jsx(p,{label:"Notatki",htmlFor:"notes",children:e.jsx(ie,{id:"notes",rows:2,...n("notes")})}),e.jsxs(k,{variant:"1-2-2",children:[e.jsx(p,{label:"Szer. geogr. (lat)",htmlFor:"lat",children:e.jsx(w,{id:"lat",type:"number",step:"any",...n("lat",{valueAsNumber:!0})})}),e.jsx(p,{label:"Dł. geogr. (lng)",htmlFor:"lng",children:e.jsx(w,{id:"lng",type:"number",step:"any",...n("lng",{valueAsNumber:!0})})}),e.jsx(p,{label:"Promień geofencingu (m)",htmlFor:"geo",children:e.jsx(w,{id:"geo",type:"number",...n("geofence_radius_m",{valueAsNumber:!0})})})]}),e.jsxs(Z,{children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>s("addresses",x.id),children:"Anuluj"}),e.jsx(u,{type:"submit",disabled:l,children:l?"Zapisywanie...":"Zapisz"})]})]})})]})]}):null)},In=()=>{const{queryResult:s}=ce({resource:"addresses"}),{list:t,edit:r,show:n}=D(),[d,i]=f.useState(""),[l,m]=f.useState("Siedziba"),c=s?.isLoading??!0,x=s?.isError??!1,h=s?.data?.data,o=h?.id,j=ge({resource:"client_addresses",filters:o?[{field:"address_id",operator:"eq",value:o}]:[],pagination:{pageSize:100},queryOptions:{enabled:!!o}}),a=(j.data?.data||[]).map(Y=>Y.client_id),g=os({resource:"clients",ids:a,queryOptions:{enabled:!!o&&a.length>0}}),{mutate:v,isLoading:F}=Ke(),{mutate:R,isLoading:B}=ha(),xe=I({isLoading:c,isError:x});if(xe)return xe;if(!h)return null;const be=()=>{const Y=Number(d);Y&&v({resource:"client_addresses",values:{client_id:Y,address_id:h.id,kind:l||null}},{onSuccess:()=>j.refetch()})},ke=Y=>{R({resource:"client_addresses",id:Y,mutationMode:"pessimistic"},{onSuccess:()=>j.refetch()})};return e.jsxs(P,{children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>t("addresses"),children:[e.jsx(V,{className:"w-4 h-4 mr-2"})," Powrót do listy"]}),e.jsxs(N,{children:[e.jsx(L,{title:h.line1,description:`ID: #${h.id}`}),e.jsxs(u,{variant:"outline",onClick:()=>r("addresses",h.id),children:[e.jsx(H,{className:"w-4 h-4 mr-2"})," Edytuj"]})]}),e.jsxs(z,{children:[e.jsx(C,{children:e.jsx($,{children:"Szczegóły"})}),e.jsxs(S,{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[h.city&&e.jsx(y,{variant:"secondary",children:h.city}),h.country&&e.jsx(y,{variant:"outline",children:h.country}),(h.lat||h.lng)&&e.jsx(y,{variant:"outline",children:"geo"}),h.geofence_radius_m&&e.jsxs(y,{variant:"outline",children:["r=",h.geofence_radius_m,"m"]})]}),e.jsx(K,{}),e.jsxs("div",{className:"text-sm space-y-1",children:[h.line2&&e.jsxs("div",{children:[e.jsx("b",{children:"Linia 2:"})," ",h.line2]}),(h.postal_code||h.city)&&e.jsxs("div",{children:[e.jsx("b",{children:"Kod/Miasto:"})," ",[h.postal_code,h.city].filter(Boolean).join(" ")]}),h.notes&&e.jsxs("div",{children:[e.jsx("b",{children:"Notatki:"})," ",h.notes]}),(h.lat||h.lng)&&e.jsxs("div",{children:[e.jsx("b",{children:"Geo:"})," ",h.lat??"—",", ",h.lng??"—"]}),h.geofence_radius_m&&e.jsxs("div",{children:[e.jsx("b",{children:"Geofencing:"})," r = ",h.geofence_radius_m," m"]})]})]})]}),e.jsxs(z,{className:"mt-4",children:[e.jsx(C,{children:e.jsx($,{children:"Powiązani klienci"})}),e.jsxs(S,{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(w,{placeholder:"ID klienta",className:"w-36",value:d,onChange:Y=>i(Y.target.value)}),e.jsx(w,{placeholder:'Etykieta (np. "Siedziba")',className:"w-56",value:l,onChange:Y=>m(Y.target.value)}),e.jsxs(u,{onClick:be,disabled:F,children:[e.jsx(ba,{className:"w-4 h-4 mr-2"})," Powiąż"]})]}),e.jsx(K,{}),j.isLoading||g.isLoading?e.jsx("div",{children:"Ładowanie powiązań..."}):(j.data?.data||[]).length===0?e.jsx("div",{className:"text-sm text-muted-foreground",children:"Brak powiązanych klientów."}):e.jsx("div",{className:"space-y-2",children:(j.data?.data||[]).map(Y=>{const ve=g.data?.data?.find(qe=>qe.id===Y.client_id);return e.jsxs("div",{className:"flex items-center justify-between rounded border p-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(y,{variant:"outline",children:["link #",Y.id]}),Y.kind&&e.jsx(y,{variant:"secondary",children:Y.kind}),e.jsx("span",{className:"text-sm",children:ve?`${ve.name} (ID #${ve.id})`:`Klient #${Y.client_id}`})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{variant:"outline",size:"sm",onClick:()=>n("clients",Y.client_id),children:"Otwórz klienta"}),e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>ke(Y.id),disabled:B,children:[e.jsx(Kr,{className:"w-4 h-4 mr-2"})," Usuń powiązanie"]})]})]},Y.id)})})]})]})]})},qs={name:"addresses",list:"/admin/addresses",create:"/admin/addresses/create",edit:"/admin/addresses/edit/:id",show:"/admin/addresses/show/:id",meta:{label:"Adresy"}},Tn=[e.jsx(b,{index:!0,element:e.jsx(En,{})},"addresses-index"),e.jsx(b,{path:"create",element:e.jsx(qn,{})},"addresses-create"),e.jsx(b,{path:"edit/:id",element:e.jsx(An,{})},"addresses-edit"),e.jsx(b,{path:"show/:id",element:e.jsx(In,{})},"addresses-show")],Wn=()=>e.jsx(fe,{children:e.jsxs(b,{element:e.jsx(Pe,{children:e.jsx(Se,{})}),children:[e.jsx(b,{index:!0,element:e.jsx(re,{to:"dashboard/overview",replace:!0})}),e.jsx(b,{path:"dashboard/overview",element:e.jsx(si,{})}),e.jsx(b,{path:"users",children:Ri}),e.jsx(b,{path:"branches",children:bi}),e.jsx(b,{path:"tasks",children:Ta}),e.jsx(b,{path:"vehicles",children:Ma}),e.jsx(b,{path:"clients",children:Ya}),e.jsx(b,{path:"addresses",children:Tn})," ",e.jsx(b,{path:"containers",children:Ti}),e.jsx(b,{path:"calendar",children:Bi}),e.jsx(b,{path:"pricelists",children:Hi}),e.jsx(b,{path:"equipment",children:rn}),e.jsx(b,{path:"hauls",children:wn}),e.jsx(b,{path:"maintenances",children:ui}),e.jsx(b,{path:"vacations",children:Sn}),e.jsx(b,{path:"reports",children:Pn}),e.jsx(b,{path:"*",element:e.jsx(re,{to:"/admin/dashboard/overview",replace:!0})})]})}),Vn=f.lazy(()=>Promise.resolve({default:Wn})),Un=e.jsx(b,{path:"/admin/*",element:e.jsx(Ne,{fallback:e.jsx(re,{to:"/login",replace:!0}),children:e.jsx(Ee,{expected:"admin",children:e.jsx(f.Suspense,{fallback:e.jsx(De,{text:"Ładowanie panelu administratora...",colorClass:"border-purple-600"}),children:e.jsx(Vn,{})})})},"admin-auth")}),Oe=(s,t=[])=>{const{tableQuery:r}=se({resource:s,filters:t.length?{initial:t}:void 0,pagination:{current:1,pageSize:1}});return{loading:r.isLoading,total:typeof r.data?.total=="number"?r.data.total:void 0}},On=()=>{const s=Oe("tasks",[{field:"status",operator:"eq",value:"nowe"}]),t=Oe("tasks",[{field:"status",operator:"eq",value:"w_realizacji"}]),r=Oe("clients"),n=Oe("vehicles"),{list:d}=D(),i=({label:m,value:c,loading:x})=>e.jsxs(z,{children:[e.jsx(C,{className:"pb-2",children:e.jsx("div",{className:"text-sm text-muted-foreground",children:m})}),e.jsx(S,{children:e.jsx("div",{className:"text-3xl font-bold",children:x?"…":c??"—"})})]}),l=({label:m,description:c,onClick:x,icon:h})=>e.jsxs(z,{className:"transition hover:shadow-md",children:[e.jsx(C,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[h,m]})}),e.jsx(S,{className:"text-sm text-muted-foreground",children:c}),e.jsx(ne,{children:e.jsx(u,{variant:"outline",size:"sm",onClick:x,children:"Przejdź"})})]});return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx(L,{title:"Dashboard – Biuro",description:"Szybki podgląd i skróty"}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsx(i,{label:"Zadania: nowe",value:s.total,loading:s.loading}),e.jsx(i,{label:"Zadania: w realizacji",value:t.total,loading:t.loading}),e.jsx(i,{label:"Klienci",value:r.total,loading:r.loading}),e.jsx(i,{label:"Pojazdy",value:n.total,loading:n.loading})]}),e.jsx(K,{}),e.jsxs(k,{children:[e.jsx(l,{label:"Zadania",description:"Lista i plan zadań",onClick:()=>d("tasks"),icon:e.jsx(Le,{className:"h-4 w-4"})}),e.jsx(l,{label:"Klienci",description:"Baza klientów",onClick:()=>d("clients"),icon:e.jsx(_e,{className:"h-4 w-4"})}),e.jsx(l,{label:"Flota",description:"Pojazdy w systemie",onClick:()=>d("vehicles"),icon:e.jsx(ue,{className:"h-4 w-4"})})]})]})},Bn=[e.jsx(b,{index:!0,element:e.jsx(qa,{})},"tasks-index"),e.jsx(b,{path:"create",element:e.jsx(Fa,{})},"tasks-create"),e.jsx(b,{path:"edit/:id",element:e.jsx(Aa,{})},"tasks-edit"),e.jsx(b,{path:"show/:id",element:e.jsx(Ia,{})},"tasks-show")],Mn=[e.jsx(b,{index:!0,element:e.jsx(Wa,{})},"vehicles-index"),e.jsx(b,{path:"create",element:e.jsx(Va,{})},"vehicles-create"),e.jsx(b,{path:"edit/:id",element:e.jsx(Ua,{})},"vehicles-edit"),e.jsx(b,{path:"show/:id",element:e.jsx(Ba,{})},"vehicles-show")],Kn=[e.jsx(b,{index:!0,element:e.jsx(Ka,{})},"clients-index"),e.jsx(b,{path:"create",element:e.jsx(Qa,{})},"clients-create"),e.jsx(b,{path:"edit/:id",element:e.jsx(Ha,{})},"clients-edit"),e.jsx(b,{path:"show/:id",element:e.jsx(Ga,{})},"clients-show")],Zn=()=>e.jsx(fe,{children:e.jsxs(b,{element:e.jsx(Pe,{brand:"Backoffice – Biuro",children:e.jsx(Se,{})}),children:[e.jsx(b,{index:!0,element:e.jsx(re,{to:"dashboard/overview",replace:!0})}),e.jsx(b,{path:"dashboard/overview",element:e.jsx(On,{})}),e.jsx(b,{path:"tasks",children:Bn}),e.jsx(b,{path:"vehicles",children:Mn}),e.jsx(b,{path:"clients",children:Kn}),e.jsx(b,{path:"*",element:e.jsx(re,{to:"/biuro/dashboard/overview",replace:!0})})]})}),Qn=f.lazy(()=>Promise.resolve({default:Zn})),Hn=e.jsx(b,{path:"/biuro/*",element:e.jsx(Ne,{fallback:e.jsx(re,{to:"/login",replace:!0}),children:e.jsx(Ee,{expected:"biuro",children:e.jsx(f.Suspense,{fallback:e.jsx(De,{text:"Ładowanie panelu Biura...",colorClass:"border-blue-600"}),children:e.jsx(Qn,{})})})},"biuro-auth")}),Je=(s,t=[])=>{const{tableQuery:r}=se({resource:s,filters:t.length?{initial:t}:void 0,pagination:{current:1,pageSize:1}});return{loading:r.isLoading,total:typeof r.data?.total=="number"?r.data.total:void 0}},es=({label:s,value:t,loading:r})=>e.jsxs(z,{children:[e.jsx(C,{className:"pb-2",children:e.jsx($,{className:"text-sm text-muted-foreground",children:s})}),e.jsx(S,{children:e.jsx("div",{className:"text-3xl font-bold",children:r?"…":t??"—"})})]}),ss=({to:s,label:t,Icon:r,desc:n})=>{const d=je();return e.jsxs(z,{className:"hover:shadow-md transition",children:[e.jsx(C,{className:"pb-2",children:e.jsxs($,{className:"flex items-center gap-2",children:[e.jsx(r,{className:"h-5 w-5 opacity-70"}),t]})}),e.jsxs(S,{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:n??"Szybkie przejście do modułu"}),e.jsxs(u,{variant:"outline",size:"sm",className:"mt-3",onClick:()=>d(s),children:["Wejdź ",e.jsx(We,{className:"ml-2 h-4 w-4"})]})]})]})},Gn=()=>{const s=Je("tasks"),t=Je("vehicles"),r=Je("clients");return e.jsxs(P,{children:[e.jsx(N,{children:e.jsx(L,{title:"Dashboard – Logistyk",description:"Podsumowanie pracy i skróty"})}),e.jsxs(k,{children:[e.jsx(es,{label:"Zadania",value:s.total,loading:s.loading}),e.jsx(es,{label:"Flota",value:t.total,loading:t.loading}),e.jsx(es,{label:"Klienci",value:r.total,loading:r.loading})]}),e.jsxs("div",{className:"mt-6 space-y-2",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Skróty"}),e.jsxs(k,{children:[e.jsx(ss,{to:"/logistyk/tasks",label:"Zadania",Icon:Le,desc:"Plan i realizacja transportów"}),e.jsx(ss,{to:"/logistyk/vehicles",label:"Flota",Icon:ue,desc:"Pojazdy i przypisania"}),e.jsx(ss,{to:"/logistyk/clients",label:"Klienci",Icon:_e,desc:"Kontrahenci i kontakty"})]})]})]})},Yn=()=>e.jsx(fe,{children:e.jsxs(b,{element:e.jsx(Pe,{brand:"Logistyka",children:e.jsx(Se,{})}),children:[e.jsx(b,{index:!0,element:e.jsx(re,{to:"dashboard/overview",replace:!0})}),e.jsx(b,{path:"dashboard/overview",element:e.jsx(Gn,{})}),e.jsx(b,{path:"tasks",children:Ta}),e.jsx(b,{path:"vehicles",children:Ma}),e.jsx(b,{path:"clients",children:Ya}),e.jsx(b,{path:"*",element:e.jsx(re,{to:"/logistyk/dashboard/overview",replace:!0})})]})}),Xn=f.lazy(()=>Promise.resolve({default:Yn})),Jn=e.jsx(b,{path:"/logistyk/*",element:e.jsx(Ne,{fallback:e.jsx(re,{to:"/login",replace:!0}),children:e.jsx(Ee,{expected:"logistyk",children:e.jsx(f.Suspense,{fallback:e.jsx(De,{text:"Ładowanie panelu logistyka...",colorClass:"border-blue-600"}),children:e.jsx(Xn,{})})})},"logistyk-auth")}),el=()=>e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Dashboard – Handlowiec"}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsx("div",{className:"rounded-2xl border p-4 shadow-sm",children:"Nowe leady: 3"}),e.jsx("div",{className:"rounded-2xl border p-4 shadow-sm",children:"Klienci bez aktywności 7d: 4"}),e.jsx("div",{className:"rounded-2xl border p-4 shadow-sm",children:"Spotkania dziś: 2"})]})]}),sl=()=>e.jsx(fe,{children:e.jsxs(b,{element:e.jsx(Pe,{children:e.jsx(Se,{})}),children:[e.jsx(b,{index:!0,element:e.jsx(re,{to:"dashboard/overview",replace:!0})}),e.jsx(b,{path:"dashboard/overview",element:e.jsx(el,{})})]})}),al=f.lazy(()=>Promise.resolve({default:sl})),rl=e.jsx(b,{path:"/handlowiec/*",element:e.jsx(Ne,{fallback:e.jsx(re,{to:"/login",replace:!0}),children:e.jsx(Ee,{expected:"handlowiec",children:e.jsx(f.Suspense,{fallback:e.jsx(De,{text:"Ładowanie panelu handlowca...",colorClass:"border-purple-600"}),children:e.jsx(al,{})})})},"handlowiec-auth")}),tl=()=>e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Dashboard – Kierowca"}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsx("div",{className:"rounded-2xl border p-4 shadow-sm",children:"Moje zadania dziś: 3"}),e.jsx("div",{className:"rounded-2xl border p-4 shadow-sm",children:"Pojazd: brak zalogowania"}),e.jsx("div",{className:"rounded-2xl border p-4 shadow-sm",children:"Powiadomienia: 1"})]})]}),il=()=>e.jsx(fe,{children:e.jsxs(b,{element:e.jsx(Pe,{children:e.jsx(Se,{})}),children:[e.jsx(b,{index:!0,element:e.jsx(re,{to:"dashboard/overview",replace:!0})}),e.jsx(b,{path:"dashboard/overview",element:e.jsx(tl,{})})]})}),nl=f.lazy(()=>Promise.resolve({default:il})),ll=e.jsx(b,{path:"/kierowca/*",element:e.jsx(Ne,{fallback:e.jsx(re,{to:"/login",replace:!0}),children:e.jsx(Ee,{expected:"kierowca",children:e.jsx(f.Suspense,{fallback:e.jsx(De,{text:"Ładowanie panelu kierowcy...",colorClass:"border-purple-600"}),children:e.jsx(nl,{})})})},"kierowca-auth")}),dl=()=>e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Dashboard – Operator"}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsx("div",{className:"rounded-2xl border p-4 shadow-sm",children:"Zadania na placu: 5"}),e.jsx("div",{className:"rounded-2xl border p-4 shadow-sm",children:"Zgłoszenia serwisowe: 1"}),e.jsx("div",{className:"rounded-2xl border p-4 shadow-sm",children:"Kontenery do przestawienia: 2"})]})]}),cl=()=>e.jsx(fe,{children:e.jsxs(b,{element:e.jsx(Pe,{children:e.jsx(Se,{})}),children:[e.jsx(b,{index:!0,element:e.jsx(re,{to:"dashboard/overview",replace:!0})}),e.jsx(b,{path:"dashboard/overview",element:e.jsx(dl,{})})]})}),ol=f.lazy(()=>Promise.resolve({default:cl})),hl=e.jsx(b,{path:"/operator/*",element:e.jsx(Ne,{fallback:e.jsx(re,{to:"/login",replace:!0}),children:e.jsx(Ee,{expected:"operator",children:e.jsx(f.Suspense,{fallback:e.jsx(De,{text:"Ładowanie panelu operatora...",colorClass:"border-purple-600"}),children:e.jsx(ol,{})})})},"operator-auth")}),xl=f.lazy(()=>Ve(()=>import("./NoRolePage-CWUvhIQQ.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8])).then(s=>({default:s.NoRolePage}))),ul=()=>e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin h-10 w-10 rounded-full border-b-2 border-purple-600"})}),ml=e.jsx(b,{path:"/no-role",element:e.jsx(Ne,{fallback:e.jsx(re,{to:"/login",replace:!0}),children:e.jsx(f.Suspense,{fallback:e.jsx(ul,{}),children:e.jsx(xl,{})})},"no-role-auth")}),jl=[{name:"dashboard",list:"/admin/dashboard/overview",meta:{label:"Dashboard",icon:e.jsx($e,{className:"h-4 w-4"})}},{...ks,meta:{...ks.meta,icon:e.jsx(as,{className:"h-4 w-4"})}},{..._s,meta:{..._s.meta,icon:e.jsx(pa,{className:"h-4 w-4"})}},{...ns,meta:{...ns.meta,icon:e.jsx(Le,{className:"h-4 w-4"})}},{...ls,meta:{...ls.meta,icon:e.jsx(ue,{className:"h-4 w-4"})}},{...ds,meta:{...ds.meta,icon:e.jsx(_e,{className:"h-4 w-4"})}},{...qs,meta:{...qs.meta,icon:e.jsx(Zr,{className:"h-4 w-4"})}},{...zs,meta:{...zs.meta,icon:e.jsx(rs,{className:"h-4 w-4"})}},{...Cs,meta:{...Cs.meta,icon:e.jsx(ps,{className:"h-4 w-4"})}},{...Ss,meta:{...Ss.meta,icon:e.jsx(Qr,{className:"h-4 w-4"})}},{...$s,meta:{...$s.meta,icon:e.jsx(rs,{className:"h-4 w-4"})}},{...Ps,meta:{...Ps.meta,icon:e.jsx(ue,{className:"h-4 w-4"})}},{...Ns,meta:{...Ns.meta,icon:e.jsx(Re,{className:"h-4 w-4"})}},{...Es,meta:{...Es.meta,icon:e.jsx(ps,{className:"h-4 w-4"})}},{...Ds,meta:{...Ds.meta,icon:e.jsx(us,{className:"h-4 w-4"})}}],pl=[{name:"dashboard",list:"/biuro/dashboard/overview",meta:{label:"Dashboard",icon:e.jsx($e,{className:"h-4 w-4"})}},{name:"tasks",list:"/biuro/tasks",create:"/biuro/tasks/create",edit:"/biuro/tasks/edit/:id",show:"/biuro/tasks/show/:id",meta:{label:"Zadania",icon:e.jsx(Le,{className:"h-4 w-4"})}},{name:"vehicles",list:"/biuro/vehicles",create:"/biuro/vehicles/create",edit:"/biuro/vehicles/edit/:id",show:"/biuro/vehicles/show/:id",meta:{label:"Flota",icon:e.jsx(ue,{className:"h-4 w-4"})}},{name:"clients",list:"/biuro/clients",create:"/biuro/clients/create",edit:"/biuro/clients/edit/:id",show:"/biuro/clients/show/:id",meta:{label:"Klienci",icon:e.jsx(_e,{className:"h-4 w-4"})}}],gl=[{name:"dashboard",list:"/logistyk/dashboard/overview",meta:{label:"Dashboard",icon:e.jsx($e,{className:"h-4 w-4"})}},{...ns,list:"/logistyk/tasks",create:"/logistyk/tasks/create",edit:"/logistyk/tasks/edit/:id",show:"/logistyk/tasks/show/:id",meta:{label:"Zadania",icon:e.jsx(Le,{className:"h-4 w-4"})}},{...ls,list:"/logistyk/vehicles",create:"/logistyk/vehicles/create",edit:"/logistyk/vehicles/edit/:id",show:"/logistyk/vehicles/show/:id",meta:{label:"Flota",icon:e.jsx(ue,{className:"h-4 w-4"})}},{...ds,list:"/logistyk/clients",create:"/logistyk/clients/create",edit:"/logistyk/clients/edit/:id",show:"/logistyk/clients/show/:id",meta:{label:"Klienci",icon:e.jsx(_e,{className:"h-4 w-4"})}}],bl=[{name:"dashboard",list:"/handlowiec/dashboard/overview",meta:{label:"Dashboard",icon:e.jsx($e,{className:"h-4 w-4"})}}],yl=[{name:"dashboard",list:"/kierowca/dashboard/overview",meta:{label:"Dashboard",icon:e.jsx($e,{className:"h-4 w-4"})}}],wl=[{name:"dashboard",list:"/operator/dashboard/overview",meta:{label:"Dashboard",icon:e.jsx($e,{className:"h-4 w-4"})}}],vl=()=>{const s=je(),[t,r]=f.useState(0),[n,d]=f.useState("");f.useEffect(()=>{const l=()=>r(window.scrollY);return window.addEventListener("scroll",l),()=>window.removeEventListener("scroll",l)},[]);const i=[{name:"Sty",value:180},{name:"Lut",value:210},{name:"Mar",value:230},{name:"Kwi",value:260},{name:"Maj",value:275},{name:"Cze",value:310}];return e.jsxs("div",{className:"min-h-screen bg-white text-foreground",children:[e.jsx("nav",{className:"fixed top-0 w-full z-50 bg-white/80 backdrop-blur-xl border-b border-gray-100",children:e.jsx("div",{className:"container mx-auto px-6 py-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-emerald-600 to-cyan-700 rounded-xl flex items-center justify-center",children:e.jsx(gs,{className:"w-5 h-5 text-white"})}),e.jsx("span",{className:"text-xl font-bold",children:"ScrapMaster"})]}),e.jsxs("div",{className:"hidden md:flex items-center gap-8",children:[e.jsx("a",{href:"#moduly",className:"text-sm font-medium text-gray-600 hover:text-gray-900 transition-colors",children:"Moduły"}),e.jsx("a",{href:"#dla-kogo",className:"text-sm font-medium text-gray-600 hover:text-gray-900 transition-colors",children:"Dla kogo"}),e.jsx("a",{href:"#cennik",className:"text-sm font-medium text-gray-600 hover:text-gray-900 transition-colors",children:"Cennik"}),e.jsx(u,{className:"bg-gray-900 hover:bg-gray-800 text-white text-sm px-6",onClick:()=>s("/login"),children:"Zaloguj się"})]})]})})}),e.jsx("section",{className:"pt-32 pb-20 overflow-hidden",children:e.jsx("div",{className:"container mx-auto px-6",children:e.jsxs("div",{className:"grid lg:grid-cols-12 gap-8 items-center",children:[e.jsxs("div",{className:"lg:col-span-5",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-emerald-50 rounded-full mb-8",children:[e.jsx(Ie,{className:"w-4 h-4 text-emerald-700"}),e.jsx("span",{className:"text-sm font-medium text-emerald-700",children:"System zarządzania złomowiskiem"})]}),e.jsxs("h1",{className:"text-5xl md:text-6xl font-bold leading-tight mb-6",children:["Operacje, które"," ",e.jsx("span",{className:"block text-transparent bg-clip-text bg-gradient-to-r from-emerald-600 to-cyan-700",children:"ważą się same"})]}),e.jsx("p",{className:"text-lg text-gray-600 mb-8 leading-relaxed",children:"Kompletny system do obsługi skupu i sprzedaży złomu: waga samochodowa, przyjęcia/wywozy, cenniki frakcji, ewidencja dokumentów i rozliczenia — w jednym miejscu."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-12",children:[e.jsxs(u,{size:"lg",className:"bg-gray-900 hover:bg-gray-800 text-white px-8",onClick:()=>s("/login"),children:["Wypróbuj teraz",e.jsx(We,{className:"ml-2 h-4 w-4"})]}),e.jsx(u,{size:"lg",variant:"outline",className:"border-gray-300",children:"Zobacz demo"})]}),e.jsxs("div",{className:"flex items-center gap-8",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:"310 t"}),e.jsx("div",{className:"text-sm text-gray-500",children:"średnio / m-c"})]}),e.jsx("div",{className:"w-px h-12 bg-gray-200"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:"-32%"}),e.jsx("div",{className:"text-sm text-gray-500",children:"mniej błędów w ważeniu"})]}),e.jsx("div",{className:"w-px h-12 bg-gray-200"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:"2 min"}),e.jsx("div",{className:"text-sm text-gray-500",children:"czas odprawy auta"})]})]})]}),e.jsx("div",{className:"lg:col-span-7",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute -inset-4 bg-gradient-to-r from-emerald-600/5 to-cyan-700/5 rounded-3xl blur-2xl"}),e.jsxs("div",{className:"relative bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-emerald-600 to-cyan-700 rounded-lg flex items-center justify-center",children:e.jsx(Ie,{className:"w-4 h-4 text-white"})}),e.jsx("span",{className:"font-semibold",children:"Panel operacyjny"})]}),e.jsx(y,{className:"bg-green-50 text-green-700 border-green-200",children:"Połączono z wagą"})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-emerald-100 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(ue,{className:"w-5 h-5 text-emerald-700"}),e.jsx("span",{className:"text-xs text-gray-500",children:"+18"})]}),e.jsx("div",{className:"text-2xl font-bold",children:"142"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Wjazdy dzisiaj"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-cyan-50 to-cyan-100 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(bs,{className:"w-5 h-5 text-cyan-700"}),e.jsx("span",{className:"text-xs text-gray-500",children:"PLN"})]}),e.jsx("div",{className:"text-2xl font-bold",children:"4,21"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Śr. cena/kg (mix)"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-amber-50 to-amber-100 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(as,{className:"w-5 h-5 text-amber-700"}),e.jsx("span",{className:"text-xs text-gray-500",children:"0"})]}),e.jsx("div",{className:"text-2xl font-bold",children:"Alarmy"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Zgodność / limity"})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("span",{className:"text-sm font-medium",children:"Przerób (t/m-c)"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Ostatnie 6 miesięcy"})]}),e.jsx(Jr,{width:"100%",height:120,children:e.jsxs(et,{data:i,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorThroughput",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#059669",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#059669",stopOpacity:0})]})}),e.jsx(st,{type:"monotone",dataKey:"value",stroke:"#059669",strokeWidth:2,fill:"url(#colorThroughput)"}),e.jsx(at,{dataKey:"name",axisLine:!1,tickLine:!1,tick:{fontSize:11}}),e.jsx(rt,{hide:!0})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"font-medium",children:"Aktywne zlecenia"}),e.jsx("a",{href:"#",className:"text-emerald-700 hover:underline",children:"Zobacz wszystkie"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-emerald-600 to-cyan-700 rounded-lg flex items-center justify-center",children:e.jsx(Hr,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm",children:"Przyjęcie: Złom stalowy (St3)"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Dostawca: Metal-Pol • Brama 2"})]})]}),e.jsx(Be,{className:"w-4 h-4 text-gray-400"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-cyan-600 to-sky-600 rounded-lg flex items-center justify-center",children:e.jsx(ue,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm",children:"Wywóz: Miedź cięta"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Odbiorca: CopperTrade • 12:45"})]})]}),e.jsx(Be,{className:"w-4 h-4 text-gray-400"})]})]})]})]})]})]})})]})})}),e.jsx("section",{id:"moduly",className:"py-20 bg-gray-50",children:e.jsxs("div",{className:"container mx-auto px-6",children:[e.jsxs("div",{className:"text-center mb-16",children:[e.jsxs("h2",{className:"text-4xl font-bold mb-4",children:["Moduły, które"," ",e.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-emerald-600 to-cyan-700",children:"upraszczają operacje"})]}),e.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"Od wagi po fakturę — pełen przepływ materiału z kontrolą jakości i zgodnością."})]}),e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:[{icon:Ie,title:"Waga i bilety",desc:"Dwuważenie, auto-pobór z wagi, bilety przyjęcia/wywozu, tary z historii.",grad:"from-emerald-600 to-cyan-700"},{icon:Gr,title:"Magazyn frakcji",desc:"Stany w czasie rzeczywistym, frakcje/klasy, partie i numeracja dostaw.",grad:"from-cyan-700 to-sky-500"},{icon:ga,title:"Cenniki i reguły",desc:"Ceny wg frakcji, wilgotności, jakości; indeksy rynkowe i marże.",grad:"from-amber-500 to-yellow-500"},{icon:Yr,title:"Kontrola jakości",desc:"Zdjęcia z kamer przy wadze, notatki jakościowe, blokady i odrzuty.",grad:"from-violet-600 to-fuchsia-600"},{icon:us,title:"Dokumenty i zgodność",desc:"KPO/BDO, WZ/PZ, JPK, rejestry kierowców i kontrahentów, audyty.",grad:"from-slate-700 to-slate-500"},{icon:Xr,title:"Analityka",desc:"Marża/kg, straty technologiczne, rotacja frakcji, KPI bram i wag.",grad:"from-teal-600 to-emerald-600"}].map((l,m)=>e.jsxs("div",{className:"group relative bg-white rounded-2xl p-8 hover:shadow-lg transition-all duration-300 cursor-pointer border border-gray-100",children:[e.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${l.grad}/10 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity`}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:`w-14 h-14 bg-gradient-to-br ${l.grad} rounded-2xl flex items-center justify-center mb-6`,children:e.jsx(l.icon,{className:"w-7 h-7 text-white"})}),e.jsx("h3",{className:"text-xl font-bold mb-3",children:l.title}),e.jsx("p",{className:"text-gray-600 mb-4",children:l.desc}),e.jsxs("div",{className:"flex items-center text-sm text-emerald-700 font-medium",children:["Dowiedz się więcej",e.jsx(We,{className:"w-4 h-4 ml-2 transform group-hover:translate-x-1 transition-transform"})]})]})]},m))})]})}),e.jsx("section",{className:"py-20 bg-white",id:"dla-kogo",children:e.jsxs("div",{className:"container mx-auto px-6",children:[e.jsxs("div",{className:"max-w-3xl mx-auto text-center mb-16",children:[e.jsxs("h2",{className:"text-4xl font-bold mb-4",children:["Jak to ",e.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-emerald-600 to-cyan-700",children:"działa"})]}),e.jsx("p",{className:"text-lg text-gray-600",children:"Cztery kroki od wjazdu do rozliczenia"})]}),e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2 top-0 bottom-0 w-0.5 bg-gray-200"}),e.jsx("div",{className:"space-y-12",children:[{number:"01",title:"Wjazd i rejestracja",description:"Skan rejestracji, wybór kontrahenta, zlecenie i frakcja.",icon:ue,color:"from-emerald-600 to-cyan-700"},{number:"02",title:"Ważenie i kontrola",description:"Auto-odczyt z wagi, zdjęcia z kamer, notatki jakościowe.",icon:Ie,color:"from-cyan-700 to-sky-500"},{number:"03",title:"Magazyn i dokumenty",description:"PZ/WZ, KPO/BDO, przyjęcie na partię i aktualizacja stanów.",icon:rs,color:"from-amber-500 to-yellow-500"},{number:"04",title:"Rozliczenie i analityka",description:"Cenniki, faktury/kwity kasowe, raporty marży i KPI.",icon:bs,color:"from-teal-600 to-emerald-600"}].map((l,m)=>e.jsx("div",{className:"relative",children:e.jsxs("div",{className:`flex items-center ${m%2===0?"flex-row":"flex-row-reverse"}`,children:[e.jsxs("div",{className:`w-5/12 ${m%2===0?"text-right pr-8":"text-left pl-8"}`,children:[e.jsxs("div",{className:`inline-flex items-center gap-4 mb-2 ${m%2===0?"flex-row-reverse":""}`,children:[e.jsx("h3",{className:"text-2xl font-bold",children:l.title}),e.jsx("span",{className:"text-4xl font-bold text-gray-200",children:l.number})]}),e.jsx("p",{className:"text-gray-600 text-lg",children:l.description})]}),e.jsx("div",{className:"w-2/12 flex justify-center",children:e.jsx("div",{className:`relative z-10 w-16 h-16 bg-gradient-to-br ${l.color} rounded-2xl flex items-center justify-center shadow-lg`,children:e.jsx(l.icon,{className:"w-8 h-8 text-white"})})}),e.jsx("div",{className:"w-5/12"})]})},m))})]})})]})}),e.jsx("section",{className:"py-20 bg-gradient-to-br from-gray-900 to-gray-800",id:"cennik",children:e.jsx("div",{className:"container mx-auto px-6",children:e.jsx("div",{className:"grid md:grid-cols-4 gap-8",children:[{value:"99,95%",label:"Dostępność",icon:as},{value:"<2 min",label:"Odprawa auta",icon:ue},{value:"0,1 kg",label:"Dokładność zapisu",icon:Ie},{value:"4.9/5",label:"Ocena użytkowników",icon:_e}].map((l,m)=>e.jsxs("div",{className:"text-center",children:[e.jsx(l.icon,{className:"w-8 h-8 mx-auto mb-4 text-white/60"}),e.jsx("div",{className:"text-4xl font-bold text-white mb-2",children:l.value}),e.jsx("div",{className:"text-sm text-white/60",children:l.label})]},m))})})}),e.jsx("section",{className:"py-20 bg-white",children:e.jsx("div",{className:"container mx-auto px-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[e.jsxs("h2",{className:"text-4xl font-bold mb-6",children:["Gotowy na"," ",e.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-emerald-600 to-cyan-700",children:"pełną kontrolę"}),"?"]}),e.jsx("p",{className:"text-lg text-gray-600 mb-8 max-w-2xl mx-auto",children:"Uporządkuj ważenia, dokumenty i rozliczenia. Pierwsze 30 dni gratis."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mb-8",children:[e.jsx(w,{type:"email",placeholder:"twoj@email.pl",value:n,onChange:l=>d(l.target.value),className:"max-w-xs h-12"}),e.jsxs(u,{size:"lg",className:"bg-gradient-to-r from-emerald-600 to-cyan-700 hover:opacity-90 text-white px-8 h-12",onClick:()=>s("/login"),children:["Zarejestruj konto",e.jsx(We,{className:"ml-2 h-4 w-4"})]})]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Bez karty • Anuluj w każdej chwili • Pełny dostęp"})]})})}),e.jsx("footer",{className:"bg-gray-900 text-white py-12",children:e.jsx("div",{className:"container mx-auto px-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-white/10 rounded-lg flex items-center justify-center",children:e.jsx(gs,{className:"w-4 h-4"})}),e.jsx("span",{className:"text-lg font-bold",children:"ScrapMaster"})]}),e.jsx("div",{className:"text-sm text-white/60",children:"© 2025 ScrapMaster. Wszystkie prawa zastrzeżone."})]})})})]})};console.log("1. Login index.tsx - ładowanie modułu");const fl=f.lazy(()=>(console.log("2. Login - rozpoczęcie lazy load"),Ve(()=>import("./LoginPage-DI91RSqG.js"),__vite__mapDeps([9,1,2,3,10,7,4,5,6,8])).then(s=>(console.log("3. Login - moduł załadowany",s),s)))),Nl=()=>(console.log("4. Login - renderowanie fallback"),e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Ładowanie logowania..."})]})})),Xa=e.jsx(b,{path:"/login",element:e.jsx(f.Suspense,{fallback:e.jsx(Nl,{}),children:e.jsx(fl,{})})});console.log("5. Login module exported",Xa);const _l=f.lazy(()=>Ve(()=>import("./RegisterFlow-yoAANJM_.js"),__vite__mapDeps([11,1,2,3,7,10,4,5,6,8]))),kl=()=>e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Przygotowywanie rejestracji..."})]})}),zl=e.jsx(b,{path:"/register/*",element:e.jsx(f.Suspense,{fallback:e.jsx(kl,{}),children:e.jsx(_l,{})})}),Cl=f.lazy(()=>Ve(()=>import("./ForgotPasswordPage-DG0itvQD.js"),__vite__mapDeps([12,1,2,3,10,7,4,5,6,8]))),Sl=()=>e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-yellow-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Ładowanie formularza resetowania..."})]})}),Ll=e.jsx(b,{path:"/forgot-password",element:e.jsx(f.Suspense,{fallback:e.jsx(Sl,{}),children:e.jsx(Cl,{})})}),Rl=f.lazy(()=>Ve(()=>import("./UpdatePasswordPage-BFoDs9qY.js"),__vite__mapDeps([13,1,2,3,10,7,4,5,6,8]))),$l=()=>e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Weryfikacja linku resetowania..."})]})}),Pl=e.jsx(b,{path:"/update-password",element:e.jsx(f.Suspense,{fallback:e.jsx($l,{}),children:e.jsx(Rl,{})})}),El=new Rr({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:!1,staleTime:300*1e3}}});function Dl({children:s}){const{pathname:t}=ca(),r=t.split("/")[1],n=r==="admin"?jl:r==="biuro"?pl:r==="logistyk"?gl:r==="handlowiec"?bl:r==="kierowca"?yl:r==="operator"?wl:[];return e.jsx(Pr,{dataProvider:qr(de),authProvider:mt,routerProvider:Er,resources:n,options:{syncWithLocation:!1,warnWhenUnsavedChanges:!0,useNewQueryKeys:!0,disableTelemetry:!0},children:s})}function ql(){return e.jsx($r,{client:El,children:e.jsx(_r,{children:e.jsx(Dl,{children:e.jsxs(fe,{children:[e.jsx(b,{path:"/",element:e.jsx(vl,{})}),Xa,zl,Ll,Pl,ml,Un,Hn,Jn,rl,ll,hl,e.jsx(b,{path:"*",element:e.jsx(re,{to:"/",replace:!0})})]})})})})}const Fl=document.getElementById("root"),Al=it.createRoot(Fl);Al.render(e.jsxs(ye.StrictMode,{children:[e.jsx(ql,{}),e.jsx(kr,{position:"top-right",richColors:!0,closeButton:!0,duration:4e3,toastOptions:{style:{width:"500px",fontSize:"20px"},className:"sonner-toast"}})]}));export{pt as A,u as B,z as C,G as F,w as I,L,C as a,$ as b,S as c,bt as d,Na as e,p as f,Gt as g,Z as h,ts as i,va as j,ya as l,wa as r,de as s,fa as u};
