const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/LoginPage-vWkplWTc.js","assets/radix-ui-BdNglvg2.js","assets/react-vendor-nLIND2rL.js","assets/refine-core-BpFEoGih.js","assets/NarrowCol-DUq-L8Qp.js","assets/ui-utils-CHvRCCKz.js","assets/utils-C8X7R3D6.js","assets/refine-ui-D3vAG_bA.js","assets/forms-aDucxvuO.js","assets/tables-B_D9J81n.js","assets/RegisterFlow-ChTA4q1X.js","assets/ForgotPasswordPage-B90kJQvi.js","assets/UpdatePasswordPage-DW7QmvoD.js"])))=>i.map(i=>d[i]);
var Zj=Object.defineProperty;var Yj=(t,s,n)=>s in t?Zj(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n;var _s=(t,s,n)=>Yj(t,typeof s!="symbol"?s+"":s,n);import{j as e,R as xh,I as gh,F as jh,S as hc,a as yh,P as Jj,C as bh,b as wh,V as Xj,c as ey,d as vh,e as ty,T as Nh,f as sy,g as kh,h as zh,i as ny,k as Sh,l as ry,L as Ch,m as Th,n as iy,o as ay,p as _h,q as oy,r as ly,s as Ah,t as Dh,u as Ph,v as Mh,w as cy,x as Ih,y as dy,z as Dn,A as Eh,B as pc,D as on,E as ze,G as uy,H as my,J as hy,K as Lh,M as py,N as fy,O as xy,Q as Oh,U as gy,W as Rh,X as jy,Y as $h,Z as qh,_ as yy,$ as Fh,a0 as by,a1 as wy,a2 as Uh,a3 as Bh,a4 as Vh,a5 as eo,a6 as vy,a7 as Ny,a8 as ky,a9 as zy,aa as Sy,ab as Cy,ac as Ty,ad as _y,ae as Ay,af as Dy,ag as Py,ah as My,ai as Wh,aj as Iy,ak as Ey,al as Ly,am as Hd}from"./radix-ui-BdNglvg2.js";import{k as Oy,a as x,l as W,n as hr,N as as,o as to,O as fc,e as se,d as Ei,u as vt,R as ne,h as ti,p as so,L as Li,B as Ry}from"./react-vendor-nLIND2rL.js";import{c as $y,t as K,a as Kh,v as qy,o as Sr,u as pr,b as xc,n as Oi,d as Pa,e as Fy,f as Gh,E as Uy,g as gc,h as xi,m as $t,i as By,j as Vy,k as Ys,s as Qo,r as Wy,l as si,p as Yn,q as Ky,M as Ma,T as Gy}from"./utils-C8X7R3D6.js";import{n as We,M as no,d as Qh,H as jc,$ as Y,e as Cr,X as os,f as zn,I as Hh,E as yc,o as bc,i as Xe,k as Zh,j as ut,l as Qy,Q as Hy,m as Zy,p as Yy,D as Jy}from"./refine-core-BpFEoGih.js";import{c as Xy,_ as ro,k as ln,I as eb}from"./refine-ui-D3vAG_bA.js";import{t as tb,c as sb,U as Ia,M as io,G as tn,a as wc,S as ao,b as oo,C as Xt,d as ws,e as Ve,X as dt,f as Ri,L as lo,g as pe,h as Ls,B as ye,i as vc,I as qt,j as $i,k as nb,l as rt,F as Yh,m as rb,T as Se,n as is,Z as Ye,P as Ie,o as Tt,p as ls,q as ib,r as ab,s as ob,u as Jh,v as lb,A as qi,w as xt,x as $e,y as va,z as fr,E as co,D as Je,H as ks,J as uo,K as Os,N as it,O as Te,Q as yt,R as Ce,V as Xh,W as Xs,Y as cb,_ as at,$ as Fi,a0 as db,a1 as vn,a2 as ub,a3 as mb,a4 as hb,a5 as xr,a6 as Re,a7 as le,a8 as Zd,a9 as pb,aa as gr,ab as Rs,ac as Tl,ad as ep,ae as Sn,af as tp,ag as fs,ah as fb,ai as Yd,aj as xb,ak as gb,al as Tr,am as Ea,an as Ui,ao as jb,ap as _l,aq as sp,ar as yb,as as bb,at as Jd,au as wb,av as vb,aw as Nb,ax as kb,ay as zb,az as Sb,aA as Cb,aB as Xd}from"./ui-utils-CHvRCCKz.js";import{R as Fe,A as mo,C as Rt,X as St,Y as gt,T as Be,a as sn,P as La,b as Oa,c as xs,B as Bi,d as jr,L as np,e as Nc,F as Tb,f as _b,g as Ab,h as lr,S as rp,Z as ip,i as ap,j as Db,k as Pb,l as Mb,m as Ib,n as Eb,o as Lb,p as Ob,q as Rb}from"./tables-B_D9J81n.js";import"./forms-aDucxvuO.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();var ca={},eu;function $b(){if(eu)return ca;eu=1;var t=Oy();return ca.createRoot=t.createRoot,ca.hydrateRoot=t.hydrateRoot,ca}var qb=$b();const Fb="https://hqsyimochfcfqahcuprn.supabase.co",Ub="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imhxc3lpbW9jaGZjZnFhaGN1cHJuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM4NjU4NTYsImV4cCI6MjA2OTQ0MTg1Nn0.KutvVrkDKuVyvrYQosU3SI6QrrMnWqDCSZ2E3fhCteI",J=Xy(Fb,Ub,{db:{schema:"public"},auth:{persistSession:!0}}),q=(...t)=>tb(sb(t)),Bb={invalid_credentials:"Nieprawidowy email lub haso.","Invalid login credentials":"Nieprawidowy email lub haso.",email_not_confirmed:"Email nie zosta potwierdzony.","Email not confirmed":"Email nie zosta potwierdzony.",user_not_found:"Nie znaleziono u偶ytkownika.","User not found":"Nie znaleziono u偶ytkownika.",network_error:"Bd poczenia z serwerem.","Too many requests":"Zbyt wiele pr贸b. Spr贸buj ponownie za chwil."},Vb=t=>{if(!t)return{message:"Nieznany bd",name:"UnknownError",statusCode:500};const s=t.message||t.error_description||"";for(const[n,r]of Object.entries(Bb))if(s.includes(n))return{message:r,name:"LoginError",statusCode:t.code==="invalid_credentials"?401:400};return{message:s||"Bd logowania",name:"LoginError",statusCode:400}},op={login:async(t,s)=>{try{if(!t||!s)return{success:!1,error:"Email i haso s wymagane"};const{data:n,error:r}=await J.auth.signInWithPassword({email:t.trim().toLowerCase(),password:s});if(r)return{success:!1,error:Vb(r).message};if(!n.session)return{success:!1,error:"Nie udao si utworzy sesji"};const{data:i}=await J.from("users").select("role").eq("id",n.user.id).single();return{success:!0,redirectTo:i?.role==="admin"?"/admin/dashboard/overview":i?.role==="teacher"?"/teacher/dashboard/overview":i?.role==="student"?"/student/dashboard":"/profiles"}}catch(n){return{success:!1,error:n.message||"Nieznany bd"}}},loginForRefine:async(t,s)=>{const n=await op.login(t,s);return n.success?n:{success:!1,error:{message:n.error,name:"LoginError",statusCode:400}}},checkAuth:async()=>{const{data:{session:t}}=await J.auth.getSession();return!!t}},Wb={user_already_exists:"Konto z tym adresem email ju偶 istnieje","User already registered":"Konto z tym adresem email ju偶 istnieje","already exists":"Konto z tym adresem email ju偶 istnieje",weak_password:"Haso musi mie co najmniej 6 znak贸w","Password should be at least":"Haso musi mie co najmniej 6 znak贸w","Password cannot be longer than 72":"Haso nie mo偶e by du偶sze ni偶 72 znaki",invalid_email:"Nieprawidowy format adresu email","Invalid email":"Nieprawidowy format adresu email",over_email_send_rate_limit:"Za szybko! Poczekaj 2 sekundy przed ponown pr贸b"},tu=t=>{if(!t)return{message:"Nieznany bd",name:"UnknownError",statusCode:500};const s=t.message||"";for(const[n,r]of Object.entries(Wb))if(s.includes(n)){let i=400;return n.includes("already")&&(i=409),n.includes("email_send_rate")&&(i=429),{message:r,name:"RegisterError",statusCode:i}}return{message:s||"Rejestracja nie powioda si",name:"RegisterError",statusCode:400}},lp={register:async(t,s,n)=>{try{const{data:r,error:i}=await J.auth.signUp({email:t.trim().toLowerCase(),password:s,options:{data:{full_name:n.trim(),role:"student"},emailRedirectTo:`${window.location.origin}/login?verified=true`}});return i?{success:!1,error:tu(i).message}:r.user?{success:!0,needsEmailConfirmation:!r.session}:{success:!1,error:"Rejestracja nie powioda si"}}catch(r){return{success:!1,error:r.message||"Bd rejestracji"}}},registerForRefine:async(t,s,n)=>{const r=await lp.register(t,s,n);return r.success?{success:!0,successNotification:r.needsEmailConfirmation?{message:"Rejestracja udana!",description:"Sprawd藕 email aby potwierdzi konto."}:{message:"Rejestracja udana!",description:"Mo偶esz si teraz zalogowa."}}:{success:!1,error:tu({message:r.error})}}},Kb={"User not found":"Nie znaleziono u偶ytkownika z tym adresem email","Invalid email":"Nieprawidowy format adresu email",over_email_send_rate_limit:"Za szybko! Poczekaj chwil przed kolejn pr贸b",reset_password_rate_limit:"Zbyt wiele pr贸b. Spr贸buj ponownie za kilka minut"},su=t=>{if(!t)return{message:"Nieznany bd",name:"UnknownError",statusCode:500};const s=t.message||"";for(const[n,r]of Object.entries(Kb))if(s.includes(n))return{message:r,name:"ForgotPasswordError",statusCode:n.includes("rate_limit")?429:400};return{message:s||"Bd podczas wysyania emaila",name:"ForgotPasswordError",statusCode:400}},cp={sendResetEmail:async t=>{try{const{error:s}=await J.auth.resetPasswordForEmail(t.trim().toLowerCase(),{redirectTo:`${window.location.origin}/update-password`});return s?{success:!1,error:su(s).message}:{success:!0}}catch(s){return{success:!1,error:s.message||"Bd podczas wysyania emaila"}}},sendResetEmailForRefine:async t=>{const s=await cp.sendResetEmail(t);return s.success?{success:!0,successNotification:{message:"Email wysany!",description:"Sprawd藕 swoj skrzynk odbiorcz"}}:{success:!1,error:su({message:s.error})}}},Gb={"New password should be different":"Nowe haso musi by inne ni偶 obecne","Password should be at least":"Haso musi mie co najmniej 6 znak贸w","Invalid token":"Link wygas lub jest nieprawidowy",session_not_found:"Sesja wygasa. Spr贸buj ponownie"},nu=t=>{if(!t)return{message:"Nieznany bd",name:"UnknownError",statusCode:500};const s=t.message||"";for(const[n,r]of Object.entries(Gb))if(s.includes(n))return{message:r,name:"UpdatePasswordError",statusCode:n.includes("token")||n.includes("session")?401:400};return{message:s||"Bd aktualizacji hasa",name:"UpdatePasswordError",statusCode:400}},dp={checkSession:async()=>{try{const{data:t}=await J.auth.getSession(),n=new URLSearchParams(window.location.hash.substring(1)).get("type");return!t.session&&n!=="recovery"?{isValid:!1,error:"Link wygas lub jest nieprawidowy"}:{isValid:!0}}catch{return{isValid:!1,error:"Bd weryfikacji sesji"}}},updatePassword:async t=>{try{const{error:s}=await J.auth.updateUser({password:t});return s?{success:!1,error:nu(s).message}:{success:!0}}catch(s){return{success:!1,error:s.message||"Bd aktualizacji hasa"}}},updatePasswordForRefine:async t=>{const s=await dp.updatePassword(t);return s.success?{success:!0,redirectTo:"/login?passwordChanged=true"}:{success:!1,error:nu({message:s.error})}}};class Qb{constructor(){_s(this,"cache",null);_s(this,"lastFetch",0);_s(this,"CACHE_DURATION",300*1e3);_s(this,"fetchPromise",null)}async get(s=!1){const n=Date.now();if(!s&&this.cache&&n-this.lastFetch<this.CACHE_DURATION)return this.cache;if(this.fetchPromise)return this.fetchPromise;this.fetchPromise=this.fetchUser();const r=await this.fetchPromise;return this.fetchPromise=null,r}async fetchUser(){try{const{data:{session:s}}=await J.auth.getSession();if(!s?.user)return this.clear(),null;const{data:n,error:r}=await J.from("users").select("*").eq("id",s.user.id).single();if(r||!n){console.error("Error fetching user data:",r);const a={id:s.user.id,email:s.user.email||"",full_name:s.user.user_metadata?.full_name||s.user.email?.split("@")[0]||"User",vendor_id:1,role:"student"};return this.set(a),a}const i={id:n.id,email:n.email,full_name:n.full_name,vendor_id:n.vendor_id,role:n.role,is_active:n.is_active,created_at:n.created_at};return this.set(i),i}catch(s){return console.error("Error in fetchUser:",s),this.clear(),null}}set(s){this.cache=s,this.lastFetch=Date.now()}clear(){this.cache=null,this.lastFetch=0,this.fetchPromise=null}async refresh(){return this.get(!0)}}const Js=new Qb;J.auth.onAuthStateChange((t,s)=>{t==="SIGNED_OUT"||!s?Js.clear():(t==="SIGNED_IN"||t==="TOKEN_REFRESHED")&&Js.get(!0)});const Ho={logout:async()=>{try{Js.clear();const{error:t}=await J.auth.signOut();return t?{success:!1,error:{message:"Bd podczas wylogowania",name:"LogoutError",statusCode:500}}:{success:!0,redirectTo:"/login"}}catch{return{success:!1,error:{message:"Nieoczekiwany bd podczas wylogowania",name:"LogoutError",statusCode:500}}}},check:async()=>{try{const{data:{session:t}}=await J.auth.getSession();if(!t)return{authenticated:!1,redirectTo:"/login"};const s=t.expires_at;return s&&s*1e3<Date.now()?{authenticated:!1,redirectTo:"/login"}:{authenticated:!0}}catch{return{authenticated:!1,redirectTo:"/login"}}},handleError:async t=>(console.error("Auth error:",t),t?.statusCode===401?(Js.clear(),{redirectTo:"/login",logout:!0,error:t}):{error:t})},Hb={login:async({email:t,password:s})=>{const n=await op.login(t,s);return n.success&&await Js.refresh(),n},logout:async()=>await Ho.logout(),check:async()=>await Ho.check(),getIdentity:async()=>await Js.get(),getPermissions:async()=>(await Js.get())?.role||null,register:async({email:t,password:s,name:n})=>await lp.registerForRefine(t,s,n),forgotPassword:async({email:t})=>await cp.sendResetEmailForRefine(t),updatePassword:async({password:t})=>{const s=await dp.updatePasswordForRefine(t);return s.success&&await Js.clear(),s},onError:async t=>await Ho.handleError(t)},kc=({isLoading:t,isError:s,loadingText:n="Loading...",errorMsg:r="Error loading data"})=>t?e.jsx("div",{className:"p-6 text-gray-600 animate-reverse-pulse",children:n}):s?e.jsx("div",{className:"p-6 text-red-500",children:r}):null;function Zb(t,s){let n;try{n=t()}catch{return}return{getItem:i=>{var a;const o=c=>c===null?null:JSON.parse(c,void 0),l=(a=n.getItem(i))!=null?a:null;return l instanceof Promise?l.then(o):o(l)},setItem:(i,a)=>n.setItem(i,JSON.stringify(a,void 0)),removeItem:i=>n.removeItem(i)}}const Al=t=>s=>{try{const n=t(s);return n instanceof Promise?n:{then(r){return Al(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return Al(r)(n)}}}},Yb=(t,s)=>(n,r,i)=>{let a={storage:Zb(()=>localStorage),partialize:f=>f,version:0,merge:(f,y)=>({...y,...f}),...s},o=!1;const l=new Set,c=new Set;let d=a.storage;if(!d)return t((...f)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),n(...f)},r,i);const m=()=>{const f=a.partialize({...r()});return d.setItem(a.name,{state:f,version:a.version})},u=i.setState;i.setState=(f,y)=>{u(f,y),m()};const h=t((...f)=>{n(...f),m()},r,i);i.getInitialState=()=>h;let p;const b=()=>{var f,y;if(!d)return;o=!1,l.forEach(j=>{var v;return j((v=r())!=null?v:h)});const w=((y=a.onRehydrateStorage)==null?void 0:y.call(a,(f=r())!=null?f:h))||void 0;return Al(d.getItem.bind(d))(a.name).then(j=>{if(j)if(typeof j.version=="number"&&j.version!==a.version){if(a.migrate){const v=a.migrate(j.state,j.version);return v instanceof Promise?v.then(T=>[!0,T]):[!0,v]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,j.state];return[!1,void 0]}).then(j=>{var v;const[T,z]=j;if(p=a.merge(z,(v=r())!=null?v:h),n(p,!0),T)return m()}).then(()=>{w?.(p,void 0),p=r(),o=!0,c.forEach(j=>j(p))}).catch(j=>{w?.(void 0,j)})};return i.persist={setOptions:f=>{a={...a,...f},f.storage&&(d=f.storage)},clearStorage:()=>{d?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>b(),hasHydrated:()=>o,onHydrate:f=>(l.add(f),()=>{l.delete(f)}),onFinishHydration:f=>(c.add(f),()=>{c.delete(f)})},a.skipHydration||b(),p||h},Jb=Yb;class Xb{static async call(s,n,r={}){const a={message:this.interpolateTemplate(n.user,r),...n.system&&{system:n.system},...s.model&&{model:s.model}},o=await fetch(s.endpoint,{method:"POST",headers:{"Content-Type":"application/json",...s.apiKey&&{Authorization:`Bearer ${s.apiKey}`}},body:JSON.stringify(a)});let l;try{l=await o.json()}catch{throw new Error(`LLM API Error: ${o.status} ${o.statusText}`)}if(!o.ok||l.error){const d=l.message||l.error||"Nieznany bd",m=l.suggestion?` ${l.suggestion}`:"";throw new Error(`${d}${m}`)}const c=l.response||l;return n.responseFormat==="json"?this.parseJsonResponse(c):c}static interpolateTemplate(s,n){return s.replace(/\{\{(\w+)\}\}/g,(r,i)=>n[i]!==void 0?String(n[i]):r)}static cleanJsonResponse(s){let n=s;return n=n.replace(/```json\s*\n?([\s\S]*?)\n?```/g,"$1"),n=n.replace(/```\s*\n?([\s\S]*?)\n?```/g,"$1"),n.trim()}static parseJsonResponse(s){const n=this.cleanJsonResponse(s);try{return JSON.parse(n)}catch{try{const i=n.replace(/\\(\d+)\./g,"$1.");return JSON.parse(i)}catch{try{const a=n.replace(/\\\\/g,"\\");return JSON.parse(a)}catch{const o=n.match(/\{[\s\S]*\}/);if(o)try{const l=o[0].replace(/\\(\d+)\./g,"$1.").replace(/\\\\/g,"\\");return JSON.parse(l)}catch{try{const c=o[0].replace(/\\"/g,'"').replace(/\\n/g,`
`).replace(/\\r/g,"\r").replace(/\\t/g,"	").replace(/\\\\/g,"\\");return JSON.parse(c)}catch{throw console.error("Failed to parse JSON response after all attempts:",s),console.error("Cleaned version:",n),new Error("Nie udao si przetworzy odpowiedzi JSON z API")}}throw console.error("No JSON found in response:",s),new Error("Nie znaleziono poprawnego JSON w odpowiedzi")}}}}}const Ke=$y()(Jb((t,s)=>({processes:{},formData:{},llmOperations:{},registeredLLMOperations:{},register:n=>t(r=>({processes:{...r.processes,[n.id]:n}})),unregister:(n,r="all")=>t(i=>{switch(r){case"all":{const{[n]:a,...o}=i.processes,{[n]:l,...c}=i.formData,d=Object.keys(i.llmOperations).filter(u=>!u.startsWith(`${n}-`)).reduce((u,h)=>(u[h]=i.llmOperations[h],u),{}),m=Object.keys(i.registeredLLMOperations).filter(u=>!u.startsWith(`${n}-`)).reduce((u,h)=>(u[h]=i.registeredLLMOperations[h],u),{});return{processes:o,formData:c,llmOperations:d,registeredLLMOperations:m}}case"data":{const{[n]:a,...o}=i.formData;return{...i,formData:o}}default:return i}}),get:n=>s().processes[n]||null,getSchemaFragment:n=>{const[r,...i]=n.split("."),a=s().processes[r];if(!a)return null;let o=a.schema;for(const l of i)o=o?.[l];return o},setData:(n,r)=>t(i=>({formData:{...i.formData,[n]:{...i.formData[n],...r}}})),getData:n=>s().formData[n]||{},reset:n=>t(r=>({formData:{...r.formData,[n]:{}}})),registerLLMOperation:(n,r)=>t(i=>({registeredLLMOperations:{...i.registeredLLMOperations,[`${n}-${r.id}`]:r}})),unregisterLLMOperation:(n,r)=>t(i=>{const{[`${n}-${r}`]:a,...o}=i.registeredLLMOperations;return{registeredLLMOperations:o}}),executeLLMOperation:async(n,r,i={})=>{const a=`${n}-${r}`,o=s().registeredLLMOperations[a];if(!o)throw new Error(`LLM Operation not found: ${a}`);try{s().setLLMOperationState(n,r,{loading:!0,error:null});const l=s().getData(n),c={...l,...i},d=o.inputMapping?o.inputMapping(c):c,m=await Xb.call(o.config,o.prompt,d);if(o.validation&&!o.validation(m))throw new Error("LLM result failed validation");let u=m;return o.outputMapping&&(u=o.outputMapping(m,l),s().setData(n,u)),s().setLLMOperationState(n,r,{loading:!1,error:null,result:m}),m}catch(l){throw s().setLLMOperationState(n,r,{loading:!1,error:l.message||"Unknown error",result:null}),l}},setLLMOperationState:(n,r,i)=>t(a=>({llmOperations:{...a.llmOperations,[`${n}-${r}`]:i}})),getLLMOperationState:(n,r)=>s().llmOperations[`${n}-${r}`]||{loading:!1,error:null},clearLLMOperation:(n,r)=>t(i=>{const{[`${n}-${r}`]:a,...o}=i.llmOperations;return{llmOperations:o}})}),{name:"form-schema-store",version:2,partialize:t=>({processes:t.processes,formData:t.formData})})),Pn=(t,s)=>{const{registerLLMOperation:n,unregisterLLMOperation:r,executeLLMOperation:i,getLLMOperationState:a,clearLLMOperation:o}=Ke();return{...a(t,s),registerOperation:h=>{n(t,h)},executeOperation:async h=>await i(t,s,h),clearOperation:()=>{o(t,s)},unregisterOperation:()=>{r(t,s)}}};console.log("1. Login index.tsx - adowanie moduu");const e0=x.lazy(()=>(console.log("2. Login - rozpoczcie lazy load"),ro(()=>import("./LoginPage-vWkplWTc.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9])).then(t=>(console.log("3. Login - modu zaadowany",t),t)))),t0=()=>(console.log("4. Login - renderowanie fallback"),e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"adowanie logowania..."})]})})),up=e.jsx(W,{path:"/login",element:e.jsx(x.Suspense,{fallback:e.jsx(t0,{}),children:e.jsx(e0,{})})});console.log("5. Login module exported",up);const s0=x.lazy(()=>ro(()=>import("./RegisterFlow-ChTA4q1X.js"),__vite__mapDeps([10,1,2,3,5,4,6,7,8,9]))),n0=()=>e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Przygotowywanie rejestracji..."})]})}),r0=e.jsx(W,{path:"/register/*",element:e.jsx(x.Suspense,{fallback:e.jsx(n0,{}),children:e.jsx(s0,{})})}),i0=x.lazy(()=>ro(()=>import("./ForgotPasswordPage-B90kJQvi.js"),__vite__mapDeps([11,1,2,3,4,5,6,7,8,9]))),a0=()=>e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-yellow-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"adowanie formularza resetowania..."})]})}),o0=e.jsx(W,{path:"/forgot-password",element:e.jsx(x.Suspense,{fallback:e.jsx(a0,{}),children:e.jsx(i0,{})})}),l0=x.lazy(()=>ro(()=>import("./UpdatePasswordPage-DW7QmvoD.js"),__vite__mapDeps([12,1,2,3,4,5,6,7,8,9]))),c0=()=>e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Weryfikacja linku resetowania..."})]})}),d0=e.jsx(W,{path:"/update-password",element:e.jsx(x.Suspense,{fallback:e.jsx(c0,{}),children:e.jsx(l0,{})})}),gi=x.forwardRef(({className:t,...s},n)=>e.jsx(xh,{ref:n,className:q("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...s}));gi.displayName=xh.displayName;const u0=x.forwardRef(({className:t,...s},n)=>e.jsx(gh,{ref:n,className:q("aspect-square h-full w-full object-cover",t),...s}));u0.displayName=gh.displayName;const ji=x.forwardRef(({className:t,...s},n)=>e.jsx(jh,{ref:n,className:q("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...s}));ji.displayName=jh.displayName;function xn({className:t,...s}){return e.jsx("div",{className:q("animate-pulse rounded-md bg-primary/10",t),...s})}const mp=({className:t="",showRole:s=!0,showEmail:n=!0,compact:r=!1})=>{const{data:i,isLoading:a,error:o}=We(),l=h=>{switch(h){case"admin":return e.jsx(ao,{className:"h-3 w-3"});case"teacher":return e.jsx(wc,{className:"h-3 w-3"});case"student":return e.jsx(tn,{className:"h-3 w-3"});default:return e.jsx(Ia,{className:"h-3 w-3"})}},c=h=>{switch(h){case"admin":return"Administrator";case"teacher":return"Nauczyciel";case"student":return"Ucze";default:return"U偶ytkownik"}},d=h=>{switch(h){case"admin":return"text-purple-600 bg-purple-50";case"teacher":return"text-blue-600 bg-blue-50";case"student":return"text-green-600 bg-green-50";default:return"text-gray-600 bg-gray-50"}};if(a)return e.jsxs("div",{className:`flex items-center space-x-3 p-3 ${t}`,children:[e.jsx(xn,{className:"h-10 w-10 rounded-full"}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(xn,{className:"h-4 w-28"}),e.jsx(xn,{className:"h-3 w-20"}),s&&e.jsx(xn,{className:"h-3 w-16"})]})]});if(o||!i)return e.jsxs("div",{className:`flex items-center space-x-3 p-3 text-muted-foreground ${t}`,children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-100 flex items-center justify-center",children:e.jsx(Ia,{className:"h-5 w-5 text-gray-400"})}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium text-gray-500",children:"Nie zalogowano"}),e.jsx("div",{className:"text-xs opacity-70",children:"Brak danych u偶ytkownika"})]})]});const u=(h=>{if(!h)return"U";const p=h.trim().split(" ");return p.length>=2?`${p[0][0]}${p[p.length-1][0]}`.toUpperCase():h.slice(0,2).toUpperCase()})(i.full_name||i.email);return r?e.jsxs("div",{className:`flex items-center space-x-2 p-2 ${t}`,children:[e.jsx(gi,{className:"h-8 w-8",children:e.jsx(ji,{className:"bg-gradient-to-br from-purple-500 to-pink-500 text-white text-xs",children:u})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("div",{className:"font-medium text-sm truncate",children:i.full_name})})]}):e.jsxs("div",{className:`flex items-center space-x-3 px-4 pt-4 rounded-lg bg-white/50 backdrop-blur-sm border border-purple-100/20 ${t}`,children:[e.jsx(gi,{className:"h-12 w-12 ring-2 ring-purple-100 ring-offset-2",children:e.jsx(ji,{className:"bg-gradient-to-br from-purple-500 to-pink-500 text-white font-medium",children:u})}),e.jsxs("div",{className:"flex-1 min-w-0 space-y-1",children:[e.jsx("div",{className:"font-semibold text-gray-900 truncate",title:i.full_name,children:i.full_name}),n&&i.email&&e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-gray-500",children:[e.jsx(io,{className:"h-3 w-3"}),e.jsx("span",{className:"truncate",title:i.email,children:i.email})]}),s&&i.role&&e.jsx("div",{className:"inline-flex items-center gap-1.5",children:e.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full text-xs font-medium ${d(i.role)}`,children:[l(i.role),c(i.role)]})})]})]})},m0=oo("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),ge=x.forwardRef(({className:t,variant:s,...n},r)=>e.jsx("div",{ref:r,role:"alert",className:q(m0({variant:s}),t),...n}));ge.displayName="Alert";const hp=x.forwardRef(({className:t,...s},n)=>e.jsx("h5",{ref:n,className:q("mb-1 font-medium leading-none tracking-tight",t),...s}));hp.displayName="AlertTitle";const je=x.forwardRef(({className:t,...s},n)=>e.jsx("div",{ref:n,className:q("text-sm [&_p]:leading-relaxed",t),...s}));je.displayName="AlertDescription";const h0=oo("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function H({className:t,variant:s,asChild:n=!1,...r}){const i=n?hc:"span";return e.jsx(i,{"data-slot":"badge",className:q(h0({variant:s}),t),...r})}const p0=x.forwardRef(({...t},s)=>e.jsx("nav",{ref:s,"aria-label":"breadcrumb",...t}));p0.displayName="Breadcrumb";const f0=x.forwardRef(({className:t,...s},n)=>e.jsx("ol",{ref:n,className:q("flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5",t),...s}));f0.displayName="BreadcrumbList";const x0=x.forwardRef(({className:t,...s},n)=>e.jsx("li",{ref:n,className:q("inline-flex items-center gap-1.5",t),...s}));x0.displayName="BreadcrumbItem";const g0=x.forwardRef(({asChild:t,className:s,...n},r)=>{const i=t?hc:"a";return e.jsx(i,{ref:r,className:q("transition-colors hover:text-foreground",s),...n})});g0.displayName="BreadcrumbLink";const j0=x.forwardRef(({className:t,...s},n)=>e.jsx("span",{ref:n,role:"link","aria-disabled":"true","aria-current":"page",className:q("font-normal text-foreground",t),...s}));j0.displayName="BreadcrumbPage";const y0=oo("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),I=x.forwardRef(({className:t,variant:s,size:n,asChild:r=!1,...i},a)=>{const o=r?hc:"button";return e.jsx(o,{className:q(y0({variant:s,size:n,className:t})),ref:a,...i})});I.displayName="Button";const D=x.forwardRef(({className:t,...s},n)=>e.jsx("div",{ref:n,className:q("rounded-xl border bg-card text-card-foreground shadow flex flex-col overflow-hidden",t),...s}));D.displayName="Card";const $=x.forwardRef(({className:t,...s},n)=>e.jsx("div",{ref:n,className:q("flex flex-col space-y-1.5 p-6 pb-3 bg-pink-200/25",t),...s}));$.displayName="CardHeader";const R=x.forwardRef(({className:t,...s},n)=>e.jsx("div",{ref:n,className:q("text-lg font-semibold leading-tight tracking-tight pt-3",t),...s}));R.displayName="CardTitle";const Oe=x.forwardRef(({className:t,...s},n)=>e.jsx("div",{ref:n,className:q("text-sm text-muted-foreground",t),...s}));Oe.displayName="CardDescription";const P=x.forwardRef(({className:t,...s},n)=>e.jsx("div",{ref:n,className:q("p-3 lg:p-6 pt-3 space-y-3 flex-1 bg-background",t),...s}));P.displayName="CardContent";const b0=x.forwardRef(({className:t,...s},n)=>e.jsx("div",{ref:n,className:q("flex items-center justify-between p-6 pt-0",t),...s}));b0.displayName="CardFooter";const w0=oo("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),re=x.forwardRef(({className:t,...s},n)=>e.jsx(yh,{ref:n,className:q(w0(),t),...s}));re.displayName=yh.displayName;x.createContext({});x.createContext({});const Z=x.forwardRef(({className:t,type:s,...n},r)=>e.jsx("input",{type:s,className:q("flex h-9 w-full rounded-md border border-input bg-background px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...n}));Z.displayName="Input";const v0=x.forwardRef(({className:t,align:s="center",sideOffset:n=4,...r},i)=>e.jsx(Jj,{children:e.jsx(bh,{ref:i,align:s,sideOffset:n,className:q("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]",t),...r})}));v0.displayName=bh.displayName;const yr=x.forwardRef(({className:t,children:s,...n},r)=>e.jsxs(wh,{ref:r,className:q("relative overflow-hidden",t),...n,children:[e.jsx(Xj,{className:"h-full w-full rounded-[inherit]",children:s}),e.jsx(pp,{}),e.jsx(ey,{})]}));yr.displayName=wh.displayName;const pp=x.forwardRef(({className:t,orientation:s="vertical",...n},r)=>e.jsx(vh,{ref:r,orientation:s,className:q("flex touch-none select-none transition-colors",s==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",s==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...n,children:e.jsx(ty,{className:"relative flex-1 rounded-full bg-border"})}));pp.displayName=vh.displayName;const fe=oy,xe=ly,me=x.forwardRef(({className:t,children:s,...n},r)=>e.jsxs(Nh,{ref:r,className:q("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-background px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...n,children:[s,e.jsx(sy,{asChild:!0,children:e.jsx(Xt,{className:"h-4 w-4 opacity-50"})})]}));me.displayName=Nh.displayName;const fp=x.forwardRef(({className:t,...s},n)=>e.jsx(kh,{ref:n,className:q("flex cursor-default items-center justify-center py-1",t),...s,children:e.jsx(ws,{className:"h-4 w-4"})}));fp.displayName=kh.displayName;const xp=x.forwardRef(({className:t,...s},n)=>e.jsx(zh,{ref:n,className:q("flex cursor-default items-center justify-center py-1",t),...s,children:e.jsx(Xt,{className:"h-4 w-4"})}));xp.displayName=zh.displayName;const he=x.forwardRef(({className:t,children:s,position:n="popper",...r},i)=>e.jsx(ny,{children:e.jsxs(Sh,{ref:i,className:q("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...r,children:[e.jsx(fp,{}),e.jsx(ry,{className:q("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),e.jsx(xp,{})]})}));he.displayName=Sh.displayName;const N0=x.forwardRef(({className:t,...s},n)=>e.jsx(Ch,{ref:n,className:q("px-2 py-1.5 text-sm font-semibold",t),...s}));N0.displayName=Ch.displayName;const V=x.forwardRef(({className:t,children:s,...n},r)=>e.jsxs(Th,{ref:r,className:q("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[e.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(iy,{children:e.jsx(Ve,{className:"h-4 w-4"})})}),e.jsx(ay,{children:s})]}));V.displayName=Th.displayName;const k0=x.forwardRef(({className:t,...s},n)=>e.jsx(_h,{ref:n,className:q("-mx-1 my-1 h-px bg-muted",t),...s}));k0.displayName=_h.displayName;const Mn=x.forwardRef(({className:t,orientation:s="horizontal",decorative:n=!0,...r},i)=>e.jsx(Ah,{ref:i,decorative:n,orientation:s,className:q("shrink-0 bg-border",s==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",t),...r}));Mn.displayName=Ah.displayName;function In({className:t,...s}){return e.jsx("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:e.jsx("table",{"data-slot":"table",className:q("w-full caption-bottom text-sm",t),...s})})}function En({className:t,...s}){return e.jsx("thead",{"data-slot":"table-header",className:q("[&_tr]:border-b",t),...s})}function Ln({className:t,...s}){return e.jsx("tbody",{"data-slot":"table-body",className:q("[&_tr:last-child]:border-0",t),...s})}function _t({className:t,...s}){return e.jsx("tr",{"data-slot":"table-row",className:q("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",t),...s})}function de({className:t,...s}){return e.jsx("th",{"data-slot":"table-head",className:q("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...s})}function ue({className:t,...s}){return e.jsx("td",{"data-slot":"table-cell",className:q("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...s})}const bt=x.forwardRef(({className:t,...s},n)=>e.jsx("textarea",{className:q("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:n,...s}));bt.displayName="Textarea";const zc=cy,ho=x.forwardRef(({className:t,...s},n)=>e.jsx(Dh,{ref:n,className:q("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",t),...s}));ho.displayName=Dh.displayName;const Kt=x.forwardRef(({className:t,...s},n)=>e.jsx(Ph,{ref:n,className:q("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",t),...s}));Kt.displayName=Ph.displayName;const Gt=x.forwardRef(({className:t,...s},n)=>e.jsx(Mh,{ref:n,className:q("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...s}));Gt.displayName=Mh.displayName;const Ct=x.forwardRef(({className:t,...s},n)=>e.jsx(Ih,{ref:n,className:q("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...s,children:e.jsx(dy,{className:q("flex items-center justify-center text-current"),children:e.jsx(Ve,{className:"h-4 w-4"})})}));Ct.displayName=Ih.displayName;var po="Switch",[z0,eP]=pc(po),[S0,C0]=z0(po),gp=x.forwardRef((t,s)=>{const{__scopeSwitch:n,name:r,checked:i,defaultChecked:a,required:o,disabled:l,value:c="on",onCheckedChange:d,form:m,...u}=t,[h,p]=x.useState(null),b=Dn(s,v=>p(v)),f=x.useRef(!1),y=h?m||!!h.closest("form"):!0,[w,j]=Eh({prop:i,defaultProp:a??!1,onChange:d,caller:po});return e.jsxs(S0,{scope:n,checked:w,disabled:l,children:[e.jsx(on.button,{type:"button",role:"switch","aria-checked":w,"aria-required":o,"data-state":wp(w),"data-disabled":l?"":void 0,disabled:l,value:c,...u,ref:b,onClick:ze(t.onClick,v=>{j(T=>!T),y&&(f.current=v.isPropagationStopped(),f.current||v.stopPropagation())})}),y&&e.jsx(bp,{control:h,bubbles:!f.current,name:r,value:c,checked:w,required:o,disabled:l,form:m,style:{transform:"translateX(-100%)"}})]})});gp.displayName=po;var jp="SwitchThumb",yp=x.forwardRef((t,s)=>{const{__scopeSwitch:n,...r}=t,i=C0(jp,n);return e.jsx(on.span,{"data-state":wp(i.checked),"data-disabled":i.disabled?"":void 0,...r,ref:s})});yp.displayName=jp;var T0="SwitchBubbleInput",bp=x.forwardRef(({__scopeSwitch:t,control:s,checked:n,bubbles:r=!0,...i},a)=>{const o=x.useRef(null),l=Dn(o,a),c=uy(n),d=my(s);return x.useEffect(()=>{const m=o.current;if(!m)return;const u=window.HTMLInputElement.prototype,p=Object.getOwnPropertyDescriptor(u,"checked").set;if(c!==n&&p){const b=new Event("click",{bubbles:r});p.call(m,n),m.dispatchEvent(b)}},[c,n,r]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...i,tabIndex:-1,ref:l,style:{...i.style,...d,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});bp.displayName=T0;function wp(t){return t?"checked":"unchecked"}var vp=gp,_0=yp;const es=x.forwardRef(({className:t,...s},n)=>e.jsx(vp,{className:q("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...s,ref:n,children:e.jsx(_0,{className:q("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));es.displayName=vp.displayName;const Ds=py,Ps=fy,Ms=xy,ps=x.forwardRef(({className:t,sideOffset:s=4,...n},r)=>e.jsx(hy,{children:e.jsx(Lh,{ref:r,sideOffset:s,className:q("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",t),...n})}));ps.displayName=Lh.displayName;const Sc=yy,A0=gy,Np=x.forwardRef(({className:t,...s},n)=>e.jsx(Oh,{ref:n,className:q("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...s}));Np.displayName=Oh.displayName;const fo=x.forwardRef(({className:t,children:s,...n},r)=>e.jsxs(A0,{children:[e.jsx(Np,{}),e.jsxs(Rh,{ref:r,className:q("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...n,children:[s,e.jsxs(jy,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(dt,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));fo.displayName=Rh.displayName;const xo=({className:t,...s})=>e.jsx("div",{className:q("flex flex-col space-y-1.5 text-center sm:text-left",t),...s});xo.displayName="DialogHeader";const go=({className:t,...s})=>e.jsx("div",{className:q("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s});go.displayName="DialogFooter";const jo=x.forwardRef(({className:t,...s},n)=>e.jsx($h,{ref:n,className:q("text-lg font-semibold leading-none tracking-tight",t),...s}));jo.displayName=$h.displayName;const D0=x.forwardRef(({className:t,...s},n)=>e.jsx(qh,{ref:n,className:q("text-sm text-muted-foreground",t),...s}));D0.displayName=qh.displayName;const Qt=x.forwardRef(({className:t,value:s,...n},r)=>e.jsx(Fh,{ref:r,className:q("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",t),...n,children:e.jsx(by,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(s||0)}%)`}})}));Qt.displayName=Fh.displayName;const P0=({onClose:t})=>{const{mutate:s}=no(),{menuItems:n}=Qh(),{data:r}=We(),i=()=>{t&&t()};return e.jsxs("div",{className:"flex h-full w-64 flex-col border-r bg-background",children:[e.jsxs("div",{className:"flex h-16 items-center justify-between border-b px-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ri,{className:"h-6 w-6 mr-2"}),e.jsx("span",{className:"font-semibold",children:"Smart Up"})]}),t&&e.jsx(I,{variant:"ghost",size:"sm",onClick:t,className:"lg:hidden",children:e.jsx(dt,{className:"h-4 w-4"})})]}),e.jsx(yr,{className:"flex-1 px-3 py-4",children:e.jsx("nav",{className:"space-y-4",children:n.map(a=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs(hr,{to:a.route??"/",onClick:i,className:({isActive:o})=>q("flex items-center justify-between rounded-md px-3 py-2 text-sm font-semibold transition-colors hover:bg-accent hover:text-accent-foreground",o?"bg-accent text-accent-foreground":"text-foreground"),children:[e.jsxs("span",{className:"flex items-center",children:[a.icon&&e.jsx("span",{className:"mr-3",children:a.icon}),a.label]}),a.children&&a.children.length>0&&e.jsx(Xt,{className:"h-4 w-4 opacity-60"})]}),a.children&&a.children.length>0&&e.jsx("div",{className:"ml-3 border-l pl-3 space-y-1",children:a.children.map(o=>e.jsxs(hr,{to:o.route??"/",onClick:i,className:({isActive:l})=>q("flex items-center rounded-md px-3 py-2 text-sm transition-colors hover:bg-accent hover:text-accent-foreground",l?"bg-accent text-accent-foreground":"text-muted-foreground"),children:[o.icon&&e.jsx("span",{className:"mr-3",children:o.icon}),o.label]},o.key))})]},a.key))})}),e.jsx(Mn,{}),e.jsx(mp,{className:"border-b"}),e.jsx("div",{className:"p-4",children:e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>{s(),t&&t()},className:"w-full justify-start",children:[e.jsx(lo,{className:"mr-2 h-4 w-4"}),"Logout"]})})]})},M0=({children:t})=>{const[s,n]=x.useState(!1),r=()=>{n(!s)};return e.jsx("div",{className:"min-h-screen bg-stone-200 relative overflow-x-hidden",children:e.jsxs("div",{className:"flex relative",children:[s&&e.jsx("div",{className:"fixed inset-0 z-40 bg-purple-900/20 backdrop-blur-sm lg:hidden",onClick:()=>n(!1)}),e.jsx("aside",{className:`
            h-screen w-64 transform transition-transform duration-300 ease-in-out
            fixed left-0 top-0 z-50
            ${s?"translate-x-0":"-translate-x-full"}
            lg:translate-x-0
            bg-background/95 backdrop-blur-md border-r border-purple-200/20
          `,children:e.jsx(P0,{onClose:()=>n(!1)})}),e.jsxs("main",{className:"flex-1 lg:ml-64 min-w-0 relative z-10",children:[e.jsxs("div",{className:"sticky top-0 z-30 flex h-16 items-center border-b border-purple-200/20 bg-background/80 backdrop-blur-md px-4 lg:hidden",children:[e.jsx(I,{variant:"ghost",size:"sm",onClick:r,className:"mr-2 hover:bg-purple-100/20 hover:text-purple-700",children:e.jsx(Ri,{className:"h-6 w-6"})}),e.jsx("span",{className:"font-semibold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent",children:"Smart Up"})]}),t]})]})})},I0=()=>e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Admin Dashboard"}),e.jsx("p",{children:"Welcome to admin panel"})]}),E0=[e.jsx(W,{path:"dashboard/overview",element:e.jsx(I0,{})},"dashboard-overview")],G=({children:t})=>e.jsx("div",{className:"p-2 md:p-12 space-y-6 max-w-7xl mx-auto",children:t}),L0=({course:t,open:s,onOpenChange:n,onAccessUpdate:r})=>{const{open:i}=jc(),[a,o]=x.useState(""),[l,c]=x.useState(""),[d,m]=x.useState(!1),{data:u}=Y({resource:"groups",filters:[{field:"is_active",operator:"eq",value:!0}],pagination:{pageSize:1e3},sorters:[{field:"name",order:"asc"}],queryOptions:{enabled:s}}),{data:h}=Y({resource:"users",filters:[{field:"role",operator:"eq",value:"teacher"},{field:"is_active",operator:"eq",value:!0}],pagination:{pageSize:1e3},sorters:[{field:"full_name",order:"asc"}],queryOptions:{enabled:s}}),{data:p,refetch:b}=Y({resource:"course_access",filters:t?[{field:"course_id",operator:"eq",value:t.id}]:[],pagination:{pageSize:1e4},queryOptions:{enabled:s&&!!t}}),f=x.useMemo(()=>u?.data??[],[u]),y=x.useMemo(()=>h?.data??[],[h]),w=x.useMemo(()=>p?.data??[],[p]),j=x.useMemo(()=>{if(!t)return{groupAccess:{},teacherAccess:{}};const _={},g={};return w.forEach(C=>{C.group_id&&(_[C.group_id]=!0),C.teacher_id&&(g[C.teacher_id]=!0)}),{groupAccess:_,teacherAccess:g}},[t,w]),v=x.useMemo(()=>f.filter(_=>!a||_.name.toLowerCase().includes(a.toLowerCase())||_.academic_year.includes(a)),[f,a]),T=x.useMemo(()=>y.filter(_=>!l||_.full_name.toLowerCase().includes(l.toLowerCase())||_.email.toLowerCase().includes(l.toLowerCase())),[y,l]);x.useEffect(()=>{s||(o(""),c(""))},[s]);const z=async(_,g)=>{if(t){m(!0);try{if(g){const{error:C}=await J.from("course_access").delete().eq("course_id",t.id).eq("group_id",_);if(C)throw C}else{const{error:C}=await J.from("course_access").insert({course_id:t.id,group_id:_,teacher_id:null});if(C)throw C}i?.({type:"success",message:g?"Dostp usunity":"Dostp przyznany"}),b(),r()}catch{i?.({type:"error",message:"Wystpi bd podczas zapisywania"})}finally{m(!1)}}},k=async(_,g)=>{if(t){m(!0);try{if(g){const{error:C}=await J.from("course_access").delete().eq("course_id",t.id).eq("teacher_id",_);if(C)throw C}else{const{error:C}=await J.from("course_access").insert({course_id:t.id,group_id:null,teacher_id:_});if(C)throw C}i?.({type:"success",message:g?"Dostp usunity":"Dostp przyznany"}),b(),r()}catch{i?.({type:"error",message:"Wystpi bd podczas zapisywania"})}finally{m(!1)}}},N=Object.values(j.groupAccess).filter(Boolean).length,S=Object.values(j.teacherAccess).filter(Boolean).length;return e.jsx(Sc,{open:s,onOpenChange:n,children:e.jsxs(fo,{className:"max-w-4xl max-h-[80vh]",children:[e.jsx(xo,{children:e.jsxs(jo,{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:t?.icon_emoji||""}),e.jsxs("div",{children:[e.jsx("div",{children:"Zarzdzaj dostpem do kursu"}),e.jsx("div",{className:"text-sm font-normal text-muted-foreground",children:t?.title})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 overflow-hidden",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"font-medium text-sm flex items-center gap-2",children:[e.jsx(pe,{className:"w-4 h-4"}),"Grupy z dostpem"]}),e.jsxs(H,{variant:"secondary",children:[N," z ",f.length]})]}),e.jsx(Z,{placeholder:"Szukaj grupy...",value:a,onChange:_=>o(_.target.value),className:"h-9"}),e.jsx(yr,{className:"h-[350px] border rounded-lg p-3",children:e.jsx("div",{className:"space-y-2",children:v.map(_=>{const g=j.groupAccess[_.id]||!1;return e.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg border-2 cursor-pointer transition-all ${g?"border-primary bg-primary/5":"border-transparent hover:bg-muted"}`,children:[e.jsx(Ct,{checked:g,onCheckedChange:()=>z(_.id,g),disabled:d}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:_.name}),e.jsx("div",{className:"text-xs text-muted-foreground",children:_.academic_year})]}),g&&e.jsx(Ve,{className:"w-4 h-4 text-primary"})]},_.id)})})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"font-medium text-sm flex items-center gap-2",children:[e.jsx(Ls,{className:"w-4 h-4"}),"Nauczyciele prowadzcy"]}),e.jsxs(H,{variant:"secondary",children:[S," z ",y.length]})]}),e.jsx(Z,{placeholder:"Szukaj nauczyciela...",value:l,onChange:_=>c(_.target.value),className:"h-9"}),e.jsx(yr,{className:"h-[350px] border rounded-lg p-3",children:e.jsx("div",{className:"space-y-2",children:T.map(_=>{const g=j.teacherAccess[_.id]||!1;return e.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg border-2 cursor-pointer transition-all ${g?"border-primary bg-primary/5":"border-transparent hover:bg-muted"}`,children:[e.jsx(Ct,{checked:g,onCheckedChange:()=>k(_.id,g),disabled:d}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:_.full_name}),e.jsx("div",{className:"text-xs text-muted-foreground",children:_.email})]}),g&&e.jsx(Ve,{className:"w-4 h-4 text-primary"})]},_.id)})})})]})]}),e.jsxs(go,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Kurs dostpny dla ",e.jsxs("strong",{children:[N," grup"]})," i"," ",e.jsxs("strong",{children:[S," nauczycieli"]})]}),e.jsx(I,{variant:"outline",onClick:()=>n(!1),children:"Zamknij"})]})]})})},O0=()=>{const[t,s]=x.useState(!1);return e.jsx(D,{className:"border-2 border-green-200/50 bg-gradient-to-br from-green-50/50 to-emerald-50/50 dark:from-green-950/20 dark:to-emerald-950/20",children:e.jsx(P,{className:"p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 rounded-xl bg-green-100 dark:bg-green-900/50 flex-shrink-0",children:e.jsx(ye,{className:"h-6 w-6 text-green-600 dark:text-green-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h3",{className:"font-semibold text-lg flex items-center gap-2",children:["Zarzdzanie dostpem do kurs贸w",e.jsx(vc,{className:"h-4 w-4 text-green-500"})]}),e.jsx("button",{onClick:()=>s(!t),className:"p-1.5 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-green-600 dark:text-green-400","aria-label":t?"Zwi szczeg贸y":"Rozwi szczeg贸y",children:t?e.jsx(ws,{className:"h-5 w-5"}):e.jsx(Xt,{className:"h-5 w-5"})})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Kontroluj, kt贸re grupy i nauczyciele maj dostp do poszczeg贸lnych kurs贸w."}),t&&e.jsxs("div",{className:"mt-4 space-y-4 animate-in slide-in-from-top-2 duration-200",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-900/50 rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900/50 rounded-lg flex-shrink-0",children:e.jsx(pe,{className:"h-4 w-4 text-green-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-sm",children:"Przypisz grupy"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Wybierz grupy, kt贸re bd miay dostp do kursu"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900/50 rounded-lg flex-shrink-0",children:e.jsx(Ls,{className:"h-4 w-4 text-green-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-sm",children:"Dodaj nauczycieli"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Wska偶 nauczycieli prowadzcych zajcia"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900/50 rounded-lg flex-shrink-0",children:e.jsx(ao,{className:"h-4 w-4 text-green-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-sm",children:"Kontroluj dostp"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Zmiany s zapisywane automatycznie"})]})]})]}),e.jsx("div",{className:"p-3 bg-green-50 dark:bg-green-950/30 rounded-lg",children:e.jsxs("p",{className:"text-xs text-green-700 dark:text-green-300 flex items-start gap-2",children:[e.jsx(qt,{className:"h-3 w-3 mt-0.5 flex-shrink-0"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Wa偶ne:"}),' Najpierw utw贸rz grupy w module "Grupy i klasy", a nastpnie przypisz je do kurs贸w tutaj.']})]})})]})]})]})})})},R0=()=>{const[t,s]=x.useState(""),[n,r]=x.useState(null),[i,a]=x.useState(!1),[o,l]=x.useState({key:"title",direction:"asc"}),{data:c,isLoading:d}=Y({resource:"courses",filters:[{field:"is_published",operator:"eq",value:!0}],pagination:{pageSize:1e3},sorters:[{field:"title",order:"asc"}]}),{data:m,refetch:u}=Y({resource:"course_access",pagination:{pageSize:1e4}}),h=x.useMemo(()=>c?.data??[],[c]),p=x.useMemo(()=>m?.data??[],[m]),b=x.useMemo(()=>{const j={};return h.forEach(v=>{const T=p.filter(z=>z.course_id===v.id);j[v.id]={groupCount:T.filter(z=>z.group_id).length,teacherCount:T.filter(z=>z.teacher_id).length}}),j},[h,p]),f=x.useMemo(()=>{const j=h.filter(v=>t===""||v.title.toLowerCase().includes(t.toLowerCase()));return o.key&&j.sort((v,T)=>{let z,k;return o.key==="groupCount"?(z=b[v.id]?.groupCount||0,k=b[T.id]?.groupCount||0):o.key==="teacherCount"?(z=b[v.id]?.teacherCount||0,k=b[T.id]?.teacherCount||0):o.key&&o.key in v&&(z=v[o.key],k=T[o.key]),z<k?o.direction==="asc"?-1:1:z>k?o.direction==="asc"?1:-1:0}),j},[h,t,o,b]),y=j=>{l(v=>({key:j,direction:v.key===j&&v.direction==="asc"?"desc":"asc"}))},w=({column:j})=>o.key!==j?e.jsx(ws,{className:"w-4 h-4 opacity-20"}):o.direction==="asc"?e.jsx(ws,{className:"w-4 h-4"}):e.jsx(Xt,{className:"w-4 h-4"});return e.jsxs(G,{children:[e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Dostp do kurs贸w"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Zarzdzaj dostpem grup i nauczycieli do kurs贸w"})]}),e.jsx(O0,{}),e.jsx(D,{children:e.jsx(P,{className:"p-4",children:e.jsxs("div",{className:"relative",children:[e.jsx($i,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(Z,{placeholder:"Szukaj kursu po nazwie...",value:t,onChange:j=>s(j.target.value),className:"pl-9"})]})})}),e.jsx(D,{children:e.jsx(P,{className:"p-0",children:d?e.jsx("div",{className:"p-8 text-center text-muted-foreground",children:"adowanie kurs贸w..."}):f.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(ye,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground/50"}),e.jsx("p",{className:"text-muted-foreground",children:t?"Nie znaleziono kurs贸w":"Brak kurs贸w w systemie"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(In,{children:[e.jsx(En,{children:e.jsxs(_t,{children:[e.jsx(de,{className:"cursor-pointer select-none",onClick:()=>y("title"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Kurs",e.jsx(w,{column:"title"})]})}),e.jsx(de,{className:"cursor-pointer select-none text-center",onClick:()=>y("groupCount"),children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:["Grupy z dostpem",e.jsx(w,{column:"groupCount"})]})}),e.jsx(de,{className:"cursor-pointer select-none text-center",onClick:()=>y("teacherCount"),children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:["Nauczyciele",e.jsx(w,{column:"teacherCount"})]})}),e.jsx(de,{className:"text-center",children:"Akcje"})]})}),e.jsx(Ln,{children:f.map(j=>{const v=b[j.id]||{groupCount:0,teacherCount:0};return e.jsxs(_t,{children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:j.icon_emoji||""}),e.jsx("div",{className:"font-medium",children:j.title})]})}),e.jsx(ue,{className:"text-center",children:e.jsxs(H,{variant:v.groupCount>0?"default":"secondary",className:"gap-1",children:[e.jsx(pe,{className:"w-3 h-3"}),v.groupCount," grup"]})}),e.jsx(ue,{className:"text-center",children:e.jsxs(H,{variant:v.teacherCount>0?"default":"secondary",className:"gap-1",children:[e.jsx(wc,{className:"w-3 h-3"}),v.teacherCount," nauczycieli"]})}),e.jsx(ue,{className:"text-center",children:e.jsxs(I,{size:"sm",variant:"outline",onClick:()=>{r(j),a(!0)},children:[e.jsx(vc,{className:"w-4 h-4 mr-1"}),"Zarzdzaj dostpem"]})})]},j.id)})})]})})})}),e.jsxs("div",{className:"text-sm text-muted-foreground text-center",children:["Wywietlono ",f.length," z ",h.length," kurs贸w"]})]}),e.jsx(L0,{course:n,open:i,onOpenChange:a,onAccessUpdate:u})]})},$0=()=>{const[t,s]=x.useState(!1);return e.jsx(D,{className:"border-2 border-purple-200/50 bg-gradient-to-br from-purple-50/50 to-pink-50/50 dark:from-purple-950/20 dark:to-pink-950/20",children:e.jsx(P,{className:"p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 rounded-xl bg-purple-100 dark:bg-purple-900/50 flex-shrink-0",children:e.jsx(nb,{className:"h-6 w-6 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h3",{className:"font-semibold text-lg flex items-center gap-2",children:["Jak zarzdza u偶ytkownikami?",e.jsx(rt,{className:"h-4 w-4 text-purple-500"})]}),e.jsx("button",{onClick:()=>s(!t),className:"p-1.5 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-purple-600 dark:text-purple-400","aria-label":t?"Zwi szczeg贸y":"Rozwi szczeg贸y",children:t?e.jsx(ws,{className:"h-5 w-5"}):e.jsx(Xt,{className:"h-5 w-5"})})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"System pozwala na atwe zarzdzanie rolami i statusami u偶ytkownik贸w."}),t&&e.jsxs("div",{className:"mt-4 space-y-4 animate-in slide-in-from-top-2 duration-200",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-purple-100 dark:bg-purple-900/50 text-sm font-bold text-purple-600 flex-shrink-0",children:"1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-sm mb-1",children:"Znajd藕 u偶ytkownika"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"U偶yj wyszukiwarki lub filtr贸w, aby znale藕 konkretnego u偶ytkownika"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-purple-100 dark:bg-purple-900/50 text-sm font-bold text-purple-600 flex-shrink-0",children:"2"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-sm mb-1",children:"Zmie rol"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Wybierz now rol z rozwijanej listy: Ucze, Nauczyciel lub Administrator"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-purple-100 dark:bg-purple-900/50 text-sm font-bold text-purple-600 flex-shrink-0",children:"3"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-sm mb-1",children:"Zarzdzaj statusem"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"U偶yj przecznika, aby aktywowa lub dezaktywowa konto u偶ytkownika"})]})]})]}),e.jsx("div",{className:"p-3 bg-purple-50 dark:bg-purple-950/30 rounded-lg",children:e.jsxs("p",{className:"text-xs text-purple-700 dark:text-purple-300 flex items-start gap-2",children:[e.jsx(ao,{className:"h-3 w-3 mt-0.5 flex-shrink-0"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Wskaz贸wka:"})," Administratorzy maj peen dostp do systemu. Przyznawaj t rol z rozwag."]})]})})]})]})]})})})},q0=()=>{const{open:t}=jc(),[s,n]=x.useState(""),[r,i]=x.useState("all"),[a,o]=x.useState("all"),[l,c]=x.useState({key:"full_name",direction:"asc"}),{data:d,isLoading:m,refetch:u}=Y({resource:"users",pagination:{pageSize:1e4},sorters:[{field:"full_name",order:"asc"}]}),{mutate:h,isLoading:p}=Cr(),b=d?.data??[],f=x.useMemo(()=>{const k=b.filter(N=>{const S=s===""||N.full_name.toLowerCase().includes(s.toLowerCase())||N.email.toLowerCase().includes(s.toLowerCase()),_=r==="all"||N.role===r,g=a==="all"||(a==="active"?N.is_active:!N.is_active);return S&&_&&g});return l.key&&k.sort((N,S)=>{const _=N[l.key],g=S[l.key];return _<g?l.direction==="asc"?-1:1:_>g?l.direction==="asc"?1:-1:0}),k},[b,s,r,a,l]),y=x.useMemo(()=>({total:b.length,students:b.filter(k=>k.role==="student").length,teachers:b.filter(k=>k.role==="teacher").length,admins:b.filter(k=>k.role==="admin").length,active:b.filter(k=>k.is_active).length,inactive:b.filter(k=>!k.is_active).length}),[b]),w=k=>{c(N=>({key:k,direction:N.key===k&&N.direction==="asc"?"desc":"asc"}))},j=async(k,N)=>{h({resource:"users",id:k,values:{is_active:!N},successNotification:()=>({message:N?"Konto dezaktywowane":"Konto aktywowane",type:"success"})},{onSuccess:()=>u()})},v=async(k,N)=>{h({resource:"users",id:k,values:{role:N},successNotification:()=>({message:"Rola zmieniona",type:"success"})},{onSuccess:()=>u()})},T=k=>{switch(k){case"admin":return e.jsxs(H,{variant:"destructive",children:[e.jsx(ao,{className:"w-3 h-3 mr-1"}),"Administrator"]});case"teacher":return e.jsxs(H,{className:"bg-blue-500",children:[e.jsx(wc,{className:"w-3 h-3 mr-1"}),"Nauczyciel"]});default:return e.jsxs(H,{className:"bg-green-500",children:[e.jsx(tn,{className:"w-3 h-3 mr-1"}),"Ucze"]})}},z=({column:k})=>l.key!==k?e.jsx(ws,{className:"w-4 h-4 opacity-20"}):l.direction==="asc"?e.jsx(ws,{className:"w-4 h-4"}):e.jsx(Xt,{className:"w-4 h-4"});return e.jsx(G,{children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Zarzdzanie u偶ytkownikami"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Zmie role u偶ytkownik贸w i zarzdzaj ich dostpem do systemu"})]}),e.jsx($0,{}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-3",children:[e.jsx(D,{children:e.jsxs(P,{className:"p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold",children:y.total}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Wszyscy"})]})}),e.jsx(D,{className:"border-green-200 bg-green-50/50 dark:bg-green-950/20",children:e.jsxs(P,{className:"p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:y.students}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Uczniowie"})]})}),e.jsx(D,{className:"border-blue-200 bg-blue-50/50 dark:bg-blue-950/20",children:e.jsxs(P,{className:"p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:y.teachers}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Nauczyciele"})]})}),e.jsx(D,{className:"border-red-200 bg-red-50/50 dark:bg-red-950/20",children:e.jsxs(P,{className:"p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:y.admins}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Admini"})]})}),e.jsx(D,{children:e.jsxs(P,{className:"p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:y.active}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Aktywni"})]})}),e.jsx(D,{children:e.jsxs(P,{className:"p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:y.inactive}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Nieaktywni"})]})})]}),e.jsxs(D,{children:[e.jsx($,{children:e.jsxs(R,{className:"text-base flex items-center gap-2",children:[e.jsx(Yh,{className:"w-4 h-4"}),"Filtry"]})}),e.jsx(P,{children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx($i,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(Z,{placeholder:"Szukaj po imieniu lub emailu...",value:s,onChange:k=>n(k.target.value),className:"pl-9"})]})}),e.jsxs(fe,{value:r,onValueChange:k=>i(k),children:[e.jsx(me,{className:"w-[180px]",children:e.jsx(xe,{placeholder:"Wszystkie role"})}),e.jsxs(he,{children:[e.jsx(V,{value:"all",children:"Wszystkie role"}),e.jsx(V,{value:"student",children:"Tylko uczniowie"}),e.jsx(V,{value:"teacher",children:"Tylko nauczyciele"}),e.jsx(V,{value:"admin",children:"Tylko admini"})]})]}),e.jsxs(fe,{value:a,onValueChange:k=>o(k),children:[e.jsx(me,{className:"w-[180px]",children:e.jsx(xe,{placeholder:"Wszystkie statusy"})}),e.jsxs(he,{children:[e.jsx(V,{value:"all",children:"Wszystkie statusy"}),e.jsx(V,{value:"active",children:"Tylko aktywni"}),e.jsx(V,{value:"inactive",children:"Tylko nieaktywni"})]})]})]})})]}),e.jsx(D,{children:e.jsx(P,{className:"p-0",children:m?e.jsx("div",{className:"p-8 text-center text-muted-foreground",children:"adowanie u偶ytkownik贸w..."}):f.length===0?e.jsx("div",{className:"p-8 text-center text-muted-foreground",children:"Nie znaleziono u偶ytkownik贸w speniajcych kryteria"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(In,{children:[e.jsx(En,{children:e.jsxs(_t,{children:[e.jsx(de,{className:"cursor-pointer select-none",onClick:()=>w("full_name"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Imi i nazwisko",e.jsx(z,{column:"full_name"})]})}),e.jsx(de,{className:"cursor-pointer select-none",onClick:()=>w("email"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Email",e.jsx(z,{column:"email"})]})}),e.jsx(de,{className:"cursor-pointer select-none",onClick:()=>w("role"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Rola",e.jsx(z,{column:"role"})]})}),e.jsx(de,{children:"Zmie rol"}),e.jsx(de,{className:"cursor-pointer select-none text-center",onClick:()=>w("is_active"),children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:["Status",e.jsx(z,{column:"is_active"})]})})]})}),e.jsx(Ln,{children:f.map(k=>e.jsxs(_t,{className:k.is_active?"":"opacity-60",children:[e.jsx(ue,{className:"font-medium",children:k.full_name}),e.jsx(ue,{className:"text-sm text-muted-foreground",children:k.email}),e.jsx(ue,{children:T(k.role)}),e.jsx(ue,{children:e.jsxs(fe,{value:k.role,onValueChange:N=>v(k.id,N),disabled:p,children:[e.jsx(me,{className:"w-[140px] h-8",children:e.jsx(xe,{})}),e.jsxs(he,{children:[e.jsx(V,{value:"student",children:"Ucze"}),e.jsx(V,{value:"teacher",children:"Nauczyciel"}),e.jsx(V,{value:"admin",children:"Administrator"})]})]})}),e.jsx(ue,{className:"text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(es,{checked:k.is_active,onCheckedChange:()=>j(k.id,k.is_active),disabled:p}),e.jsx("span",{className:"text-sm",children:k.is_active?e.jsx(H,{variant:"outline",className:"text-green-600",children:"Aktywny"}):e.jsx(H,{variant:"destructive",children:"Nieaktywny"})})]})})]},k.id))})]})})})}),e.jsxs("div",{className:"text-sm text-muted-foreground text-center",children:["Wywietlono ",f.length," z ",b.length," u偶ytkownik贸w"]})]})})},F0=({group:t,open:s,onOpenChange:n,onMembersUpdate:r})=>{const{open:i}=jc(),[a,o]=x.useState(""),[l,c]=x.useState(new Set),{data:d}=Y({resource:"users",filters:[{field:"role",operator:"eq",value:"student"},{field:"is_active",operator:"eq",value:!0}],pagination:{pageSize:1e4},sorters:[{field:"full_name",order:"asc"}],queryOptions:{enabled:s}}),{data:m,refetch:u}=Y({resource:"group_members",filters:t?[{field:"group_id",operator:"eq",value:t.id}]:[],pagination:{pageSize:1e4},meta:{select:`
        *,
        users!inner(full_name, email)
      `},queryOptions:{enabled:s&&!!t}}),h=x.useMemo(()=>d?.data??[],[d]),p=x.useMemo(()=>m?.data??[],[m]),b=x.useMemo(()=>t?p.filter(v=>v.group_id===t.id):[],[t,p]),f=x.useMemo(()=>{if(!t)return[];const v=new Set(b.map(T=>T.user_id));return h.filter(T=>!(v.has(T.id)||a&&!T.full_name.toLowerCase().includes(a.toLowerCase())))},[h,t,b,a]);x.useEffect(()=>{s||(c(new Set),o(""))},[s]);const y=async()=>{if(!(!t||l.size===0))try{const v=Array.from(l).map(z=>({group_id:t.id,user_id:z})),{error:T}=await J.from("group_members").insert(v);if(T)throw T;i?.({type:"success",message:`Dodano ${l.size} uczni贸w do grupy`}),c(new Set),o(""),u(),r()}catch{i?.({type:"error",message:"Nie udao si doda uczni贸w"})}},w=async v=>{if(t)try{const{error:T}=await J.from("group_members").delete().eq("group_id",t.id).eq("user_id",v);if(T)throw T;i?.({type:"success",message:"Ucze usunity z grupy"}),u(),r()}catch{i?.({type:"error",message:"Nie udao si usun ucznia"})}},j=()=>{n(!1),c(new Set),o("")};return e.jsx(Sc,{open:s,onOpenChange:n,children:e.jsxs(fo,{className:"max-w-4xl max-h-[80vh]",children:[e.jsx(xo,{children:e.jsxs(jo,{children:["Zarzdzaj uczniami w grupie: ",t?.name]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 overflow-hidden",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"font-medium text-sm",children:["Uczniowie w grupie (",b.length,")"]}),e.jsx("div",{className:"border rounded-lg p-3 h-[400px] overflow-y-auto",children:b.length===0?e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"Brak uczni贸w w grupie"}):e.jsx("div",{className:"space-y-2",children:b.map(v=>e.jsxs("div",{className:"flex items-center justify-between p-2 rounded hover:bg-muted",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm",children:v.users?.full_name}),e.jsx("div",{className:"text-xs text-muted-foreground",children:v.users?.email})]}),e.jsx(I,{size:"sm",variant:"ghost",onClick:()=>w(v.user_id),className:"text-red-600",children:e.jsx(rb,{className:"w-4 h-4"})})]},v.user_id))})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"font-medium text-sm",children:["Dostpni uczniowie (",f.length,")"]}),e.jsx(Z,{placeholder:"Szukaj ucznia...",value:a,onChange:v=>o(v.target.value),className:"h-9"}),e.jsx("div",{className:"border rounded-lg p-3 h-[350px] overflow-y-auto",children:f.length===0?e.jsx("p",{className:"text-center text-muted-foreground py-8",children:a?"Nie znaleziono uczni贸w":"Wszyscy uczniowie s ju偶 w grupie"}):e.jsx("div",{className:"space-y-2",children:f.map(v=>e.jsxs("label",{className:"flex items-center gap-3 p-2 rounded hover:bg-muted cursor-pointer",children:[e.jsx(Ct,{checked:l.has(v.id),onCheckedChange:T=>{const z=new Set(l);T?z.add(v.id):z.delete(v.id),c(z)}}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-sm",children:v.full_name}),e.jsx("div",{className:"text-xs text-muted-foreground",children:v.email})]})]},v.id))})}),l.size>0&&e.jsxs(I,{onClick:y,className:"w-full",children:[e.jsx(Ls,{className:"w-4 h-4 mr-2"}),"Dodaj zaznaczonych (",l.size,")"]})]})]}),e.jsx(go,{children:e.jsx(I,{variant:"outline",onClick:j,children:"Zamknij"})})]})})},U0=()=>{const[t,s]=x.useState(!1);return e.jsx(D,{className:"border-2 border-blue-200/50 bg-gradient-to-br from-blue-50/50 to-indigo-50/50 dark:from-blue-950/20 dark:to-indigo-950/20",children:e.jsx(P,{className:"p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 rounded-xl bg-blue-100 dark:bg-blue-900/50 flex-shrink-0",children:e.jsx(Se,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h3",{className:"font-semibold text-lg flex items-center gap-2",children:["System zarzdzania grupami",e.jsx(pe,{className:"h-4 w-4 text-blue-500"})]}),e.jsx("button",{onClick:()=>s(!t),className:"p-1.5 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-blue-600 dark:text-blue-400","aria-label":t?"Zwi szczeg贸y":"Rozwi szczeg贸y",children:t?e.jsx(ws,{className:"h-5 w-5"}):e.jsx(Xt,{className:"h-5 w-5"})})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Tw贸rz grupy i klasy, przypisuj uczni贸w i organizuj struktur nauczania."}),t&&e.jsxs("div",{className:"mt-4 space-y-4 animate-in slide-in-from-top-2 duration-200",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-sm text-blue-700 dark:text-blue-300",children:"Tworzenie grup"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(is,{className:"h-3 w-3 mt-0.5 text-blue-500 flex-shrink-0"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:'Kliknij "Nowa grupa"'})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(is,{className:"h-3 w-3 mt-0.5 text-blue-500 flex-shrink-0"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:'Nadaj nazw (np. "Klasa 1A")'})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(is,{className:"h-3 w-3 mt-0.5 text-blue-500 flex-shrink-0"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Okrel rok akademicki"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-sm text-blue-700 dark:text-blue-300",children:"Zarzdzanie uczniami"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(is,{className:"h-3 w-3 mt-0.5 text-blue-500 flex-shrink-0"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:'Kliknij "Zarzdzaj" przy grupie'})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(is,{className:"h-3 w-3 mt-0.5 text-blue-500 flex-shrink-0"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Dodaj uczni贸w z listy"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(is,{className:"h-3 w-3 mt-0.5 text-blue-500 flex-shrink-0"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Usu niepotrzebnych czonk贸w"})]})]})]})]}),e.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-950/30 rounded-lg",children:e.jsxs("p",{className:"text-xs text-blue-700 dark:text-blue-300 flex items-start gap-2",children:[e.jsx(Ye,{className:"h-3 w-3 mt-0.5 flex-shrink-0"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Pro tip:"})," Grupy mo偶na dezaktywowa bez usuwania - przydatne na koniec roku szkolnego!"]})]})})]})]})]})})})},B0=()=>{const[t,s]=x.useState(null),[n,r]=x.useState(!1),[i,a]=x.useState(!1),[o,l]=x.useState(""),[c,d]=x.useState("2024/2025"),[m,u]=x.useState(""),[h,p]=x.useState({key:"name",direction:"asc"}),{data:b,isLoading:f,refetch:y}=Y({resource:"groups",pagination:{pageSize:1e3},sorters:[{field:"name",order:"asc"}]}),{data:w,refetch:j}=Y({resource:"group_members",pagination:{pageSize:1e4}}),{mutate:v,isLoading:T}=os(),{mutate:z}=Cr(),{mutate:k}=zn(),N=x.useMemo(()=>b?.data??[],[b]),S=x.useMemo(()=>w?.data??[],[w]),_=x.useMemo(()=>{const L={};return N.forEach(U=>{L[U.id]=S.filter(F=>F.group_id===U.id).length}),L},[N,S]),g=x.useMemo(()=>{const L=N.filter(U=>m===""||U.name.toLowerCase().includes(m.toLowerCase())||U.academic_year.includes(m));return h.key&&L.sort((U,F)=>{let ae,B;return h.key==="memberCount"?(ae=_[U.id]||0,B=_[F.id]||0):(ae=U[h.key],B=F[h.key]),ae<B?h.direction==="asc"?-1:1:ae>B?h.direction==="asc"?1:-1:0}),L},[N,m,h,_]),C=L=>{p(U=>({key:L,direction:U.key===L&&U.direction==="asc"?"desc":"asc"}))},A=()=>{o.trim()&&v({resource:"groups",values:{name:o,academic_year:c,vendor_id:1},successNotification:()=>({message:"Grupa zostaa utworzona",type:"success"})},{onSuccess:()=>{r(!1),l(""),y()}})},E=L=>{confirm("Czy na pewno chcesz usun t grup?")&&k({resource:"groups",id:L,successNotification:()=>({message:"Grupa zostaa usunita",type:"success"})},{onSuccess:()=>y()})},M=async L=>{z({resource:"groups",id:L.id,values:{is_active:!L.is_active},successNotification:()=>({message:L.is_active?"Grupa dezaktywowana":"Grupa aktywowana",type:"success"})},{onSuccess:()=>y()})},O=({column:L})=>h.key!==L?e.jsx(ws,{className:"w-4 h-4 opacity-20"}):h.direction==="asc"?e.jsx(ws,{className:"w-4 h-4"}):e.jsx(Xt,{className:"w-4 h-4"}),Q=f;return e.jsxs(G,{children:[e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Zarzdzanie grupami i klasami"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Tw贸rz grupy i przypisuj do nich uczni贸w"})]}),e.jsxs(I,{onClick:()=>r(!0),children:[e.jsx(Ie,{className:"w-4 h-4 mr-2"}),"Nowa grupa"]})]}),e.jsx(U0,{}),e.jsx(D,{children:e.jsx(P,{className:"p-4",children:e.jsxs("div",{className:"relative",children:[e.jsx($i,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(Z,{placeholder:"Szukaj grupy po nazwie lub roku akademickim...",value:m,onChange:L=>u(L.target.value),className:"pl-9"})]})})}),e.jsx(D,{children:e.jsx(P,{className:"p-0",children:Q?e.jsx("div",{className:"p-8 text-center text-muted-foreground",children:"adowanie grup..."}):g.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(pe,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground/50"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:m?"Nie znaleziono grup":"Brak grup w systemie"}),e.jsxs(I,{onClick:()=>r(!0),children:[e.jsx(Ie,{className:"w-4 h-4 mr-2"}),"Utw贸rz pierwsz grup"]})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(In,{children:[e.jsx(En,{children:e.jsxs(_t,{children:[e.jsx(de,{className:"cursor-pointer select-none",onClick:()=>C("name"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Nazwa grupy",e.jsx(O,{column:"name"})]})}),e.jsx(de,{className:"cursor-pointer select-none",onClick:()=>C("academic_year"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Rok akademicki",e.jsx(O,{column:"academic_year"})]})}),e.jsx(de,{className:"cursor-pointer select-none text-center",onClick:()=>C("memberCount"),children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:["Liczba uczni贸w",e.jsx(O,{column:"memberCount"})]})}),e.jsx(de,{className:"text-center",children:"Status"}),e.jsx(de,{className:"text-center",children:"Akcje"})]})}),e.jsx(Ln,{children:g.map(L=>e.jsxs(_t,{children:[e.jsx(ue,{className:"font-medium",children:L.name}),e.jsx(ue,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Tt,{className:"w-4 h-4 text-muted-foreground"}),L.academic_year]})}),e.jsx(ue,{className:"text-center",children:e.jsxs(H,{variant:"secondary",children:[_[L.id]||0," uczni贸w"]})}),e.jsx(ue,{className:"text-center",children:e.jsx(es,{checked:L.is_active,onCheckedChange:()=>M(L)})}),e.jsx(ue,{children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsxs(I,{size:"sm",variant:"outline",onClick:()=>{s(L),a(!0)},children:[e.jsx(pe,{className:"w-4 h-4 mr-1"}),"Zarzdzaj"]}),e.jsx(I,{size:"sm",variant:"ghost",onClick:()=>E(L.id),className:"text-red-600 hover:bg-red-50",children:e.jsx(ls,{className:"w-4 h-4"})})]})})]},L.id))})]})})})})]}),e.jsx(Sc,{open:n,onOpenChange:r,children:e.jsxs(fo,{children:[e.jsx(xo,{children:e.jsx(jo,{children:"Utw贸rz now grup"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(re,{htmlFor:"name",children:"Nazwa grupy"}),e.jsx(Z,{id:"name",value:o,onChange:L=>l(L.target.value),placeholder:"np. Klasa 1A"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(re,{htmlFor:"year",children:"Rok akademicki"}),e.jsx(Z,{id:"year",value:c,onChange:L=>d(L.target.value),placeholder:"np. 2024/2025"})]})]}),e.jsxs(go,{children:[e.jsx(I,{variant:"outline",onClick:()=>r(!1),children:"Anuluj"}),e.jsx(I,{onClick:A,disabled:T||!o.trim(),children:"Utw贸rz grup"})]})]})}),e.jsx(F0,{group:t,open:i,onOpenChange:a,onMembersUpdate:j})]})},V0={name:"permissions",list:"/admin/permissions",meta:{label:"Zarzdzanie dostpem",icon:e.jsx(ib,{className:"h-4 w-4"})}},W0={name:"permissions-users",list:"/admin/permissions/users",meta:{label:"U偶ytkownicy",icon:e.jsx(pe,{className:"h-4 w-4"}),parent:"permissions"}},K0={name:"permissions-groups",list:"/admin/permissions/groups",meta:{label:"Grupy i klasy",icon:e.jsx(ab,{className:"h-4 w-4"}),parent:"permissions"}},G0={name:"permissions-access",list:"/admin/permissions/access",meta:{label:"Dostp do kurs贸w",icon:e.jsx(Ve,{className:"h-4 w-4"}),parent:"permissions"}},Q0=[e.jsx(W,{path:"permissions",element:e.jsx(as,{to:"/admin/permissions/users",replace:!0})},"permissions-default"),e.jsx(W,{path:"permissions/users",element:e.jsx(q0,{})},"permissions-users"),e.jsx(W,{path:"permissions/groups",element:e.jsx(B0,{})},"permissions-groups"),e.jsx(W,{path:"permissions/access",element:e.jsx(R0,{})},"permissions-access")],Zo=[V0,W0,K0,G0],H0={"between-center":"flex justify-between items-center gap-2",center:"flex justify-center items-center gap-2",start:"flex justify-start items-center gap-2",end:"flex justify-end items-center gap-2"},X=({children:t,variant:s="between-center",className:n=""})=>{const r=H0[s],i=n?`${r} ${n}`:r;return e.jsx("div",{className:i,children:t})},Z0={"1-2-3":"grid gap-6 md:grid-cols-2 lg:grid-cols-3","1-2-2":"grid gap-6 md:grid-cols-2","1-1-1":"grid gap-6","2-2-4":"grid gap-6 grid-cols-2 lg:grid-cols-4"},wt=({children:t,variant:s="1-2-3",className:n=""})=>{const r=Z0[s],i=n?`${r} ${n}`:r;return e.jsx("div",{className:i,children:t})},kp=({current:t,pageSize:s,total:n,setCurrent:r,setPageSize:i,itemName:a="element贸w",pageSizeOptions:o=[10,20,50]})=>{const l=Math.ceil(n/s),c=(t-1)*s+1,d=Math.min(t*s,n),m=t>1,u=t<l,h=()=>{const p=[];if(l<=5)for(let f=1;f<=l;f++)p.push(f);else{p.push(1),t>3&&p.push("...");const f=Math.max(2,t-1),y=Math.min(l-1,t+1);for(let w=f;w<=y;w++)p.push(w);t<l-2&&p.push("..."),p.push(l)}return p};return n===0?null:e.jsxs(X,{className:"mt-6",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Pokazuje ",c,"-",d," z ",n," ",a]}),e.jsxs(X,{className:"gap-2",children:[i&&e.jsxs(fe,{value:s.toString(),onValueChange:p=>{i(parseInt(p)),r(1)},children:[e.jsx(me,{className:"w-[100px]",children:e.jsx(xe,{})}),e.jsx(he,{children:o.map(p=>e.jsxs(V,{value:p.toString(),children:[p," / str."]},p))})]}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>r(t-1),disabled:!m,children:e.jsx(ob,{className:"w-4 h-4"})}),e.jsx("div",{className:"hidden sm:flex gap-1",children:h().map((p,b)=>p==="..."?e.jsx("span",{className:"px-3 py-1 text-sm text-muted-foreground",children:"..."},`ellipsis-${b}`):e.jsx(I,{variant:t===p?"default":"outline",size:"sm",onClick:()=>r(p),className:"min-w-[40px]",children:p},p))}),e.jsxs("div",{className:"flex sm:hidden items-center px-3 text-sm",children:[t," / ",l]}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>r(t+1),disabled:!u,children:e.jsx(is,{className:"w-4 h-4"})})]})]})},Y0={card:{wrap:"space-y-0",title:"font-medium",description:"text-muted-foreground"},lg:{wrap:"space-y-0",title:"text-3xl font-bold tracking-tight",description:"text-muted-foreground"},md:{wrap:"space-y-0",title:"font-medium",description:"text-muted-foreground"},sm:{wrap:"space-y-1",title:"font-medium text-sm text-muted-foreground mb-1",description:"text-sm"}},_e=({title:t,description:s,variant:n="lg"})=>{const r=Y0[n],i=()=>{switch(n){case"lg":return e.jsx("h1",{className:r.title,children:t});case"md":return e.jsx("h2",{className:r.title,children:t});case"sm":return e.jsx("h3",{className:r.title,children:t});default:return e.jsx("h1",{className:r.title,children:t})}};return n==="card"?e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"text-lg font-semibold leading-tight flex items-center gap-2",children:t}),e.jsx(Oe,{className:"text-sm text-muted-foreground mt-2",children:s})]}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:r.wrap,children:[i(),e.jsx("p",{className:`prose ${r.description}`,children:s})]})})},J0=()=>{const{tableQuery:{data:t,isLoading:s,isError:n},current:r,setCurrent:i,pageSize:a,setFilters:o}=Hh({sorters:{initial:[{field:"created_at",order:"desc"}]}}),l=kc({isLoading:s,isError:n});return l||e.jsxs(G,{children:[e.jsx(_e,{title:"Organizacje",description:"Lista wszystkich organizacji w systemie"}),e.jsx(X,{children:e.jsx(Z,{placeholder:"Szukaj organizacji...",className:"max-w-sm",onChange:c=>{o([{operator:"or",value:[{field:"name",operator:"contains",value:c.target.value},{field:"subdomain",operator:"contains",value:c.target.value}]}])}})}),e.jsx(wt,{children:t?.data?.map(c=>e.jsxs(D,{children:[e.jsx($,{children:e.jsxs(X,{children:[e.jsxs(R,{className:"flex items-center gap-2",children:[e.jsx(Jh,{className:"w-5 h-5"}),c.name]}),e.jsx(H,{variant:c.is_active?"default":"secondary",children:c.is_active?"Aktywna":"Nieaktywna"})]})}),e.jsxs(P,{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(lb,{className:"w-3 h-3"}),e.jsxs("span",{children:[c.subdomain,".example.com"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(Tt,{className:"w-3 h-3"}),e.jsxs("span",{children:["Utworzono: ",new Date(c.created_at).toLocaleDateString("pl-PL")]})]})]})]},c.id))}),e.jsx(kp,{current:r,pageSize:a,total:t?.total||0,setCurrent:i,itemName:"organizacji"})]})},ru={name:"vendors",list:"/admin/vendors",meta:{label:"Organizacje",icon:e.jsx(Jh,{className:"h-4 w-4"})}},X0=[e.jsx(W,{path:"vendors",element:e.jsx(J0,{})},"vendors-list")],ew=[...E0,...Q0,...X0],tw=()=>e.jsx(to,{children:e.jsxs(W,{element:e.jsx(M0,{children:e.jsx(fc,{})}),children:[e.jsx(W,{index:!0,element:e.jsx(as,{to:"dashboard/overview",replace:!0})}),e.jsx(W,{path:"dashboard",element:e.jsx(as,{to:"dashboard/overview",replace:!0})}),ew]})}),sw=x.lazy(()=>Promise.resolve({default:tw})),zp=({text:t,colorClass:s})=>e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-background",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`inline-block h-12 w-12 animate-spin rounded-full border-4 border-current border-r-transparent ${s}`}),e.jsx("p",{className:"mt-4 text-muted-foreground",children:t})]})}),nw=({children:t})=>{const{data:s,isLoading:n}=We();if(n||!s)return e.jsx(zp,{text:"Sprawdzanie uprawnie...",colorClass:"border-red-600"});if(s.role!=="admin"){const r=s.role==="teacher"?"/teacher/dashboard":"/student/dashboard";return e.jsx(as,{to:r,replace:!0})}return e.jsx(e.Fragment,{children:t})},rw=e.jsx(W,{path:"/admin/*",element:e.jsx(yc,{fallback:e.jsx(bc,{to:"/login"}),children:e.jsx(nw,{children:e.jsx(x.Suspense,{fallback:e.jsx(zp,{text:"adowanie panelu administratora...",colorClass:"border-red-600"}),children:e.jsx(sw,{})})})},"admin-auth")}),iw=({onClose:t})=>{const{mutate:s}=no(),{menuItems:n}=Qh(),{data:r}=We(),i=()=>{t&&t()};return e.jsxs("div",{className:"flex h-full w-64 flex-col border-r bg-background",children:[e.jsxs("div",{className:"flex h-16 items-center justify-between border-b px-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ri,{className:"h-6 w-6 mr-2"}),e.jsx("span",{className:"font-semibold",children:"Smart Up"})]}),t&&e.jsx(I,{variant:"ghost",size:"sm",onClick:t,className:"lg:hidden",children:e.jsx(dt,{className:"h-4 w-4"})})]}),e.jsx(yr,{className:"flex-1 px-3 py-4",children:e.jsx("nav",{className:"space-y-4",children:n.map(a=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs(hr,{to:a.route??"/",onClick:i,className:({isActive:o})=>q("flex items-center justify-between rounded-md px-3 py-2 text-sm font-semibold transition-colors hover:bg-accent hover:text-accent-foreground",o?"bg-accent text-accent-foreground":"text-foreground"),children:[e.jsxs("span",{className:"flex items-center",children:[a.icon&&e.jsx("span",{className:"mr-3",children:a.icon}),a.label]}),e.jsx(Xt,{className:"h-4 w-4 opacity-60"})]}),a.children&&a.children.length>0&&e.jsx("div",{className:"ml-3 border-l pl-3 space-y-1",children:a.children.map(o=>e.jsxs(hr,{to:o.route??"/",onClick:i,className:({isActive:l})=>q("flex items-center rounded-md px-3 py-2 text-sm transition-colors hover:bg-accent hover:text-accent-foreground",l?"bg-accent text-accent-foreground":"text-muted-foreground"),children:[o.icon&&e.jsx("span",{className:"mr-3",children:o.icon}),o.label]},o.key))})]},a.key))})}),e.jsx(Mn,{}),e.jsx(mp,{className:"border-b"}),e.jsx("div",{className:"p-4",children:e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>{s(),t&&t()},className:"w-full justify-start",children:[e.jsx(lo,{className:"mr-2 h-4 w-4"}),"Logout"]})})]})},aw=({children:t})=>{const[s,n]=x.useState(!1),r=()=>{n(!s)};return e.jsx("div",{className:"min-h-screen bg-stone-200 relative overflow-x-hidden",children:e.jsxs("div",{className:"flex relative",children:[s&&e.jsx("div",{className:"fixed inset-0 z-40 bg-purple-900/20 backdrop-blur-sm lg:hidden",onClick:()=>n(!1)}),e.jsx("aside",{className:`
            h-screen w-64 transform transition-transform duration-300 ease-in-out
            fixed left-0 top-0 z-50
            ${s?"translate-x-0":"-translate-x-full"}
            lg:translate-x-0
            bg-background/95 backdrop-blur-md border-r border-purple-200/20
          `,children:e.jsx(iw,{onClose:()=>n(!1)})}),e.jsxs("main",{className:"flex-1 lg:ml-64 min-w-0 relative z-10",children:[e.jsxs("div",{className:"sticky top-0 z-30 flex h-16 items-center border-b border-purple-200/20 bg-background/80 backdrop-blur-md px-4 lg:hidden",children:[e.jsx(I,{variant:"ghost",size:"sm",onClick:r,className:"mr-2 hover:bg-purple-100/20 hover:text-purple-700",children:e.jsx(Ri,{className:"h-6 w-6"})}),e.jsx("span",{className:"font-semibold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent",children:"Smart Up"})]}),t]})]})})},ow=()=>{const{data:t,isLoading:s}=We(),[n,r]=x.useState(null),[i,a]=x.useState(!0);return x.useEffect(()=>{if(s||!t?.vendor_id){a(!1);return}let o=!0;return(async()=>{try{const[c,d,m,u,h]=await Promise.all([J.from("users").select("*",{count:"exact",head:!0}).eq("vendor_id",t.vendor_id),J.from("courses").select("*",{count:"exact"}).eq("vendor_id",t.vendor_id),J.from("activities").select("*, topics!inner(course_id, courses!inner(vendor_id))",{count:"exact"}).eq("topics.courses.vendor_id",t.vendor_id),J.from("activity_progress").select("score, completed_at").not("completed_at","is",null),J.from("user_stats").select("total_points")]);if(!o)return;const p=u.data?.length?u.data.reduce((f,y)=>f+(y.score||0),0)/u.data.length:0,b=h.data?.reduce((f,y)=>f+y.total_points,0)||0;r({totalUsers:c.count||0,activeUsers:c.count||0,totalCourses:d.count||0,publishedCourses:d.data?.filter(f=>f.is_published).length||0,totalActivities:m.count||0,completedActivities:u.data?.length||0,averageScore:Math.round(p),totalPoints:b})}catch(c){console.error("Error fetching dashboard stats:",c)}finally{o&&a(!1)}})(),()=>{o=!1}},[t?.vendor_id,s]),i||s?e.jsx(G,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})}):t?e.jsxs(G,{children:[e.jsx(_e,{title:"Dashboard",description:"Przegld statystyk systemu e-learning"}),e.jsxs(wt,{variant:"1-2-2",children:[e.jsxs(D,{children:[e.jsxs($,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(R,{className:"text-sm font-medium",children:"U偶ytkownicy"}),e.jsx(pe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(P,{children:[e.jsx("div",{className:"text-2xl font-bold",children:n?.totalUsers||0}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[n?.activeUsers||0," aktywnych"]})]})]}),e.jsxs(D,{children:[e.jsxs($,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(R,{className:"text-sm font-medium",children:"Kursy"}),e.jsx(ye,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(P,{children:[e.jsx("div",{className:"text-2xl font-bold",children:n?.totalCourses||0}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[n?.publishedCourses||0," opublikowanych"]})]})]}),e.jsxs(D,{children:[e.jsxs($,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(R,{className:"text-sm font-medium",children:"Aktywnoci"}),e.jsx(qi,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(P,{children:[e.jsx("div",{className:"text-2xl font-bold",children:n?.totalActivities||0}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[n?.completedActivities||0," ukoczonych"]})]})]}),e.jsxs(D,{children:[e.jsxs($,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(R,{className:"text-sm font-medium",children:"redni wynik"}),e.jsx(Se,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(P,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[n?.averageScore||0,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"z wszystkich quiz贸w"})]})]})]}),e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{children:"Aktywno w ostatnich 7 dniach"})}),e.jsx(P,{children:e.jsxs("div",{className:"h-[300px] flex items-center justify-center text-muted-foreground",children:[e.jsx(xt,{className:"h-8 w-8 mr-2"}),"Wykres aktywnoci (do implementacji)"]})})]}),e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{children:"Top 5 u偶ytkownik贸w"})}),e.jsx(P,{children:e.jsx("div",{className:"space-y-4",children:[1,2,3,4,5].map(o=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx($e,{className:`h-5 w-5 ${o<=3?"text-yellow-500":"text-muted-foreground"}`}),e.jsxs("span",{children:["U偶ytkownik ",o]})]}),e.jsxs("span",{className:"font-semibold",children:[1e3-o*100," pkt"]})]},o))})})]})]}):e.jsx(G,{children:e.jsx("div",{className:"text-center text-muted-foreground",children:"Nie mo偶na zaadowa danych u偶ytkownika"})})},lw=[e.jsx(W,{path:"/dashboard/overview",element:e.jsx(ow,{})},"dashboard")];var Dl=["Enter"," "],cw=["ArrowDown","PageUp","Home"],Sp=["ArrowUp","PageDown","End"],dw=[...cw,...Sp],uw={ltr:[...Dl,"ArrowRight"],rtl:[...Dl,"ArrowLeft"]},mw={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Vi="Menu",[yi,hw,pw]=wy(Vi),[On,Cp]=pc(Vi,[pw,Uh,Bh]),yo=Uh(),Tp=Bh(),[fw,Rn]=On(Vi),[xw,Wi]=On(Vi),_p=t=>{const{__scopeMenu:s,open:n=!1,children:r,dir:i,onOpenChange:a,modal:o=!0}=t,l=yo(s),[c,d]=x.useState(null),m=x.useRef(!1),u=Wh(a),h=Iy(i);return x.useEffect(()=>{const p=()=>{m.current=!0,document.addEventListener("pointerdown",b,{capture:!0,once:!0}),document.addEventListener("pointermove",b,{capture:!0,once:!0})},b=()=>m.current=!1;return document.addEventListener("keydown",p,{capture:!0}),()=>{document.removeEventListener("keydown",p,{capture:!0}),document.removeEventListener("pointerdown",b,{capture:!0}),document.removeEventListener("pointermove",b,{capture:!0})}},[]),e.jsx(Ey,{...l,children:e.jsx(fw,{scope:s,open:n,onOpenChange:u,content:c,onContentChange:d,children:e.jsx(xw,{scope:s,onClose:x.useCallback(()=>u(!1),[u]),isUsingKeyboardRef:m,dir:h,modal:o,children:r})})})};_p.displayName=Vi;var gw="MenuAnchor",Cc=x.forwardRef((t,s)=>{const{__scopeMenu:n,...r}=t,i=yo(n);return e.jsx(Ny,{...i,...r,ref:s})});Cc.displayName=gw;var Tc="MenuPortal",[jw,Ap]=On(Tc,{forceMount:void 0}),Dp=t=>{const{__scopeMenu:s,forceMount:n,children:r,container:i}=t,a=Rn(Tc,s);return e.jsx(jw,{scope:s,forceMount:n,children:e.jsx(eo,{present:n||a.open,children:e.jsx(vy,{asChild:!0,container:i,children:r})})})};Dp.displayName=Tc;var Ht="MenuContent",[yw,_c]=On(Ht),Pp=x.forwardRef((t,s)=>{const n=Ap(Ht,t.__scopeMenu),{forceMount:r=n.forceMount,...i}=t,a=Rn(Ht,t.__scopeMenu),o=Wi(Ht,t.__scopeMenu);return e.jsx(yi.Provider,{scope:t.__scopeMenu,children:e.jsx(eo,{present:r||a.open,children:e.jsx(yi.Slot,{scope:t.__scopeMenu,children:o.modal?e.jsx(bw,{...i,ref:s}):e.jsx(ww,{...i,ref:s})})})})}),bw=x.forwardRef((t,s)=>{const n=Rn(Ht,t.__scopeMenu),r=x.useRef(null),i=Dn(s,r);return x.useEffect(()=>{const a=r.current;if(a)return Py(a)},[]),e.jsx(Ac,{...t,ref:i,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:ze(t.onFocusOutside,a=>a.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),ww=x.forwardRef((t,s)=>{const n=Rn(Ht,t.__scopeMenu);return e.jsx(Ac,{...t,ref:s,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),vw=Cy("MenuContent.ScrollLock"),Ac=x.forwardRef((t,s)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:i,onOpenAutoFocus:a,onCloseAutoFocus:o,disableOutsidePointerEvents:l,onEntryFocus:c,onEscapeKeyDown:d,onPointerDownOutside:m,onFocusOutside:u,onInteractOutside:h,onDismiss:p,disableOutsideScroll:b,...f}=t,y=Rn(Ht,n),w=Wi(Ht,n),j=yo(n),v=Tp(n),T=hw(n),[z,k]=x.useState(null),N=x.useRef(null),S=Dn(s,N,y.onContentChange),_=x.useRef(0),g=x.useRef(""),C=x.useRef(0),A=x.useRef(null),E=x.useRef("right"),M=x.useRef(0),O=b?Sy:x.Fragment,Q=b?{as:vw,allowPinchZoom:!0}:void 0,L=F=>{const ae=g.current+F,B=T().filter(He=>!He.disabled),ee=document.activeElement,et=B.find(He=>He.ref.current===ee)?.textValue,ts=B.map(He=>He.textValue),Us=Iw(ts,ae,et),Qe=B.find(He=>He.textValue===Us)?.ref.current;(function He(ss){g.current=ss,window.clearTimeout(_.current),ss!==""&&(_.current=window.setTimeout(()=>He(""),1e3))})(ae),Qe&&setTimeout(()=>Qe.focus())};x.useEffect(()=>()=>window.clearTimeout(_.current),[]),zy();const U=x.useCallback(F=>E.current===A.current?.side&&Lw(F,A.current?.area),[]);return e.jsx(yw,{scope:n,searchRef:g,onItemEnter:x.useCallback(F=>{U(F)&&F.preventDefault()},[U]),onItemLeave:x.useCallback(F=>{U(F)||(N.current?.focus(),k(null))},[U]),onTriggerLeave:x.useCallback(F=>{U(F)&&F.preventDefault()},[U]),pointerGraceTimerRef:C,onPointerGraceIntentChange:x.useCallback(F=>{A.current=F},[]),children:e.jsx(O,{...Q,children:e.jsx(Ty,{asChild:!0,trapped:i,onMountAutoFocus:ze(a,F=>{F.preventDefault(),N.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:e.jsx(_y,{asChild:!0,disableOutsidePointerEvents:l,onEscapeKeyDown:d,onPointerDownOutside:m,onFocusOutside:u,onInteractOutside:h,onDismiss:p,children:e.jsx(Ay,{asChild:!0,...v,dir:w.dir,orientation:"vertical",loop:r,currentTabStopId:z,onCurrentTabStopIdChange:k,onEntryFocus:ze(c,F=>{w.isUsingKeyboardRef.current||F.preventDefault()}),preventScrollOnEntryFocus:!0,children:e.jsx(Dy,{role:"menu","aria-orientation":"vertical","data-state":Qp(y.open),"data-radix-menu-content":"",dir:w.dir,...j,...f,ref:S,style:{outline:"none",...f.style},onKeyDown:ze(f.onKeyDown,F=>{const B=F.target.closest("[data-radix-menu-content]")===F.currentTarget,ee=F.ctrlKey||F.altKey||F.metaKey,et=F.key.length===1;B&&(F.key==="Tab"&&F.preventDefault(),!ee&&et&&L(F.key));const ts=N.current;if(F.target!==ts||!dw.includes(F.key))return;F.preventDefault();const Qe=T().filter(He=>!He.disabled).map(He=>He.ref.current);Sp.includes(F.key)&&Qe.reverse(),Pw(Qe)}),onBlur:ze(t.onBlur,F=>{F.currentTarget.contains(F.target)||(window.clearTimeout(_.current),g.current="")}),onPointerMove:ze(t.onPointerMove,bi(F=>{const ae=F.target,B=M.current!==F.clientX;if(F.currentTarget.contains(ae)&&B){const ee=F.clientX>M.current?"right":"left";E.current=ee,M.current=F.clientX}}))})})})})})})});Pp.displayName=Ht;var Nw="MenuGroup",Dc=x.forwardRef((t,s)=>{const{__scopeMenu:n,...r}=t;return e.jsx(on.div,{role:"group",...r,ref:s})});Dc.displayName=Nw;var kw="MenuLabel",Mp=x.forwardRef((t,s)=>{const{__scopeMenu:n,...r}=t;return e.jsx(on.div,{...r,ref:s})});Mp.displayName=kw;var Ra="MenuItem",iu="menu.itemSelect",bo=x.forwardRef((t,s)=>{const{disabled:n=!1,onSelect:r,...i}=t,a=x.useRef(null),o=Wi(Ra,t.__scopeMenu),l=_c(Ra,t.__scopeMenu),c=Dn(s,a),d=x.useRef(!1),m=()=>{const u=a.current;if(!n&&u){const h=new CustomEvent(iu,{bubbles:!0,cancelable:!0});u.addEventListener(iu,p=>r?.(p),{once:!0}),My(u,h),h.defaultPrevented?d.current=!1:o.onClose()}};return e.jsx(Ip,{...i,ref:c,disabled:n,onClick:ze(t.onClick,m),onPointerDown:u=>{t.onPointerDown?.(u),d.current=!0},onPointerUp:ze(t.onPointerUp,u=>{d.current||u.currentTarget?.click()}),onKeyDown:ze(t.onKeyDown,u=>{const h=l.searchRef.current!=="";n||h&&u.key===" "||Dl.includes(u.key)&&(u.currentTarget.click(),u.preventDefault())})})});bo.displayName=Ra;var Ip=x.forwardRef((t,s)=>{const{__scopeMenu:n,disabled:r=!1,textValue:i,...a}=t,o=_c(Ra,n),l=Tp(n),c=x.useRef(null),d=Dn(s,c),[m,u]=x.useState(!1),[h,p]=x.useState("");return x.useEffect(()=>{const b=c.current;b&&p((b.textContent??"").trim())},[a.children]),e.jsx(yi.ItemSlot,{scope:n,disabled:r,textValue:i??h,children:e.jsx(ky,{asChild:!0,...l,focusable:!r,children:e.jsx(on.div,{role:"menuitem","data-highlighted":m?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...a,ref:d,onPointerMove:ze(t.onPointerMove,bi(b=>{r?o.onItemLeave(b):(o.onItemEnter(b),b.defaultPrevented||b.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:ze(t.onPointerLeave,bi(b=>o.onItemLeave(b))),onFocus:ze(t.onFocus,()=>u(!0)),onBlur:ze(t.onBlur,()=>u(!1))})})})}),zw="MenuCheckboxItem",Ep=x.forwardRef((t,s)=>{const{checked:n=!1,onCheckedChange:r,...i}=t;return e.jsx(qp,{scope:t.__scopeMenu,checked:n,children:e.jsx(bo,{role:"menuitemcheckbox","aria-checked":$a(n)?"mixed":n,...i,ref:s,"data-state":Mc(n),onSelect:ze(i.onSelect,()=>r?.($a(n)?!0:!n),{checkForDefaultPrevented:!1})})})});Ep.displayName=zw;var Lp="MenuRadioGroup",[Sw,Cw]=On(Lp,{value:void 0,onValueChange:()=>{}}),Op=x.forwardRef((t,s)=>{const{value:n,onValueChange:r,...i}=t,a=Wh(r);return e.jsx(Sw,{scope:t.__scopeMenu,value:n,onValueChange:a,children:e.jsx(Dc,{...i,ref:s})})});Op.displayName=Lp;var Rp="MenuRadioItem",$p=x.forwardRef((t,s)=>{const{value:n,...r}=t,i=Cw(Rp,t.__scopeMenu),a=n===i.value;return e.jsx(qp,{scope:t.__scopeMenu,checked:a,children:e.jsx(bo,{role:"menuitemradio","aria-checked":a,...r,ref:s,"data-state":Mc(a),onSelect:ze(r.onSelect,()=>i.onValueChange?.(n),{checkForDefaultPrevented:!1})})})});$p.displayName=Rp;var Pc="MenuItemIndicator",[qp,Tw]=On(Pc,{checked:!1}),Fp=x.forwardRef((t,s)=>{const{__scopeMenu:n,forceMount:r,...i}=t,a=Tw(Pc,n);return e.jsx(eo,{present:r||$a(a.checked)||a.checked===!0,children:e.jsx(on.span,{...i,ref:s,"data-state":Mc(a.checked)})})});Fp.displayName=Pc;var _w="MenuSeparator",Up=x.forwardRef((t,s)=>{const{__scopeMenu:n,...r}=t;return e.jsx(on.div,{role:"separator","aria-orientation":"horizontal",...r,ref:s})});Up.displayName=_w;var Aw="MenuArrow",Bp=x.forwardRef((t,s)=>{const{__scopeMenu:n,...r}=t,i=yo(n);return e.jsx(Ly,{...i,...r,ref:s})});Bp.displayName=Aw;var Dw="MenuSub",[tP,Vp]=On(Dw),ni="MenuSubTrigger",Wp=x.forwardRef((t,s)=>{const n=Rn(ni,t.__scopeMenu),r=Wi(ni,t.__scopeMenu),i=Vp(ni,t.__scopeMenu),a=_c(ni,t.__scopeMenu),o=x.useRef(null),{pointerGraceTimerRef:l,onPointerGraceIntentChange:c}=a,d={__scopeMenu:t.__scopeMenu},m=x.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return x.useEffect(()=>m,[m]),x.useEffect(()=>{const u=l.current;return()=>{window.clearTimeout(u),c(null)}},[l,c]),e.jsx(Cc,{asChild:!0,...d,children:e.jsx(Ip,{id:i.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":i.contentId,"data-state":Qp(n.open),...t,ref:Vh(s,i.onTriggerChange),onClick:u=>{t.onClick?.(u),!(t.disabled||u.defaultPrevented)&&(u.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:ze(t.onPointerMove,bi(u=>{a.onItemEnter(u),!u.defaultPrevented&&!t.disabled&&!n.open&&!o.current&&(a.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{n.onOpenChange(!0),m()},100))})),onPointerLeave:ze(t.onPointerLeave,bi(u=>{m();const h=n.content?.getBoundingClientRect();if(h){const p=n.content?.dataset.side,b=p==="right",f=b?-5:5,y=h[b?"left":"right"],w=h[b?"right":"left"];a.onPointerGraceIntentChange({area:[{x:u.clientX+f,y:u.clientY},{x:y,y:h.top},{x:w,y:h.top},{x:w,y:h.bottom},{x:y,y:h.bottom}],side:p}),window.clearTimeout(l.current),l.current=window.setTimeout(()=>a.onPointerGraceIntentChange(null),300)}else{if(a.onTriggerLeave(u),u.defaultPrevented)return;a.onPointerGraceIntentChange(null)}})),onKeyDown:ze(t.onKeyDown,u=>{const h=a.searchRef.current!=="";t.disabled||h&&u.key===" "||uw[r.dir].includes(u.key)&&(n.onOpenChange(!0),n.content?.focus(),u.preventDefault())})})})});Wp.displayName=ni;var Kp="MenuSubContent",Gp=x.forwardRef((t,s)=>{const n=Ap(Ht,t.__scopeMenu),{forceMount:r=n.forceMount,...i}=t,a=Rn(Ht,t.__scopeMenu),o=Wi(Ht,t.__scopeMenu),l=Vp(Kp,t.__scopeMenu),c=x.useRef(null),d=Dn(s,c);return e.jsx(yi.Provider,{scope:t.__scopeMenu,children:e.jsx(eo,{present:r||a.open,children:e.jsx(yi.Slot,{scope:t.__scopeMenu,children:e.jsx(Ac,{id:l.contentId,"aria-labelledby":l.triggerId,...i,ref:d,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:m=>{o.isUsingKeyboardRef.current&&c.current?.focus(),m.preventDefault()},onCloseAutoFocus:m=>m.preventDefault(),onFocusOutside:ze(t.onFocusOutside,m=>{m.target!==l.trigger&&a.onOpenChange(!1)}),onEscapeKeyDown:ze(t.onEscapeKeyDown,m=>{o.onClose(),m.preventDefault()}),onKeyDown:ze(t.onKeyDown,m=>{const u=m.currentTarget.contains(m.target),h=mw[o.dir].includes(m.key);u&&h&&(a.onOpenChange(!1),l.trigger?.focus(),m.preventDefault())})})})})})});Gp.displayName=Kp;function Qp(t){return t?"open":"closed"}function $a(t){return t==="indeterminate"}function Mc(t){return $a(t)?"indeterminate":t?"checked":"unchecked"}function Pw(t){const s=document.activeElement;for(const n of t)if(n===s||(n.focus(),document.activeElement!==s))return}function Mw(t,s){return t.map((n,r)=>t[(s+r)%t.length])}function Iw(t,s,n){const i=s.length>1&&Array.from(s).every(d=>d===s[0])?s[0]:s,a=n?t.indexOf(n):-1;let o=Mw(t,Math.max(a,0));i.length===1&&(o=o.filter(d=>d!==n));const c=o.find(d=>d.toLowerCase().startsWith(i.toLowerCase()));return c!==n?c:void 0}function Ew(t,s){const{x:n,y:r}=t;let i=!1;for(let a=0,o=s.length-1;a<s.length;o=a++){const l=s[a],c=s[o],d=l.x,m=l.y,u=c.x,h=c.y;m>r!=h>r&&n<(u-d)*(r-m)/(h-m)+d&&(i=!i)}return i}function Lw(t,s){if(!s)return!1;const n={x:t.clientX,y:t.clientY};return Ew(n,s)}function bi(t){return s=>s.pointerType==="mouse"?t(s):void 0}var Ow=_p,Rw=Cc,$w=Dp,qw=Pp,Fw=Dc,Uw=Mp,Bw=bo,Vw=Ep,Ww=Op,Kw=$p,Gw=Fp,Qw=Up,Hw=Bp,Zw=Wp,Yw=Gp,wo="DropdownMenu",[Jw,sP]=pc(wo,[Cp]),Nt=Cp(),[Xw,Hp]=Jw(wo),Zp=t=>{const{__scopeDropdownMenu:s,children:n,dir:r,open:i,defaultOpen:a,onOpenChange:o,modal:l=!0}=t,c=Nt(s),d=x.useRef(null),[m,u]=Eh({prop:i,defaultProp:a??!1,onChange:o,caller:wo});return e.jsx(Xw,{scope:s,triggerId:Hd(),triggerRef:d,contentId:Hd(),open:m,onOpenChange:u,onOpenToggle:x.useCallback(()=>u(h=>!h),[u]),modal:l,children:e.jsx(Ow,{...c,open:m,onOpenChange:u,dir:r,modal:l,children:n})})};Zp.displayName=wo;var Yp="DropdownMenuTrigger",Jp=x.forwardRef((t,s)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...i}=t,a=Hp(Yp,n),o=Nt(n);return e.jsx(Rw,{asChild:!0,...o,children:e.jsx(on.button,{type:"button",id:a.triggerId,"aria-haspopup":"menu","aria-expanded":a.open,"aria-controls":a.open?a.contentId:void 0,"data-state":a.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...i,ref:Vh(s,a.triggerRef),onPointerDown:ze(t.onPointerDown,l=>{!r&&l.button===0&&l.ctrlKey===!1&&(a.onOpenToggle(),a.open||l.preventDefault())}),onKeyDown:ze(t.onKeyDown,l=>{r||(["Enter"," "].includes(l.key)&&a.onOpenToggle(),l.key==="ArrowDown"&&a.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(l.key)&&l.preventDefault())})})})});Jp.displayName=Yp;var ev="DropdownMenuPortal",Xp=t=>{const{__scopeDropdownMenu:s,...n}=t,r=Nt(s);return e.jsx($w,{...r,...n})};Xp.displayName=ev;var ef="DropdownMenuContent",tf=x.forwardRef((t,s)=>{const{__scopeDropdownMenu:n,...r}=t,i=Hp(ef,n),a=Nt(n),o=x.useRef(!1);return e.jsx(qw,{id:i.contentId,"aria-labelledby":i.triggerId,...a,...r,ref:s,onCloseAutoFocus:ze(t.onCloseAutoFocus,l=>{o.current||i.triggerRef.current?.focus(),o.current=!1,l.preventDefault()}),onInteractOutside:ze(t.onInteractOutside,l=>{const c=l.detail.originalEvent,d=c.button===0&&c.ctrlKey===!0,m=c.button===2||d;(!i.modal||m)&&(o.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});tf.displayName=ef;var tv="DropdownMenuGroup",sv=x.forwardRef((t,s)=>{const{__scopeDropdownMenu:n,...r}=t,i=Nt(n);return e.jsx(Fw,{...i,...r,ref:s})});sv.displayName=tv;var nv="DropdownMenuLabel",sf=x.forwardRef((t,s)=>{const{__scopeDropdownMenu:n,...r}=t,i=Nt(n);return e.jsx(Uw,{...i,...r,ref:s})});sf.displayName=nv;var rv="DropdownMenuItem",nf=x.forwardRef((t,s)=>{const{__scopeDropdownMenu:n,...r}=t,i=Nt(n);return e.jsx(Bw,{...i,...r,ref:s})});nf.displayName=rv;var iv="DropdownMenuCheckboxItem",rf=x.forwardRef((t,s)=>{const{__scopeDropdownMenu:n,...r}=t,i=Nt(n);return e.jsx(Vw,{...i,...r,ref:s})});rf.displayName=iv;var av="DropdownMenuRadioGroup",ov=x.forwardRef((t,s)=>{const{__scopeDropdownMenu:n,...r}=t,i=Nt(n);return e.jsx(Ww,{...i,...r,ref:s})});ov.displayName=av;var lv="DropdownMenuRadioItem",af=x.forwardRef((t,s)=>{const{__scopeDropdownMenu:n,...r}=t,i=Nt(n);return e.jsx(Kw,{...i,...r,ref:s})});af.displayName=lv;var cv="DropdownMenuItemIndicator",of=x.forwardRef((t,s)=>{const{__scopeDropdownMenu:n,...r}=t,i=Nt(n);return e.jsx(Gw,{...i,...r,ref:s})});of.displayName=cv;var dv="DropdownMenuSeparator",lf=x.forwardRef((t,s)=>{const{__scopeDropdownMenu:n,...r}=t,i=Nt(n);return e.jsx(Qw,{...i,...r,ref:s})});lf.displayName=dv;var uv="DropdownMenuArrow",mv=x.forwardRef((t,s)=>{const{__scopeDropdownMenu:n,...r}=t,i=Nt(n);return e.jsx(Hw,{...i,...r,ref:s})});mv.displayName=uv;var hv="DropdownMenuSubTrigger",cf=x.forwardRef((t,s)=>{const{__scopeDropdownMenu:n,...r}=t,i=Nt(n);return e.jsx(Zw,{...i,...r,ref:s})});cf.displayName=hv;var pv="DropdownMenuSubContent",df=x.forwardRef((t,s)=>{const{__scopeDropdownMenu:n,...r}=t,i=Nt(n);return e.jsx(Yw,{...i,...r,ref:s,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});df.displayName=pv;var fv=Zp,xv=Jp,gv=Xp,uf=tf,mf=sf,hf=nf,pf=rf,ff=af,xf=of,gf=lf,jf=cf,yf=df;const br=fv,wr=xv,jv=x.forwardRef(({className:t,inset:s,children:n,...r},i)=>e.jsxs(jf,{ref:i,className:q("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",s&&"pl-8",t),...r,children:[n,e.jsx(is,{className:"ml-auto"})]}));jv.displayName=jf.displayName;const yv=x.forwardRef(({className:t,...s},n)=>e.jsx(yf,{ref:n,className:q("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",t),...s}));yv.displayName=yf.displayName;const Cn=x.forwardRef(({className:t,sideOffset:s=4,...n},r)=>e.jsx(gv,{children:e.jsx(uf,{ref:r,sideOffset:s,className:q("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",t),...n})}));Cn.displayName=uf.displayName;const ve=x.forwardRef(({className:t,inset:s,...n},r)=>e.jsx(hf,{ref:r,className:q("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0",s&&"pl-8",t),...n}));ve.displayName=hf.displayName;const bv=x.forwardRef(({className:t,children:s,checked:n,...r},i)=>e.jsxs(pf,{ref:i,className:q("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:n,...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(xf,{children:e.jsx(Ve,{className:"h-4 w-4"})})}),s]}));bv.displayName=pf.displayName;const wv=x.forwardRef(({className:t,children:s,...n},r)=>e.jsxs(ff,{ref:r,className:q("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(xf,{children:e.jsx(va,{className:"h-2 w-2 fill-current"})})}),s]}));wv.displayName=ff.displayName;const bf=x.forwardRef(({className:t,inset:s,...n},r)=>e.jsx(mf,{ref:r,className:q("px-2 py-1.5 text-sm font-semibold",s&&"pl-8",t),...n}));bf.displayName=mf.displayName;const jt=x.forwardRef(({className:t,...s},n)=>e.jsx(gf,{ref:n,className:q("-mx-1 my-1 h-px bg-muted",t),...s}));jt.displayName=gf.displayName;const vv=()=>{const t=se(),s=Ei(),n=()=>{const o=`${s.pathname}${s.search}`;sessionStorage.setItem("returnUrl",o)};return{navigateWithReturn:o=>{n(),t(o)},goBack:o=>{const l=sessionStorage.getItem("returnUrl");l?(sessionStorage.removeItem("returnUrl"),t(l)):t(o||-1)},saveReturnUrl:n,navigateToWizard:(o,l)=>{l&&sessionStorage.setItem("wizardContext",JSON.stringify(l)),n(),t(o)},currentUrl:`${s.pathname}${s.search}`}},Pl=t=>{const{mutate:s,isLoading:n}=Cr();return{togglePublish:async(i,a,o,l)=>{s({resource:t,id:i,values:{is_published:!a}},{onSuccess:()=>{K.success(a?`${o} zosta ukryty`:`${o} zosta opublikowany`),l?.()},onError:c=>{K.error("Nie udao si zmieni statusu publikacji"),console.error("Publish toggle error:",c)}})},isToggling:n}},au=t=>{const{mutate:s}=Cr(),n=Zh(),[r,i]=x.useState(!1);return{updatePosition:x.useCallback(async(o,l)=>{if(!r){i(!0);try{await new Promise((c,d)=>{s({resource:t,id:o,values:{position:l},mutationMode:"optimistic"},{onSuccess:()=>{console.log(`Updated position for ${t} ${o} to ${l}`),c()},onError:m=>d(m)})}),setTimeout(()=>{n({resource:t,invalidates:["list"]})},1e3)}catch(c){console.error("Position update error:",c),K.error("Nie udao si zaktualizowa pozycji"),await n({resource:t,invalidates:["list"]})}finally{i(!1)}}},[t,s,n,r]),isUpdating:r}},Nv=t=>{const{data:s,isLoading:n}=Xe({resource:"courses",id:t,queryOptions:{enabled:!!t}}),{data:r,isLoading:i,refetch:a}=Y({resource:"topics",filters:[{field:"course_id",operator:"eq",value:t}],sorters:[{field:"position",order:"asc"}],pagination:{mode:"off"},meta:{select:"*, activities(count)"},queryOptions:{enabled:!!t}}),{data:o,refetch:l}=Y({resource:"activities",filters:[{field:"topic_id",operator:"in",value:r?.data?.map(h=>h.id)||[]}],sorters:[{field:"position",order:"asc"}],pagination:{mode:"off"},meta:{select:"*, questions(count)"},queryOptions:{enabled:!!r?.data?.length}}),{data:c}=Y({resource:"course_access",filters:[{field:"course_id",operator:"eq",value:t}],queryOptions:{enabled:!!t}}),d=n||i,m={topicsCount:r?.total||0,activitiesCount:o?.total||0,accessCount:c?.total||0},u=h=>o?.data?.filter(p=>p.topic_id===h)||[];return{course:s?.data,topics:r?.data||[],activities:o?.data||[],stats:m,isLoading:d,refetchTopics:a,refetchActivities:l,getActivitiesForTopic:u}},kv=()=>{const{create:t,edit:s,show:n}=ut(),{mutate:r}=zn(),{togglePublish:i}=Pl("courses"),{data:a}=We(),[o,l]=x.useState(""),{data:c,isLoading:d,isError:m,refetch:u}=Y({resource:"courses",pagination:{mode:"off"},sorters:[{field:"created_at",order:"desc"}]}),{data:h,isLoading:p}=Y({resource:"course_access",filters:a?.role==="teacher"?[{field:"teacher_id",operator:"eq",value:a?.id}]:[],pagination:{mode:"off"},queryOptions:{enabled:!!a?.id&&a?.role==="teacher"}}),{data:b}=Y({resource:"topics",pagination:{mode:"off"},meta:{select:"course_id"}}),{data:f}=Y({resource:"course_access",pagination:{mode:"off"},meta:{select:"course_id"}}),y=x.useMemo(()=>h?.data?.map(g=>g.course_id)||[],[h?.data]),w=x.useMemo(()=>{let g=c?.data||[];return a?.role==="teacher"&&(g=g.filter(C=>y.includes(C.id))),o&&(g=g.filter(C=>C.title.toLowerCase().includes(o.toLowerCase()))),g},[c?.data,y,a?.role,o]),j=g=>{const C=b?.data?.filter(E=>E.course_id===g).length||0,A=f?.data?.filter(E=>E.course_id===g).length||0;return{topicsCount:C,accessCount:A}},v=(g,C)=>{confirm(`Czy na pewno chcesz usun kurs "${C}"?`)&&r({resource:"courses",id:g},{onSuccess:()=>{K.success("Kurs zosta usunity"),u()}})},T=(g,C,A)=>{C&&A&&sessionStorage.setItem("wizardContext",JSON.stringify({courseId:C,courseTitle:A})),window.location.href=g},z=d||a?.role==="teacher"&&p,N=kc({isLoading:z,isError:m});if(N)return N;const S=a?.role==="teacher",_=a?.role==="admin";return e.jsxs(G,{children:[e.jsxs(X,{children:[e.jsx(_e,{title:"Moje kursy",description:_?"Zarzdzaj wszystkimi kursami w systemie":"Kursy, kt贸re prowadzisz"}),_&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ds,{children:e.jsxs(Ps,{children:[e.jsx(Ms,{asChild:!0,children:e.jsxs(I,{variant:"outline",onClick:()=>T("/teacher/course-structure/step1"),children:[e.jsx(fr,{className:"w-4 h-4 mr-2"}),e.jsx(rt,{className:"w-3 h-3"})]})}),e.jsx(ps,{children:e.jsx("p",{children:"Stw贸rz kurs z pomoc AI"})})]})}),e.jsxs(I,{onClick:()=>t("courses"),children:[e.jsx(Ie,{className:"w-4 h-4 mr-2"}),"Dodaj kurs"]})]})]}),e.jsxs(X,{children:[e.jsx(Z,{placeholder:"Szukaj kurs贸w...",className:"max-w-sm",value:o,onChange:g=>l(g.target.value)}),S&&e.jsx(H,{variant:"outline",children:"Pokazuj tylko kursy, kt贸re prowadzisz"})]}),e.jsx(wt,{children:w.map(g=>{const C=j(g.id);return e.jsxs(D,{className:`relative cursor-pointer transition-all duration-200 ${g.is_published?"hover:shadow-lg":"opacity-80 hover:opacity-90 "}`,onClick:A=>{A.target.closest('[role="menu"]')||n("courses",g.id)},children:[e.jsx($,{children:e.jsxs(X,{children:[e.jsxs(R,{className:"flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:"flex-shrink-0",children:g.icon_emoji?e.jsx("span",{className:"text-2xl",children:g.icon_emoji}):e.jsx(ye,{className:"w-5 h-5"})}),e.jsx(Ds,{delayDuration:200,children:e.jsxs(Ps,{children:[e.jsx(Ms,{asChild:!0,children:e.jsx("span",{className:"truncate",children:g.title})}),g.title.length>30&&e.jsx(ps,{children:e.jsx("p",{className:"max-w-xs",children:g.title})})]})})]}),e.jsxs(br,{children:[e.jsx(wr,{asChild:!0,children:e.jsx(I,{variant:"ghost",size:"sm",onClick:A=>A.stopPropagation(),children:e.jsx(co,{className:"h-4 w-4"})})}),e.jsxs(Cn,{align:"end",children:[e.jsxs(ve,{onClick:()=>n("courses",g.id),children:[e.jsx(Je,{className:"mr-2 h-4 w-4"}),"Podgld"]}),_&&e.jsxs(e.Fragment,{children:[e.jsxs(ve,{onClick:()=>s("courses",g.id),children:[e.jsx(ks,{className:"mr-2 h-4 w-4"}),"Edytuj"]}),e.jsx(jt,{}),e.jsx(ve,{onClick:()=>i(g.id,g.is_published,g.title,u),children:g.is_published?e.jsxs(e.Fragment,{children:[e.jsx(uo,{className:"mr-2 h-4 w-4"}),"Ukryj kurs"]}):e.jsxs(e.Fragment,{children:[e.jsx(Je,{className:"mr-2 h-4 w-4"}),"Opublikuj kurs"]})})]}),e.jsx(jt,{}),e.jsxs(ve,{onClick:()=>T("/teacher/educational-material/step1",g.id,g.title),className:"text-purple-600 focus:text-purple-600",children:[e.jsx(rt,{className:"mr-2 h-4 w-4"}),"Generuj materia z AI"]}),e.jsxs(ve,{onClick:()=>T("/teacher/quiz-wizard/step1",g.id,g.title),className:"text-blue-600 focus:text-blue-600",children:[e.jsx(Os,{className:"mr-2 h-4 w-4"}),"Generuj quiz z AI"]}),_&&e.jsxs(e.Fragment,{children:[e.jsx(jt,{}),e.jsxs(ve,{onClick:()=>v(g.id,g.title),className:"text-red-600 focus:text-red-600",children:[e.jsx(ls,{className:"mr-2 h-4 w-4"}),"Usu"]})]})]})]})]})}),e.jsxs(P,{children:[g.description&&e.jsx("p",{className:"text-sm text-muted-foreground mb-3 line-clamp-2",children:g.description}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex gap-2",children:e.jsx(H,{variant:g.is_published?"default":"secondary",className:g.is_published?"bg-green-600":"",children:g.is_published?"Opublikowany":"Szkic"})}),e.jsxs("div",{className:"flex gap-3 text-sm text-muted-foreground",children:[e.jsx(Ds,{children:e.jsxs(Ps,{children:[e.jsx(Ms,{asChild:!0,children:e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(it,{className:"w-3 h-3"}),C.topicsCount]})}),e.jsx(ps,{children:e.jsx("p",{children:"Liczba temat贸w"})})]})}),e.jsx(Ds,{children:e.jsxs(Ps,{children:[e.jsx(Ms,{asChild:!0,children:e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(pe,{className:"w-3 h-3"}),C.accessCount]})}),e.jsx(ps,{children:e.jsx("p",{children:"Liczba przypisa"})})]})})]})]}),g.created_at&&e.jsxs("div",{className:"flex items-center gap-1 mt-2 text-xs text-muted-foreground",children:[e.jsx(Te,{className:"w-3 h-3"}),e.jsxs("span",{children:["Utworzono:"," ",new Date(g.created_at).toLocaleDateString("pl-PL")]})]})]})]},g.id)})}),w.length===0&&e.jsx(D,{className:"border-dashed border-2",children:e.jsx(P,{className:"text-center py-12",children:S?e.jsxs(e.Fragment,{children:[e.jsx(yt,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Nie prowadzisz jeszcze 偶adnych kurs贸w"}),e.jsx("p",{className:"text-muted-foreground mb-6 max-w-md mx-auto",children:"Administrator systemu tworzy kursy i przypisuje do nich nauczycieli. Skontaktuj si z administratorem, aby uzyska dostp do kurs贸w, kt贸re bdziesz prowadzi."}),e.jsx("div",{className:"flex gap-3 justify-center",children:e.jsxs(I,{variant:"outline",disabled:!0,children:[e.jsx(yt,{className:"w-4 h-4 mr-2"}),"Kursy tworzy administrator"]})})]}):e.jsxs(e.Fragment,{children:[e.jsx(fr,{className:"w-12 h-12 mx-auto mb-4 text-indigo-600"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Brak kurs贸w"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Rozpocznij od stworzenia pierwszego kursu"}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsxs(I,{variant:"outline",onClick:()=>t("courses"),children:[e.jsx(Ie,{className:"w-4 h-4 mr-2"}),"Dodaj rcznie"]}),e.jsxs(I,{onClick:()=>T("/teacher/course-structure/step1"),className:"bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700",children:[e.jsx(rt,{className:"w-4 h-4 mr-2"}),"Wygeneruj z AI"]})]})]})})})]})},cn=({children:t,onSubmit:s,className:n="",...r})=>{const i="space-y-6",a=n?`${i} ${n}`:i;return e.jsx("form",{onSubmit:s,className:a,...r,children:t})},oe=({children:t,label:s,htmlFor:n,error:r,required:i=!1,className:a="",hint:o})=>{const l="space-y-2",c=a?`${l} ${a}`:l,d=()=>s?typeof s=="string"?e.jsxs(re,{htmlFor:n,children:[s,i&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}):e.jsxs(re,{htmlFor:n,className:"flex items-center",children:[s,i&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}):null,m=x.isValidElement(t)?x.cloneElement(t,{className:`${t.props.className||""} ${r?"border-red-500 ring-1 ring-red-500":""}`.trim()}):t;return e.jsxs("div",{className:c,children:[d(),m,o&&!r&&e.jsx("p",{className:"text-sm text-muted-foreground",children:o}),r&&e.jsx("p",{className:"text-sm text-red-500",children:r})]})},dn=({children:t,className:s=""})=>{const n="flex justify-end items-center gap-4 pt-6 border-t",r=s?`${n} ${s}`:n;return e.jsx("div",{className:r,children:t})},zv=["","","","","猸","","","","锔","М"],Sv=()=>{const{list:t}=ut(),{data:s}=We(),[n,r]=x.useState(!1),{refineCore:{onFinish:i},register:a,handleSubmit:o,setValue:l,watch:c,formState:{errors:d,isSubmitting:m}}=ln({defaultValues:{title:"",description:"",vendor_id:s?.vendor_id||0,is_published:!1,icon_emoji:""}}),u=c("icon_emoji");return e.jsxs(G,{children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>t("courses"),children:[e.jsx(Ce,{className:"w-4 h-4 mr-2"}),"Powr贸t do listy"]}),e.jsx(X,{children:e.jsx(_e,{title:"Dodaj kurs",description:"Utw贸rz nowy kurs w systemie"})}),e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{children:"Informacje o kursie"})}),e.jsx(P,{children:e.jsxs(cn,{onSubmit:o(i),children:[e.jsxs(wt,{variant:"1-2-2",children:[e.jsx(oe,{label:"Tytu kursu",htmlFor:"title",error:d.title?.message?.toString(),required:!0,children:e.jsx(Z,{id:"title",placeholder:"np. Podstawy programowania",...a("title",{required:"Tytu kursu jest wymagany",minLength:{value:3,message:"Tytu musi mie minimum 3 znaki"}})})}),e.jsx(oe,{label:"Ikona kursu",htmlFor:"icon_emoji",children:e.jsxs("div",{className:"relative",children:[e.jsxs(I,{type:"button",variant:"outline",className:"w-full justify-start",onClick:()=>r(!n),children:[e.jsx("span",{className:"text-2xl mr-2",children:u||""}),"Wybierz ikon"]}),n&&e.jsx("div",{className:"absolute top-full mt-2 p-2 bg-white border rounded-lg shadow-lg z-10",children:e.jsx("div",{className:"grid grid-cols-5 gap-2",children:zv.map(h=>e.jsx("button",{type:"button",className:"p-2 hover:bg-gray-100 rounded text-2xl",onClick:()=>{l("icon_emoji",h),r(!1)},children:h},h))})})]})})]}),e.jsx(oe,{label:"Opis kursu",htmlFor:"description",error:d.description?.message?.toString(),children:e.jsx(bt,{id:"description",placeholder:"Opisz czego uczniowie naucz si na tym kursie...",rows:4,...a("description")})}),e.jsx(oe,{label:"Status publikacji",children:e.jsxs(X,{variant:"start",children:[e.jsx(es,{checked:c("is_published")||!1,onCheckedChange:h=>l("is_published",h)}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Opublikuj kurs od razu (mo偶esz to zmieni p贸藕niej)"})]})}),e.jsxs(dn,{children:[e.jsx(I,{type:"button",variant:"outline",onClick:()=>t("courses"),children:"Anuluj"}),e.jsx(I,{type:"submit",disabled:m,children:m?"Tworzenie...":"Utw贸rz kurs"})]})]})})]})]})},Cv=["","","","","猸","","","","锔","М"],Tv=()=>{const{list:t}=ut(),{id:s}=vt(),[n,r]=x.useState(!1),{data:i,isLoading:a}=Xe({resource:"courses",id:s,liveMode:"off"}),{refineCore:{onFinish:o},register:l,handleSubmit:c,setValue:d,watch:m,formState:{errors:u,isSubmitting:h}}=ln({refineCoreProps:{resource:"courses",id:s,liveMode:"off"}}),p=m("icon_emoji");return a?e.jsx(G,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})}):e.jsxs(G,{children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>t("courses"),children:[e.jsx(Ce,{className:"w-4 h-4 mr-2"}),"Powr贸t do listy"]}),e.jsx(X,{children:e.jsx(_e,{title:"Edytuj kurs",description:`Edycja kursu: ${i?.data?.title}`})}),e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{children:"Informacje o kursie"})}),e.jsx(P,{children:e.jsxs(cn,{onSubmit:c(o),children:[e.jsxs(wt,{variant:"1-2-2",children:[e.jsx(oe,{label:"Tytu kursu",htmlFor:"title",error:u.title?.message,required:!0,children:e.jsx(Z,{id:"title",placeholder:"np. Podstawy programowania",...l("title",{required:"Tytu kursu jest wymagany",minLength:{value:3,message:"Tytu musi mie minimum 3 znaki"}})})}),e.jsx(oe,{label:"Ikona kursu",htmlFor:"icon_emoji",children:e.jsxs("div",{className:"relative",children:[e.jsxs(I,{type:"button",variant:"outline",className:"w-full justify-start",onClick:()=>r(!n),children:[e.jsx("span",{className:"text-2xl mr-2",children:p||""}),"Wybierz ikon"]}),n&&e.jsx("div",{className:"absolute top-full mt-2 p-2 bg-white border rounded-lg shadow-lg z-10",children:e.jsx("div",{className:"grid grid-cols-5 gap-2",children:Cv.map(b=>e.jsx("button",{type:"button",className:"p-2 hover:bg-gray-100 rounded text-2xl",onClick:()=>{d("icon_emoji",b),r(!1)},children:b},b))})})]})})]}),e.jsx(oe,{label:"Opis kursu",htmlFor:"description",error:u.description?.message,children:e.jsx(bt,{id:"description",placeholder:"Opisz czego uczniowie naucz si na tym kursie...",rows:4,...l("description")})}),e.jsx(oe,{label:"Status publikacji",children:e.jsxs(X,{variant:"start",children:[e.jsx(es,{checked:m("is_published")||!1,onCheckedChange:b=>d("is_published",b)}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Kurs jest opublikowany i widoczny dla uczni贸w"})]})}),e.jsxs(dn,{children:[e.jsx(I,{type:"button",variant:"outline",onClick:()=>t("courses"),children:"Anuluj"}),e.jsx(I,{type:"submit",disabled:h,children:h?"Zapisywanie...":"Zapisz zmiany"})]})]})})]})]})},_v=({topic:t,isExpanded:s,onToggle:n,onDelete:r,onEdit:i,onTogglePublish:a,onNavigateToWizard:o,courseId:l,courseTitle:c,children:d,activitiesCount:m,dragHandleProps:u})=>{const h=se(),p=f=>{const y=window.location.pathname+window.location.search;sessionStorage.setItem("returnUrl",y),h(f)},b=(f,y)=>{o&&o(f,{courseId:l,courseTitle:c,topicId:t.id,topicTitle:t.title,...y})};return e.jsxs("div",{className:`border-2 rounded-lg overflow-hidden group ${s?"shadow-lg border-primary":"border-border hover:border-primary/50"}`,children:[e.jsx("div",{className:`p-4 ${s?"bg-primary text-primary-foreground":"bg-background hover:bg-muted"}`,children:e.jsxs(X,{children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("button",{onClick:n,className:`p-1 rounded ${s?"text-primary-foreground hover:bg-primary-foreground/20":"hover:bg-muted"}`,"aria-label":s?"Zwi temat":"Rozwi temat",children:s?e.jsx(Xt,{className:"w-5 h-5"}):e.jsx(is,{className:"w-5 h-5"})}),e.jsx("div",{className:"cursor-move",...u,children:e.jsx(Xh,{className:`w-4 h-4 ${s?"text-primary-foreground/70":"text-muted-foreground"}`})}),e.jsxs("div",{className:"flex-1 cursor-pointer group",onClick:n,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("h4",{className:`font-semibold text-base ${s?"text-primary-foreground":"group-hover:text-primary"}`,children:["Temat ",t.position,": ",t.title]}),e.jsx(H,{variant:t.is_published?s?"secondary":"default":"outline",className:s?"bg-primary-foreground/20 text-primary-foreground border-primary-foreground/30":"",children:t.is_published?"Opublikowany":"Szkic"})]}),e.jsx("div",{className:"flex items-center gap-4 mt-1",children:e.jsxs("span",{className:`text-sm flex items-center gap-1 ${s?"text-primary-foreground/80":"text-muted-foreground"}`,children:[e.jsx(it,{className:"w-3 h-3"}),m," ",m===1?"aktywno":"aktywnoci"]})})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs(br,{children:[e.jsx(wr,{asChild:!0,children:e.jsx(I,{size:"sm",variant:s?"secondary":"ghost",title:"Dodaj aktywno",className:`h-8 w-8 p-0 ${s?"bg-primary-foreground/20 hover:bg-primary-foreground/30 text-primary-foreground":""}`,children:e.jsx(Ie,{className:"h-4 w-4"})})}),e.jsxs(Cn,{align:"end",children:[e.jsx(bf,{children:"Dodaj tre"}),e.jsxs(ve,{onClick:()=>p(`/activities/create?topic_id=${t.id}`),children:[e.jsx(Ie,{className:"mr-2 h-4 w-4"}),"Dodaj rcznie"]}),e.jsx(jt,{}),e.jsxs(ve,{onClick:()=>b("/teacher/educational-material/step1"),className:"text-purple-600 focus:text-purple-600",children:[e.jsx(rt,{className:"mr-2 h-4 w-4"}),"Generuj materia z AI"]}),e.jsxs(ve,{onClick:()=>b("/teacher/quiz-wizard/step1"),className:"text-blue-600 focus:text-blue-600",children:[e.jsx(Os,{className:"mr-2 h-4 w-4"}),"Generuj quiz z AI"]})]})]}),e.jsxs(br,{children:[e.jsx(wr,{asChild:!0,children:e.jsx(I,{variant:s?"secondary":"ghost",size:"sm",className:`h-8 w-8 p-0 ${s?"bg-primary-foreground/20 hover:bg-primary-foreground/30 text-primary-foreground":""}`,children:e.jsx(co,{className:"h-4 w-4"})})}),e.jsxs(Cn,{align:"end",children:[e.jsxs(ve,{onClick:()=>i("teacher/topics",t.id),children:[e.jsx(ks,{className:"mr-2 h-4 w-4"}),"Edytuj temat"]}),e.jsx(jt,{}),e.jsx(ve,{onClick:()=>a(t.id,t.is_published,t.title),children:t.is_published?e.jsxs(e.Fragment,{children:[e.jsx(uo,{className:"mr-2 h-4 w-4"}),"Ukryj temat"]}):e.jsxs(e.Fragment,{children:[e.jsx(Je,{className:"mr-2 h-4 w-4"}),"Opublikuj temat"]})}),e.jsx(jt,{}),e.jsxs(ve,{onClick:()=>r(t.id,t.title),className:"text-red-600 focus:text-red-600",children:[e.jsx(ls,{className:"mr-2 h-4 w-4"}),"Usu temat"]})]})]})]})]})}),s&&e.jsx("div",{className:"p-4 bg-muted/20 border-t-2 border-primary",children:e.jsx("div",{className:"space-y-2",children:d})})]})},Av=({activity:t,topicPosition:s,onDelete:n,onEdit:r,onTogglePublish:i,dragHandleProps:a})=>{const o=se(),l=()=>t.type==="quiz"?e.jsx("div",{className:"p-2 bg-blue-600 rounded-lg",children:e.jsx(at,{className:"w-5 h-5 text-white"})}):e.jsx("div",{className:"p-2 bg-green-600 rounded-lg",children:e.jsx(it,{className:"w-5 h-5 text-white"})}),c=()=>t.type==="quiz"?"Quiz":"Materia";return e.jsxs("div",{className:"group flex items-center gap-4 p-4 bg-white border-2 rounded-lg hover:border-primary/50 transition-all duration-200",children:[e.jsx("div",{className:"cursor-move opacity-0 group-hover:opacity-100 transition-opacity",...a,children:e.jsx(Xh,{className:"w-4 h-4 text-muted-foreground"})}),l(),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("h5",{className:"font-semibold text-sm text-foreground",children:[s,".",t.position," ",t.title]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(H,{variant:t.type==="quiz"?"default":"secondary",className:"text-xs font-medium",children:c()}),t.type==="quiz"&&t._count?.questions!==void 0&&e.jsxs(H,{variant:"outline",className:"text-xs font-medium border-2",children:[e.jsx(Xs,{className:"w-3 h-3 mr-1"}),t._count.questions," ",t._count.questions===1?"pytanie":"pyta"]}),e.jsx(H,{variant:t.is_published?"default":"outline",className:`text-xs font-medium ${t.is_published?"bg-green-600 hover:bg-green-700":"border-2"}`,children:t.is_published?e.jsxs(e.Fragment,{children:[e.jsx(cb,{className:"w-3 h-3 mr-1"}),"Opublikowany"]}):"Szkic"})]})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-muted-foreground",children:[t.duration_min&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Te,{className:"w-3 h-3"}),e.jsxs("span",{children:[t.duration_min," min"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(pe,{className:"w-3 h-3"}),e.jsx("span",{children:"0 ukocze"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[t.type==="quiz"&&e.jsx(I,{size:"sm",variant:"ghost",onClick:()=>o(`/teacher/questions/manage/${t.id}`),title:"Zarzdzaj pytaniami",className:"h-8 w-8 p-0",children:e.jsx(Xs,{className:"h-4 w-4"})}),e.jsx(I,{size:"sm",variant:"ghost",onClick:()=>o(`/teacher/activities/show/${t.id}`),title:"Podgld",className:"h-8 w-8 p-0",children:e.jsx(Je,{className:"h-4 w-4"})}),e.jsxs(br,{children:[e.jsx(wr,{asChild:!0,children:e.jsx(I,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(co,{className:"h-4 w-4"})})}),e.jsxs(Cn,{align:"end",children:[e.jsxs(ve,{onClick:()=>o(`/teacher/activities/show/${t.id}`),children:[e.jsx(Je,{className:"mr-2 h-4 w-4"}),"Podgld"]}),e.jsxs(ve,{onClick:()=>r("teacher/activities",t.id),children:[e.jsx(ks,{className:"mr-2 h-4 w-4"}),"Edytuj"]}),e.jsx(jt,{}),e.jsx(ve,{onClick:()=>i(t.id,t.is_published,t.title),children:t.is_published?e.jsxs(e.Fragment,{children:[e.jsx(uo,{className:"mr-2 h-4 w-4"}),"Ukryj aktywno"]}):e.jsxs(e.Fragment,{children:[e.jsx(Je,{className:"mr-2 h-4 w-4"}),"Opublikuj aktywno"]})}),t.type==="quiz"&&e.jsxs(e.Fragment,{children:[e.jsx(jt,{}),e.jsxs(ve,{onClick:()=>o(`/teacher/questions/manage/${t.id}`),className:"text-blue-600 focus:text-blue-600",children:[e.jsx(Xs,{className:"mr-2 h-4 w-4"}),"Zarzdzaj pytaniami"]}),e.jsxs(ve,{onClick:()=>o(`/teacher/questions/create?activity_id=${t.id}`),className:"text-blue-600 focus:text-blue-600",children:[e.jsx(Ie,{className:"mr-2 h-4 w-4"}),"Dodaj pytanie"]})]}),e.jsx(jt,{}),e.jsxs(ve,{onClick:()=>n(t.id,t.title),className:"text-red-600 focus:text-red-600",children:[e.jsx(ls,{className:"mr-2 h-4 w-4"}),"Usu"]})]})]})]})]})},Dv=({course:t})=>t?e.jsx(D,{className:"flex-1",children:e.jsx(P,{className:"pt-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[t.icon_emoji&&e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-16 h-16 bg-primary/10 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-3xl",children:t.icon_emoji})})}),e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold",children:t.title}),e.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:t.is_published?"Opublikowany":"Szkic"}),t.created_at&&e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Utworzony: ",new Date(t.created_at).toLocaleDateString("pl-PL")]})]})]}),t.description&&e.jsx("div",{className:"prose prose-sm max-w-none",children:e.jsx("p",{className:"text-muted-foreground leading-relaxed whitespace-pre-wrap",children:t.description})})]})]})})}):null;function Pv(){for(var t=arguments.length,s=new Array(t),n=0;n<t;n++)s[n]=arguments[n];return x.useMemo(()=>r=>{s.forEach(i=>i(r))},s)}const vo=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function _r(t){const s=Object.prototype.toString.call(t);return s==="[object Window]"||s==="[object global]"}function Ic(t){return"nodeType"in t}function At(t){var s,n;return t?_r(t)?t:Ic(t)&&(s=(n=t.ownerDocument)==null?void 0:n.defaultView)!=null?s:window:window}function Ec(t){const{Document:s}=At(t);return t instanceof s}function Ki(t){return _r(t)?!1:t instanceof At(t).HTMLElement}function wf(t){return t instanceof At(t).SVGElement}function Ar(t){return t?_r(t)?t.document:Ic(t)?Ec(t)?t:Ki(t)||wf(t)?t.ownerDocument:document:document:document}const vs=vo?x.useLayoutEffect:x.useEffect;function Lc(t){const s=x.useRef(t);return vs(()=>{s.current=t}),x.useCallback(function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return s.current==null?void 0:s.current(...r)},[])}function Mv(){const t=x.useRef(null),s=x.useCallback((r,i)=>{t.current=setInterval(r,i)},[]),n=x.useCallback(()=>{t.current!==null&&(clearInterval(t.current),t.current=null)},[]);return[s,n]}function wi(t,s){s===void 0&&(s=[t]);const n=x.useRef(t);return vs(()=>{n.current!==t&&(n.current=t)},s),n}function Gi(t,s){const n=x.useRef();return x.useMemo(()=>{const r=t(n.current);return n.current=r,r},[...s])}function qa(t){const s=Lc(t),n=x.useRef(null),r=x.useCallback(i=>{i!==n.current&&s?.(i,n.current),n.current=i},[]);return[n,r]}function Ml(t){const s=x.useRef();return x.useEffect(()=>{s.current=t},[t]),s.current}let Yo={};function Qi(t,s){return x.useMemo(()=>{if(s)return s;const n=Yo[t]==null?0:Yo[t]+1;return Yo[t]=n,t+"-"+n},[t,s])}function vf(t){return function(s){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.reduce((a,o)=>{const l=Object.entries(o);for(const[c,d]of l){const m=a[c];m!=null&&(a[c]=m+t*d)}return a},{...s})}}const cr=vf(1),vi=vf(-1);function Iv(t){return"clientX"in t&&"clientY"in t}function Oc(t){if(!t)return!1;const{KeyboardEvent:s}=At(t.target);return s&&t instanceof s}function Ev(t){if(!t)return!1;const{TouchEvent:s}=At(t.target);return s&&t instanceof s}function Il(t){if(Ev(t)){if(t.touches&&t.touches.length){const{clientX:s,clientY:n}=t.touches[0];return{x:s,y:n}}else if(t.changedTouches&&t.changedTouches.length){const{clientX:s,clientY:n}=t.changedTouches[0];return{x:s,y:n}}}return Iv(t)?{x:t.clientX,y:t.clientY}:null}const Ni=Object.freeze({Translate:{toString(t){if(!t)return;const{x:s,y:n}=t;return"translate3d("+(s?Math.round(s):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(t){if(!t)return;const{scaleX:s,scaleY:n}=t;return"scaleX("+s+") scaleY("+n+")"}},Transform:{toString(t){if(t)return[Ni.Translate.toString(t),Ni.Scale.toString(t)].join(" ")}},Transition:{toString(t){let{property:s,duration:n,easing:r}=t;return s+" "+n+"ms "+r}}}),ou="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Lv(t){return t.matches(ou)?t:t.querySelector(ou)}const Ov={display:"none"};function Rv(t){let{id:s,value:n}=t;return ne.createElement("div",{id:s,style:Ov},n)}function $v(t){let{id:s,announcement:n,ariaLiveType:r="assertive"}=t;const i={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return ne.createElement("div",{id:s,style:i,role:"status","aria-live":r,"aria-atomic":!0},n)}function qv(){const[t,s]=x.useState("");return{announce:x.useCallback(r=>{r!=null&&s(r)},[]),announcement:t}}const Nf=x.createContext(null);function Fv(t){const s=x.useContext(Nf);x.useEffect(()=>{if(!s)throw new Error("useDndMonitor must be used within a children of <DndContext>");return s(t)},[t,s])}function Uv(){const[t]=x.useState(()=>new Set),s=x.useCallback(r=>(t.add(r),()=>t.delete(r)),[t]);return[x.useCallback(r=>{let{type:i,event:a}=r;t.forEach(o=>{var l;return(l=o[i])==null?void 0:l.call(o,a)})},[t]),s]}const Bv={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Vv={onDragStart(t){let{active:s}=t;return"Picked up draggable item "+s.id+"."},onDragOver(t){let{active:s,over:n}=t;return n?"Draggable item "+s.id+" was moved over droppable area "+n.id+".":"Draggable item "+s.id+" is no longer over a droppable area."},onDragEnd(t){let{active:s,over:n}=t;return n?"Draggable item "+s.id+" was dropped over droppable area "+n.id:"Draggable item "+s.id+" was dropped."},onDragCancel(t){let{active:s}=t;return"Dragging was cancelled. Draggable item "+s.id+" was dropped."}};function Wv(t){let{announcements:s=Vv,container:n,hiddenTextDescribedById:r,screenReaderInstructions:i=Bv}=t;const{announce:a,announcement:o}=qv(),l=Qi("DndLiveRegion"),[c,d]=x.useState(!1);if(x.useEffect(()=>{d(!0)},[]),Fv(x.useMemo(()=>({onDragStart(u){let{active:h}=u;a(s.onDragStart({active:h}))},onDragMove(u){let{active:h,over:p}=u;s.onDragMove&&a(s.onDragMove({active:h,over:p}))},onDragOver(u){let{active:h,over:p}=u;a(s.onDragOver({active:h,over:p}))},onDragEnd(u){let{active:h,over:p}=u;a(s.onDragEnd({active:h,over:p}))},onDragCancel(u){let{active:h,over:p}=u;a(s.onDragCancel({active:h,over:p}))}}),[a,s])),!c)return null;const m=ne.createElement(ne.Fragment,null,ne.createElement(Rv,{id:r,value:i.draggable}),ne.createElement($v,{id:l,announcement:o}));return n?ti.createPortal(m,n):m}var Ge;(function(t){t.DragStart="dragStart",t.DragMove="dragMove",t.DragEnd="dragEnd",t.DragCancel="dragCancel",t.DragOver="dragOver",t.RegisterDroppable="registerDroppable",t.SetDroppableDisabled="setDroppableDisabled",t.UnregisterDroppable="unregisterDroppable"})(Ge||(Ge={}));function Fa(){}function lu(t,s){return x.useMemo(()=>({sensor:t,options:s??{}}),[t,s])}function Kv(){for(var t=arguments.length,s=new Array(t),n=0;n<t;n++)s[n]=arguments[n];return x.useMemo(()=>[...s].filter(r=>r!=null),[...s])}const cs=Object.freeze({x:0,y:0});function kf(t,s){return Math.sqrt(Math.pow(t.x-s.x,2)+Math.pow(t.y-s.y,2))}function zf(t,s){let{data:{value:n}}=t,{data:{value:r}}=s;return n-r}function Gv(t,s){let{data:{value:n}}=t,{data:{value:r}}=s;return r-n}function cu(t){let{left:s,top:n,height:r,width:i}=t;return[{x:s,y:n},{x:s+i,y:n},{x:s,y:n+r},{x:s+i,y:n+r}]}function Sf(t,s){if(!t||t.length===0)return null;const[n]=t;return n[s]}function du(t,s,n){return s===void 0&&(s=t.left),n===void 0&&(n=t.top),{x:s+t.width*.5,y:n+t.height*.5}}const Qv=t=>{let{collisionRect:s,droppableRects:n,droppableContainers:r}=t;const i=du(s,s.left,s.top),a=[];for(const o of r){const{id:l}=o,c=n.get(l);if(c){const d=kf(du(c),i);a.push({id:l,data:{droppableContainer:o,value:d}})}}return a.sort(zf)},Hv=t=>{let{collisionRect:s,droppableRects:n,droppableContainers:r}=t;const i=cu(s),a=[];for(const o of r){const{id:l}=o,c=n.get(l);if(c){const d=cu(c),m=i.reduce((h,p,b)=>h+kf(d[b],p),0),u=Number((m/4).toFixed(4));a.push({id:l,data:{droppableContainer:o,value:u}})}}return a.sort(zf)};function Zv(t,s){const n=Math.max(s.top,t.top),r=Math.max(s.left,t.left),i=Math.min(s.left+s.width,t.left+t.width),a=Math.min(s.top+s.height,t.top+t.height),o=i-r,l=a-n;if(r<i&&n<a){const c=s.width*s.height,d=t.width*t.height,m=o*l,u=m/(c+d-m);return Number(u.toFixed(4))}return 0}const Yv=t=>{let{collisionRect:s,droppableRects:n,droppableContainers:r}=t;const i=[];for(const a of r){const{id:o}=a,l=n.get(o);if(l){const c=Zv(l,s);c>0&&i.push({id:o,data:{droppableContainer:a,value:c}})}}return i.sort(Gv)};function Jv(t,s,n){return{...t,scaleX:s&&n?s.width/n.width:1,scaleY:s&&n?s.height/n.height:1}}function Cf(t,s){return t&&s?{x:t.left-s.left,y:t.top-s.top}:cs}function Xv(t){return function(n){for(var r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];return i.reduce((o,l)=>({...o,top:o.top+t*l.y,bottom:o.bottom+t*l.y,left:o.left+t*l.x,right:o.right+t*l.x}),{...n})}}const eN=Xv(1);function tN(t){if(t.startsWith("matrix3d(")){const s=t.slice(9,-1).split(/, /);return{x:+s[12],y:+s[13],scaleX:+s[0],scaleY:+s[5]}}else if(t.startsWith("matrix(")){const s=t.slice(7,-1).split(/, /);return{x:+s[4],y:+s[5],scaleX:+s[0],scaleY:+s[3]}}return null}function sN(t,s,n){const r=tN(s);if(!r)return t;const{scaleX:i,scaleY:a,x:o,y:l}=r,c=t.left-o-(1-i)*parseFloat(n),d=t.top-l-(1-a)*parseFloat(n.slice(n.indexOf(" ")+1)),m=i?t.width/i:t.width,u=a?t.height/a:t.height;return{width:m,height:u,top:d,right:c+m,bottom:d+u,left:c}}const nN={ignoreTransform:!1};function Dr(t,s){s===void 0&&(s=nN);let n=t.getBoundingClientRect();if(s.ignoreTransform){const{transform:d,transformOrigin:m}=At(t).getComputedStyle(t);d&&(n=sN(n,d,m))}const{top:r,left:i,width:a,height:o,bottom:l,right:c}=n;return{top:r,left:i,width:a,height:o,bottom:l,right:c}}function uu(t){return Dr(t,{ignoreTransform:!0})}function rN(t){const s=t.innerWidth,n=t.innerHeight;return{top:0,left:0,right:s,bottom:n,width:s,height:n}}function iN(t,s){return s===void 0&&(s=At(t).getComputedStyle(t)),s.position==="fixed"}function aN(t,s){s===void 0&&(s=At(t).getComputedStyle(t));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(i=>{const a=s[i];return typeof a=="string"?n.test(a):!1})}function No(t,s){const n=[];function r(i){if(s!=null&&n.length>=s||!i)return n;if(Ec(i)&&i.scrollingElement!=null&&!n.includes(i.scrollingElement))return n.push(i.scrollingElement),n;if(!Ki(i)||wf(i)||n.includes(i))return n;const a=At(t).getComputedStyle(i);return i!==t&&aN(i,a)&&n.push(i),iN(i,a)?n:r(i.parentNode)}return t?r(t):n}function Tf(t){const[s]=No(t,1);return s??null}function Jo(t){return!vo||!t?null:_r(t)?t:Ic(t)?Ec(t)||t===Ar(t).scrollingElement?window:Ki(t)?t:null:null}function _f(t){return _r(t)?t.scrollX:t.scrollLeft}function Af(t){return _r(t)?t.scrollY:t.scrollTop}function El(t){return{x:_f(t),y:Af(t)}}var Ze;(function(t){t[t.Forward=1]="Forward",t[t.Backward=-1]="Backward"})(Ze||(Ze={}));function Df(t){return!vo||!t?!1:t===document.scrollingElement}function Pf(t){const s={x:0,y:0},n=Df(t)?{height:window.innerHeight,width:window.innerWidth}:{height:t.clientHeight,width:t.clientWidth},r={x:t.scrollWidth-n.width,y:t.scrollHeight-n.height},i=t.scrollTop<=s.y,a=t.scrollLeft<=s.x,o=t.scrollTop>=r.y,l=t.scrollLeft>=r.x;return{isTop:i,isLeft:a,isBottom:o,isRight:l,maxScroll:r,minScroll:s}}const oN={x:.2,y:.2};function lN(t,s,n,r,i){let{top:a,left:o,right:l,bottom:c}=n;r===void 0&&(r=10),i===void 0&&(i=oN);const{isTop:d,isBottom:m,isLeft:u,isRight:h}=Pf(t),p={x:0,y:0},b={x:0,y:0},f={height:s.height*i.y,width:s.width*i.x};return!d&&a<=s.top+f.height?(p.y=Ze.Backward,b.y=r*Math.abs((s.top+f.height-a)/f.height)):!m&&c>=s.bottom-f.height&&(p.y=Ze.Forward,b.y=r*Math.abs((s.bottom-f.height-c)/f.height)),!h&&l>=s.right-f.width?(p.x=Ze.Forward,b.x=r*Math.abs((s.right-f.width-l)/f.width)):!u&&o<=s.left+f.width&&(p.x=Ze.Backward,b.x=r*Math.abs((s.left+f.width-o)/f.width)),{direction:p,speed:b}}function cN(t){if(t===document.scrollingElement){const{innerWidth:a,innerHeight:o}=window;return{top:0,left:0,right:a,bottom:o,width:a,height:o}}const{top:s,left:n,right:r,bottom:i}=t.getBoundingClientRect();return{top:s,left:n,right:r,bottom:i,width:t.clientWidth,height:t.clientHeight}}function Mf(t){return t.reduce((s,n)=>cr(s,El(n)),cs)}function dN(t){return t.reduce((s,n)=>s+_f(n),0)}function uN(t){return t.reduce((s,n)=>s+Af(n),0)}function mN(t,s){if(s===void 0&&(s=Dr),!t)return;const{top:n,left:r,bottom:i,right:a}=s(t);Tf(t)&&(i<=0||a<=0||n>=window.innerHeight||r>=window.innerWidth)&&t.scrollIntoView({block:"center",inline:"center"})}const hN=[["x",["left","right"],dN],["y",["top","bottom"],uN]];class Rc{constructor(s,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=No(n),i=Mf(r);this.rect={...s},this.width=s.width,this.height=s.height;for(const[a,o,l]of hN)for(const c of o)Object.defineProperty(this,c,{get:()=>{const d=l(r),m=i[a]-d;return this.rect[c]+m},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class ai{constructor(s){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=s}add(s,n,r){var i;(i=this.target)==null||i.addEventListener(s,n,r),this.listeners.push([s,n,r])}}function pN(t){const{EventTarget:s}=At(t);return t instanceof s?t:Ar(t)}function Xo(t,s){const n=Math.abs(t.x),r=Math.abs(t.y);return typeof s=="number"?Math.sqrt(n**2+r**2)>s:"x"in s&&"y"in s?n>s.x&&r>s.y:"x"in s?n>s.x:"y"in s?r>s.y:!1}var Wt;(function(t){t.Click="click",t.DragStart="dragstart",t.Keydown="keydown",t.ContextMenu="contextmenu",t.Resize="resize",t.SelectionChange="selectionchange",t.VisibilityChange="visibilitychange"})(Wt||(Wt={}));function mu(t){t.preventDefault()}function fN(t){t.stopPropagation()}var ce;(function(t){t.Space="Space",t.Down="ArrowDown",t.Right="ArrowRight",t.Left="ArrowLeft",t.Up="ArrowUp",t.Esc="Escape",t.Enter="Enter",t.Tab="Tab"})(ce||(ce={}));const If={start:[ce.Space,ce.Enter],cancel:[ce.Esc],end:[ce.Space,ce.Enter,ce.Tab]},xN=(t,s)=>{let{currentCoordinates:n}=s;switch(t.code){case ce.Right:return{...n,x:n.x+25};case ce.Left:return{...n,x:n.x-25};case ce.Down:return{...n,y:n.y+25};case ce.Up:return{...n,y:n.y-25}}};class $c{constructor(s){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=s;const{event:{target:n}}=s;this.props=s,this.listeners=new ai(Ar(n)),this.windowListeners=new ai(At(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Wt.Resize,this.handleCancel),this.windowListeners.add(Wt.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Wt.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:s,onStart:n}=this.props,r=s.node.current;r&&mN(r),n(cs)}handleKeyDown(s){if(Oc(s)){const{active:n,context:r,options:i}=this.props,{keyboardCodes:a=If,coordinateGetter:o=xN,scrollBehavior:l="smooth"}=i,{code:c}=s;if(a.end.includes(c)){this.handleEnd(s);return}if(a.cancel.includes(c)){this.handleCancel(s);return}const{collisionRect:d}=r.current,m=d?{x:d.left,y:d.top}:cs;this.referenceCoordinates||(this.referenceCoordinates=m);const u=o(s,{active:n,context:r.current,currentCoordinates:m});if(u){const h=vi(u,m),p={x:0,y:0},{scrollableAncestors:b}=r.current;for(const f of b){const y=s.code,{isTop:w,isRight:j,isLeft:v,isBottom:T,maxScroll:z,minScroll:k}=Pf(f),N=cN(f),S={x:Math.min(y===ce.Right?N.right-N.width/2:N.right,Math.max(y===ce.Right?N.left:N.left+N.width/2,u.x)),y:Math.min(y===ce.Down?N.bottom-N.height/2:N.bottom,Math.max(y===ce.Down?N.top:N.top+N.height/2,u.y))},_=y===ce.Right&&!j||y===ce.Left&&!v,g=y===ce.Down&&!T||y===ce.Up&&!w;if(_&&S.x!==u.x){const C=f.scrollLeft+h.x,A=y===ce.Right&&C<=z.x||y===ce.Left&&C>=k.x;if(A&&!h.y){f.scrollTo({left:C,behavior:l});return}A?p.x=f.scrollLeft-C:p.x=y===ce.Right?f.scrollLeft-z.x:f.scrollLeft-k.x,p.x&&f.scrollBy({left:-p.x,behavior:l});break}else if(g&&S.y!==u.y){const C=f.scrollTop+h.y,A=y===ce.Down&&C<=z.y||y===ce.Up&&C>=k.y;if(A&&!h.x){f.scrollTo({top:C,behavior:l});return}A?p.y=f.scrollTop-C:p.y=y===ce.Down?f.scrollTop-z.y:f.scrollTop-k.y,p.y&&f.scrollBy({top:-p.y,behavior:l});break}}this.handleMove(s,cr(vi(u,this.referenceCoordinates),p))}}}handleMove(s,n){const{onMove:r}=this.props;s.preventDefault(),r(n)}handleEnd(s){const{onEnd:n}=this.props;s.preventDefault(),this.detach(),n()}handleCancel(s){const{onCancel:n}=this.props;s.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}$c.activators=[{eventName:"onKeyDown",handler:(t,s,n)=>{let{keyboardCodes:r=If,onActivation:i}=s,{active:a}=n;const{code:o}=t.nativeEvent;if(r.start.includes(o)){const l=a.activatorNode.current;return l&&t.target!==l?!1:(t.preventDefault(),i?.({event:t.nativeEvent}),!0)}return!1}}];function hu(t){return!!(t&&"distance"in t)}function pu(t){return!!(t&&"delay"in t)}class qc{constructor(s,n,r){var i;r===void 0&&(r=pN(s.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=s,this.events=n;const{event:a}=s,{target:o}=a;this.props=s,this.events=n,this.document=Ar(o),this.documentListeners=new ai(this.document),this.listeners=new ai(r),this.windowListeners=new ai(At(o)),this.initialCoordinates=(i=Il(a))!=null?i:cs,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:s,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(s.move.name,this.handleMove,{passive:!1}),this.listeners.add(s.end.name,this.handleEnd),s.cancel&&this.listeners.add(s.cancel.name,this.handleCancel),this.windowListeners.add(Wt.Resize,this.handleCancel),this.windowListeners.add(Wt.DragStart,mu),this.windowListeners.add(Wt.VisibilityChange,this.handleCancel),this.windowListeners.add(Wt.ContextMenu,mu),this.documentListeners.add(Wt.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(pu(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(hu(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(s,n){const{active:r,onPending:i}=this.props;i(r,s,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:s}=this,{onStart:n}=this.props;s&&(this.activated=!0,this.documentListeners.add(Wt.Click,fN,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Wt.SelectionChange,this.removeTextSelection),n(s))}handleMove(s){var n;const{activated:r,initialCoordinates:i,props:a}=this,{onMove:o,options:{activationConstraint:l}}=a;if(!i)return;const c=(n=Il(s))!=null?n:cs,d=vi(i,c);if(!r&&l){if(hu(l)){if(l.tolerance!=null&&Xo(d,l.tolerance))return this.handleCancel();if(Xo(d,l.distance))return this.handleStart()}if(pu(l)&&Xo(d,l.tolerance))return this.handleCancel();this.handlePending(l,d);return}s.cancelable&&s.preventDefault(),o(c)}handleEnd(){const{onAbort:s,onEnd:n}=this.props;this.detach(),this.activated||s(this.props.active),n()}handleCancel(){const{onAbort:s,onCancel:n}=this.props;this.detach(),this.activated||s(this.props.active),n()}handleKeydown(s){s.code===ce.Esc&&this.handleCancel()}removeTextSelection(){var s;(s=this.document.getSelection())==null||s.removeAllRanges()}}const gN={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Fc extends qc{constructor(s){const{event:n}=s,r=Ar(n.target);super(s,gN,r)}}Fc.activators=[{eventName:"onPointerDown",handler:(t,s)=>{let{nativeEvent:n}=t,{onActivation:r}=s;return!n.isPrimary||n.button!==0?!1:(r?.({event:n}),!0)}}];const jN={move:{name:"mousemove"},end:{name:"mouseup"}};var Ll;(function(t){t[t.RightClick=2]="RightClick"})(Ll||(Ll={}));class yN extends qc{constructor(s){super(s,jN,Ar(s.event.target))}}yN.activators=[{eventName:"onMouseDown",handler:(t,s)=>{let{nativeEvent:n}=t,{onActivation:r}=s;return n.button===Ll.RightClick?!1:(r?.({event:n}),!0)}}];const el={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class bN extends qc{constructor(s){super(s,el)}static setup(){return window.addEventListener(el.move.name,s,{capture:!1,passive:!1}),function(){window.removeEventListener(el.move.name,s)};function s(){}}}bN.activators=[{eventName:"onTouchStart",handler:(t,s)=>{let{nativeEvent:n}=t,{onActivation:r}=s;const{touches:i}=n;return i.length>1?!1:(r?.({event:n}),!0)}}];var oi;(function(t){t[t.Pointer=0]="Pointer",t[t.DraggableRect=1]="DraggableRect"})(oi||(oi={}));var Ua;(function(t){t[t.TreeOrder=0]="TreeOrder",t[t.ReversedTreeOrder=1]="ReversedTreeOrder"})(Ua||(Ua={}));function wN(t){let{acceleration:s,activator:n=oi.Pointer,canScroll:r,draggingRect:i,enabled:a,interval:o=5,order:l=Ua.TreeOrder,pointerCoordinates:c,scrollableAncestors:d,scrollableAncestorRects:m,delta:u,threshold:h}=t;const p=NN({delta:u,disabled:!a}),[b,f]=Mv(),y=x.useRef({x:0,y:0}),w=x.useRef({x:0,y:0}),j=x.useMemo(()=>{switch(n){case oi.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case oi.DraggableRect:return i}},[n,i,c]),v=x.useRef(null),T=x.useCallback(()=>{const k=v.current;if(!k)return;const N=y.current.x*w.current.x,S=y.current.y*w.current.y;k.scrollBy(N,S)},[]),z=x.useMemo(()=>l===Ua.TreeOrder?[...d].reverse():d,[l,d]);x.useEffect(()=>{if(!a||!d.length||!j){f();return}for(const k of z){if(r?.(k)===!1)continue;const N=d.indexOf(k),S=m[N];if(!S)continue;const{direction:_,speed:g}=lN(k,S,j,s,h);for(const C of["x","y"])p[C][_[C]]||(g[C]=0,_[C]=0);if(g.x>0||g.y>0){f(),v.current=k,b(T,o),y.current=g,w.current=_;return}}y.current={x:0,y:0},w.current={x:0,y:0},f()},[s,T,r,f,a,o,JSON.stringify(j),JSON.stringify(p),b,d,z,m,JSON.stringify(h)])}const vN={x:{[Ze.Backward]:!1,[Ze.Forward]:!1},y:{[Ze.Backward]:!1,[Ze.Forward]:!1}};function NN(t){let{delta:s,disabled:n}=t;const r=Ml(s);return Gi(i=>{if(n||!r||!i)return vN;const a={x:Math.sign(s.x-r.x),y:Math.sign(s.y-r.y)};return{x:{[Ze.Backward]:i.x[Ze.Backward]||a.x===-1,[Ze.Forward]:i.x[Ze.Forward]||a.x===1},y:{[Ze.Backward]:i.y[Ze.Backward]||a.y===-1,[Ze.Forward]:i.y[Ze.Forward]||a.y===1}}},[n,s,r])}function kN(t,s){const n=s!=null?t.get(s):void 0,r=n?n.node.current:null;return Gi(i=>{var a;return s==null?null:(a=r??i)!=null?a:null},[r,s])}function zN(t,s){return x.useMemo(()=>t.reduce((n,r)=>{const{sensor:i}=r,a=i.activators.map(o=>({eventName:o.eventName,handler:s(o.handler,r)}));return[...n,...a]},[]),[t,s])}var ki;(function(t){t[t.Always=0]="Always",t[t.BeforeDragging=1]="BeforeDragging",t[t.WhileDragging=2]="WhileDragging"})(ki||(ki={}));var Ol;(function(t){t.Optimized="optimized"})(Ol||(Ol={}));const fu=new Map;function SN(t,s){let{dragging:n,dependencies:r,config:i}=s;const[a,o]=x.useState(null),{frequency:l,measure:c,strategy:d}=i,m=x.useRef(t),u=y(),h=wi(u),p=x.useCallback(function(w){w===void 0&&(w=[]),!h.current&&o(j=>j===null?w:j.concat(w.filter(v=>!j.includes(v))))},[h]),b=x.useRef(null),f=Gi(w=>{if(u&&!n)return fu;if(!w||w===fu||m.current!==t||a!=null){const j=new Map;for(let v of t){if(!v)continue;if(a&&a.length>0&&!a.includes(v.id)&&v.rect.current){j.set(v.id,v.rect.current);continue}const T=v.node.current,z=T?new Rc(c(T),T):null;v.rect.current=z,z&&j.set(v.id,z)}return j}return w},[t,a,n,u,c]);return x.useEffect(()=>{m.current=t},[t]),x.useEffect(()=>{u||p()},[n,u]),x.useEffect(()=>{a&&a.length>0&&o(null)},[JSON.stringify(a)]),x.useEffect(()=>{u||typeof l!="number"||b.current!==null||(b.current=setTimeout(()=>{p(),b.current=null},l))},[l,u,p,...r]),{droppableRects:f,measureDroppableContainers:p,measuringScheduled:a!=null};function y(){switch(d){case ki.Always:return!1;case ki.BeforeDragging:return n;default:return!n}}}function Ef(t,s){return Gi(n=>t?n||(typeof s=="function"?s(t):t):null,[s,t])}function CN(t,s){return Ef(t,s)}function TN(t){let{callback:s,disabled:n}=t;const r=Lc(s),i=x.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:a}=window;return new a(r)},[r,n]);return x.useEffect(()=>()=>i?.disconnect(),[i]),i}function ko(t){let{callback:s,disabled:n}=t;const r=Lc(s),i=x.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:a}=window;return new a(r)},[n]);return x.useEffect(()=>()=>i?.disconnect(),[i]),i}function _N(t){return new Rc(Dr(t),t)}function xu(t,s,n){s===void 0&&(s=_N);const[r,i]=x.useState(null);function a(){i(c=>{if(!t)return null;if(t.isConnected===!1){var d;return(d=c??n)!=null?d:null}const m=s(t);return JSON.stringify(c)===JSON.stringify(m)?c:m})}const o=TN({callback(c){if(t)for(const d of c){const{type:m,target:u}=d;if(m==="childList"&&u instanceof HTMLElement&&u.contains(t)){a();break}}}}),l=ko({callback:a});return vs(()=>{a(),t?(l?.observe(t),o?.observe(document.body,{childList:!0,subtree:!0})):(l?.disconnect(),o?.disconnect())},[t]),r}function AN(t){const s=Ef(t);return Cf(t,s)}const gu=[];function DN(t){const s=x.useRef(t),n=Gi(r=>t?r&&r!==gu&&t&&s.current&&t.parentNode===s.current.parentNode?r:No(t):gu,[t]);return x.useEffect(()=>{s.current=t},[t]),n}function PN(t){const[s,n]=x.useState(null),r=x.useRef(t),i=x.useCallback(a=>{const o=Jo(a.target);o&&n(l=>l?(l.set(o,El(o)),new Map(l)):null)},[]);return x.useEffect(()=>{const a=r.current;if(t!==a){o(a);const l=t.map(c=>{const d=Jo(c);return d?(d.addEventListener("scroll",i,{passive:!0}),[d,El(d)]):null}).filter(c=>c!=null);n(l.length?new Map(l):null),r.current=t}return()=>{o(t),o(a)};function o(l){l.forEach(c=>{const d=Jo(c);d?.removeEventListener("scroll",i)})}},[i,t]),x.useMemo(()=>t.length?s?Array.from(s.values()).reduce((a,o)=>cr(a,o),cs):Mf(t):cs,[t,s])}function ju(t,s){s===void 0&&(s=[]);const n=x.useRef(null);return x.useEffect(()=>{n.current=null},s),x.useEffect(()=>{const r=t!==cs;r&&!n.current&&(n.current=t),!r&&n.current&&(n.current=null)},[t]),n.current?vi(t,n.current):cs}function MN(t){x.useEffect(()=>{if(!vo)return;const s=t.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of s)n?.()}},t.map(s=>{let{sensor:n}=s;return n}))}function IN(t,s){return x.useMemo(()=>t.reduce((n,r)=>{let{eventName:i,handler:a}=r;return n[i]=o=>{a(o,s)},n},{}),[t,s])}function Lf(t){return x.useMemo(()=>t?rN(t):null,[t])}const yu=[];function EN(t,s){s===void 0&&(s=Dr);const[n]=t,r=Lf(n?At(n):null),[i,a]=x.useState(yu);function o(){a(()=>t.length?t.map(c=>Df(c)?r:new Rc(s(c),c)):yu)}const l=ko({callback:o});return vs(()=>{l?.disconnect(),o(),t.forEach(c=>l?.observe(c))},[t]),i}function LN(t){if(!t)return null;if(t.children.length>1)return t;const s=t.children[0];return Ki(s)?s:t}function ON(t){let{measure:s}=t;const[n,r]=x.useState(null),i=x.useCallback(d=>{for(const{target:m}of d)if(Ki(m)){r(u=>{const h=s(m);return u?{...u,width:h.width,height:h.height}:h});break}},[s]),a=ko({callback:i}),o=x.useCallback(d=>{const m=LN(d);a?.disconnect(),m&&a?.observe(m),r(m?s(m):null)},[s,a]),[l,c]=qa(o);return x.useMemo(()=>({nodeRef:l,rect:n,setRef:c}),[n,l,c])}const RN=[{sensor:Fc,options:{}},{sensor:$c,options:{}}],$N={current:{}},Na={draggable:{measure:uu},droppable:{measure:uu,strategy:ki.WhileDragging,frequency:Ol.Optimized},dragOverlay:{measure:Dr}};class li extends Map{get(s){var n;return s!=null&&(n=super.get(s))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(s=>{let{disabled:n}=s;return!n})}getNodeFor(s){var n,r;return(n=(r=this.get(s))==null?void 0:r.node.current)!=null?n:void 0}}const qN={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new li,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Fa},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Na,measureDroppableContainers:Fa,windowRect:null,measuringScheduled:!1},FN={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Fa,draggableNodes:new Map,over:null,measureDroppableContainers:Fa},zo=x.createContext(FN),Of=x.createContext(qN);function UN(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new li}}}function BN(t,s){switch(s.type){case Ge.DragStart:return{...t,draggable:{...t.draggable,initialCoordinates:s.initialCoordinates,active:s.active}};case Ge.DragMove:return t.draggable.active==null?t:{...t,draggable:{...t.draggable,translate:{x:s.coordinates.x-t.draggable.initialCoordinates.x,y:s.coordinates.y-t.draggable.initialCoordinates.y}}};case Ge.DragEnd:case Ge.DragCancel:return{...t,draggable:{...t.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Ge.RegisterDroppable:{const{element:n}=s,{id:r}=n,i=new li(t.droppable.containers);return i.set(r,n),{...t,droppable:{...t.droppable,containers:i}}}case Ge.SetDroppableDisabled:{const{id:n,key:r,disabled:i}=s,a=t.droppable.containers.get(n);if(!a||r!==a.key)return t;const o=new li(t.droppable.containers);return o.set(n,{...a,disabled:i}),{...t,droppable:{...t.droppable,containers:o}}}case Ge.UnregisterDroppable:{const{id:n,key:r}=s,i=t.droppable.containers.get(n);if(!i||r!==i.key)return t;const a=new li(t.droppable.containers);return a.delete(n),{...t,droppable:{...t.droppable,containers:a}}}default:return t}}function VN(t){let{disabled:s}=t;const{active:n,activatorEvent:r,draggableNodes:i}=x.useContext(zo),a=Ml(r),o=Ml(n?.id);return x.useEffect(()=>{if(!s&&!r&&a&&o!=null){if(!Oc(a)||document.activeElement===a.target)return;const l=i.get(o);if(!l)return;const{activatorNode:c,node:d}=l;if(!c.current&&!d.current)return;requestAnimationFrame(()=>{for(const m of[c.current,d.current]){if(!m)continue;const u=Lv(m);if(u){u.focus();break}}})}},[r,s,i,o,a]),null}function WN(t,s){let{transform:n,...r}=s;return t!=null&&t.length?t.reduce((i,a)=>a({transform:i,...r}),n):n}function KN(t){return x.useMemo(()=>({draggable:{...Na.draggable,...t?.draggable},droppable:{...Na.droppable,...t?.droppable},dragOverlay:{...Na.dragOverlay,...t?.dragOverlay}}),[t?.draggable,t?.droppable,t?.dragOverlay])}function GN(t){let{activeNode:s,measure:n,initialRect:r,config:i=!0}=t;const a=x.useRef(!1),{x:o,y:l}=typeof i=="boolean"?{x:i,y:i}:i;vs(()=>{if(!o&&!l||!s){a.current=!1;return}if(a.current||!r)return;const d=s?.node.current;if(!d||d.isConnected===!1)return;const m=n(d),u=Cf(m,r);if(o||(u.x=0),l||(u.y=0),a.current=!0,Math.abs(u.x)>0||Math.abs(u.y)>0){const h=Tf(d);h&&h.scrollBy({top:u.y,left:u.x})}},[s,o,l,r,n])}const Rf=x.createContext({...cs,scaleX:1,scaleY:1});var Hs;(function(t){t[t.Uninitialized=0]="Uninitialized",t[t.Initializing=1]="Initializing",t[t.Initialized=2]="Initialized"})(Hs||(Hs={}));const QN=x.memo(function(s){var n,r,i,a;let{id:o,accessibility:l,autoScroll:c=!0,children:d,sensors:m=RN,collisionDetection:u=Yv,measuring:h,modifiers:p,...b}=s;const f=x.useReducer(BN,void 0,UN),[y,w]=f,[j,v]=Uv(),[T,z]=x.useState(Hs.Uninitialized),k=T===Hs.Initialized,{draggable:{active:N,nodes:S,translate:_},droppable:{containers:g}}=y,C=N!=null?S.get(N):null,A=x.useRef({initial:null,translated:null}),E=x.useMemo(()=>{var ot;return N!=null?{id:N,data:(ot=C?.data)!=null?ot:$N,rect:A}:null},[N,C]),M=x.useRef(null),[O,Q]=x.useState(null),[L,U]=x.useState(null),F=wi(b,Object.values(b)),ae=Qi("DndDescribedBy",o),B=x.useMemo(()=>g.getEnabled(),[g]),ee=KN(h),{droppableRects:et,measureDroppableContainers:ts,measuringScheduled:Us}=SN(B,{dragging:k,dependencies:[_.x,_.y],config:ee.droppable}),Qe=kN(S,N),He=x.useMemo(()=>L?Il(L):null,[L]),ss=Hj(),Ss=CN(Qe,ee.draggable.measure);GN({activeNode:N!=null?S.get(N):null,config:ss.layoutShiftCompensation,initialRect:Ss,measure:ee.draggable.measure});const be=xu(Qe,ee.draggable.measure,Ss),Kr=xu(Qe?Qe.parentElement:null),us=x.useRef({activatorEvent:null,active:null,activeNode:Qe,collisionRect:null,collisions:null,droppableRects:et,draggableNodes:S,draggingNode:null,draggingNodeRect:null,droppableContainers:g,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Bn=g.getNodeFor((n=us.current.over)==null?void 0:n.id),Cs=ON({measure:ee.dragOverlay.measure}),Vn=(r=Cs.nodeRef.current)!=null?r:Qe,Wn=k?(i=Cs.rect)!=null?i:be:null,Fd=!!(Cs.nodeRef.current&&Cs.rect),Ud=AN(Fd?null:be),Wo=Lf(Vn?At(Vn):null),Bs=DN(k?Bn??Qe:null),oa=EN(Bs),la=WN(p,{transform:{x:_.x-Ud.x,y:_.y-Ud.y,scaleX:1,scaleY:1},activatorEvent:L,active:E,activeNodeRect:be,containerNodeRect:Kr,draggingNodeRect:Wn,over:us.current.over,overlayNodeRect:Cs.rect,scrollableAncestors:Bs,scrollableAncestorRects:oa,windowRect:Wo}),Bd=He?cr(He,_):null,Vd=PN(Bs),Uj=ju(Vd),Bj=ju(Vd,[be]),Kn=cr(la,Uj),Gn=Wn?eN(Wn,la):null,Gr=E&&Gn?u({active:E,collisionRect:Gn,droppableRects:et,droppableContainers:B,pointerCoordinates:Bd}):null,Wd=Sf(Gr,"id"),[Vs,Kd]=x.useState(null),Vj=Fd?la:cr(la,Bj),Wj=Jv(Vj,(a=Vs?.rect)!=null?a:null,be),Ko=x.useRef(null),Gd=x.useCallback((ot,Dt)=>{let{sensor:Pt,options:Ws}=Dt;if(M.current==null)return;const Ft=S.get(M.current);if(!Ft)return;const Mt=ot.nativeEvent,ms=new Pt({active:M.current,activeNode:Ft,event:Mt,options:Ws,context:us,onAbort(tt){if(!S.get(tt))return;const{onDragAbort:hs}=F.current,Ts={id:tt};hs?.(Ts),j({type:"onDragAbort",event:Ts})},onPending(tt,Ks,hs,Ts){if(!S.get(tt))return;const{onDragPending:Hr}=F.current,Gs={id:tt,constraint:Ks,initialCoordinates:hs,offset:Ts};Hr?.(Gs),j({type:"onDragPending",event:Gs})},onStart(tt){const Ks=M.current;if(Ks==null)return;const hs=S.get(Ks);if(!hs)return;const{onDragStart:Ts}=F.current,Qr={activatorEvent:Mt,active:{id:Ks,data:hs.data,rect:A}};ti.unstable_batchedUpdates(()=>{Ts?.(Qr),z(Hs.Initializing),w({type:Ge.DragStart,initialCoordinates:tt,active:Ks}),j({type:"onDragStart",event:Qr}),Q(Ko.current),U(Mt)})},onMove(tt){w({type:Ge.DragMove,coordinates:tt})},onEnd:Qn(Ge.DragEnd),onCancel:Qn(Ge.DragCancel)});Ko.current=ms;function Qn(tt){return async function(){const{active:hs,collisions:Ts,over:Qr,scrollAdjustedTranslate:Hr}=us.current;let Gs=null;if(hs&&Hr){const{cancelDrop:Zr}=F.current;Gs={activatorEvent:Mt,active:hs,collisions:Ts,delta:Hr,over:Qr},tt===Ge.DragEnd&&typeof Zr=="function"&&await Promise.resolve(Zr(Gs))&&(tt=Ge.DragCancel)}M.current=null,ti.unstable_batchedUpdates(()=>{w({type:tt}),z(Hs.Uninitialized),Kd(null),Q(null),U(null),Ko.current=null;const Zr=tt===Ge.DragEnd?"onDragEnd":"onDragCancel";if(Gs){const Go=F.current[Zr];Go?.(Gs),j({type:Zr,event:Gs})}})}}},[S]),Kj=x.useCallback((ot,Dt)=>(Pt,Ws)=>{const Ft=Pt.nativeEvent,Mt=S.get(Ws);if(M.current!==null||!Mt||Ft.dndKit||Ft.defaultPrevented)return;const ms={active:Mt};ot(Pt,Dt.options,ms)===!0&&(Ft.dndKit={capturedBy:Dt.sensor},M.current=Ws,Gd(Pt,Dt))},[S,Gd]),Qd=zN(m,Kj);MN(m),vs(()=>{be&&T===Hs.Initializing&&z(Hs.Initialized)},[be,T]),x.useEffect(()=>{const{onDragMove:ot}=F.current,{active:Dt,activatorEvent:Pt,collisions:Ws,over:Ft}=us.current;if(!Dt||!Pt)return;const Mt={active:Dt,activatorEvent:Pt,collisions:Ws,delta:{x:Kn.x,y:Kn.y},over:Ft};ti.unstable_batchedUpdates(()=>{ot?.(Mt),j({type:"onDragMove",event:Mt})})},[Kn.x,Kn.y]),x.useEffect(()=>{const{active:ot,activatorEvent:Dt,collisions:Pt,droppableContainers:Ws,scrollAdjustedTranslate:Ft}=us.current;if(!ot||M.current==null||!Dt||!Ft)return;const{onDragOver:Mt}=F.current,ms=Ws.get(Wd),Qn=ms&&ms.rect.current?{id:ms.id,rect:ms.rect.current,data:ms.data,disabled:ms.disabled}:null,tt={active:ot,activatorEvent:Dt,collisions:Pt,delta:{x:Ft.x,y:Ft.y},over:Qn};ti.unstable_batchedUpdates(()=>{Kd(Qn),Mt?.(tt),j({type:"onDragOver",event:tt})})},[Wd]),vs(()=>{us.current={activatorEvent:L,active:E,activeNode:Qe,collisionRect:Gn,collisions:Gr,droppableRects:et,draggableNodes:S,draggingNode:Vn,draggingNodeRect:Wn,droppableContainers:g,over:Vs,scrollableAncestors:Bs,scrollAdjustedTranslate:Kn},A.current={initial:Wn,translated:Gn}},[E,Qe,Gr,Gn,S,Vn,Wn,et,g,Vs,Bs,Kn]),wN({...ss,delta:_,draggingRect:Gn,pointerCoordinates:Bd,scrollableAncestors:Bs,scrollableAncestorRects:oa});const Gj=x.useMemo(()=>({active:E,activeNode:Qe,activeNodeRect:be,activatorEvent:L,collisions:Gr,containerNodeRect:Kr,dragOverlay:Cs,draggableNodes:S,droppableContainers:g,droppableRects:et,over:Vs,measureDroppableContainers:ts,scrollableAncestors:Bs,scrollableAncestorRects:oa,measuringConfiguration:ee,measuringScheduled:Us,windowRect:Wo}),[E,Qe,be,L,Gr,Kr,Cs,S,g,et,Vs,ts,Bs,oa,ee,Us,Wo]),Qj=x.useMemo(()=>({activatorEvent:L,activators:Qd,active:E,activeNodeRect:be,ariaDescribedById:{draggable:ae},dispatch:w,draggableNodes:S,over:Vs,measureDroppableContainers:ts}),[L,Qd,E,be,w,ae,S,Vs,ts]);return ne.createElement(Nf.Provider,{value:v},ne.createElement(zo.Provider,{value:Qj},ne.createElement(Of.Provider,{value:Gj},ne.createElement(Rf.Provider,{value:Wj},d)),ne.createElement(VN,{disabled:l?.restoreFocus===!1})),ne.createElement(Wv,{...l,hiddenTextDescribedById:ae}));function Hj(){const ot=O?.autoScrollEnabled===!1,Dt=typeof c=="object"?c.enabled===!1:c===!1,Pt=k&&!ot&&!Dt;return typeof c=="object"?{...c,enabled:Pt}:{enabled:Pt}}}),HN=x.createContext(null),bu="button",ZN="Draggable";function YN(t){let{id:s,data:n,disabled:r=!1,attributes:i}=t;const a=Qi(ZN),{activators:o,activatorEvent:l,active:c,activeNodeRect:d,ariaDescribedById:m,draggableNodes:u,over:h}=x.useContext(zo),{role:p=bu,roleDescription:b="draggable",tabIndex:f=0}=i??{},y=c?.id===s,w=x.useContext(y?Rf:HN),[j,v]=qa(),[T,z]=qa(),k=IN(o,s),N=wi(n);vs(()=>(u.set(s,{id:s,key:a,node:j,activatorNode:T,data:N}),()=>{const _=u.get(s);_&&_.key===a&&u.delete(s)}),[u,s]);const S=x.useMemo(()=>({role:p,tabIndex:f,"aria-disabled":r,"aria-pressed":y&&p===bu?!0:void 0,"aria-roledescription":b,"aria-describedby":m.draggable}),[r,p,f,y,b,m.draggable]);return{active:c,activatorEvent:l,activeNodeRect:d,attributes:S,isDragging:y,listeners:r?void 0:k,node:j,over:h,setNodeRef:v,setActivatorNodeRef:z,transform:w}}function JN(){return x.useContext(Of)}const XN="Droppable",ek={timeout:25};function tk(t){let{data:s,disabled:n=!1,id:r,resizeObserverConfig:i}=t;const a=Qi(XN),{active:o,dispatch:l,over:c,measureDroppableContainers:d}=x.useContext(zo),m=x.useRef({disabled:n}),u=x.useRef(!1),h=x.useRef(null),p=x.useRef(null),{disabled:b,updateMeasurementsFor:f,timeout:y}={...ek,...i},w=wi(f??r),j=x.useCallback(()=>{if(!u.current){u.current=!0;return}p.current!=null&&clearTimeout(p.current),p.current=setTimeout(()=>{d(Array.isArray(w.current)?w.current:[w.current]),p.current=null},y)},[y]),v=ko({callback:j,disabled:b||!o}),T=x.useCallback((S,_)=>{v&&(_&&(v.unobserve(_),u.current=!1),S&&v.observe(S))},[v]),[z,k]=qa(T),N=wi(s);return x.useEffect(()=>{!v||!z.current||(v.disconnect(),u.current=!1,v.observe(z.current))},[z,v]),x.useEffect(()=>(l({type:Ge.RegisterDroppable,element:{id:r,key:a,disabled:n,node:z,rect:h,data:N}}),()=>l({type:Ge.UnregisterDroppable,key:a,id:r})),[r]),x.useEffect(()=>{n!==m.current.disabled&&(l({type:Ge.SetDroppableDisabled,id:r,key:a,disabled:n}),m.current.disabled=n)},[r,a,n,l]),{active:o,rect:h,isOver:c?.id===r,node:z,over:c,setNodeRef:k}}function Uc(t,s,n){const r=t.slice();return r.splice(n<0?r.length+n:n,0,r.splice(s,1)[0]),r}function sk(t,s){return t.reduce((n,r,i)=>{const a=s.get(r);return a&&(n[i]=a),n},Array(t.length))}function da(t){return t!==null&&t>=0}function nk(t,s){if(t===s)return!0;if(t.length!==s.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==s[n])return!1;return!0}function rk(t){return typeof t=="boolean"?{draggable:t,droppable:t}:t}const $f=t=>{let{rects:s,activeIndex:n,overIndex:r,index:i}=t;const a=Uc(s,r,n),o=s[i],l=a[i];return!l||!o?null:{x:l.left-o.left,y:l.top-o.top,scaleX:l.width/o.width,scaleY:l.height/o.height}},ua={scaleX:1,scaleY:1},ik=t=>{var s;let{activeIndex:n,activeNodeRect:r,index:i,rects:a,overIndex:o}=t;const l=(s=a[n])!=null?s:r;if(!l)return null;if(i===n){const d=a[o];return d?{x:0,y:n<o?d.top+d.height-(l.top+l.height):d.top-l.top,...ua}:null}const c=ak(a,i,n);return i>n&&i<=o?{x:0,y:-l.height-c,...ua}:i<n&&i>=o?{x:0,y:l.height+c,...ua}:{x:0,y:0,...ua}};function ak(t,s,n){const r=t[s],i=t[s-1],a=t[s+1];return r?n<s?i?r.top-(i.top+i.height):a?a.top-(r.top+r.height):0:a?a.top-(r.top+r.height):i?r.top-(i.top+i.height):0:0}const qf="Sortable",Ff=ne.createContext({activeIndex:-1,containerId:qf,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:$f,disabled:{draggable:!1,droppable:!1}});function ok(t){let{children:s,id:n,items:r,strategy:i=$f,disabled:a=!1}=t;const{active:o,dragOverlay:l,droppableRects:c,over:d,measureDroppableContainers:m}=JN(),u=Qi(qf,n),h=l.rect!==null,p=x.useMemo(()=>r.map(k=>typeof k=="object"&&"id"in k?k.id:k),[r]),b=o!=null,f=o?p.indexOf(o.id):-1,y=d?p.indexOf(d.id):-1,w=x.useRef(p),j=!nk(p,w.current),v=y!==-1&&f===-1||j,T=rk(a);vs(()=>{j&&b&&m(p)},[j,p,b,m]),x.useEffect(()=>{w.current=p},[p]);const z=x.useMemo(()=>({activeIndex:f,containerId:u,disabled:T,disableTransforms:v,items:p,overIndex:y,useDragOverlay:h,sortedRects:sk(p,c),strategy:i}),[f,u,T.draggable,T.droppable,v,p,y,c,h,i]);return ne.createElement(Ff.Provider,{value:z},s)}const lk=t=>{let{id:s,items:n,activeIndex:r,overIndex:i}=t;return Uc(n,r,i).indexOf(s)},ck=t=>{let{containerId:s,isSorting:n,wasDragging:r,index:i,items:a,newIndex:o,previousItems:l,previousContainerId:c,transition:d}=t;return!d||!r||l!==a&&i===o?!1:n?!0:o!==i&&s===c},dk={duration:200,easing:"ease"},Uf="transform",uk=Ni.Transition.toString({property:Uf,duration:0,easing:"linear"}),mk={roleDescription:"sortable"};function hk(t){let{disabled:s,index:n,node:r,rect:i}=t;const[a,o]=x.useState(null),l=x.useRef(n);return vs(()=>{if(!s&&n!==l.current&&r.current){const c=i.current;if(c){const d=Dr(r.current,{ignoreTransform:!0}),m={x:c.left-d.left,y:c.top-d.top,scaleX:c.width/d.width,scaleY:c.height/d.height};(m.x||m.y)&&o(m)}}n!==l.current&&(l.current=n)},[s,n,r,i]),x.useEffect(()=>{a&&o(null)},[a]),a}function pk(t){let{animateLayoutChanges:s=ck,attributes:n,disabled:r,data:i,getNewIndex:a=lk,id:o,strategy:l,resizeObserverConfig:c,transition:d=dk}=t;const{items:m,containerId:u,activeIndex:h,disabled:p,disableTransforms:b,sortedRects:f,overIndex:y,useDragOverlay:w,strategy:j}=x.useContext(Ff),v=fk(r,p),T=m.indexOf(o),z=x.useMemo(()=>({sortable:{containerId:u,index:T,items:m},...i}),[u,i,T,m]),k=x.useMemo(()=>m.slice(m.indexOf(o)),[m,o]),{rect:N,node:S,isOver:_,setNodeRef:g}=tk({id:o,data:z,disabled:v.droppable,resizeObserverConfig:{updateMeasurementsFor:k,...c}}),{active:C,activatorEvent:A,activeNodeRect:E,attributes:M,setNodeRef:O,listeners:Q,isDragging:L,over:U,setActivatorNodeRef:F,transform:ae}=YN({id:o,data:z,attributes:{...mk,...n},disabled:v.draggable}),B=Pv(g,O),ee=!!C,et=ee&&!b&&da(h)&&da(y),ts=!w&&L,Us=ts&&et?ae:null,He=et?Us??(l??j)({rects:f,activeNodeRect:E,activeIndex:h,overIndex:y,index:T}):null,ss=da(h)&&da(y)?a({id:o,items:m,activeIndex:h,overIndex:y}):T,Ss=C?.id,be=x.useRef({activeId:Ss,items:m,newIndex:ss,containerId:u}),Kr=m!==be.current.items,us=s({active:C,containerId:u,isDragging:L,isSorting:ee,id:o,index:T,items:m,newIndex:be.current.newIndex,previousItems:be.current.items,previousContainerId:be.current.containerId,transition:d,wasDragging:be.current.activeId!=null}),Bn=hk({disabled:!us,index:T,node:S,rect:N});return x.useEffect(()=>{ee&&be.current.newIndex!==ss&&(be.current.newIndex=ss),u!==be.current.containerId&&(be.current.containerId=u),m!==be.current.items&&(be.current.items=m)},[ee,ss,u,m]),x.useEffect(()=>{if(Ss===be.current.activeId)return;if(Ss!=null&&be.current.activeId==null){be.current.activeId=Ss;return}const Vn=setTimeout(()=>{be.current.activeId=Ss},50);return()=>clearTimeout(Vn)},[Ss]),{active:C,activeIndex:h,attributes:M,data:z,rect:N,index:T,newIndex:ss,items:m,isOver:_,isSorting:ee,isDragging:L,listeners:Q,node:S,overIndex:y,over:U,setNodeRef:B,setActivatorNodeRef:F,setDroppableNodeRef:g,setDraggableNodeRef:O,transform:Bn??He,transition:Cs()};function Cs(){if(Bn||Kr&&be.current.newIndex===T)return uk;if(!(ts&&!Oc(A)||!d)&&(ee||us))return Ni.Transition.toString({...d,property:Uf})}}function fk(t,s){var n,r;return typeof t=="boolean"?{draggable:t,droppable:!1}:{draggable:(n=t?.draggable)!=null?n:s.draggable,droppable:(r=t?.droppable)!=null?r:s.droppable}}function Ba(t){if(!t)return!1;const s=t.data.current;return!!(s&&"sortable"in s&&typeof s.sortable=="object"&&"containerId"in s.sortable&&"items"in s.sortable&&"index"in s.sortable)}const xk=[ce.Down,ce.Right,ce.Up,ce.Left],gk=(t,s)=>{let{context:{active:n,collisionRect:r,droppableRects:i,droppableContainers:a,over:o,scrollableAncestors:l}}=s;if(xk.includes(t.code)){if(t.preventDefault(),!n||!r)return;const c=[];a.getEnabled().forEach(u=>{if(!u||u!=null&&u.disabled)return;const h=i.get(u.id);if(h)switch(t.code){case ce.Down:r.top<h.top&&c.push(u);break;case ce.Up:r.top>h.top&&c.push(u);break;case ce.Left:r.left>h.left&&c.push(u);break;case ce.Right:r.left<h.left&&c.push(u);break}});const d=Hv({collisionRect:r,droppableRects:i,droppableContainers:c});let m=Sf(d,"id");if(m===o?.id&&d.length>1&&(m=d[1].id),m!=null){const u=a.get(n.id),h=a.get(m),p=h?i.get(h.id):null,b=h?.node.current;if(b&&p&&u&&h){const y=No(b).some((k,N)=>l[N]!==k),w=Bf(u,h),j=jk(u,h),v=y||!w?{x:0,y:0}:{x:j?r.width-p.width:0,y:j?r.height-p.height:0},T={x:p.left,y:p.top};return v.x&&v.y?T:vi(T,v)}}}};function Bf(t,s){return!Ba(t)||!Ba(s)?!1:t.data.current.sortable.containerId===s.data.current.sortable.containerId}function jk(t,s){return!Ba(t)||!Ba(s)||!Bf(t,s)?!1:t.data.current.sortable.index<s.data.current.sortable.index}const yk=()=>e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}),bk=({course:t,topicsCount:s,activitiesCount:n,accessCount:r})=>e.jsxs(wt,{variant:"2-2-4",children:[e.jsxs(D,{children:[e.jsx($,{className:"pb-2",children:e.jsx(R,{className:"text-sm font-medium",children:"Status"})}),e.jsx(P,{children:e.jsx(H,{variant:t?.is_published?"default":"secondary",children:t?.is_published?"Opublikowany":"Szkic"})})]}),e.jsxs(D,{children:[e.jsx($,{className:"pb-2",children:e.jsx(R,{className:"text-sm font-medium",children:"Tematy"})}),e.jsx(P,{children:e.jsx("div",{className:"text-2xl font-bold",children:s})})]}),e.jsxs(D,{children:[e.jsx($,{className:"pb-2",children:e.jsx(R,{className:"text-sm font-medium",children:"Aktywnoci"})}),e.jsx(P,{children:e.jsx("div",{className:"text-2xl font-bold",children:n})})]}),e.jsxs(D,{children:[e.jsx($,{className:"pb-2",children:e.jsx(R,{className:"text-sm font-medium",children:"Uczestnik贸w"})}),e.jsx(P,{children:e.jsx("div",{className:"text-2xl font-bold",children:r})})]})]}),wk=({id:t,disabled:s=!1,children:n})=>{const{attributes:r,listeners:i,setNodeRef:a,transform:o,transition:l,isDragging:c}=pk({id:t,disabled:s}),d={transform:Ni.Transform.toString(o),transition:l,opacity:c?.5:1,cursor:c?"grabbing":"grab"},m=s?{}:{...r,...i,style:{cursor:c?"grabbing":"grab"}};return e.jsx("div",{ref:a,style:d,className:c?"z-50":"",children:n({dragHandleProps:m,isDragging:c})})},wu=({items:t,renderItem:s,onReorder:n,className:r="space-y-2",disabled:i=!1})=>{const[a,o]=x.useState(t),[l,c]=x.useState(null),[d,m]=x.useState(null);x.useEffect(()=>{if(!d)o(t);else{const b=a.map(f=>{const y=t.find(w=>w.id===f.id);return y?{...y,position:f.position}:f});o(b)}},[t]);const u=Kv(lu(Fc,{activationConstraint:{distance:8}}),lu($c,{coordinateGetter:gk})),h=b=>{c(Number(b.active.id))},p=b=>{const{active:f,over:y}=b;if(c(null),y&&f.id!==y.id){const w=a.findIndex(v=>v.id===Number(f.id)),j=a.findIndex(v=>v.id===Number(y.id));if(w!==-1&&j!==-1&&w!==j){let v;const T=a[w];if(j===0)v=a[0].position/2;else if(j===a.length-1)v=a[a.length-1].position+1e3;else if(w<j){const N=a[j],S=j+1<a.length?a[j+1]:null;S?v=(N.position+S.position)/2:v=N.position+1e3}else{const N=j>0?a[j-1]:null,S=a[j];N?v=(N.position+S.position)/2:v=S.position/2}const k=Uc(a,w,j).map(N=>N.id===T.id?{...N,position:v}:N);o(k),m({id:T.id,position:v}),n(T.id,v),setTimeout(()=>m(null),2e3)}}};return e.jsx(QN,{sensors:u,collisionDetection:Qv,onDragStart:h,onDragEnd:p,children:e.jsx(ok,{items:a.map(b=>b.id),strategy:ik,children:e.jsx("div",{className:r,children:a.map((b,f)=>e.jsx(wk,{id:b.id,disabled:i||d!==null&&d.id!==b.id,children:y=>s(b,f,y.dragHandleProps)},b.id))})})})},vk=()=>{const{list:t,edit:s}=ut(),{id:n}=vt(),[r,i]=so(),{navigateWithReturn:a,navigateToWizard:o}=vv(),{course:l,topics:c,stats:d,isLoading:m,refetchTopics:u,refetchActivities:h,getActivitiesForTopic:p}=Nv(n),{togglePublish:b}=Pl("topics"),{togglePublish:f}=Pl("activities"),{updatePosition:y,isUpdating:w}=au("topics"),{updatePosition:j,isUpdating:v}=au("activities"),{mutate:T}=zn(),{mutate:z}=zn(),k=r.get("expanded");if(m)return e.jsx(yk,{});if(!l)return e.jsx(G,{children:e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:"Nie znaleziono kursu"})})});const N=A=>{k===A.toString()?(r.delete("expanded"),i(r)):i({expanded:A.toString()})},S=(A,E)=>{confirm(`Czy na pewno chcesz usun temat "${E}" wraz ze wszystkimi aktywnociami?`)&&T({resource:"topics",id:A},{onSuccess:()=>{K.success("Temat zosta usunity"),u(),h(),k===A.toString()&&(r.delete("expanded"),i(r))}})},_=(A,E)=>{confirm(`Czy na pewno chcesz usun aktywno "${E}"?`)&&z({resource:"activities",id:A},{onSuccess:()=>{K.success("Aktywno zostaa usunita"),h(),u()}})},g=async(A,E)=>{try{await y(A,E)}catch(M){console.error("Failed to reorder topic:",M)}},C=async(A,E)=>{try{await j(A,E)}catch(M){console.error("Failed to reorder activity:",M)}};return e.jsxs(G,{children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>t("courses"),children:[e.jsx(Ce,{className:"w-4 h-4 mr-2"}),"Powr贸t do listy"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Szczeg贸y kursu"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(I,{onClick:()=>a(`/teacher/course-structure/edit/${l?.id}`),size:"sm",variant:"secondary",children:[e.jsx(rt,{className:"w-4 h-4 mr-2"}),"Edytuj z AI"]}),e.jsxs(I,{onClick:()=>s("courses",l?.id??0),size:"sm",children:[e.jsx(ks,{className:"w-4 h-4 mr-2"}),"Edytuj kurs"]})]})]}),e.jsx(Dv,{course:l})]}),e.jsx(bk,{course:l,topicsCount:d.topicsCount,activitiesCount:d.activitiesCount,accessCount:d.accessCount}),e.jsxs(D,{children:[e.jsx($,{children:e.jsxs(X,{children:[e.jsxs(R,{className:"flex items-center gap-2",children:["Struktura kursu",(w||v)&&e.jsxs("span",{className:"text-sm font-normal text-muted-foreground flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),"Zapisywanie..."]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(I,{size:"sm",variant:"outline",onClick:()=>a(`/teacher/course-structure/edit/${l?.id}`),children:[e.jsx(Ie,{className:"w-4 h-4 mr-2"}),"Dodaj tematy z AI"]}),e.jsxs(I,{size:"sm",onClick:()=>a(`/teacher/topics/create?course_id=${n}`),children:[e.jsx(Ie,{className:"w-4 h-4 mr-2"}),"Dodaj temat"]})]})]})}),e.jsx(P,{children:c.length>0?e.jsx(wu,{items:c,onReorder:g,disabled:w||v,renderItem:(A,E,M)=>{const O=p(A.id),Q=k===A.id.toString();return e.jsx(_v,{topic:{...A,position:E+1},isExpanded:Q,onToggle:()=>N(A.id),onDelete:S,onEdit:(L,U)=>a(`/${L}/edit/${U}`),onTogglePublish:(L,U,F)=>b(L,U,F,u),activitiesCount:O.length,onNavigateToWizard:o,courseId:Number(l?.id),courseTitle:l?.title,dragHandleProps:M,children:O.length>0?e.jsx(wu,{items:O,onReorder:C,disabled:v,renderItem:(L,U,F)=>e.jsx(Av,{activity:{...L,position:U+1},topicPosition:E+1,onDelete:_,onEdit:(ae,B)=>a(`/${ae}/edit/${B}`),onTogglePublish:(ae,B,ee)=>f(ae,B,ee,h),dragHandleProps:F},L.id)}):e.jsxs("div",{className:"text-center py-6 text-muted-foreground",children:[e.jsx("p",{children:"Brak aktywnoci w tym temacie"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 justify-center mt-4",children:[e.jsxs(I,{size:"sm",variant:"outline",onClick:()=>a(`/activities/create?topic_id=${A.id}`),children:[e.jsx(Ie,{className:"w-4 h-4 mr-2"}),"Dodaj rcznie"]}),e.jsxs(I,{size:"sm",onClick:()=>o("/teacher/educational-material/step1",{courseId:l?.id,courseTitle:l?.title,topicId:A.id,topicTitle:A.title}),children:[e.jsx(rt,{className:"w-4 h-4 mr-2"}),"Generuj materia z AI"]}),e.jsxs(I,{size:"sm",variant:"secondary",onClick:()=>o("/teacher/quiz-wizard/step1",{courseId:l?.id,courseTitle:l?.title,topicId:A.id,topicTitle:A.title}),children:[e.jsx(Os,{className:"w-4 h-4 mr-2"}),"Generuj quiz z AI"]})]})]})},A.id)}}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(it,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),e.jsx("p",{children:"Brak temat贸w w tym kursie"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center mt-4",children:[e.jsxs(I,{onClick:()=>a(`/topics/create?course_id=${n}`),children:[e.jsx(Ie,{className:"w-4 h-4 mr-2"}),"Dodaj pierwszy temat"]}),e.jsxs(I,{variant:"secondary",onClick:()=>a(`/teacher/course-structure/edit/${l?.id}`),children:[e.jsx(fr,{className:"w-4 h-4 mr-2"}),"Wygeneruj struktur z AI"]})]})]})})]}),e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{children:"Grupy z dostpem"})}),e.jsx(P,{children:e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(pe,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),e.jsx("p",{children:"Lista grup (do implementacji)"})]})})]}),e.jsxs(D,{className:"border-dashed border-2 bg-gradient-to-r from-purple-50 to-blue-50 dark:from-purple-950/20 dark:to-blue-950/20",children:[e.jsx($,{children:e.jsxs(R,{className:"flex items-center gap-2",children:[e.jsx(rt,{className:"w-5 h-5 text-purple-600"}),"Szybkie akcje AI"]})}),e.jsx(P,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsx(I,{variant:"outline",className:"justify-start h-auto py-3 px-4 bg-white dark:bg-background",onClick:()=>a(`/teacher/course-structure/edit/${l?.id}`),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(fr,{className:"w-5 h-5 text-indigo-600 mt-0.5"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-medium",children:"Rozbuduj struktur kursu"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Dodaj nowe tematy z AI"})]})]})}),e.jsx(I,{variant:"outline",className:"justify-start h-auto py-3 px-4 bg-white dark:bg-background",onClick:()=>o("/educational-material/step1",{courseId:l?.id,courseTitle:l?.title}),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Fi,{className:"w-5 h-5 text-purple-600 mt-0.5"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-medium",children:"Generuj materia"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Stw贸rz treci z AI"})]})]})}),e.jsx(I,{variant:"outline",className:"justify-start h-auto py-3 px-4 bg-white dark:bg-background",onClick:()=>o("/quiz-wizard/step1",{courseId:l?.id,courseTitle:l?.title}),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Os,{className:"w-5 h-5 text-blue-600 mt-0.5"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-medium",children:"Stw贸rz quiz"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Quiz sprawdzajcy z AI"})]})]})})]})})]})]})},vu={name:"courses",list:"/teacher/courses",create:"/teacher/courses/create",edit:"/teacher/courses/edit/:id",show:"/teacher/courses/show/:id",meta:{label:"Kursy",icon:e.jsx(ye,{className:"h-4 w-4"})}},Nk=[e.jsx(W,{path:"courses",element:e.jsx(kv,{})},"courses-list"),e.jsx(W,{path:"courses/create",element:e.jsx(Sv,{})},"courses-create"),e.jsx(W,{path:"courses/edit/:id",element:e.jsx(Tv,{})},"courses-edit"),e.jsx(W,{path:"courses/show/:id",element:e.jsx(vk,{})},"courses-show")],kk=()=>{const{edit:t,list:s}=ut(),{mutate:n}=Cr(),{mutate:r}=zn(),[i,a]=x.useState("all"),[o,l]=x.useState(!1),[c,d]=x.useState(null),m=i!=="all"?[{field:"course_id",operator:"eq",value:i}]:[],{data:u,isLoading:h,refetch:p}=Y({resource:"topics",meta:{populate:["courses"]},filters:m,pagination:{pageSize:20},sorters:[{field:"courses.title",order:"asc"},{field:"position",order:"asc"}]}),{data:b}=Y({resource:"courses",pagination:{pageSize:100},sorters:[{field:"title",order:"asc"}]}),f=u?.data||[],y=b?.data||[],w=async v=>{await n({resource:"topics",id:v.id,values:{is_published:!v.is_published},successNotification:()=>({message:v.is_published?"Temat zosta ukryty":"Temat zosta opublikowany",type:"success"})}),p()},j=v=>{d(v),l(!0)};return e.jsxs(G,{children:[e.jsxs(X,{children:[e.jsx(_e,{title:"Tematy",description:"Zarzdzaj tematami kurs贸w"}),e.jsxs(X,{variant:"start",className:"gap-2",children:[y.length>0&&e.jsxs(fe,{value:i,onValueChange:a,children:[e.jsxs(me,{className:"w-[250px]",children:[e.jsx(Yh,{className:"h-4 w-4 mr-2"}),e.jsx(xe,{placeholder:"Filtruj po kursie"})]}),e.jsxs(he,{children:[e.jsx(V,{value:"all",children:"Wszystkie kursy"}),e.jsx(jt,{}),y.map(v=>e.jsx(V,{value:v.id.toString(),children:v.title},v.id))]})]}),e.jsxs(I,{onClick:()=>s("courses"),children:[e.jsx(ye,{className:"h-4 w-4 mr-2"}),"Przejd藕 do kurs贸w"]})]})]}),e.jsx(D,{children:e.jsx(P,{className:"p-0",children:h?e.jsx("div",{className:"p-8",children:e.jsx("div",{className:"space-y-3",children:[...Array(5)].map((v,T)=>e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(xn,{className:"h-12 w-12"}),e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsx(xn,{className:"h-4 w-3/4"}),e.jsx(xn,{className:"h-4 w-1/2"})]})]},T))})}):f.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(ye,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-lg font-medium text-muted-foreground",children:i!=="all"?"Brak temat贸w w wybranym kursie":"Brak temat贸w"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Aby doda temat, przejd藕 do kursu"}),e.jsxs(I,{onClick:()=>s("courses"),children:[e.jsx(ye,{className:"h-4 w-4 mr-2"}),"Przejd藕 do kurs贸w"]})]}):e.jsxs(In,{children:[e.jsx(En,{children:e.jsxs(_t,{children:[e.jsx(de,{className:"w-[50px]",children:"#"}),e.jsx(de,{children:"Tytu"}),e.jsx(de,{className:"w-[200px]",children:"Kurs"}),e.jsx(de,{className:"w-[120px]",children:"Status"}),e.jsx(de,{className:"w-[140px]",children:"Data utworzenia"}),e.jsx(de,{className:"text-right w-[80px]",children:"Akcje"})]})}),e.jsx(Ln,{children:f.map(v=>e.jsxs(_t,{children:[e.jsx(ue,{className:"font-medium",children:e.jsx(H,{variant:"outline",className:"w-12 justify-center",children:v.position})}),e.jsx(ue,{children:e.jsx("div",{className:"font-medium",children:v.title})}),e.jsx(ue,{className:"max-w-[200px]",children:e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(ye,{className:"h-4 w-4 mr-2 text-muted-foreground shrink-0"}),e.jsx("span",{className:"truncate block",title:v.courses?.title||"Brak kursu",children:v.courses?.title||"Brak kursu"})]})}),e.jsx(ue,{children:e.jsx(H,{variant:v.is_published?"default":"secondary",children:v.is_published?"Opublikowany":"Szkic"})}),e.jsx(ue,{children:e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx(Te,{className:"h-4 w-4 mr-2"}),new Date(v.created_at).toLocaleDateString("pl-PL")]})}),e.jsx(ue,{className:"text-right",children:e.jsxs(br,{children:[e.jsx(wr,{asChild:!0,children:e.jsxs(I,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Otw贸rz menu"}),e.jsx(db,{className:"h-4 w-4"})]})}),e.jsxs(Cn,{align:"end",children:[e.jsxs(ve,{onClick:()=>t("topics",v.id),children:[e.jsx(ks,{className:"mr-2 h-4 w-4"}),"Edytuj"]}),e.jsx(jt,{}),e.jsx(ve,{onClick:()=>w(v),children:v.is_published?e.jsxs(e.Fragment,{children:[e.jsx(vn,{className:"mr-2 h-4 w-4"}),"Ukryj temat"]}):e.jsxs(e.Fragment,{children:[e.jsx(ub,{className:"mr-2 h-4 w-4"}),"Opublikuj temat"]})}),e.jsx(jt,{}),e.jsxs(ve,{onClick:()=>j(v),className:"text-destructive focus:text-destructive",children:[e.jsx(ls,{className:"mr-2 h-4 w-4"}),"Usu temat"]})]})]})})]},v.id))})]})})})]})},zk=()=>{const{show:t}=ut(),s=se(),[n]=so(),r=n.get("course_id"),{data:i}=Xe({resource:"courses",id:r,queryOptions:{enabled:!!r}}),{data:a,isLoading:o}=Y({resource:"topics",filters:[{field:"course_id",operator:"eq",value:r}],sorters:[{field:"position",order:"desc"}],pagination:{pageSize:1},queryOptions:{enabled:!!r}}),{refineCore:{onFinish:l},register:c,handleSubmit:d,setValue:m,watch:u,formState:{errors:h,isSubmitting:p}}=ln({defaultValues:{course_id:r?parseInt(r):void 0,is_published:!1,position:1},refineCoreProps:{successNotification:()=>({message:"Temat zosta utworzony",type:"success"}),redirect:!1,onMutationSuccess:()=>{r?t("courses",r):s("/courses")}}});x.useEffect(()=>{if(!o&&a&&a.data.length>0){const f=a.data[0].position+1;m("position",f)}},[a,o,m]);const b=()=>{r?t("courses",r):s("/courses")};return e.jsxs(G,{children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:b,children:[e.jsx(Ce,{className:"w-4 h-4 mr-2"}),"Powr贸t do kursu"]}),e.jsx(X,{children:e.jsx(_e,{title:"Dodaj temat",description:i?.data?`Do kursu: ${i.data.title}`:"Utw贸rz nowy temat"})}),e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{children:"Informacje o temacie"})}),e.jsx(P,{children:e.jsxs(cn,{onSubmit:d(l),children:[e.jsx("input",{type:"hidden",...c("course_id")}),e.jsx(oe,{label:"Tytu tematu",htmlFor:"title",error:h.title?.message,required:!0,children:e.jsx(Z,{id:"title",placeholder:"np. Wprowadzenie do zmiennych",...c("title",{required:"Tytu tematu jest wymagany",minLength:{value:3,message:"Tytu musi mie minimum 3 znaki"}})})}),e.jsx(oe,{label:"Pozycja",htmlFor:"position",error:h.position?.message,required:!0,children:e.jsx(Z,{id:"position",type:"number",min:"1",disabled:!0,className:"bg-muted",...c("position",{required:"Pozycja jest wymagana",min:{value:1,message:"Pozycja musi by wiksza od 0"},valueAsNumber:!0})})}),e.jsx(oe,{label:"Status publikacji",children:e.jsxs(X,{variant:"start",children:[e.jsx(es,{checked:u("is_published")||!1,onCheckedChange:f=>m("is_published",f)}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Opublikuj temat od razu"})]})}),e.jsxs(dn,{children:[e.jsx(I,{type:"button",variant:"outline",onClick:b,children:"Anuluj"}),e.jsx(I,{type:"submit",disabled:p||!r,children:p?"Tworzenie...":"Utw贸rz temat"})]})]})})]})]})},Tn=({variant:t="outline",size:s="sm",children:n="Powr贸t do kursu"})=>{const r=se(),i=Ei(),a=()=>{const o=sessionStorage.getItem("returnUrl");if(o){sessionStorage.removeItem("returnUrl"),r(o);return}const c=new URLSearchParams(i.search).get("returnUrl");if(c){r(decodeURIComponent(c));return}r(-1)};return e.jsxs(I,{variant:t,size:s,onClick:a,children:[e.jsx(Ce,{className:"w-4 h-4 mr-2"}),n]})},Sk=()=>{const{show:t}=ut(),{id:s}=vt(),n=se(),{data:r,isLoading:i}=Xe({resource:"topics",id:s,liveMode:"off"}),a=r?.data,o=a?.course_id,{refineCore:{onFinish:l},register:c,handleSubmit:d,setValue:m,watch:u,formState:{errors:h,isSubmitting:p}}=ln({refineCoreProps:{resource:"topics",id:s,liveMode:"off",successNotification:()=>({message:"Temat zosta zaktualizowany",type:"success"}),redirect:!1,onMutationSuccess:()=>{const f=sessionStorage.getItem("returnUrl");f?(sessionStorage.removeItem("returnUrl"),n(f)):o&&n(`/teacher/courses/show/${o}?expanded=${s}`)}}}),b=()=>{const f=sessionStorage.getItem("returnUrl");f?(sessionStorage.removeItem("returnUrl"),n(f)):o?n(`/teacher/courses/show/${o}?expanded=${s}`):t("courses","")};return i?e.jsx(G,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})}):e.jsxs(G,{children:[e.jsx(Tn,{}),e.jsx(X,{children:e.jsx(_e,{title:"Edytuj temat",description:`Edycja: ${a?.title}`})}),e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{children:"Informacje o temacie"})}),e.jsx(P,{children:e.jsxs(cn,{onSubmit:d(l),children:[e.jsx(oe,{label:"Tytu tematu",htmlFor:"title",error:h.title?.message,required:!0,children:e.jsx(Z,{id:"title",placeholder:"np. Wprowadzenie do zmiennych",...c("title",{required:"Tytu tematu jest wymagany",minLength:{value:3,message:"Tytu musi mie minimum 3 znaki"}})})}),e.jsx(oe,{label:"Pozycja",htmlFor:"position",error:h.position?.message,required:!0,children:e.jsx(Z,{id:"position",type:"number",min:"1",...c("position",{required:"Pozycja jest wymagana",min:{value:1,message:"Pozycja musi by wiksza od 0"},valueAsNumber:!0})})}),e.jsx(oe,{label:"Status publikacji",children:e.jsxs(X,{variant:"start",children:[e.jsx(es,{checked:u("is_published")||!1,onCheckedChange:f=>m("is_published",f)}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Temat jest opublikowany"})]})}),e.jsxs(dn,{children:[e.jsx(I,{type:"button",variant:"outline",onClick:b,children:"Anuluj"}),e.jsx(I,{type:"submit",disabled:p,children:p?"Zapisywanie...":"Zapisz zmiany"})]})]})})]})]})},Nu={name:"topics",list:"/teacher/topics",create:"/teacher/topics/create",edit:"/teacher/topics/edit/:id",meta:{label:"Tematy",icon:e.jsx(it,{className:"h-4 w-4"})}},Ck=[e.jsx(W,{path:"topics",element:e.jsx(kk,{})},"topics-list"),e.jsx(W,{path:"topics/create",element:e.jsx(zk,{})},"topics-create"),e.jsx(W,{path:"topics/edit/:id",element:e.jsx(Sk,{})},"topics-edit")],Tk=()=>{const{show:t}=ut(),s=se(),[n]=so(),r=n.get("topic_id"),{data:i}=Xe({resource:"topics",id:r,meta:{select:"*, courses(*)"},queryOptions:{enabled:!!r}}),{data:a,isLoading:o}=Y({resource:"activities",filters:[{field:"topic_id",operator:"eq",value:r}],sorters:[{field:"position",order:"desc"}],pagination:{pageSize:1},queryOptions:{enabled:!!r}}),{refineCore:{onFinish:l},register:c,handleSubmit:d,setValue:m,watch:u,formState:{errors:h,isSubmitting:p}}=ln({defaultValues:{topic_id:r?parseInt(r):void 0,type:"material",is_published:!1,position:1,passing_score:70},refineCoreProps:{successNotification:!1,redirect:!1,onMutationSuccess:y=>{const w=i?.data?.course_id,j=y.data.type;if(K.success("Aktywno zostaa utworzona"),j==="quiz")K.info("Dodaj pytania do quizu"),s(`/teacher/questions/manage/${y.data.id}`);else{const v=sessionStorage.getItem("returnUrl");v?(sessionStorage.removeItem("returnUrl"),s(v)):s(w?`/teacher/courses/show/${w}?expanded=${r}`:"/teacher/courses")}}}}),b=u("type");x.useEffect(()=>{if(!o&&a&&a.data.length>0){const y=a.data[0].position+1;m("position",y)}},[a,o,m]);const f=()=>{const y=sessionStorage.getItem("returnUrl");y?(sessionStorage.removeItem("returnUrl"),s(y)):i?.data?.course_id?s(`/courses/show/${i.data.course_id}?expanded=${r}`):s("/courses")};return i?.data?.course_id,r?e.jsxs(G,{children:[e.jsx(Tn,{}),e.jsx(X,{children:e.jsx(_e,{title:"Dodaj aktywno",description:i?.data?e.jsxs("div",{children:[e.jsx("div",{className:"text-lg",children:i.data.courses?.title}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Temat ",i.data.position,": ",i.data.title]})]}):"Utw贸rz nowy materia lub quiz"})}),e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{children:"Informacje o aktywnoci"})}),e.jsx(P,{children:e.jsxs(cn,{onSubmit:d(l),children:[e.jsx("input",{type:"hidden",...c("topic_id")}),e.jsxs(wt,{variant:"1-2-2",children:[e.jsx(oe,{label:"Typ aktywnoci",error:h.type?.message,required:!0,children:e.jsxs(fe,{value:b,onValueChange:y=>m("type",y),children:[e.jsx(me,{children:e.jsx(xe,{placeholder:"Wybierz typ"})}),e.jsxs(he,{children:[e.jsx(V,{value:"material",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(it,{className:"w-4 h-4"}),"Materia"]})}),e.jsx(V,{value:"quiz",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(at,{className:"w-4 h-4"}),"Quiz"]})})]})]})}),e.jsx(oe,{label:"Tytu",htmlFor:"title",error:h.title?.message,required:!0,children:e.jsx(Z,{id:"title",placeholder:b==="quiz"?"np. Test wiedzy z rozdziau":"np. Wprowadzenie do tematu",...c("title",{required:"Tytu jest wymagany",minLength:{value:3,message:"Tytu musi mie minimum 3 znaki"}})})}),e.jsx(oe,{label:"Pozycja w temacie",htmlFor:"position",error:h.position?.message,required:!0,children:e.jsx(Z,{id:"position",type:"number",min:"1",disabled:!0,className:"bg-muted",...c("position",{required:"Pozycja jest wymagana",min:{value:1,message:"Pozycja musi by wiksza od 0"},valueAsNumber:!0})})}),e.jsx(oe,{label:"Czas trwania (min)",htmlFor:"duration_min",hint:"Szacowany czas potrzebny na ukoczenie",children:e.jsx(Z,{id:"duration_min",type:"number",min:"1",placeholder:"np. 15",...c("duration_min",{min:{value:1,message:"Czas musi by wikszy od 0"},valueAsNumber:!0})})})]}),b==="material"&&e.jsx(oe,{label:"Tre materiau",htmlFor:"content",error:h.content?.message,required:!0,hint:"Mo偶esz u偶ywa formatowania Markdown",children:e.jsx(bt,{id:"content",placeholder:"Wprowad藕 tre materiau edukacyjnego...",rows:10,...c("content",{required:b==="material"?"Tre jest wymagana dla materiau":!1})})}),b==="quiz"&&e.jsxs(e.Fragment,{children:[e.jsxs(wt,{variant:"1-1-1",children:[e.jsx(oe,{label:"Pr贸g zaliczenia (%)",htmlFor:"passing_score",error:h.passing_score?.message,hint:"Minimalny wynik do zaliczenia",children:e.jsx(Z,{id:"passing_score",type:"number",min:"0",max:"100",...c("passing_score",{min:{value:0,message:"Warto minimalna to 0"},max:{value:100,message:"Warto maksymalna to 100"},valueAsNumber:!0})})}),e.jsx(oe,{label:"Limit czasu (min)",htmlFor:"time_limit",hint:"Pozostaw puste dla braku limitu",children:e.jsx(Z,{id:"time_limit",type:"number",min:"1",placeholder:"Brak limitu",...c("time_limit",{min:{value:1,message:"Limit musi by wikszy od 0"},valueAsNumber:!0})})}),e.jsx(oe,{label:"Maksymalna liczba pr贸b",htmlFor:"max_attempts",hint:"Pozostaw puste dla nieograniczonej liczby",children:e.jsx(Z,{id:"max_attempts",type:"number",min:"1",placeholder:"Bez limitu",...c("max_attempts",{min:{value:1,message:"Minimum 1 pr贸ba"},valueAsNumber:!0})})})]}),e.jsx("div",{className:"mt-4 p-4 bg-blue-50 dark:bg-blue-950 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{className:"text-blue-700 dark:text-blue-300",children:" Wskaz贸wka:"})," ",e.jsx("span",{className:"text-blue-600 dark:text-blue-400",children:"Po utworzeniu quizu zostaniesz przekierowany do ekranu dodawania pyta."})]})})]}),e.jsx(oe,{label:"Status publikacji",children:e.jsxs(X,{variant:"start",children:[e.jsx(es,{checked:u("is_published")||!1,onCheckedChange:y=>m("is_published",y)}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Opublikuj aktywno od razu (uczniowie bd mogli j zobaczy)"})]})}),e.jsxs(dn,{children:[e.jsx(I,{type:"button",variant:"outline",onClick:f,disabled:p,children:"Anuluj"}),e.jsx(I,{type:"submit",disabled:p||!r,children:p?"Tworzenie...":b==="quiz"?"Utw贸rz i dodaj pytania":"Utw贸rz aktywno"})]})]})})]})]}):e.jsx(G,{children:e.jsx(D,{children:e.jsxs(P,{className:"text-center py-12",children:[e.jsx("p",{className:"text-lg font-medium text-muted-foreground mb-4",children:"Nie wybrano tematu"}),e.jsx(I,{onClick:()=>s("/courses"),children:"Przejd藕 do kurs贸w"})]})})})},_k=()=>{const{list:t}=ut(),{id:s}=vt(),n=se(),{data:r,isLoading:i}=Xe({resource:"activities",id:s,liveMode:"off",meta:{select:"*, topics(*, courses(*))"}}),{data:a}=Xe({resource:"questions",id:s,meta:{select:"count",filter:`activity_id.eq.${s}`},queryOptions:{enabled:!!s&&r?.data?.type==="quiz"}}),{refineCore:{onFinish:o,formLoading:l},register:c,handleSubmit:d,setValue:m,watch:u,reset:h,formState:{errors:p,isSubmitting:b}}=ln({refineCoreProps:{resource:"activities",id:s,liveMode:"off",redirect:!1,successNotification:!1,onMutationSuccess:()=>{const _=r?.data?.topics?.course_id,g=r?.data?.topic_id;K.success("Aktywno zostaa zaktualizowana");const C=sessionStorage.getItem("returnUrl");C?(sessionStorage.removeItem("returnUrl"),n(C)):_?n(`/teacher/courses/show/${_}?expanded=${g}`):t("activities")},onMutationError:_=>{console.error("Bd podczas aktualizacji:",_),_?.code==="PGRST204"?K.error("Bd konfiguracji - skontaktuj si z administratorem"):_?.code==="23505"?K.error("Aktywno o tej pozycji ju偶 istnieje w tym temacie"):_?.code==="23503"?K.error("Nieprawidowe powizanie z tematem"):_?.message?K.error(`Bd: ${_.message}`):K.error("Wystpi nieoczekiwany bd. Spr贸buj ponownie.")}}});x.useEffect(()=>{if(r?.data){const{topics:_,_count:g,questions:C,...A}=r.data;h(A)}},[r,h]);const f=u("type")||r?.data?.type||"material";if(i||l)return e.jsx(G,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const y=r?.data,w=y?.topics,j=w?.courses,v=j?.id,T=y?.topic_id,z=()=>{const _=sessionStorage.getItem("returnUrl");_?(sessionStorage.removeItem("returnUrl"),n(_)):v?n(`/teacher/courses/show/${v}?expanded=${T}`):t("activities")},k=()=>f==="quiz"?e.jsx(at,{className:"w-6 h-6 text-blue-500"}):e.jsx(it,{className:"w-6 h-6 text-green-500"}),N=()=>{const _=window.location.pathname+window.location.search;sessionStorage.setItem("returnUrl",_),n(`/teacher/questions/manage/${y?.id}`)},S=a?.data?.[0]?.count||0;return e.jsxs(G,{children:[e.jsx(Tn,{}),e.jsxs(X,{children:[e.jsx(_e,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[k(),"Edytuj aktywno"]}),description:e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-medium",children:y?.title}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[j?.title,"  Temat ",w?.position,": ",w?.title]})]})}),f==="quiz"&&e.jsxs(I,{onClick:N,variant:"outline",children:[e.jsx(Xs,{className:"w-4 h-4 mr-2"}),"Zarzdzaj pytaniami (",S,")"]})]}),e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{children:"Informacje o aktywnoci"})}),e.jsx(P,{children:e.jsxs(cn,{onSubmit:d(o),children:[e.jsxs(wt,{variant:"1-2-2",children:[e.jsxs(oe,{label:"Typ aktywnoci",error:p.type?.message,required:!0,children:[e.jsxs(fe,{value:f,disabled:!0,children:[e.jsx(me,{className:"bg-muted",children:e.jsx(xe,{placeholder:"Wybierz typ"})}),e.jsxs(he,{children:[e.jsx(V,{value:"material",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(it,{className:"w-4 h-4"}),"Materia"]})}),e.jsx(V,{value:"quiz",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(at,{className:"w-4 h-4"}),"Quiz"]})})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Typ aktywnoci nie mo偶e by zmieniony"})]}),e.jsx(oe,{label:"Tytu",htmlFor:"title",error:p.title?.message,required:!0,children:e.jsx(Z,{id:"title",placeholder:f==="quiz"?"np. Test wiedzy":"np. Wprowadzenie",...c("title",{required:"Tytu jest wymagany",minLength:{value:3,message:"Tytu musi mie minimum 3 znaki"}})})}),e.jsx(oe,{label:"Pozycja w temacie",htmlFor:"position",error:p.position?.message,required:!0,children:e.jsx(Z,{id:"position",type:"number",min:"1",...c("position",{required:"Pozycja jest wymagana",min:{value:1,message:"Pozycja musi by wiksza od 0"},valueAsNumber:!0})})}),e.jsx(oe,{label:"Czas trwania (min)",htmlFor:"duration_min",hint:"Szacowany czas potrzebny na ukoczenie",children:e.jsx(Z,{id:"duration_min",type:"number",min:"1",placeholder:"np. 15",...c("duration_min",{min:{value:1,message:"Czas musi by wikszy od 0"},valueAsNumber:!0})})})]}),f==="material"&&e.jsx(oe,{label:"Tre materiau",htmlFor:"content",error:p.content?.message,required:!0,hint:"Mo偶esz u偶ywa formatowania Markdown",children:e.jsx(bt,{id:"content",placeholder:"Wprowad藕 tre materiau...",rows:10,...c("content",{required:f==="material"?"Tre jest wymagana dla materiau":!1})})}),f==="quiz"&&e.jsxs(e.Fragment,{children:[e.jsxs(wt,{variant:"1-1-1",children:[e.jsx(oe,{label:"Pr贸g zaliczenia (%)",htmlFor:"passing_score",error:p.passing_score?.message,hint:"Minimalny wynik do zaliczenia",children:e.jsx(Z,{id:"passing_score",type:"number",min:"0",max:"100",...c("passing_score",{min:{value:0,message:"Warto minimalna to 0"},max:{value:100,message:"Warto maksymalna to 100"},valueAsNumber:!0})})}),e.jsx(oe,{label:"Limit czasu (min)",htmlFor:"time_limit",hint:"Pozostaw puste dla braku limitu",children:e.jsx(Z,{id:"time_limit",type:"number",min:"1",placeholder:"Brak limitu",...c("time_limit",{min:{value:1,message:"Limit musi by wikszy od 0"},valueAsNumber:!0})})}),e.jsx(oe,{label:"Maksymalna liczba pr贸b",htmlFor:"max_attempts",hint:"Pozostaw puste dla nieograniczonej liczby",children:e.jsx(Z,{id:"max_attempts",type:"number",min:"1",placeholder:"Bez limitu",...c("max_attempts",{min:{value:1,message:"Minimum 1 pr贸ba"},valueAsNumber:!0})})})]}),S>0&&e.jsx(D,{className:"mt-4 bg-blue-50 dark:bg-blue-950/30 border-blue-200 dark:border-blue-800",children:e.jsx(P,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium",children:["Ten quiz zawiera ",S," ",S===1?"pytanie":"pyta"]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Mo偶esz zarzdza pytaniami klikajc przycisk powy偶ej"})]}),e.jsx(H,{variant:"outline",className:"text-lg px-3 py-1",children:S})]})})})]}),e.jsx(oe,{label:"Status publikacji",children:e.jsxs(X,{variant:"start",children:[e.jsx(es,{checked:u("is_published")||!1,onCheckedChange:_=>m("is_published",_)}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Aktywno jest opublikowana (uczniowie mog j zobaczy)"})]})}),e.jsxs(dn,{children:[e.jsx(I,{type:"button",variant:"outline",onClick:z,disabled:b,children:"Anuluj"}),e.jsx(I,{type:"submit",disabled:b,children:b?"Zapisywanie...":"Zapisz zmiany"})]})]})})]})]})};function ku(t,s){const n=String(t);if(typeof s!="string")throw new TypeError("Expected character");let r=0,i=n.indexOf(s);for(;i!==-1;)r++,i=n.indexOf(s,i+s.length);return r}function Ak(t){if(typeof t!="string")throw new TypeError("Expected a string");return t.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function Dk(t,s,n){const i=Kh((n||{}).ignore||[]),a=Pk(s);let o=-1;for(;++o<a.length;)qy(t,"text",l);function l(d,m){let u=-1,h;for(;++u<m.length;){const p=m[u],b=h?h.children:void 0;if(i(p,b?b.indexOf(p):void 0,h))return;h=p}if(h)return c(d,m)}function c(d,m){const u=m[m.length-1],h=a[o][0],p=a[o][1];let b=0;const y=u.children.indexOf(d);let w=!1,j=[];h.lastIndex=0;let v=h.exec(d.value);for(;v;){const T=v.index,z={index:v.index,input:v.input,stack:[...m,d]};let k=p(...v,z);if(typeof k=="string"&&(k=k.length>0?{type:"text",value:k}:void 0),k===!1?h.lastIndex=T+1:(b!==T&&j.push({type:"text",value:d.value.slice(b,T)}),Array.isArray(k)?j.push(...k):k&&j.push(k),b=T+v[0].length,w=!0),!h.global)break;v=h.exec(d.value)}return w?(b<d.value.length&&j.push({type:"text",value:d.value.slice(b)}),u.children.splice(y,1,...j)):j=[d],y+j.length}}function Pk(t){const s=[];if(!Array.isArray(t))throw new TypeError("Expected find and replace tuple or list of tuples");const n=!t[0]||Array.isArray(t[0])?t:[t];let r=-1;for(;++r<n.length;){const i=n[r];s.push([Mk(i[0]),Ik(i[1])])}return s}function Mk(t){return typeof t=="string"?new RegExp(Ak(t),"g"):t}function Ik(t){return typeof t=="function"?t:function(){return t}}const tl="phrasing",sl=["autolink","link","image","label"];function Ek(){return{transforms:[Uk],enter:{literalAutolink:Ok,literalAutolinkEmail:nl,literalAutolinkHttp:nl,literalAutolinkWww:nl},exit:{literalAutolink:Fk,literalAutolinkEmail:qk,literalAutolinkHttp:Rk,literalAutolinkWww:$k}}}function Lk(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:tl,notInConstruct:sl},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:tl,notInConstruct:sl},{character:":",before:"[ps]",after:"\\/",inConstruct:tl,notInConstruct:sl}]}}function Ok(t){this.enter({type:"link",title:null,url:"",children:[]},t)}function nl(t){this.config.enter.autolinkProtocol.call(this,t)}function Rk(t){this.config.exit.autolinkProtocol.call(this,t)}function $k(t){this.config.exit.data.call(this,t);const s=this.stack[this.stack.length-1];Sr(s.type==="link"),s.url="http://"+this.sliceSerialize(t)}function qk(t){this.config.exit.autolinkEmail.call(this,t)}function Fk(t){this.exit(t)}function Uk(t){Dk(t,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,Bk],[/(?<=^|\s|\p{P}|\p{S})([-.\w+]+)@([-\w]+(?:\.[-\w]+)+)/gu,Vk]],{ignore:["link","linkReference"]})}function Bk(t,s,n,r,i){let a="";if(!Vf(i)||(/^w/i.test(s)&&(n=s+n,s="",a="http://"),!Wk(n)))return!1;const o=Kk(n+r);if(!o[0])return!1;const l={type:"link",title:null,url:a+s+o[0],children:[{type:"text",value:s+o[0]}]};return o[1]?[l,{type:"text",value:o[1]}]:l}function Vk(t,s,n,r){return!Vf(r,!0)||/[-\d_]$/.test(n)?!1:{type:"link",title:null,url:"mailto:"+s+"@"+n,children:[{type:"text",value:s+"@"+n}]}}function Wk(t){const s=t.split(".");return!(s.length<2||s[s.length-1]&&(/_/.test(s[s.length-1])||!/[a-zA-Z\d]/.test(s[s.length-1]))||s[s.length-2]&&(/_/.test(s[s.length-2])||!/[a-zA-Z\d]/.test(s[s.length-2])))}function Kk(t){const s=/[!"&'),.:;<>?\]}]+$/.exec(t);if(!s)return[t,void 0];t=t.slice(0,s.index);let n=s[0],r=n.indexOf(")");const i=ku(t,"(");let a=ku(t,")");for(;r!==-1&&i>a;)t+=n.slice(0,r+1),n=n.slice(r+1),r=n.indexOf(")"),a++;return[t,n]}function Vf(t,s){const n=t.input.charCodeAt(t.index-1);return(t.index===0||pr(n)||xc(n))&&(!s||n!==47)}Wf.peek=tz;function Gk(){this.buffer()}function Qk(t){this.enter({type:"footnoteReference",identifier:"",label:""},t)}function Hk(){this.buffer()}function Zk(t){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},t)}function Yk(t){const s=this.resume(),n=this.stack[this.stack.length-1];Sr(n.type==="footnoteReference"),n.identifier=Oi(this.sliceSerialize(t)).toLowerCase(),n.label=s}function Jk(t){this.exit(t)}function Xk(t){const s=this.resume(),n=this.stack[this.stack.length-1];Sr(n.type==="footnoteDefinition"),n.identifier=Oi(this.sliceSerialize(t)).toLowerCase(),n.label=s}function ez(t){this.exit(t)}function tz(){return"["}function Wf(t,s,n,r){const i=n.createTracker(r);let a=i.move("[^");const o=n.enter("footnoteReference"),l=n.enter("reference");return a+=i.move(n.safe(n.associationId(t),{after:"]",before:a})),l(),o(),a+=i.move("]"),a}function sz(){return{enter:{gfmFootnoteCallString:Gk,gfmFootnoteCall:Qk,gfmFootnoteDefinitionLabelString:Hk,gfmFootnoteDefinition:Zk},exit:{gfmFootnoteCallString:Yk,gfmFootnoteCall:Jk,gfmFootnoteDefinitionLabelString:Xk,gfmFootnoteDefinition:ez}}}function nz(t){let s=!1;return t&&t.firstLineBlank&&(s=!0),{handlers:{footnoteDefinition:n,footnoteReference:Wf},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]};function n(r,i,a,o){const l=a.createTracker(o);let c=l.move("[^");const d=a.enter("footnoteDefinition"),m=a.enter("label");return c+=l.move(a.safe(a.associationId(r),{before:c,after:"]"})),m(),c+=l.move("]:"),r.children&&r.children.length>0&&(l.shift(4),c+=l.move((s?`
`:" ")+a.indentLines(a.containerFlow(r,l.current()),s?Kf:rz))),d(),c}}function rz(t,s,n){return s===0?t:Kf(t,s,n)}function Kf(t,s,n){return(n?"":"    ")+t}const iz=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];Gf.peek=dz;function az(){return{canContainEols:["delete"],enter:{strikethrough:lz},exit:{strikethrough:cz}}}function oz(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:iz}],handlers:{delete:Gf}}}function lz(t){this.enter({type:"delete",children:[]},t)}function cz(t){this.exit(t)}function Gf(t,s,n,r){const i=n.createTracker(r),a=n.enter("strikethrough");let o=i.move("~~");return o+=n.containerPhrasing(t,{...i.current(),before:o,after:"~"}),o+=i.move("~~"),a(),o}function dz(){return"~"}function uz(t){return t.length}function mz(t,s){const n=s||{},r=(n.align||[]).concat(),i=n.stringLength||uz,a=[],o=[],l=[],c=[];let d=0,m=-1;for(;++m<t.length;){const f=[],y=[];let w=-1;for(t[m].length>d&&(d=t[m].length);++w<t[m].length;){const j=hz(t[m][w]);if(n.alignDelimiters!==!1){const v=i(j);y[w]=v,(c[w]===void 0||v>c[w])&&(c[w]=v)}f.push(j)}o[m]=f,l[m]=y}let u=-1;if(typeof r=="object"&&"length"in r)for(;++u<d;)a[u]=zu(r[u]);else{const f=zu(r);for(;++u<d;)a[u]=f}u=-1;const h=[],p=[];for(;++u<d;){const f=a[u];let y="",w="";f===99?(y=":",w=":"):f===108?y=":":f===114&&(w=":");let j=n.alignDelimiters===!1?1:Math.max(1,c[u]-y.length-w.length);const v=y+"-".repeat(j)+w;n.alignDelimiters!==!1&&(j=y.length+j+w.length,j>c[u]&&(c[u]=j),p[u]=j),h[u]=v}o.splice(1,0,h),l.splice(1,0,p),m=-1;const b=[];for(;++m<o.length;){const f=o[m],y=l[m];u=-1;const w=[];for(;++u<d;){const j=f[u]||"";let v="",T="";if(n.alignDelimiters!==!1){const z=c[u]-(y[u]||0),k=a[u];k===114?v=" ".repeat(z):k===99?z%2?(v=" ".repeat(z/2+.5),T=" ".repeat(z/2-.5)):(v=" ".repeat(z/2),T=v):T=" ".repeat(z)}n.delimiterStart!==!1&&!u&&w.push("|"),n.padding!==!1&&!(n.alignDelimiters===!1&&j==="")&&(n.delimiterStart!==!1||u)&&w.push(" "),n.alignDelimiters!==!1&&w.push(v),w.push(j),n.alignDelimiters!==!1&&w.push(T),n.padding!==!1&&w.push(" "),(n.delimiterEnd!==!1||u!==d-1)&&w.push("|")}b.push(n.delimiterEnd===!1?w.join("").replace(/ +$/,""):w.join(""))}return b.join(`
`)}function hz(t){return t==null?"":String(t)}function zu(t){const s=typeof t=="string"?t.codePointAt(0):0;return s===67||s===99?99:s===76||s===108?108:s===82||s===114?114:0}function pz(t,s,n,r){const i=n.enter("blockquote"),a=n.createTracker(r);a.move("> "),a.shift(2);const o=n.indentLines(n.containerFlow(t,a.current()),fz);return i(),o}function fz(t,s,n){return">"+(n?"":" ")+t}function xz(t,s){return Su(t,s.inConstruct,!0)&&!Su(t,s.notInConstruct,!1)}function Su(t,s,n){if(typeof s=="string"&&(s=[s]),!s||s.length===0)return n;let r=-1;for(;++r<s.length;)if(t.includes(s[r]))return!0;return!1}function Cu(t,s,n,r){let i=-1;for(;++i<n.unsafe.length;)if(n.unsafe[i].character===`
`&&xz(n.stack,n.unsafe[i]))return/[ \t]/.test(r.before)?"":" ";return`\\
`}function gz(t,s){const n=String(t);let r=n.indexOf(s),i=r,a=0,o=0;if(typeof s!="string")throw new TypeError("Expected substring");for(;r!==-1;)r===i?++a>o&&(o=a):a=1,i=r+s.length,r=n.indexOf(s,i);return o}function jz(t,s){return!!(s.options.fences===!1&&t.value&&!t.lang&&/[^ \r\n]/.test(t.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(t.value))}function yz(t){const s=t.options.fence||"`";if(s!=="`"&&s!=="~")throw new Error("Cannot serialize code with `"+s+"` for `options.fence`, expected `` ` `` or `~`");return s}function bz(t,s,n,r){const i=yz(n),a=t.value||"",o=i==="`"?"GraveAccent":"Tilde";if(jz(t,n)){const u=n.enter("codeIndented"),h=n.indentLines(a,wz);return u(),h}const l=n.createTracker(r),c=i.repeat(Math.max(gz(a,i)+1,3)),d=n.enter("codeFenced");let m=l.move(c);if(t.lang){const u=n.enter(`codeFencedLang${o}`);m+=l.move(n.safe(t.lang,{before:m,after:" ",encode:["`"],...l.current()})),u()}if(t.lang&&t.meta){const u=n.enter(`codeFencedMeta${o}`);m+=l.move(" "),m+=l.move(n.safe(t.meta,{before:m,after:`
`,encode:["`"],...l.current()})),u()}return m+=l.move(`
`),a&&(m+=l.move(a+`
`)),m+=l.move(c),d(),m}function wz(t,s,n){return(n?"":"    ")+t}function Bc(t){const s=t.options.quote||'"';if(s!=='"'&&s!=="'")throw new Error("Cannot serialize title with `"+s+"` for `options.quote`, expected `\"`, or `'`");return s}function vz(t,s,n,r){const i=Bc(n),a=i==='"'?"Quote":"Apostrophe",o=n.enter("definition");let l=n.enter("label");const c=n.createTracker(r);let d=c.move("[");return d+=c.move(n.safe(n.associationId(t),{before:d,after:"]",...c.current()})),d+=c.move("]: "),l(),!t.url||/[\0- \u007F]/.test(t.url)?(l=n.enter("destinationLiteral"),d+=c.move("<"),d+=c.move(n.safe(t.url,{before:d,after:">",...c.current()})),d+=c.move(">")):(l=n.enter("destinationRaw"),d+=c.move(n.safe(t.url,{before:d,after:t.title?" ":`
`,...c.current()}))),l(),t.title&&(l=n.enter(`title${a}`),d+=c.move(" "+i),d+=c.move(n.safe(t.title,{before:d,after:i,...c.current()})),d+=c.move(i),l()),o(),d}function Nz(t){const s=t.options.emphasis||"*";if(s!=="*"&&s!=="_")throw new Error("Cannot serialize emphasis with `"+s+"` for `options.emphasis`, expected `*`, or `_`");return s}function zi(t){return"&#x"+t.toString(16).toUpperCase()+";"}function Va(t,s,n){const r=Pa(t),i=Pa(s);return r===void 0?i===void 0?n==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:i===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:r===1?i===void 0?{inside:!1,outside:!1}:i===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:i===void 0?{inside:!1,outside:!1}:i===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}Qf.peek=kz;function Qf(t,s,n,r){const i=Nz(n),a=n.enter("emphasis"),o=n.createTracker(r),l=o.move(i);let c=o.move(n.containerPhrasing(t,{after:i,before:l,...o.current()}));const d=c.charCodeAt(0),m=Va(r.before.charCodeAt(r.before.length-1),d,i);m.inside&&(c=zi(d)+c.slice(1));const u=c.charCodeAt(c.length-1),h=Va(r.after.charCodeAt(0),u,i);h.inside&&(c=c.slice(0,-1)+zi(u));const p=o.move(i);return a(),n.attentionEncodeSurroundingInfo={after:h.outside,before:m.outside},l+c+p}function kz(t,s,n){return n.options.emphasis||"*"}function zz(t,s){let n=!1;return Fy(t,function(r){if("value"in r&&/\r?\n|\r/.test(r.value)||r.type==="break")return n=!0,Uy}),!!((!t.depth||t.depth<3)&&Gh(t)&&(s.options.setext||n))}function Sz(t,s,n,r){const i=Math.max(Math.min(6,t.depth||1),1),a=n.createTracker(r);if(zz(t,n)){const m=n.enter("headingSetext"),u=n.enter("phrasing"),h=n.containerPhrasing(t,{...a.current(),before:`
`,after:`
`});return u(),m(),h+`
`+(i===1?"=":"-").repeat(h.length-(Math.max(h.lastIndexOf("\r"),h.lastIndexOf(`
`))+1))}const o="#".repeat(i),l=n.enter("headingAtx"),c=n.enter("phrasing");a.move(o+" ");let d=n.containerPhrasing(t,{before:"# ",after:`
`,...a.current()});return/^[\t ]/.test(d)&&(d=zi(d.charCodeAt(0))+d.slice(1)),d=d?o+" "+d:o,n.options.closeAtx&&(d+=" "+o),c(),l(),d}Hf.peek=Cz;function Hf(t){return t.value||""}function Cz(){return"<"}Zf.peek=Tz;function Zf(t,s,n,r){const i=Bc(n),a=i==='"'?"Quote":"Apostrophe",o=n.enter("image");let l=n.enter("label");const c=n.createTracker(r);let d=c.move("![");return d+=c.move(n.safe(t.alt,{before:d,after:"]",...c.current()})),d+=c.move("]("),l(),!t.url&&t.title||/[\0- \u007F]/.test(t.url)?(l=n.enter("destinationLiteral"),d+=c.move("<"),d+=c.move(n.safe(t.url,{before:d,after:">",...c.current()})),d+=c.move(">")):(l=n.enter("destinationRaw"),d+=c.move(n.safe(t.url,{before:d,after:t.title?" ":")",...c.current()}))),l(),t.title&&(l=n.enter(`title${a}`),d+=c.move(" "+i),d+=c.move(n.safe(t.title,{before:d,after:i,...c.current()})),d+=c.move(i),l()),d+=c.move(")"),o(),d}function Tz(){return"!"}Yf.peek=_z;function Yf(t,s,n,r){const i=t.referenceType,a=n.enter("imageReference");let o=n.enter("label");const l=n.createTracker(r);let c=l.move("![");const d=n.safe(t.alt,{before:c,after:"]",...l.current()});c+=l.move(d+"]["),o();const m=n.stack;n.stack=[],o=n.enter("reference");const u=n.safe(n.associationId(t),{before:c,after:"]",...l.current()});return o(),n.stack=m,a(),i==="full"||!d||d!==u?c+=l.move(u+"]"):i==="shortcut"?c=c.slice(0,-1):c+=l.move("]"),c}function _z(){return"!"}Jf.peek=Az;function Jf(t,s,n){let r=t.value||"",i="`",a=-1;for(;new RegExp("(^|[^`])"+i+"([^`]|$)").test(r);)i+="`";for(/[^ \r\n]/.test(r)&&(/^[ \r\n]/.test(r)&&/[ \r\n]$/.test(r)||/^`|`$/.test(r))&&(r=" "+r+" ");++a<n.unsafe.length;){const o=n.unsafe[a],l=n.compilePattern(o);let c;if(o.atBreak)for(;c=l.exec(r);){let d=c.index;r.charCodeAt(d)===10&&r.charCodeAt(d-1)===13&&d--,r=r.slice(0,d)+" "+r.slice(c.index+1)}}return i+r+i}function Az(){return"`"}function Xf(t,s){const n=Gh(t);return!!(!s.options.resourceLink&&t.url&&!t.title&&t.children&&t.children.length===1&&t.children[0].type==="text"&&(n===t.url||"mailto:"+n===t.url)&&/^[a-z][a-z+.-]+:/i.test(t.url)&&!/[\0- <>\u007F]/.test(t.url))}ex.peek=Dz;function ex(t,s,n,r){const i=Bc(n),a=i==='"'?"Quote":"Apostrophe",o=n.createTracker(r);let l,c;if(Xf(t,n)){const m=n.stack;n.stack=[],l=n.enter("autolink");let u=o.move("<");return u+=o.move(n.containerPhrasing(t,{before:u,after:">",...o.current()})),u+=o.move(">"),l(),n.stack=m,u}l=n.enter("link"),c=n.enter("label");let d=o.move("[");return d+=o.move(n.containerPhrasing(t,{before:d,after:"](",...o.current()})),d+=o.move("]("),c(),!t.url&&t.title||/[\0- \u007F]/.test(t.url)?(c=n.enter("destinationLiteral"),d+=o.move("<"),d+=o.move(n.safe(t.url,{before:d,after:">",...o.current()})),d+=o.move(">")):(c=n.enter("destinationRaw"),d+=o.move(n.safe(t.url,{before:d,after:t.title?" ":")",...o.current()}))),c(),t.title&&(c=n.enter(`title${a}`),d+=o.move(" "+i),d+=o.move(n.safe(t.title,{before:d,after:i,...o.current()})),d+=o.move(i),c()),d+=o.move(")"),l(),d}function Dz(t,s,n){return Xf(t,n)?"<":"["}tx.peek=Pz;function tx(t,s,n,r){const i=t.referenceType,a=n.enter("linkReference");let o=n.enter("label");const l=n.createTracker(r);let c=l.move("[");const d=n.containerPhrasing(t,{before:c,after:"]",...l.current()});c+=l.move(d+"]["),o();const m=n.stack;n.stack=[],o=n.enter("reference");const u=n.safe(n.associationId(t),{before:c,after:"]",...l.current()});return o(),n.stack=m,a(),i==="full"||!d||d!==u?c+=l.move(u+"]"):i==="shortcut"?c=c.slice(0,-1):c+=l.move("]"),c}function Pz(){return"["}function Vc(t){const s=t.options.bullet||"*";if(s!=="*"&&s!=="+"&&s!=="-")throw new Error("Cannot serialize items with `"+s+"` for `options.bullet`, expected `*`, `+`, or `-`");return s}function Mz(t){const s=Vc(t),n=t.options.bulletOther;if(!n)return s==="*"?"-":"*";if(n!=="*"&&n!=="+"&&n!=="-")throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(n===s)throw new Error("Expected `bullet` (`"+s+"`) and `bulletOther` (`"+n+"`) to be different");return n}function Iz(t){const s=t.options.bulletOrdered||".";if(s!=="."&&s!==")")throw new Error("Cannot serialize items with `"+s+"` for `options.bulletOrdered`, expected `.` or `)`");return s}function sx(t){const s=t.options.rule||"*";if(s!=="*"&&s!=="-"&&s!=="_")throw new Error("Cannot serialize rules with `"+s+"` for `options.rule`, expected `*`, `-`, or `_`");return s}function Ez(t,s,n,r){const i=n.enter("list"),a=n.bulletCurrent;let o=t.ordered?Iz(n):Vc(n);const l=t.ordered?o==="."?")":".":Mz(n);let c=s&&n.bulletLastUsed?o===n.bulletLastUsed:!1;if(!t.ordered){const m=t.children?t.children[0]:void 0;if((o==="*"||o==="-")&&m&&(!m.children||!m.children[0])&&n.stack[n.stack.length-1]==="list"&&n.stack[n.stack.length-2]==="listItem"&&n.stack[n.stack.length-3]==="list"&&n.stack[n.stack.length-4]==="listItem"&&n.indexStack[n.indexStack.length-1]===0&&n.indexStack[n.indexStack.length-2]===0&&n.indexStack[n.indexStack.length-3]===0&&(c=!0),sx(n)===o&&m){let u=-1;for(;++u<t.children.length;){const h=t.children[u];if(h&&h.type==="listItem"&&h.children&&h.children[0]&&h.children[0].type==="thematicBreak"){c=!0;break}}}}c&&(o=l),n.bulletCurrent=o;const d=n.containerFlow(t,r);return n.bulletLastUsed=o,n.bulletCurrent=a,i(),d}function Lz(t){const s=t.options.listItemIndent||"one";if(s!=="tab"&&s!=="one"&&s!=="mixed")throw new Error("Cannot serialize items with `"+s+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return s}function Oz(t,s,n,r){const i=Lz(n);let a=n.bulletCurrent||Vc(n);s&&s.type==="list"&&s.ordered&&(a=(typeof s.start=="number"&&s.start>-1?s.start:1)+(n.options.incrementListMarker===!1?0:s.children.indexOf(t))+a);let o=a.length+1;(i==="tab"||i==="mixed"&&(s&&s.type==="list"&&s.spread||t.spread))&&(o=Math.ceil(o/4)*4);const l=n.createTracker(r);l.move(a+" ".repeat(o-a.length)),l.shift(o);const c=n.enter("listItem"),d=n.indentLines(n.containerFlow(t,l.current()),m);return c(),d;function m(u,h,p){return h?(p?"":" ".repeat(o))+u:(p?a:a+" ".repeat(o-a.length))+u}}function Rz(t,s,n,r){const i=n.enter("paragraph"),a=n.enter("phrasing"),o=n.containerPhrasing(t,r);return a(),i(),o}const $z=Kh(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function qz(t,s,n,r){return(t.children.some(function(o){return $z(o)})?n.containerPhrasing:n.containerFlow).call(n,t,r)}function Fz(t){const s=t.options.strong||"*";if(s!=="*"&&s!=="_")throw new Error("Cannot serialize strong with `"+s+"` for `options.strong`, expected `*`, or `_`");return s}nx.peek=Uz;function nx(t,s,n,r){const i=Fz(n),a=n.enter("strong"),o=n.createTracker(r),l=o.move(i+i);let c=o.move(n.containerPhrasing(t,{after:i,before:l,...o.current()}));const d=c.charCodeAt(0),m=Va(r.before.charCodeAt(r.before.length-1),d,i);m.inside&&(c=zi(d)+c.slice(1));const u=c.charCodeAt(c.length-1),h=Va(r.after.charCodeAt(0),u,i);h.inside&&(c=c.slice(0,-1)+zi(u));const p=o.move(i+i);return a(),n.attentionEncodeSurroundingInfo={after:h.outside,before:m.outside},l+c+p}function Uz(t,s,n){return n.options.strong||"*"}function Bz(t,s,n,r){return n.safe(t.value,r)}function Vz(t){const s=t.options.ruleRepetition||3;if(s<3)throw new Error("Cannot serialize rules with repetition `"+s+"` for `options.ruleRepetition`, expected `3` or more");return s}function Wz(t,s,n){const r=(sx(n)+(n.options.ruleSpaces?" ":"")).repeat(Vz(n));return n.options.ruleSpaces?r.slice(0,-1):r}const rx={blockquote:pz,break:Cu,code:bz,definition:vz,emphasis:Qf,hardBreak:Cu,heading:Sz,html:Hf,image:Zf,imageReference:Yf,inlineCode:Jf,link:ex,linkReference:tx,list:Ez,listItem:Oz,paragraph:Rz,root:qz,strong:nx,text:Bz,thematicBreak:Wz};function Kz(){return{enter:{table:Gz,tableData:Tu,tableHeader:Tu,tableRow:Hz},exit:{codeText:Zz,table:Qz,tableData:rl,tableHeader:rl,tableRow:rl}}}function Gz(t){const s=t._align;this.enter({type:"table",align:s.map(function(n){return n==="none"?null:n}),children:[]},t),this.data.inTable=!0}function Qz(t){this.exit(t),this.data.inTable=void 0}function Hz(t){this.enter({type:"tableRow",children:[]},t)}function rl(t){this.exit(t)}function Tu(t){this.enter({type:"tableCell",children:[]},t)}function Zz(t){let s=this.resume();this.data.inTable&&(s=s.replace(/\\([\\|])/g,Yz));const n=this.stack[this.stack.length-1];Sr(n.type==="inlineCode"),n.value=s,this.exit(t)}function Yz(t,s){return s==="|"?s:t}function Jz(t){const s=t||{},n=s.tableCellPadding,r=s.tablePipeAlign,i=s.stringLength,a=n?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:h,table:o,tableCell:c,tableRow:l}};function o(p,b,f,y){return d(m(p,f,y),p.align)}function l(p,b,f,y){const w=u(p,f,y),j=d([w]);return j.slice(0,j.indexOf(`
`))}function c(p,b,f,y){const w=f.enter("tableCell"),j=f.enter("phrasing"),v=f.containerPhrasing(p,{...y,before:a,after:a});return j(),w(),v}function d(p,b){return mz(p,{align:b,alignDelimiters:r,padding:n,stringLength:i})}function m(p,b,f){const y=p.children;let w=-1;const j=[],v=b.enter("table");for(;++w<y.length;)j[w]=u(y[w],b,f);return v(),j}function u(p,b,f){const y=p.children;let w=-1;const j=[],v=b.enter("tableRow");for(;++w<y.length;)j[w]=c(y[w],p,b,f);return v(),j}function h(p,b,f){let y=rx.inlineCode(p,b,f);return f.stack.includes("tableCell")&&(y=y.replace(/\|/g,"\\$&")),y}}function Xz(){return{exit:{taskListCheckValueChecked:_u,taskListCheckValueUnchecked:_u,paragraph:t1}}}function e1(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:s1}}}function _u(t){const s=this.stack[this.stack.length-2];Sr(s.type==="listItem"),s.checked=t.type==="taskListCheckValueChecked"}function t1(t){const s=this.stack[this.stack.length-2];if(s&&s.type==="listItem"&&typeof s.checked=="boolean"){const n=this.stack[this.stack.length-1];Sr(n.type==="paragraph");const r=n.children[0];if(r&&r.type==="text"){const i=s.children;let a=-1,o;for(;++a<i.length;){const l=i[a];if(l.type==="paragraph"){o=l;break}}o===n&&(r.value=r.value.slice(1),r.value.length===0?n.children.shift():n.position&&r.position&&typeof r.position.start.offset=="number"&&(r.position.start.column++,r.position.start.offset++,n.position.start=Object.assign({},r.position.start)))}}this.exit(t)}function s1(t,s,n,r){const i=t.children[0],a=typeof t.checked=="boolean"&&i&&i.type==="paragraph",o="["+(t.checked?"x":" ")+"] ",l=n.createTracker(r);a&&l.move(o);let c=rx.listItem(t,s,n,{...r,...l.current()});return a&&(c=c.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,d)),c;function d(m){return m+o}}function n1(){return[Ek(),sz(),az(),Kz(),Xz()]}function r1(t){return{extensions:[Lk(),nz(t),oz(),Jz(t),e1()]}}const i1={tokenize:u1,partial:!0},ix={tokenize:m1,partial:!0},ax={tokenize:h1,partial:!0},ox={tokenize:p1,partial:!0},a1={tokenize:f1,partial:!0},lx={name:"wwwAutolink",tokenize:c1,previous:dx},cx={name:"protocolAutolink",tokenize:d1,previous:ux},Fs={name:"emailAutolink",tokenize:l1,previous:mx},zs={};function o1(){return{text:zs}}let hn=48;for(;hn<123;)zs[hn]=Fs,hn++,hn===58?hn=65:hn===91&&(hn=97);zs[43]=Fs;zs[45]=Fs;zs[46]=Fs;zs[95]=Fs;zs[72]=[Fs,cx];zs[104]=[Fs,cx];zs[87]=[Fs,lx];zs[119]=[Fs,lx];function l1(t,s,n){const r=this;let i,a;return o;function o(u){return!Rl(u)||!mx.call(r,r.previous)||Wc(r.events)?n(u):(t.enter("literalAutolink"),t.enter("literalAutolinkEmail"),l(u))}function l(u){return Rl(u)?(t.consume(u),l):u===64?(t.consume(u),c):n(u)}function c(u){return u===46?t.check(a1,m,d)(u):u===45||u===95||gc(u)?(a=!0,t.consume(u),c):m(u)}function d(u){return t.consume(u),i=!0,c}function m(u){return a&&i&&xi(r.previous)?(t.exit("literalAutolinkEmail"),t.exit("literalAutolink"),s(u)):n(u)}}function c1(t,s,n){const r=this;return i;function i(o){return o!==87&&o!==119||!dx.call(r,r.previous)||Wc(r.events)?n(o):(t.enter("literalAutolink"),t.enter("literalAutolinkWww"),t.check(i1,t.attempt(ix,t.attempt(ax,a),n),n)(o))}function a(o){return t.exit("literalAutolinkWww"),t.exit("literalAutolink"),s(o)}}function d1(t,s,n){const r=this;let i="",a=!1;return o;function o(u){return(u===72||u===104)&&ux.call(r,r.previous)&&!Wc(r.events)?(t.enter("literalAutolink"),t.enter("literalAutolinkHttp"),i+=String.fromCodePoint(u),t.consume(u),l):n(u)}function l(u){if(xi(u)&&i.length<5)return i+=String.fromCodePoint(u),t.consume(u),l;if(u===58){const h=i.toLowerCase();if(h==="http"||h==="https")return t.consume(u),c}return n(u)}function c(u){return u===47?(t.consume(u),a?d:(a=!0,c)):n(u)}function d(u){return u===null||By(u)||$t(u)||pr(u)||xc(u)?n(u):t.attempt(ix,t.attempt(ax,m),n)(u)}function m(u){return t.exit("literalAutolinkHttp"),t.exit("literalAutolink"),s(u)}}function u1(t,s,n){let r=0;return i;function i(o){return(o===87||o===119)&&r<3?(r++,t.consume(o),i):o===46&&r===3?(t.consume(o),a):n(o)}function a(o){return o===null?n(o):s(o)}}function m1(t,s,n){let r,i,a;return o;function o(d){return d===46||d===95?t.check(ox,c,l)(d):d===null||$t(d)||pr(d)||d!==45&&xc(d)?c(d):(a=!0,t.consume(d),o)}function l(d){return d===95?r=!0:(i=r,r=void 0),t.consume(d),o}function c(d){return i||r||!a?n(d):s(d)}}function h1(t,s){let n=0,r=0;return i;function i(o){return o===40?(n++,t.consume(o),i):o===41&&r<n?a(o):o===33||o===34||o===38||o===39||o===41||o===42||o===44||o===46||o===58||o===59||o===60||o===63||o===93||o===95||o===126?t.check(ox,s,a)(o):o===null||$t(o)||pr(o)?s(o):(t.consume(o),i)}function a(o){return o===41&&r++,t.consume(o),i}}function p1(t,s,n){return r;function r(l){return l===33||l===34||l===39||l===41||l===42||l===44||l===46||l===58||l===59||l===63||l===95||l===126?(t.consume(l),r):l===38?(t.consume(l),a):l===93?(t.consume(l),i):l===60||l===null||$t(l)||pr(l)?s(l):n(l)}function i(l){return l===null||l===40||l===91||$t(l)||pr(l)?s(l):r(l)}function a(l){return xi(l)?o(l):n(l)}function o(l){return l===59?(t.consume(l),r):xi(l)?(t.consume(l),o):n(l)}}function f1(t,s,n){return r;function r(a){return t.consume(a),i}function i(a){return gc(a)?n(a):s(a)}}function dx(t){return t===null||t===40||t===42||t===95||t===91||t===93||t===126||$t(t)}function ux(t){return!xi(t)}function mx(t){return!(t===47||Rl(t))}function Rl(t){return t===43||t===45||t===46||t===95||gc(t)}function Wc(t){let s=t.length,n=!1;for(;s--;){const r=t[s][1];if((r.type==="labelLink"||r.type==="labelImage")&&!r._balanced){n=!0;break}if(r._gfmAutolinkLiteralWalkedInto){n=!1;break}}return t.length>0&&!n&&(t[t.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),n}const x1={tokenize:k1,partial:!0};function g1(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:w1,continuation:{tokenize:v1},exit:N1}},text:{91:{name:"gfmFootnoteCall",tokenize:b1},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:j1,resolveTo:y1}}}}function j1(t,s,n){const r=this;let i=r.events.length;const a=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let o;for(;i--;){const c=r.events[i][1];if(c.type==="labelImage"){o=c;break}if(c.type==="gfmFootnoteCall"||c.type==="labelLink"||c.type==="label"||c.type==="image"||c.type==="link")break}return l;function l(c){if(!o||!o._balanced)return n(c);const d=Oi(r.sliceSerialize({start:o.end,end:r.now()}));return d.codePointAt(0)!==94||!a.includes(d.slice(1))?n(c):(t.enter("gfmFootnoteCallLabelMarker"),t.consume(c),t.exit("gfmFootnoteCallLabelMarker"),s(c))}}function y1(t,s){let n=t.length;for(;n--;)if(t[n][1].type==="labelImage"&&t[n][0]==="enter"){t[n][1];break}t[n+1][1].type="data",t[n+3][1].type="gfmFootnoteCallLabelMarker";const r={type:"gfmFootnoteCall",start:Object.assign({},t[n+3][1].start),end:Object.assign({},t[t.length-1][1].end)},i={type:"gfmFootnoteCallMarker",start:Object.assign({},t[n+3][1].end),end:Object.assign({},t[n+3][1].end)};i.end.column++,i.end.offset++,i.end._bufferIndex++;const a={type:"gfmFootnoteCallString",start:Object.assign({},i.end),end:Object.assign({},t[t.length-1][1].start)},o={type:"chunkString",contentType:"string",start:Object.assign({},a.start),end:Object.assign({},a.end)},l=[t[n+1],t[n+2],["enter",r,s],t[n+3],t[n+4],["enter",i,s],["exit",i,s],["enter",a,s],["enter",o,s],["exit",o,s],["exit",a,s],t[t.length-2],t[t.length-1],["exit",r,s]];return t.splice(n,t.length-n+1,...l),t}function b1(t,s,n){const r=this,i=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let a=0,o;return l;function l(u){return t.enter("gfmFootnoteCall"),t.enter("gfmFootnoteCallLabelMarker"),t.consume(u),t.exit("gfmFootnoteCallLabelMarker"),c}function c(u){return u!==94?n(u):(t.enter("gfmFootnoteCallMarker"),t.consume(u),t.exit("gfmFootnoteCallMarker"),t.enter("gfmFootnoteCallString"),t.enter("chunkString").contentType="string",d)}function d(u){if(a>999||u===93&&!o||u===null||u===91||$t(u))return n(u);if(u===93){t.exit("chunkString");const h=t.exit("gfmFootnoteCallString");return i.includes(Oi(r.sliceSerialize(h)))?(t.enter("gfmFootnoteCallLabelMarker"),t.consume(u),t.exit("gfmFootnoteCallLabelMarker"),t.exit("gfmFootnoteCall"),s):n(u)}return $t(u)||(o=!0),a++,t.consume(u),u===92?m:d}function m(u){return u===91||u===92||u===93?(t.consume(u),a++,d):d(u)}}function w1(t,s,n){const r=this,i=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let a,o=0,l;return c;function c(b){return t.enter("gfmFootnoteDefinition")._container=!0,t.enter("gfmFootnoteDefinitionLabel"),t.enter("gfmFootnoteDefinitionLabelMarker"),t.consume(b),t.exit("gfmFootnoteDefinitionLabelMarker"),d}function d(b){return b===94?(t.enter("gfmFootnoteDefinitionMarker"),t.consume(b),t.exit("gfmFootnoteDefinitionMarker"),t.enter("gfmFootnoteDefinitionLabelString"),t.enter("chunkString").contentType="string",m):n(b)}function m(b){if(o>999||b===93&&!l||b===null||b===91||$t(b))return n(b);if(b===93){t.exit("chunkString");const f=t.exit("gfmFootnoteDefinitionLabelString");return a=Oi(r.sliceSerialize(f)),t.enter("gfmFootnoteDefinitionLabelMarker"),t.consume(b),t.exit("gfmFootnoteDefinitionLabelMarker"),t.exit("gfmFootnoteDefinitionLabel"),h}return $t(b)||(l=!0),o++,t.consume(b),b===92?u:m}function u(b){return b===91||b===92||b===93?(t.consume(b),o++,m):m(b)}function h(b){return b===58?(t.enter("definitionMarker"),t.consume(b),t.exit("definitionMarker"),i.includes(a)||i.push(a),Ys(t,p,"gfmFootnoteDefinitionWhitespace")):n(b)}function p(b){return s(b)}}function v1(t,s,n){return t.check(Vy,s,t.attempt(x1,s,n))}function N1(t){t.exit("gfmFootnoteDefinition")}function k1(t,s,n){const r=this;return Ys(t,i,"gfmFootnoteDefinitionIndent",5);function i(a){const o=r.events[r.events.length-1];return o&&o[1].type==="gfmFootnoteDefinitionIndent"&&o[2].sliceSerialize(o[1],!0).length===4?s(a):n(a)}}function z1(t){let n=(t||{}).singleTilde;const r={name:"strikethrough",tokenize:a,resolveAll:i};return n==null&&(n=!0),{text:{126:r},insideSpan:{null:[r]},attentionMarkers:{null:[126]}};function i(o,l){let c=-1;for(;++c<o.length;)if(o[c][0]==="enter"&&o[c][1].type==="strikethroughSequenceTemporary"&&o[c][1]._close){let d=c;for(;d--;)if(o[d][0]==="exit"&&o[d][1].type==="strikethroughSequenceTemporary"&&o[d][1]._open&&o[c][1].end.offset-o[c][1].start.offset===o[d][1].end.offset-o[d][1].start.offset){o[c][1].type="strikethroughSequence",o[d][1].type="strikethroughSequence";const m={type:"strikethrough",start:Object.assign({},o[d][1].start),end:Object.assign({},o[c][1].end)},u={type:"strikethroughText",start:Object.assign({},o[d][1].end),end:Object.assign({},o[c][1].start)},h=[["enter",m,l],["enter",o[d][1],l],["exit",o[d][1],l],["enter",u,l]],p=l.parser.constructs.insideSpan.null;p&&Qo(h,h.length,0,Wy(p,o.slice(d+1,c),l)),Qo(h,h.length,0,[["exit",u,l],["enter",o[c][1],l],["exit",o[c][1],l],["exit",m,l]]),Qo(o,d-1,c-d+3,h),c=d+h.length-2;break}}for(c=-1;++c<o.length;)o[c][1].type==="strikethroughSequenceTemporary"&&(o[c][1].type="data");return o}function a(o,l,c){const d=this.previous,m=this.events;let u=0;return h;function h(b){return d===126&&m[m.length-1][1].type!=="characterEscape"?c(b):(o.enter("strikethroughSequenceTemporary"),p(b))}function p(b){const f=Pa(d);if(b===126)return u>1?c(b):(o.consume(b),u++,p);if(u<2&&!n)return c(b);const y=o.exit("strikethroughSequenceTemporary"),w=Pa(b);return y._open=!w||w===2&&!!f,y._close=!f||f===2&&!!w,l(b)}}}class S1{constructor(){this.map=[]}add(s,n,r){C1(this,s,n,r)}consume(s){if(this.map.sort(function(a,o){return a[0]-o[0]}),this.map.length===0)return;let n=this.map.length;const r=[];for(;n>0;)n-=1,r.push(s.slice(this.map[n][0]+this.map[n][1]),this.map[n][2]),s.length=this.map[n][0];r.push(s.slice()),s.length=0;let i=r.pop();for(;i;){for(const a of i)s.push(a);i=r.pop()}this.map.length=0}}function C1(t,s,n,r){let i=0;if(!(n===0&&r.length===0)){for(;i<t.map.length;){if(t.map[i][0]===s){t.map[i][1]+=n,t.map[i][2].push(...r);return}i+=1}t.map.push([s,n,r])}}function T1(t,s){let n=!1;const r=[];for(;s<t.length;){const i=t[s];if(n){if(i[0]==="enter")i[1].type==="tableContent"&&r.push(t[s+1][1].type==="tableDelimiterMarker"?"left":"none");else if(i[1].type==="tableContent"){if(t[s-1][1].type==="tableDelimiterMarker"){const a=r.length-1;r[a]=r[a]==="left"?"center":"right"}}else if(i[1].type==="tableDelimiterRow")break}else i[0]==="enter"&&i[1].type==="tableDelimiterRow"&&(n=!0);s+=1}return r}function _1(){return{flow:{null:{name:"table",tokenize:A1,resolveAll:D1}}}}function A1(t,s,n){const r=this;let i=0,a=0,o;return l;function l(g){let C=r.events.length-1;for(;C>-1;){const M=r.events[C][1].type;if(M==="lineEnding"||M==="linePrefix")C--;else break}const A=C>-1?r.events[C][1].type:null,E=A==="tableHead"||A==="tableRow"?k:c;return E===k&&r.parser.lazy[r.now().line]?n(g):E(g)}function c(g){return t.enter("tableHead"),t.enter("tableRow"),d(g)}function d(g){return g===124||(o=!0,a+=1),m(g)}function m(g){return g===null?n(g):si(g)?a>1?(a=0,r.interrupt=!0,t.exit("tableRow"),t.enter("lineEnding"),t.consume(g),t.exit("lineEnding"),p):n(g):Yn(g)?Ys(t,m,"whitespace")(g):(a+=1,o&&(o=!1,i+=1),g===124?(t.enter("tableCellDivider"),t.consume(g),t.exit("tableCellDivider"),o=!0,m):(t.enter("data"),u(g)))}function u(g){return g===null||g===124||$t(g)?(t.exit("data"),m(g)):(t.consume(g),g===92?h:u)}function h(g){return g===92||g===124?(t.consume(g),u):u(g)}function p(g){return r.interrupt=!1,r.parser.lazy[r.now().line]?n(g):(t.enter("tableDelimiterRow"),o=!1,Yn(g)?Ys(t,b,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(g):b(g))}function b(g){return g===45||g===58?y(g):g===124?(o=!0,t.enter("tableCellDivider"),t.consume(g),t.exit("tableCellDivider"),f):z(g)}function f(g){return Yn(g)?Ys(t,y,"whitespace")(g):y(g)}function y(g){return g===58?(a+=1,o=!0,t.enter("tableDelimiterMarker"),t.consume(g),t.exit("tableDelimiterMarker"),w):g===45?(a+=1,w(g)):g===null||si(g)?T(g):z(g)}function w(g){return g===45?(t.enter("tableDelimiterFiller"),j(g)):z(g)}function j(g){return g===45?(t.consume(g),j):g===58?(o=!0,t.exit("tableDelimiterFiller"),t.enter("tableDelimiterMarker"),t.consume(g),t.exit("tableDelimiterMarker"),v):(t.exit("tableDelimiterFiller"),v(g))}function v(g){return Yn(g)?Ys(t,T,"whitespace")(g):T(g)}function T(g){return g===124?b(g):g===null||si(g)?!o||i!==a?z(g):(t.exit("tableDelimiterRow"),t.exit("tableHead"),s(g)):z(g)}function z(g){return n(g)}function k(g){return t.enter("tableRow"),N(g)}function N(g){return g===124?(t.enter("tableCellDivider"),t.consume(g),t.exit("tableCellDivider"),N):g===null||si(g)?(t.exit("tableRow"),s(g)):Yn(g)?Ys(t,N,"whitespace")(g):(t.enter("data"),S(g))}function S(g){return g===null||g===124||$t(g)?(t.exit("data"),N(g)):(t.consume(g),g===92?_:S)}function _(g){return g===92||g===124?(t.consume(g),S):S(g)}}function D1(t,s){let n=-1,r=!0,i=0,a=[0,0,0,0],o=[0,0,0,0],l=!1,c=0,d,m,u;const h=new S1;for(;++n<t.length;){const p=t[n],b=p[1];p[0]==="enter"?b.type==="tableHead"?(l=!1,c!==0&&(Au(h,s,c,d,m),m=void 0,c=0),d={type:"table",start:Object.assign({},b.start),end:Object.assign({},b.end)},h.add(n,0,[["enter",d,s]])):b.type==="tableRow"||b.type==="tableDelimiterRow"?(r=!0,u=void 0,a=[0,0,0,0],o=[0,n+1,0,0],l&&(l=!1,m={type:"tableBody",start:Object.assign({},b.start),end:Object.assign({},b.end)},h.add(n,0,[["enter",m,s]])),i=b.type==="tableDelimiterRow"?2:m?3:1):i&&(b.type==="data"||b.type==="tableDelimiterMarker"||b.type==="tableDelimiterFiller")?(r=!1,o[2]===0&&(a[1]!==0&&(o[0]=o[1],u=ma(h,s,a,i,void 0,u),a=[0,0,0,0]),o[2]=n)):b.type==="tableCellDivider"&&(r?r=!1:(a[1]!==0&&(o[0]=o[1],u=ma(h,s,a,i,void 0,u)),a=o,o=[a[1],n,0,0])):b.type==="tableHead"?(l=!0,c=n):b.type==="tableRow"||b.type==="tableDelimiterRow"?(c=n,a[1]!==0?(o[0]=o[1],u=ma(h,s,a,i,n,u)):o[1]!==0&&(u=ma(h,s,o,i,n,u)),i=0):i&&(b.type==="data"||b.type==="tableDelimiterMarker"||b.type==="tableDelimiterFiller")&&(o[3]=n)}for(c!==0&&Au(h,s,c,d,m),h.consume(s.events),n=-1;++n<s.events.length;){const p=s.events[n];p[0]==="enter"&&p[1].type==="table"&&(p[1]._align=T1(s.events,n))}return t}function ma(t,s,n,r,i,a){const o=r===1?"tableHeader":r===2?"tableDelimiter":"tableData",l="tableContent";n[0]!==0&&(a.end=Object.assign({},Jn(s.events,n[0])),t.add(n[0],0,[["exit",a,s]]));const c=Jn(s.events,n[1]);if(a={type:o,start:Object.assign({},c),end:Object.assign({},c)},t.add(n[1],0,[["enter",a,s]]),n[2]!==0){const d=Jn(s.events,n[2]),m=Jn(s.events,n[3]),u={type:l,start:Object.assign({},d),end:Object.assign({},m)};if(t.add(n[2],0,[["enter",u,s]]),r!==2){const h=s.events[n[2]],p=s.events[n[3]];if(h[1].end=Object.assign({},p[1].end),h[1].type="chunkText",h[1].contentType="text",n[3]>n[2]+1){const b=n[2]+1,f=n[3]-n[2]-1;t.add(b,f,[])}}t.add(n[3]+1,0,[["exit",u,s]])}return i!==void 0&&(a.end=Object.assign({},Jn(s.events,i)),t.add(i,0,[["exit",a,s]]),a=void 0),a}function Au(t,s,n,r,i){const a=[],o=Jn(s.events,n);i&&(i.end=Object.assign({},o),a.push(["exit",i,s])),r.end=Object.assign({},o),a.push(["exit",r,s]),t.add(n+1,0,a)}function Jn(t,s){const n=t[s],r=n[0]==="enter"?"start":"end";return n[1][r]}const P1={name:"tasklistCheck",tokenize:I1};function M1(){return{text:{91:P1}}}function I1(t,s,n){const r=this;return i;function i(c){return r.previous!==null||!r._gfmTasklistFirstContentOfListItem?n(c):(t.enter("taskListCheck"),t.enter("taskListCheckMarker"),t.consume(c),t.exit("taskListCheckMarker"),a)}function a(c){return $t(c)?(t.enter("taskListCheckValueUnchecked"),t.consume(c),t.exit("taskListCheckValueUnchecked"),o):c===88||c===120?(t.enter("taskListCheckValueChecked"),t.consume(c),t.exit("taskListCheckValueChecked"),o):n(c)}function o(c){return c===93?(t.enter("taskListCheckMarker"),t.consume(c),t.exit("taskListCheckMarker"),t.exit("taskListCheck"),l):n(c)}function l(c){return si(c)?s(c):Yn(c)?t.check({tokenize:E1},s,n)(c):n(c)}}function E1(t,s,n){return Ys(t,r,"whitespace");function r(i){return i===null?n(i):s(i)}}function L1(t){return Ky([o1(),g1(),z1(t),_1(),M1()])}const O1={};function $l(t){const s=this,n=t||O1,r=s.data(),i=r.micromarkExtensions||(r.micromarkExtensions=[]),a=r.fromMarkdownExtensions||(r.fromMarkdownExtensions=[]),o=r.toMarkdownExtensions||(r.toMarkdownExtensions=[]);i.push(L1(n)),a.push(n1()),o.push(r1(n))}const R1=({activity:t})=>e.jsxs("div",{className:"grid gap-6 lg:grid-cols-[1fr,300px]",children:[e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{children:"Tre materiau"})}),e.jsx(P,{children:t.content?e.jsx("div",{className:"prose max-w-none",children:e.jsx(Ma,{remarkPlugins:[$l],children:t.content})}):e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(it,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"Brak treci materiau"})]})})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs(D,{children:[e.jsx($,{className:"pb-3",children:e.jsx(R,{className:"text-base",children:"Informacje"})}),e.jsxs(P,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-1",children:[e.jsx(Te,{className:"w-4 h-4"}),"Czas trwania"]}),e.jsxs("p",{className:"font-medium",children:[t.duration_min||"-"," minut"]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-1",children:[e.jsx(mb,{className:"w-4 h-4"}),"Pozycja w temacie"]}),e.jsx("p",{className:"font-medium",children:t.position})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-1",children:[e.jsx(Tt,{className:"w-4 h-4"}),"Data utworzenia"]}),e.jsx("p",{className:"font-medium",children:new Date(t.created_at).toLocaleDateString("pl-PL")})]}),t.updated_at&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-1",children:[e.jsx(Tt,{className:"w-4 h-4"}),"Ostatnia aktualizacja"]}),e.jsx("p",{className:"font-medium",children:new Date(t.updated_at).toLocaleDateString("pl-PL")})]})]})]})})]}),$1=({activity:t,questionsCount:s,questionsData:n,questionsLoading:r,onNavigateToQuestions:i})=>{const a=n?.reduce((l,c)=>l+(c.points||0),0)||0,o=Math.ceil((t.passing_score||70)/100*a);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{children:"Parametry quizu"})}),e.jsx(P,{children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs("div",{className:"p-4 rounded-lg bg-muted",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Te,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Czas trwania"})]}),e.jsxs("p",{className:"text-2xl font-bold",children:[t.duration_min||"-"," min"]})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-muted",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Se,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Pr贸g zaliczenia"})]}),e.jsxs("p",{className:"text-2xl font-bold",children:[t.passing_score||70,"%"]})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-muted",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(hb,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Limit czasu"})]}),e.jsx("p",{className:"text-2xl font-bold",children:t.time_limit?`${t.time_limit} min`:"Brak"})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-muted",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(xr,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Liczba pr贸b"})]}),e.jsx("p",{className:"text-2xl font-bold",children:t.max_attempts||"Bez limitu"})]})]})})]}),e.jsxs(D,{children:[e.jsx($,{children:e.jsxs(R,{className:"flex items-center justify-between",children:[e.jsxs("span",{children:["Pytania (",s,")"]}),s>0&&e.jsxs(I,{size:"sm",variant:"outline",onClick:()=>i(t.id),children:[e.jsx(ks,{className:"w-3 h-3 mr-1"}),"Zarzdzaj"]})]})}),e.jsx(P,{children:s===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(at,{className:"w-16 h-16 mx-auto mb-4 text-muted-foreground/30"}),e.jsx("p",{className:"text-lg font-medium text-muted-foreground mb-2",children:"Ten quiz nie ma jeszcze pyta"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-6",children:"Dodaj pytania, aby uczniowie mogli rozwiza quiz"}),e.jsxs(I,{onClick:()=>i(t.id),children:[e.jsx(Ie,{className:"w-4 h-4 mr-2"}),"Dodaj pierwsze pytanie"]})]}):r?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary"})}):e.jsx("div",{className:"space-y-2",children:n?.map((l,c)=>e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg border bg-card hover:bg-muted/50 transition-colors",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-primary/10 rounded-full flex items-center justify-center text-sm font-semibold",children:c+1}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.type==="single_choice"&&e.jsxs(H,{variant:"outline",className:"text-xs",children:[e.jsx(Re,{className:"w-3 h-3 mr-1"}),"Jednokrotny wyb贸r"]}),l.type==="multiple_choice"&&e.jsxs(H,{variant:"outline",className:"text-xs",children:[e.jsx(Xs,{className:"w-3 h-3 mr-1"}),"Wielokrotny wyb贸r"]}),l.type==="true_false"&&e.jsxs(H,{variant:"outline",className:"text-xs",children:[e.jsx(yt,{className:"w-3 h-3 mr-1"}),"Prawda/Fasz"]}),e.jsxs(H,{variant:"secondary",className:"text-xs",children:[l.points," pkt"]})]}),e.jsx("p",{className:"text-sm font-medium line-clamp-2",children:l.content}),l.explanation&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1 line-clamp-1",children:[e.jsx("span",{className:"font-medium",children:"Wyjanienie:"})," ",l.explanation]})]})]},l.id))})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(D,{children:[e.jsx($,{className:"pb-3",children:e.jsx(R,{className:"text-base",children:"Statystyki"})}),e.jsx(P,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Liczba pyta"}),e.jsx("span",{className:"font-medium",children:s})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Maksymalna liczba punkt贸w"}),e.jsx("span",{className:"font-medium",children:a})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Wymagane punkty do zaliczenia"}),e.jsx("span",{className:"font-medium",children:o})]})]})})]}),e.jsxs(D,{children:[e.jsx($,{className:"pb-3",children:e.jsx(R,{className:"text-base",children:"Informacje"})}),e.jsx(P,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Pozycja w temacie"}),e.jsx("span",{className:"font-medium",children:t.position})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Data utworzenia"}),e.jsx("span",{className:"font-medium",children:new Date(t.created_at).toLocaleDateString("pl-PL")})]}),t.updated_at&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Ostatnia aktualizacja"}),e.jsx("span",{className:"font-medium",children:new Date(t.updated_at).toLocaleDateString("pl-PL")})]})]})})]})]})]})},q1=()=>{const{edit:t}=ut(),{id:s}=vt(),n=se(),{data:r,isLoading:i}=Xe({resource:"activities",id:s,meta:{select:"*, topics(*, courses(*)), questions:questions(count)"}}),{data:a,isLoading:o}=Y({resource:"questions",filters:[{field:"activity_id",operator:"eq",value:parseInt(s)}],sorters:[{field:"position",order:"asc"}],queryOptions:{enabled:r?.data?.type==="quiz"&&!!s}});if(i)return e.jsx(G,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const l=r?.data;if(!l)return e.jsx(G,{children:e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:"Nie znaleziono aktywnoci"})})});const c=l.topics,d=c?.courses,m=l.questions?.[0]?.count||l._count?.questions||0,u=()=>{const f=window.location.pathname+window.location.search;sessionStorage.setItem("returnUrl",f),t("activities",l.id??"")},h=f=>{const y=window.location.pathname+window.location.search;sessionStorage.setItem("returnUrl",y),n(f)},p=()=>l.type==="quiz"?e.jsx(at,{className:"w-5 h-5"}):e.jsx(it,{className:"w-5 h-5"}),b=()=>l.type==="quiz"?"text-blue-500":"text-green-500";return e.jsxs(G,{children:[e.jsx(Tn,{}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"text-sm text-muted-foreground mb-2",children:[d?.title,"  Temat ",c?.position,": ",c?.title]}),e.jsxs(X,{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg bg-muted ${b()}`,children:p()}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:l.title}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(H,{variant:l.type==="quiz"?"default":"secondary",children:l.type==="quiz"?"Quiz":"Materia"}),e.jsx(H,{variant:l.is_published?"default":"outline",children:l.is_published?e.jsxs(e.Fragment,{children:[e.jsx(Je,{className:"w-3 h-3 mr-1"})," Opublikowany"]}):e.jsxs(e.Fragment,{children:[e.jsx(uo,{className:"w-3 h-3 mr-1"})," Szkic"]})})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[l.type==="quiz"&&e.jsxs(I,{variant:"outline",onClick:()=>h(`/teacher/questions/manage/${l.id}`),children:[e.jsx(Xs,{className:"w-4 h-4 mr-2"}),"Zarzdzaj pytaniami (",m,")"]}),e.jsxs(I,{onClick:u,children:[e.jsx(ks,{className:"w-4 h-4 mr-2"}),"Edytuj"]})]})]})]}),l.type==="material"?e.jsx(R1,{activity:l}):e.jsx($1,{activity:l,questionsCount:m,questionsData:a?.data,questionsLoading:o,onNavigateToQuestions:f=>h(`/teacher/questions/manage/${f}`)})]})},Du={name:"activities",list:"/teacher/activities/create",create:"/teacher/activities/create",edit:"/teacher/activities/edit/:id",show:"/teacher/activities/show/:id",meta:{hide:!0}},F1=[e.jsx(W,{path:"activities/create",element:e.jsx(Tk,{})},"activities-create"),e.jsx(W,{path:"activities/edit/:id",element:e.jsx(_k,{})},"activities-edit"),e.jsx(W,{path:"activities/show/:id",element:e.jsx(q1,{})},"activities-show")],U1=()=>{const{create:t,edit:s,show:n}=ut(),r=se(),{mutate:i}=zn(),{tableQuery:{data:a,isLoading:o,isError:l,refetch:c},current:d,setCurrent:m,pageSize:u,setFilters:h}=Hh({sorters:{initial:[{field:"created_at",order:"desc"}]},meta:{select:"*, group_members(count), course_access(count)"}}),p=kc({isLoading:o,isError:l});if(p)return p;const b=(j,v)=>{confirm(`Czy na pewno chcesz usun grup "${v}"? Ta akcja usunie r贸wnie偶 wszystkie przypisania uczni贸w i kurs贸w.`)&&i({resource:"groups",id:j},{onSuccess:()=>{K.success("Grupa zostaa usunita"),c()},onError:()=>{K.error("Bd podczas usuwania grupy")}})},f=(j,v)=>{v?.stopPropagation(),r(`/teacher/groups/${j}/assign-courses`)},y=(j,v)=>{v?.stopPropagation(),r(`/teacher/groups/${j}/assign-students`)},w=j=>!j||!Array.isArray(j)||j.length===0?0:j[0].count||0;return e.jsxs(G,{children:[e.jsxs(X,{children:[e.jsx(_e,{title:"Grupy",description:"Zarzdzaj grupami uczni贸w i przypisuj im kursy"}),e.jsxs(I,{onClick:()=>t("groups"),children:[e.jsx(Ie,{className:"w-4 h-4 mr-2"}),"Dodaj grup"]})]}),e.jsx(X,{children:e.jsx(Z,{placeholder:"Szukaj grup...",className:"max-w-sm",onChange:j=>{h([{field:"name",operator:"contains",value:j.target.value}])}})}),a?.data?.length===0?e.jsx(D,{className:"border-dashed border-2",children:e.jsxs(P,{className:"text-center py-12",children:[e.jsx(pe,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Brak grup"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Utw贸rz pierwsz grup, aby m贸c przypisywa uczni贸w do kurs贸w"}),e.jsxs(I,{onClick:()=>t("groups"),children:[e.jsx(Ie,{className:"w-4 h-4 mr-2"}),"Utw贸rz pierwsz grup"]})]})}):e.jsx(wt,{children:a?.data?.map(j=>{const v=w(j.group_members),T=w(j.course_access);return e.jsxs(D,{className:"cursor-pointer transition-all hover:shadow-lg hover:border-primary/50 relative overflow-hidden",onClick:z=>{!z.target.closest('[role="menu"]')&&!z.target.closest(".quick-action")&&n("groups",j.id)},children:[!j.is_active&&e.jsx("div",{className:"absolute inset-0 bg-muted/50 z-10 pointer-events-none"}),e.jsx($,{children:e.jsxs(X,{children:[e.jsxs(R,{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"w-5 h-5 text-primary"}),e.jsx("span",{className:"truncate",children:j.name})]}),e.jsxs(br,{children:[e.jsx(wr,{asChild:!0,children:e.jsx(I,{variant:"ghost",size:"sm",onClick:z=>z.stopPropagation(),className:"relative z-20",children:e.jsx(co,{className:"h-4 w-4"})})}),e.jsxs(Cn,{align:"end",children:[e.jsxs(ve,{onClick:()=>n("groups",j.id),children:[e.jsx(Je,{className:"mr-2 h-4 w-4"}),"Podgld"]}),e.jsxs(ve,{onClick:()=>s("groups",j.id),children:[e.jsx(ks,{className:"mr-2 h-4 w-4"}),"Edytuj"]}),e.jsx(jt,{}),e.jsxs(ve,{onClick:z=>y(j.id,z),className:"text-blue-600 focus:text-blue-600",children:[e.jsx(Ls,{className:"mr-2 h-4 w-4"}),"Dodaj uczni贸w"]}),e.jsxs(ve,{onClick:z=>f(j.id,z),className:"text-green-600 focus:text-green-600",children:[e.jsx(ye,{className:"mr-2 h-4 w-4"}),"Przypisz kursy"]}),e.jsx(jt,{}),e.jsxs(ve,{onClick:()=>b(j.id,j.name),className:"text-red-600 focus:text-red-600",children:[e.jsx(ls,{className:"mr-2 h-4 w-4"}),"Usu"]})]})]})]})}),e.jsx(P,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(Tt,{className:"w-4 h-4"}),e.jsxs("span",{children:["Rok akademicki: ",j.academic_year]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-background rounded-md",children:e.jsx(pe,{className:"w-4 h-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Uczniowie"}),e.jsx("p",{className:"text-lg font-semibold",children:v})]})]})}),e.jsx("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-background rounded-md",children:e.jsx(ye,{className:"w-4 h-4 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Kursy"}),e.jsx("p",{className:"text-lg font-semibold",children:T})]})]})})]}),e.jsxs("div",{className:"flex items-center justify-between pt-2",children:[e.jsx(H,{variant:j.is_active?"default":"secondary",className:j.is_active?"bg-green-600":"",children:j.is_active?"Aktywna":"Nieaktywna"}),e.jsxs("div",{className:"flex gap-1",children:[v===0&&e.jsx(I,{size:"sm",variant:"ghost",className:"h-8 px-2 quick-action text-blue-600 hover:text-blue-700 hover:bg-blue-50",onClick:z=>y(j.id,z),title:"Dodaj uczni贸w",children:e.jsx(Ls,{className:"h-4 w-4"})}),e.jsxs(I,{size:"sm",variant:"ghost",className:"h-8 px-2 quick-action text-green-600 hover:text-green-700 hover:bg-green-50",onClick:z=>f(j.id,z),title:"Przypisz kursy",children:[e.jsx(ye,{className:"h-4 w-4"}),e.jsx(le,{className:"h-3 w-3 ml-1"})]})]})]})]})})]},j.id)})}),e.jsx(kp,{current:d,pageSize:u,total:a?.total||0,setCurrent:m,itemName:"grup"})]})},B1=()=>{const{list:t}=ut(),{data:s}=We(),{refineCore:{onFinish:n},register:r,handleSubmit:i,setValue:a,watch:o,formState:{errors:l,isSubmitting:c}}=ln({defaultValues:{name:"",vendor_id:s?.vendor_id||0,is_active:!0,academic_year:new Date().getFullYear().toString()+"/"+(new Date().getFullYear()+1).toString()}});return e.jsxs(G,{children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>t("groups"),children:[e.jsx(Ce,{className:"w-4 h-4 mr-2"}),"Powr贸t do listy"]}),e.jsx(X,{children:e.jsx(_e,{title:"Dodaj grup",description:"Utw贸rz now grup uczni贸w"})}),e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{children:"Informacje o grupie"})}),e.jsx(P,{children:e.jsxs(cn,{onSubmit:i(n),children:[e.jsx(oe,{label:"Nazwa grupy",htmlFor:"name",error:l.name?.message?.toString(),required:!0,children:e.jsx(Z,{id:"name",placeholder:"np. Klasa 1A",...r("name",{required:"Nazwa grupy jest wymagana",minLength:{value:2,message:"Nazwa musi mie minimum 2 znaki"}})})}),e.jsx(oe,{label:"Rok akademicki",htmlFor:"academic_year",error:l.academic_year?.message?.toString(),required:!0,children:e.jsx(Z,{id:"academic_year",placeholder:"np. 2024/2025",...r("academic_year",{required:"Rok akademicki jest wymagany",pattern:{value:/^\d{4}\/\d{4}$/,message:"Format: RRRR/RRRR (np. 2024/2025)"}})})}),e.jsx(oe,{label:"Status grupy",children:e.jsxs(X,{variant:"start",children:[e.jsx(es,{checked:o("is_active"),onCheckedChange:d=>a("is_active",d)}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Grupa aktywna"})]})}),e.jsxs(dn,{children:[e.jsx(I,{type:"button",variant:"outline",onClick:()=>t("groups"),children:"Anuluj"}),e.jsx(I,{type:"submit",disabled:c,children:c?"Tworzenie...":"Utw贸rz grup"})]})]})})]})]})},V1=()=>{const{list:t}=ut(),{id:s}=vt(),{data:n,isLoading:r}=Xe({resource:"groups",id:s,liveMode:"off"}),{refineCore:{onFinish:i},register:a,handleSubmit:o,setValue:l,watch:c,reset:d,formState:{errors:m,isSubmitting:u}}=ln({refineCoreProps:{resource:"groups",id:s,redirect:"list",liveMode:"off"}});return x.useEffect(()=>{n?.data&&d({name:n.data.name,academic_year:n.data.academic_year,is_active:n.data.is_active,vendor_id:n.data.vendor_id})},[n,d]),r?e.jsx(G,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})}):e.jsxs(G,{children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>t("groups"),children:[e.jsx(Ce,{className:"w-4 h-4 mr-2"}),"Powr贸t do listy"]}),e.jsx(X,{children:e.jsx(_e,{title:"Edytuj grup",description:`Edycja: ${n?.data?.name}`})}),e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{children:"Informacje o grupie"})}),e.jsx(P,{children:e.jsxs(cn,{onSubmit:o(i),children:[e.jsx(oe,{label:"Nazwa grupy",htmlFor:"name",error:m.name?.message,required:!0,children:e.jsx(Z,{id:"name",placeholder:"np. Klasa 1A",...a("name",{required:"Nazwa grupy jest wymagana",minLength:{value:2,message:"Nazwa musi mie minimum 2 znaki"}})})}),e.jsx(oe,{label:"Rok akademicki",htmlFor:"academic_year",error:m.academic_year?.message,required:!0,children:e.jsx(Z,{id:"academic_year",placeholder:"np. 2024/2025",...a("academic_year",{required:"Rok akademicki jest wymagany",pattern:{value:/^\d{4}\/\d{4}$/,message:"Format: RRRR/RRRR (np. 2024/2025)"}})})}),e.jsx(oe,{label:"Status grupy",children:e.jsxs(X,{variant:"start",children:[e.jsx(es,{checked:c("is_active"),onCheckedChange:h=>l("is_active",h)}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Grupa aktywna"})]})}),e.jsxs(dn,{children:[e.jsx(I,{type:"button",variant:"outline",onClick:()=>t("groups"),children:"Anuluj"}),e.jsx(I,{type:"submit",disabled:u,children:u?"Zapisywanie...":"Zapisz zmiany"})]})]})})]})]})},W1=()=>{const{list:t,edit:s,show:n}=ut(),{id:r}=vt(),i=se(),a=Zh(),{data:o,isLoading:l}=Xe({resource:"groups",id:r,liveMode:"off"}),{data:c,isLoading:d}=Y({resource:"group_members",filters:[{field:"group_id",operator:"eq",value:r}],meta:{select:"*, users(*)"},queryOptions:{enabled:!!r},liveMode:"off"}),{data:m,isLoading:u}=Y({resource:"course_access",filters:[{field:"group_id",operator:"eq",value:r}],meta:{select:"*, courses(*)"},queryOptions:{enabled:!!r},liveMode:"off"}),h=async(w,j)=>{if(confirm(`Czy na pewno chcesz odpi kurs "${j}" od tej grupy?`))try{const{error:v}=await J.from("course_access").delete().eq("course_id",w).eq("group_id",parseInt(r));if(v)throw v;K.success("Kurs zosta odpity od grupy"),a({resource:"course_access",invalidates:["list"]})}catch(v){console.error("Error removing course:",v),K.error("Bd podczas odpinania kursu")}},p=async(w,j)=>{if(confirm(`Czy na pewno chcesz usun "${j}" z tej grupy?`))try{const{error:v}=await J.from("group_members").delete().eq("user_id",w).eq("group_id",parseInt(r));if(v)throw v;K.success("Ucze zosta usunity z grupy"),a({resource:"group_members",invalidates:["list"]})}catch(v){console.error("Error removing member:",v),K.error("Bd podczas usuwania ucznia z grupy")}};if(l||d||u)return e.jsx(G,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const b=o?.data,f=c?.total||0,y=m?.total||0;return e.jsxs(G,{children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>t("groups"),children:[e.jsx(Ce,{className:"w-4 h-4 mr-2"}),"Powr贸t do listy"]}),e.jsxs(X,{children:[e.jsxs("div",{children:[e.jsx(_e,{title:b?.name,description:`Rok akademicki: ${b?.academic_year}`}),!b?.is_active&&e.jsx(H,{variant:"secondary",className:"mt-2",children:"Grupa nieaktywna"})]}),e.jsxs(I,{onClick:()=>s("groups",b?.id??""),children:[e.jsx(ks,{className:"w-4 h-4 mr-2"}),"Edytuj grup"]})]}),!b?.is_active&&e.jsxs(ge,{children:[e.jsx(yt,{className:"h-4 w-4"}),e.jsx(je,{children:"Ta grupa jest nieaktywna. Uczniowie nie maj dostpu do przypisanych kurs贸w."})]}),e.jsxs(wt,{variant:"2-2-4",children:[e.jsxs(D,{children:[e.jsx($,{className:"pb-2",children:e.jsx(R,{className:"text-sm font-medium",children:"Status"})}),e.jsx(P,{children:e.jsx(H,{variant:b?.is_active?"default":"secondary",className:b?.is_active?"bg-green-600":"",children:b?.is_active?"Aktywna":"Nieaktywna"})})]}),e.jsxs(D,{children:[e.jsx($,{className:"pb-2",children:e.jsx(R,{className:"text-sm font-medium",children:"Uczniowie"})}),e.jsx(P,{children:e.jsx("div",{className:"text-2xl font-bold",children:f})})]}),e.jsxs(D,{children:[e.jsx($,{className:"pb-2",children:e.jsx(R,{className:"text-sm font-medium",children:"Kursy"})}),e.jsx(P,{children:e.jsx("div",{className:"text-2xl font-bold",children:y})})]}),e.jsxs(D,{children:[e.jsx($,{className:"pb-2",children:e.jsx(R,{className:"text-sm font-medium",children:"Utworzono"})}),e.jsx(P,{children:e.jsx("div",{className:"text-sm",children:new Date(b?.created_at).toLocaleDateString("pl-PL")})})]})]}),e.jsxs(wt,{variant:"1-2-2",children:[e.jsxs(D,{children:[e.jsx($,{children:e.jsxs(X,{children:[e.jsx(R,{children:"Uczniowie grupy"}),e.jsxs(I,{size:"sm",onClick:()=>i(`/teacher/groups/${r}/assign-students`),children:[e.jsx(Ls,{className:"w-4 h-4 mr-2"}),"Dodaj ucznia"]})]})}),e.jsx(P,{children:c?.data?.length?e.jsx("div",{className:"space-y-2",children:c.data.map(w=>e.jsx("div",{className:"p-4 border rounded-lg hover:bg-muted/30 transition-all duration-200 group",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-muted/50 flex items-center justify-center flex-shrink-0",children:e.jsx(pe,{className:"h-5 w-5 text-muted-foreground"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-base leading-tight truncate pr-2",children:w.users?.full_name}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx(io,{className:"h-3.5 w-3.5 text-muted-foreground"}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:w.users?.email})]})]})]}),e.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx(Ds,{children:e.jsxs(Ps,{children:[e.jsx(Ms,{asChild:!0,children:e.jsx(I,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>n("users",w.user_id),children:e.jsx(Zd,{className:"h-4 w-4"})})}),e.jsx(ps,{children:e.jsx("p",{children:"Zobacz profil"})})]})}),e.jsx(Ds,{children:e.jsxs(Ps,{children:[e.jsx(Ms,{asChild:!0,children:e.jsx(I,{variant:"ghost",size:"icon",className:"h-8 w-8 hover:bg-red-50",onClick:()=>p(w.user_id,w.users?.full_name),children:e.jsx(ls,{className:"h-4 w-4 text-red-600"})})}),e.jsx(ps,{children:e.jsx("p",{children:"Usu z grupy"})})]})})]})]})},w.user_id))}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(pe,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),e.jsx("p",{children:"Brak uczni贸w w grupie"}),e.jsxs(I,{size:"sm",variant:"outline",className:"mt-4",onClick:()=>i(`/teacher/groups/${r}/assign-students`),children:[e.jsx(Ls,{className:"w-4 h-4 mr-2"}),"Dodaj pierwszego ucznia"]})]})})]}),e.jsxs(D,{children:[e.jsx($,{children:e.jsxs(X,{children:[e.jsx(R,{children:"Przypisane kursy"}),e.jsxs(I,{size:"sm",onClick:()=>i(`/teacher/groups/${r}/assign-courses`),children:[e.jsx(Ie,{className:"w-4 h-4 mr-2"}),"Przypisz kurs"]})]})}),e.jsx(P,{children:m?.data?.length?e.jsx("div",{className:"space-y-2",children:m.data.map(w=>e.jsx("div",{className:"p-4 border rounded-lg hover:bg-muted/30 transition-all duration-200 group",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:w.courses?.icon_emoji?e.jsx("div",{className:"h-10 w-10 rounded-lg bg-muted/50 flex items-center justify-center",children:e.jsx("span",{className:"text-xl",children:w.courses.icon_emoji})}):e.jsx("div",{className:"h-10 w-10 rounded-lg bg-muted/50 flex items-center justify-center",children:e.jsx(ye,{className:"h-5 w-5 text-muted-foreground"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-base leading-tight truncate pr-2",children:w.courses?.title}),e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[e.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[e.jsx(Tt,{className:"h-3.5 w-3.5"}),e.jsx("span",{children:new Date(w.assigned_at).toLocaleDateString("pl-PL")})]}),e.jsx(H,{variant:w.courses?.is_published?"default":"secondary",className:`text-xs ${w.courses?.is_published?"bg-green-100 text-green-700 hover:bg-green-100":""}`,children:w.courses?.is_published?"Opublikowany":"Szkic"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx(Ds,{children:e.jsxs(Ps,{children:[e.jsx(Ms,{asChild:!0,children:e.jsx(I,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>n("courses",w.course_id),children:e.jsx(Zd,{className:"h-4 w-4"})})}),e.jsx(ps,{children:e.jsx("p",{children:"Zobacz kurs"})})]})}),e.jsx(Ds,{children:e.jsxs(Ps,{children:[e.jsx(Ms,{asChild:!0,children:e.jsx(I,{variant:"ghost",size:"icon",className:"h-8 w-8 hover:bg-red-50",onClick:()=>h(w.course_id,w.courses?.title),children:e.jsx(ls,{className:"h-4 w-4 text-red-600"})})}),e.jsx(ps,{children:e.jsx("p",{children:"Odepnij kurs"})})]})})]})]})},w.course_id))}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(ye,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),e.jsx("p",{children:"Brak przypisanych kurs贸w"}),e.jsxs(I,{size:"sm",variant:"outline",className:"mt-4",onClick:()=>i(`/teacher/groups/${r}/assign-courses`),children:[e.jsx(Ie,{className:"w-4 h-4 mr-2"}),"Przypisz pierwszy kurs"]})]})})]})]})]})},K1=()=>{const{id:t}=vt(),s=se(),[n,r]=x.useState([]),[i,a]=x.useState(""),[o,l]=x.useState(!1),{data:c,isLoading:d}=Xe({resource:"groups",id:t}),{data:m,isLoading:u}=Y({resource:"courses",pagination:{mode:"off"},meta:{select:"*, topics(count)"}}),{data:h,isLoading:p}=Y({resource:"course_access",filters:[{field:"group_id",operator:"eq",value:parseInt(t)}],pagination:{mode:"off"},meta:{select:"course_id, group_id"}}),{mutate:b,isLoading:f}=os(),y=async()=>{if(n.length===0){K.error("Wybierz przynajmniej jeden kurs");return}try{const g=n.map(C=>b({resource:"course_access",values:{course_id:C,group_id:parseInt(t)}},{onSuccess:()=>{console.log(`Course ${C} assigned successfully`)},onError:A=>{console.error("Error assigning course:",C,A)}}));await Promise.all(g),K.success(`Przypisano ${n.length} ${n.length===1?"kurs":"kurs贸w"} do grupy`),s(`/groups/show/${t}`)}catch(g){K.error("Bd podczas przypisywania kurs贸w"),console.error("Error details:",g)}};if(d||u||p)return e.jsx(G,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const w=c?.data,j=h?.data?.map(g=>g.course_id)||[];let v=m?.data?.filter(g=>!j.includes(g.id))||[];o&&(v=v.filter(g=>g.is_published));const T=v.filter(g=>g.title.toLowerCase().includes(i.toLowerCase())||g.description?.toLowerCase().includes(i.toLowerCase())),z=g=>{r(C=>C.includes(g)?C.filter(A=>A!==g):[...C,g])},k=()=>{r(T.map(g=>g.id))},N=()=>{r([])},S=v.filter(g=>g.is_published).length,_=v.length-S;return e.jsxs(G,{children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>s(`/teacher/groups/show/${t}`),children:[e.jsx(Ce,{className:"w-4 h-4 mr-2"}),"Powr贸t do grupy"]}),e.jsx(X,{children:e.jsx(_e,{title:"Przypisz kursy",description:`Przypisywanie kurs贸w do grupy: ${w?.name}`})}),e.jsxs(D,{children:[e.jsx($,{children:e.jsxs(X,{children:[e.jsxs("div",{children:[e.jsx(R,{children:"Dostpne kursy"}),v.length>0&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:[S," opublikowanych, ",_," szkic贸w"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>l(!o),className:o?"bg-primary text-primary-foreground":"",children:[e.jsx(Je,{className:"w-4 h-4 mr-2"}),"Tylko opublikowane"]}),e.jsxs(I,{variant:"outline",size:"sm",onClick:k,disabled:T.length===0,children:[e.jsx(Ve,{className:"w-4 h-4 mr-2"}),"Zaznacz wszystkie"]}),e.jsxs(I,{variant:"outline",size:"sm",onClick:N,disabled:n.length===0,children:[e.jsx(dt,{className:"w-4 h-4 mr-2"}),"Odznacz wszystkie"]})]})]})}),e.jsxs(P,{children:[e.jsxs("div",{className:"relative mb-4",children:[e.jsx($i,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(Z,{placeholder:"Szukaj kurs贸w po nazwie lub opisie...",value:i,onChange:g=>a(g.target.value),className:"pl-10"})]}),T.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:v.length===0?e.jsxs(e.Fragment,{children:[e.jsx(ye,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),e.jsx("p",{className:"font-medium mb-1",children:"Wszystkie kursy s ju偶 przypisane"}),e.jsx("p",{className:"text-sm",children:"Ta grupa ma dostp do wszystkich dostpnych kurs贸w"}),e.jsx(I,{size:"sm",variant:"outline",className:"mt-4",onClick:()=>s("/courses"),children:"Przejd藕 do listy kurs贸w"})]}):e.jsxs(e.Fragment,{children:[e.jsx(ye,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),e.jsx("p",{children:"Nie znaleziono kurs贸w speniajcych kryteria"})]})}):e.jsx("div",{className:"space-y-2",children:T.map(g=>{const C=g._count?.topics||0;return e.jsxs("div",{className:`
                      flex items-center space-x-3 p-3 border rounded-lg 
                      cursor-pointer transition-all
                      ${n.includes(g.id)?"border-primary bg-primary/5":"hover:bg-muted/50"}
                    `,onClick:()=>z(g.id),children:[e.jsx(Ct,{checked:n.includes(g.id),onCheckedChange:()=>z(g.id),onClick:A=>A.stopPropagation()}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[g.icon_emoji&&e.jsx("span",{className:"text-xl",children:g.icon_emoji}),e.jsx("span",{className:"font-medium",children:g.title}),e.jsx(H,{variant:g.is_published?"default":"secondary",className:"text-xs",children:g.is_published?"Opublikowany":"Szkic"})]}),g.description&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g.description}),e.jsx("div",{className:"flex items-center gap-4 mt-2 text-xs text-muted-foreground",children:e.jsxs("span",{children:[C," ",C===1?"temat":"temat贸w"]})})]}),e.jsx(Ds,{children:e.jsxs(Ps,{children:[e.jsx(Ms,{asChild:!0,children:e.jsx(I,{size:"sm",variant:"ghost",onClick:A=>{A.stopPropagation(),s(`/courses/show/${g.id}`)},children:e.jsx(Je,{className:"h-4 w-4"})})}),e.jsx(ps,{children:e.jsx("p",{children:"Zobacz kurs"})})]})})]},g.id)})}),n.length>0&&e.jsxs("div",{className:"mt-6 p-4 bg-muted rounded-lg",children:[e.jsxs("p",{className:"text-sm text-muted-foreground mb-3",children:["Wybrano ",n.length," kurs贸w do przypisania"]}),e.jsxs(X,{children:[e.jsx(I,{variant:"outline",onClick:()=>s(`/teacher/groups/show/${t}`),children:"Anuluj"}),e.jsx(I,{onClick:y,disabled:f,children:f?"Przypisywanie...":"Przypisz kursy"})]})]})]})]})]})},G1=()=>{const{id:t}=vt(),s=se(),[n,r]=x.useState([]),[i,a]=x.useState(""),{data:o,isLoading:l}=Xe({resource:"groups",id:t}),{data:c,isLoading:d}=Y({resource:"users",filters:[{field:"role",operator:"eq",value:"student"}],pagination:{mode:"off"}}),{data:m,isLoading:u}=Y({resource:"group_members",filters:[{field:"group_id",operator:"eq",value:parseInt(t)}],pagination:{mode:"off"},meta:{select:"user_id, group_id"}}),{mutate:h,isLoading:p}=os(),b=async()=>{if(n.length===0){K.error("Wybierz przynajmniej jednego ucznia");return}try{const k=n.map(N=>h({resource:"group_members",values:{user_id:N,group_id:parseInt(t)}},{onSuccess:()=>{console.log(`Student ${N} assigned successfully`)},onError:S=>{console.error("Error assigning student:",N,S)}}));await Promise.all(k),K.success(`Dodano ${n.length} uczni贸w do grupy`),s(`/groups/show/${t}`)}catch(k){K.error("Bd podczas dodawania uczni贸w"),console.error("Error details:",k)}};if(l||d||u)return e.jsx(G,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const f=o?.data,y=m?.data?.map(k=>k.user_id)||[],w=c?.data?.filter(k=>!y.includes(k.id))||[],j=w.filter(k=>k.full_name.toLowerCase().includes(i.toLowerCase())||k.email.toLowerCase().includes(i.toLowerCase())),v=k=>{r(N=>N.includes(k)?N.filter(S=>S!==k):[...N,k])},T=()=>{r(j.map(k=>k.id))},z=()=>{r([])};return e.jsxs(G,{children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>s(`/teacher/groups/show/${t}`),children:[e.jsx(Ce,{className:"w-4 h-4 mr-2"}),"Powr贸t do grupy"]}),e.jsx(X,{children:e.jsx(_e,{title:"Dodaj uczni贸w",description:`Dodawanie uczni贸w do grupy: ${f?.name}`})}),e.jsxs(D,{children:[e.jsx($,{children:e.jsxs(X,{children:[e.jsx(R,{children:"Dostpni uczniowie"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:T,disabled:j.length===0,children:[e.jsx(Ve,{className:"w-4 h-4 mr-2"}),"Zaznacz wszystkich"]}),e.jsxs(I,{variant:"outline",size:"sm",onClick:z,disabled:n.length===0,children:[e.jsx(dt,{className:"w-4 h-4 mr-2"}),"Odznacz wszystkich"]})]})]})}),e.jsxs(P,{children:[e.jsx(Z,{placeholder:"Szukaj uczni贸w...",value:i,onChange:k=>a(k.target.value),className:"mb-4"}),j.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:w.length===0?e.jsxs(e.Fragment,{children:[e.jsx(Ls,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),e.jsx("p",{children:"Wszyscy uczniowie s ju偶 w tej grupie"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ls,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),e.jsx("p",{children:"Nie znaleziono uczni贸w"})]})}):e.jsx("div",{className:"space-y-2",children:j.map(k=>e.jsxs("div",{className:"flex items-center space-x-3 p-3 border rounded-lg hover:bg-muted/50 cursor-pointer",onClick:()=>v(k.id),children:[e.jsx(Ct,{checked:n.includes(k.id),onCheckedChange:()=>v(k.id),onClick:N=>N.stopPropagation()}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:k.full_name}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(io,{className:"w-3 h-3"}),k.email]})]}),e.jsx(H,{variant:"secondary",className:"text-xs",children:"Ucze"})]},k.id))}),n.length>0&&e.jsxs("div",{className:"mt-6 p-4 bg-muted rounded-lg",children:[e.jsxs("p",{className:"text-sm text-muted-foreground mb-3",children:["Wybrano ",n.length," uczni贸w do dodania"]}),e.jsxs(X,{children:[e.jsx(I,{variant:"outline",onClick:()=>s(`/teacher/groups/show/${t}`),children:"Anuluj"}),e.jsx(I,{onClick:b,disabled:p,children:p?"Dodawanie...":"Dodaj uczni贸w"})]})]})]})]})]})},Pu={name:"groups",list:"/teacher/groups",create:"/teacher/groups/create",edit:"/teacher/groups/edit/:id",show:"/teacher/groups/show/:id",meta:{label:"Grupy",icon:e.jsx(pe,{className:"h-4 w-4"})}},Q1=[e.jsx(W,{path:"groups",element:e.jsx(U1,{})},"groups-list"),e.jsx(W,{path:"groups/create",element:e.jsx(B1,{})},"groups-create"),e.jsx(W,{path:"groups/edit/:id",element:e.jsx(V1,{})},"groups-edit"),e.jsx(W,{path:"groups/show/:id",element:e.jsx(W1,{})},"groups-show"),e.jsx(W,{path:"groups/:id/assign-courses",element:e.jsx(K1,{})},"groups-assign-courses"),e.jsx(W,{path:"groups/:id/assign-students",element:e.jsx(G1,{})},"groups-assign-students")],H1=()=>{const{show:t}=ut(),{data:s}=We(),[n,r]=x.useState(""),[i,a]=x.useState("all"),[o,l]=x.useState([]),[c,d]=x.useState([]),[m,u]=x.useState(!0);x.useEffect(()=>{(async()=>{if(s?.id){u(!0);try{const{data:f,error:y}=await J.from("course_access").select("course_id").eq("teacher_id",s.id);if(y)throw y;if(!f||f.length===0){l([]),d([]),u(!1);return}const w=[...new Set(f.map(C=>C.course_id))],{data:j,error:v}=await J.from("course_access").select("group_id").in("course_id",w).not("group_id","is",null);if(v)throw v;const T=[...new Set(j?.map(C=>C.group_id).filter(Boolean)||[])];if(T.length===0){l([]),d([]),u(!1);return}const{data:z,error:k}=await J.from("groups").select("*").in("id",T).order("name");if(k)throw k;const N=z?.map(C=>({id:C.id,name:C.name,academic_year:C.academic_year,vendor_id:C.vendor_id||0,is_active:C.is_active??!0,created_at:C.created_at||new Date().toISOString()}))||[];l(N);const{data:S,error:_}=await J.from("users").select(`
            *,
            user_stats(*),
            group_members!inner(
              group_id,
              user_id,
              joined_at,
              groups!inner(*)
            )
          `).in("group_members.group_id",T).eq("role","student").order("full_name");if(_)throw _;const g=S?.map(C=>({id:C.id,email:C.email,full_name:C.full_name,vendor_id:C.vendor_id,role:C.role,is_active:C.is_active,created_at:C.created_at,groups:C.group_members?.map(A=>({group_id:A.group_id,user_id:A.user_id,joined_at:A.joined_at,groups:A.groups}))||[],user_stats:C.user_stats?Array.isArray(C.user_stats)?C.user_stats:[C.user_stats]:[]}))||[];d(g)}catch(f){console.error("Error fetching students:",f),l([]),d([])}finally{u(!1)}}})()},[s]);const h=x.useMemo(()=>c.filter(b=>{const f=!n||b.full_name.toLowerCase().includes(n.toLowerCase())||b.email.toLowerCase().includes(n.toLowerCase()),y=i==="all"||b.groups?.some(w=>w.groups?.id.toString()===i);return f&&y}),[c,n,i]),p=b=>{if(!b)return{color:"text-gray-500",text:"Brak aktywnoci"};const f=Math.floor((new Date().getTime()-new Date(b).getTime())/(1e3*60*60*24));return f===0?{color:"text-green-600",text:"Dzisiaj"}:f===1?{color:"text-green-600",text:"Wczoraj"}:f<=7?{color:"text-yellow-600",text:`${f} dni temu`}:f<=30?{color:"text-orange-600",text:`${Math.floor(f/7)} tyg. temu`}:{color:"text-red-600",text:"Ponad miesic temu"}};return m?e.jsx(G,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})}):e.jsxs(G,{children:[e.jsx(X,{children:e.jsx(_e,{title:"Uczniowie z moich kurs贸w",description:`Uczniowie z grup kt贸re maj dostp do Twoich kurs贸w (${o.length} ${o.length===1?"grupa":o.length<5?"grupy":"grup"})`})}),e.jsxs(X,{className:"gap-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-sm",children:[e.jsx($i,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(Z,{placeholder:"Szukaj ucznia...",className:"pl-10",value:n,onChange:b=>r(b.target.value)})]}),o.length>0&&e.jsxs(fe,{value:i,onValueChange:a,children:[e.jsx(me,{className:"w-[200px]",children:e.jsx(xe,{placeholder:"Filtruj po grupie"})}),e.jsxs(he,{children:[e.jsx(V,{value:"all",children:"Wszystkie grupy"}),o.map(b=>e.jsxs(V,{value:b.id.toString(),children:[b.name," (",b.academic_year,")"]},b.id))]})]})]}),o.length===0?e.jsx(D,{children:e.jsxs(P,{className:"p-12 text-center",children:[e.jsx(yt,{className:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"Nie masz przypisanych kurs贸w"}),e.jsx("p",{className:"text-muted-foreground",children:'Popro administratora o przypisanie Ci do kurs贸w. Administrator mo偶e to zrobi w module "Zarzdzanie dostpem"  "Dostp do kurs贸w"'})]})}):h.length===0&&c.length===0?e.jsx(D,{children:e.jsxs(P,{className:"p-12 text-center",children:[e.jsx(pe,{className:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"Brak uczni贸w w grupach z Twoimi kursami"}),e.jsx("p",{className:"text-muted-foreground",children:"Uczniowie pojawi si tutaj, gdy administrator przypisze grupy do Twoich kurs贸w"})]})}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:[h.map(b=>{const f=b.user_stats?.[0],y=p(f?.last_active);return e.jsx(D,{className:"hover:shadow-md transition-shadow",children:e.jsxs(P,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(pb,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-sm",children:b.full_name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:b.email})]})]}),e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>t("users",b.id),children:e.jsx(Je,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-muted-foreground flex items-center gap-1",children:[e.jsx(pe,{className:"w-3 h-3"}),"Grupa"]}),e.jsxs("div",{className:"flex gap-1 flex-wrap justify-end",children:[b.groups?.slice(0,2).map(w=>e.jsx(H,{variant:"outline",className:"text-xs",children:w.groups?.name},w.groups?.id)),b.groups?.length>2&&e.jsxs(H,{variant:"outline",className:"text-xs",children:["+",b.groups.length-2]})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-muted-foreground flex items-center gap-1",children:[e.jsx($e,{className:"w-3 h-3"}),"Punkty"]}),e.jsxs("span",{className:"font-medium",children:[f?.total_points||0,e.jsxs("span",{className:"text-xs text-muted-foreground ml-1",children:["(poz. ",f?.current_level||1,")"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-muted-foreground flex items-center gap-1",children:[e.jsx(tn,{className:"w-3 h-3"}),"Quizy"]}),e.jsx("span",{className:"font-medium",children:f?.quizzes_completed||0})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-muted-foreground flex items-center gap-1",children:[e.jsx(Te,{className:"w-3 h-3"}),"Aktywno"]}),e.jsx("span",{className:`font-medium ${y.color}`,children:y.text})]}),f&&f.daily_streak>0&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-muted-foreground flex items-center gap-1",children:[e.jsx(xt,{className:"w-3 h-3"}),"Seria dni"]}),e.jsxs("span",{className:"font-medium text-orange-600",children:[" ",f.daily_streak]})]})]}),y.color==="text-red-600"&&e.jsx("div",{className:"mt-3 pt-3 border-t",children:e.jsxs("div",{className:"flex items-center gap-2 text-xs text-orange-600",children:[e.jsx(yt,{className:"w-3 h-3"}),e.jsx("span",{children:"Ucze mo偶e potrzebowa wsparcia"})]})})]})},b.id)}),h.length===0&&c.length>0&&e.jsx(D,{className:"col-span-full",children:e.jsxs(P,{className:"p-12 text-center",children:[e.jsx(pe,{className:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Nie znaleziono uczni贸w speniajcych kryteria"})]})})]})]})},Z1=()=>{const{list:t}=ut(),{id:s}=vt(),{data:n}=We(),[r,i]=x.useState([]),[a,o]=x.useState([]),[l,c]=x.useState(!0),[d,m]=x.useState(null);if(x.useEffect(()=>{(async()=>{if(s){c(!0);try{const{data:j,error:v}=await J.from("users").select(`
            *,
            user_stats(*),
            group_members(
              group_id,
              user_id,
              joined_at,
              groups(*)
            )
          `).eq("id",s).single();if(v)throw v;if(j){const T={id:j.id,email:j.email,full_name:j.full_name,vendor_id:j.vendor_id,role:j.role,is_active:j.is_active,created_at:j.created_at,groups:j.group_members?.map(z=>({group_id:z.group_id,user_id:z.user_id,joined_at:z.joined_at,groups:z.groups}))||[],user_stats:j.user_stats?Array.isArray(j.user_stats)?j.user_stats:[j.user_stats]:[]};m(T)}}catch(j){console.error("Error fetching student data:",j)}finally{c(!1)}}})()},[s]),x.useEffect(()=>{(async()=>{if(!(!s||!n?.id))try{const{data:j}=await J.from("course_access").select("course_id").eq("teacher_id",n.id);if(!j||j.length===0)return;const v=j.map(k=>k.course_id),{data:T}=await J.from("courses").select(`
            id,
            title,
            topics!inner(
              id,
              title,
              activities!inner(
                id,
                type,
                activity_progress!left(
                  completed_at,
                  score,
                  attempts,
                  time_spent
                )
              )
            )
          `).in("id",v).eq("topics.activities.activity_progress.user_id",s);if(T){const k=T.map(N=>{let S=0,_=0,g=0,C=0,A=0,E=0,M=null;return N.topics?.forEach(O=>{O.activities?.forEach(Q=>{S++;const L=Q.activity_progress?.[0];L?.completed_at&&(_++,(!M||new Date(L.completed_at)>new Date(M))&&(M=L.completed_at)),Q.type==="quiz"&&L?.score!==null&&(g+=L.score,C++,L.score>=70?A++:L.attempts>0&&E++)})}),{course_id:N.id,course_title:N.title,total_activities:S,completed_activities:_,avg_score:C>0?Math.round(g/C):0,quizzes_passed:A,quizzes_failed:E,last_activity:M||""}});i(k)}const{data:z}=await J.from("activity_progress").select(`
            *,
            activities(
              id,
              title,
              type,
              topics(
                title,
                courses(title)
              )
            )
          `).eq("user_id",s).order("completed_at",{ascending:!1,nullsFirst:!1}).limit(10);z&&o(z)}catch(j){console.error("Error fetching student progress:",j)}})()},[s,n]),l)return e.jsx(G,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const u=d,h=u?.user_stats?.[0],p=w=>w>=80?"text-green-600":w>=60?"text-yellow-600":"text-red-600",b=w=>w==="quiz"?"":"",f=w=>{const j=Math.floor(w/60),v=w%60;return j>0?`${j}h ${v}min`:`${v}min`},y=w=>{if(!w)return"text-gray-500";const j=Math.floor((new Date().getTime()-new Date(w).getTime())/(1e3*60*60*24));return j===0?"text-green-600":j<=7?"text-yellow-600":j<=30?"text-orange-600":"text-red-600"};return e.jsxs(G,{children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>t("users"),children:[e.jsx(Ce,{className:"w-4 h-4 mr-2"}),"Powr贸t do listy"]}),e.jsx(X,{children:e.jsxs("div",{children:[e.jsx(_e,{title:u?.full_name||"",description:u?.email||""}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[u?.groups?.map(w=>e.jsxs(H,{variant:"outline",children:[e.jsx(pe,{className:"w-3 h-3 mr-1"}),w.groups?.name," (",w.groups?.academic_year,")"]},w.groups?.id)),!u?.is_active&&e.jsx(H,{variant:"destructive",children:"Nieaktywny"})]})]})}),e.jsxs(wt,{children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(D,{children:[e.jsx($,{children:e.jsxs(R,{className:"flex items-center gap-2",children:[e.jsx(gr,{className:"w-5 h-5"}),"Podsumowanie postp贸w"]})}),e.jsxs(P,{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center p-4 bg-blue-50 dark:bg-blue-950/20 rounded-lg",children:[e.jsx($e,{className:"w-8 h-8 mx-auto mb-2 text-blue-600"}),e.jsx("p",{className:"text-2xl font-bold",children:h?.total_points||0}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Punkty"})]}),e.jsxs("div",{className:"text-center p-4 bg-purple-50 dark:bg-purple-950/20 rounded-lg",children:[e.jsx(Se,{className:"w-8 h-8 mx-auto mb-2 text-purple-600"}),e.jsx("p",{className:"text-2xl font-bold",children:h?.current_level||1}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Poziom"})]}),e.jsxs("div",{className:"text-center p-4 bg-green-50 dark:bg-green-950/20 rounded-lg",children:[e.jsx(Rs,{className:"w-8 h-8 mx-auto mb-2 text-green-600"}),e.jsx("p",{className:"text-2xl font-bold",children:h?.quizzes_completed||0}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Ukoczone quizy"})]}),e.jsxs("div",{className:"text-center p-4 bg-orange-50 dark:bg-orange-950/20 rounded-lg",children:[e.jsx(xt,{className:"w-8 h-8 mx-auto mb-2 text-orange-600"}),e.jsx("p",{className:"text-2xl font-bold",children:h?.daily_streak||0}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Dni z rzdu"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 pt-4 border-t",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Perfekcyjne wyniki"}),e.jsxs("p",{className:"text-lg font-semibold text-green-600",children:[h?.perfect_scores||0,h&&h.quizzes_completed>0&&e.jsxs("span",{className:"text-sm text-muted-foreground ml-1",children:["(",Math.round(h.perfect_scores/h.quizzes_completed*100),"%)"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Czas nauki"}),e.jsx("p",{className:"text-lg font-semibold",children:h?f(h.total_time_spent):"0min"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Punkty/h (idle)"}),e.jsx("p",{className:"text-lg font-semibold",children:h?.idle_points_rate||1})]})]})]})]}),e.jsxs(D,{children:[e.jsx($,{children:e.jsxs(R,{className:"flex items-center gap-2",children:[e.jsx(ye,{className:"w-5 h-5"}),"Postpy w Twoich kursach"]})}),e.jsxs(P,{className:"space-y-4",children:[r.map(w=>{const j=w.total_activities>0?Math.round(w.completed_activities/w.total_activities*100):0;return e.jsxs("div",{className:"p-4 border rounded-lg space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-semibold",children:w.course_title}),e.jsxs(H,{variant:j===100?"default":"outline",children:[j,"% ukoczone"]})]}),e.jsx(Qt,{value:j,className:"h-2"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Ukoczone"}),e.jsxs("p",{className:"font-medium",children:[w.completed_activities,"/",w.total_activities," aktywnoci"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"redni wynik"}),e.jsx("p",{className:`font-medium ${w.avg_score>0?p(w.avg_score):""}`,children:w.avg_score>0?`${w.avg_score}%`:"Brak"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Quizy"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-green-600 flex items-center",children:[e.jsx(Re,{className:"w-3 h-3 mr-1"}),w.quizzes_passed]}),e.jsxs("span",{className:"text-red-600 flex items-center",children:[e.jsx(Tl,{className:"w-3 h-3 mr-1"}),w.quizzes_failed]})]})]})]}),w.last_activity&&e.jsx("div",{className:"pt-2 border-t",children:e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Ostatnia aktywno: ",new Date(w.last_activity).toLocaleDateString("pl-PL")]})})]},w.course_id)}),r.length===0&&e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"Ucze nie rozpocz jeszcze 偶adnego z Twoich kurs贸w"})]})]}),e.jsxs(D,{children:[e.jsx($,{children:e.jsxs(R,{className:"flex items-center gap-2",children:[e.jsx(qi,{className:"w-5 h-5"}),"Ostatnie aktywnoci"]})}),e.jsx(P,{children:e.jsxs("div",{className:"space-y-3",children:[a.map(w=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:w.activities&&b(w.activities.type)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:w.activities?.title}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[w.activities?.topics?.courses?.title,"  ",w.activities?.topics?.title]})]})]}),e.jsxs("div",{className:"text-right",children:[w.score!==null&&e.jsxs("p",{className:`font-medium ${p(w.score)}`,children:[w.score,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:w.completed_at?new Date(w.completed_at).toLocaleDateString("pl-PL"):new Date(w.started_at).toLocaleDateString("pl-PL")}),w.attempts>1&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Pr贸ba ",w.attempts]})]})]},`${w.user_id}-${w.activity_id}`)),a.length===0&&e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"Brak aktywnoci do wywietlenia"})]})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(D,{children:[e.jsx($,{children:e.jsxs(R,{className:"text-lg flex items-center gap-2",children:[e.jsx(Te,{className:"w-4 h-4"}),"Czas nauki"]})}),e.jsxs(P,{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"czny czas"}),e.jsx("p",{className:"text-xl font-bold",children:h?f(h.total_time_spent):"0min"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Ostatnia aktywno"}),e.jsx("p",{className:`text-sm font-medium ${y(h?.last_active)}`,children:h?.last_active?new Date(h.last_active).toLocaleDateString("pl-PL",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):"Brak aktywnoci"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Ostatnie pobieranie idle"}),e.jsx("p",{className:"text-sm font-medium",children:h?.last_idle_claim?new Date(h.last_idle_claim).toLocaleString("pl-PL",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Nigdy"})]})]})]}),e.jsxs(D,{children:[e.jsx($,{children:e.jsxs(R,{className:"text-lg flex items-center gap-2",children:[e.jsx(Rs,{className:"w-4 h-4"}),"Statystyki quiz贸w"]})}),e.jsxs(P,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Ukoczone"}),e.jsx("span",{className:"font-bold",children:h?.quizzes_completed||0})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Wyniki 100%"}),e.jsx("span",{className:"font-bold text-green-600",children:h?.perfect_scores||0})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Wsp贸czynnik"}),e.jsx("span",{className:"font-bold",children:h&&h.quizzes_completed>0?`${Math.round(h.perfect_scores/h.quizzes_completed*100)}%`:"0%"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"redni czas/quiz"}),e.jsx("span",{className:"font-bold",children:h&&h.quizzes_completed>0?f(Math.round(h.total_time_spent/h.quizzes_completed)):"0min"})]})]})]}),e.jsxs(D,{children:[e.jsx($,{children:e.jsxs(R,{className:"text-lg flex items-center gap-2",children:[e.jsx(Tt,{className:"w-4 h-4"}),"Informacje"]})}),e.jsxs(P,{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Doczy"}),e.jsx("p",{className:"text-sm font-medium",children:u?.created_at&&new Date(u.created_at).toLocaleDateString("pl-PL",{year:"numeric",month:"long",day:"numeric"})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Dni od rejestracji"}),e.jsxs("p",{className:"text-sm font-medium",children:[u?.created_at&&Math.floor((new Date().getTime()-new Date(u.created_at).getTime())/(1e3*60*60*24))," dni"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Status konta"}),e.jsx("p",{className:"text-sm font-medium",children:u?.is_active?e.jsx("span",{className:"text-green-600",children:" Aktywny"}):e.jsx("span",{className:"text-red-600",children:" Nieaktywny"})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Grupy"}),e.jsx("div",{className:"text-sm font-medium",children:u?.groups?.map(w=>e.jsxs("div",{children:[w.groups?.name," (",w.groups?.academic_year,")"]},w.groups?.id))})]})]})]})]})]})]})},Y1={name:"users",list:"/teacher/users",show:"/teacher/users/show/:id",meta:{label:"Uczniowie",icon:e.jsx(pe,{className:"h-4 w-4"})}},J1=[e.jsx(W,{path:"users",element:e.jsx(H1,{})},"users-list"),e.jsx(W,{path:"users/show/:id",element:e.jsx(Z1,{})},"users-show")],X1=t=>{const s=new Date(t);return new Date(Date.UTC(s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate())).toISOString().slice(0,10)},eS=()=>{const t=se(),s={queryOptions:{staleTime:1/0,gcTime:1800*1e3,refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,refetchInterval:!1,retry:0}},{data:n}=Y({resource:"user_stats",filters:[{field:"last_active",operator:"gte",value:new Date(Date.now()-10080*60*1e3).toISOString().split("T")[0]}],pagination:{mode:"off"},...s}),{data:r}=Y({resource:"activity_progress",pagination:{mode:"off"},meta:{select:"*, activities(type, passing_score)",query:m=>m.not("completed_at","is",null)},...s}),{data:i}=Y({resource:"user_stats",pagination:{mode:"off"},sorters:[{field:"total_points",order:"desc"}],...s}),a=x.useMemo(()=>{const m=n?.data?.length||0,u=r?.data?.filter(w=>w.activities?.type==="quiz"&&w.score!==null).map(w=>Number(w.score))||[],h=u.length>0?Math.round(u.reduce((w,j)=>w+j,0)/u.length):0,p=r?.data?.length||0,b=r?.data?.filter(w=>w.completed_at).length||0,f=p>0?Math.round(b/p*100):0,y=i?.data?.reduce((w,j)=>w+Number(j.total_points),0)||0;return{activeUsers:m,activeUsersChange:12,avgQuizScore:h,avgQuizScoreChange:3,completionRate:f,completionRateChange:5,totalPoints:y,totalPointsChange:8}},[n?.data,r?.data,i?.data]),o=x.useMemo(()=>{const m=Array.from({length:7},(h,p)=>{const b=new Date;return b.setUTCDate(b.getUTCDate()-(6-p)),b.toISOString().slice(0,10)}),u=new Map;for(const h of m)u.set(h,{quizzes:0,materials:0});for(const h of r?.data||[]){if(!h?.started_at)continue;const p=X1(h.started_at);if(!u.has(p))continue;const b=u.get(p);h.activities?.type==="quiz"?b.quizzes+=1:h.activities?.type==="material"&&(b.materials+=1)}return m.map(h=>({date:new Date(h+"T00:00:00Z").toLocaleDateString("pl-PL",{weekday:"short",day:"numeric"}),quizzes:u.get(h).quizzes,materials:u.get(h).materials}))},[r?.data]),l=[{title:"Aktywni u偶ytkownicy",value:a.activeUsers,change:a.activeUsersChange,icon:pe,color:"text-blue-600",bgColor:"bg-blue-50",link:"/teacher/reports/engagement"},{title:"redni wynik quiz贸w",value:`${a.avgQuizScore}%`,change:a.avgQuizScoreChange,icon:Se,color:"text-green-600",bgColor:"bg-green-50",link:"/teacher/reports/performance"},{title:"Wska藕nik ukocze",value:`${a.completionRate}%`,change:a.completionRateChange,icon:xt,color:"text-purple-600",bgColor:"bg-purple-50",link:"/teacher/reports/progress"},{title:"Suma punkt贸w",value:a.totalPoints.toLocaleString("pl-PL"),change:a.totalPointsChange,icon:$e,color:"text-orange-600",bgColor:"bg-orange-50",link:"/teacher/reports/gamification"}],c=[{to:"/teacher/reports/engagement",title:"Raport zaanga偶owania",description:"Aktywno u偶ytkownik贸w, czas nauki, trendy",icon:e.jsx(qi,{className:"h-5 w-5"}),color:"text-blue-600"},{to:"/teacher/reports/progress",title:"Raport postp贸w",description:"Postp kurs贸w, wska藕niki ukocze",icon:e.jsx(xt,{className:"h-5 w-5"}),color:"text-purple-600"},{to:"/teacher/reports/performance",title:"Raport wynik贸w",description:"Wyniki quiz贸w, najtrudniejsze pytania",icon:e.jsx(Se,{className:"h-5 w-5"}),color:"text-green-600"},{to:"/teacher/reports/gamification",title:"Raport gamifikacji",description:"Ranking punktowy, poziomy, osignicia",icon:e.jsx($e,{className:"h-5 w-5"}),color:"text-orange-600"}],d=i?.data?.slice(0,5)||[];return e.jsxs(G,{children:[e.jsx(X,{children:e.jsx(_e,{title:"Centrum Raport贸w",description:"Kompleksowy przegld wynik贸w i postp贸w uczni贸w"})}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4 mb-6",children:l.map((m,u)=>e.jsxs(D,{className:"cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>t(m.link),children:[e.jsxs($,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(R,{className:"text-sm font-medium",children:m.title}),e.jsx("div",{className:`${m.bgColor} p-2 rounded-lg`,children:e.jsx(m.icon,{className:`h-4 w-4 ${m.color}`})})]}),e.jsxs(P,{children:[e.jsx("div",{className:"text-2xl font-bold",children:m.value}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[e.jsxs("span",{className:m.change>0?"text-green-600":"text-red-600",children:[m.change>0?"+":"",m.change,"%"]})," ","vs. ostatnie 7 dni"]})]})]},u))}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-3 mb-6",children:[e.jsxs(D,{className:"lg:col-span-2",children:[e.jsx($,{children:e.jsxs(R,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Aktywno w ostatnich 7 dniach"}),e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>t("/teacher/reports/engagement"),children:"Zobacz wicej "})]})}),e.jsx(P,{children:e.jsx("div",{style:{width:"100%",height:250},children:e.jsx(Fe,{width:"100%",height:"100%",children:e.jsxs(mo,{data:o,children:[e.jsx(Rt,{strokeDasharray:"3 3"}),e.jsx(St,{dataKey:"date"}),e.jsx(gt,{allowDecimals:!1}),e.jsx(Be,{}),e.jsx(sn,{type:"monotone",dataKey:"materials",stackId:"1",stroke:"#82ca9d",fill:"#82ca9d",name:"Materiay",isAnimationActive:!1,dot:!0}),e.jsx(sn,{type:"monotone",dataKey:"quizzes",stackId:"1",stroke:"#8884d8",fill:"#8884d8",name:"Quizy",isAnimationActive:!1,dot:!0})]},`${o.map(m=>m.quizzes+m.materials).join("-")}`)})})})]}),e.jsxs(D,{children:[e.jsx($,{children:e.jsxs(R,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Top 5 uczni贸w"}),e.jsx($e,{className:"h-4 w-4 text-orange-600"})]})}),e.jsx(P,{children:e.jsx("div",{className:"space-y-3",children:d.map((m,u)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold
                      ${u===0?"bg-yellow-100 text-yellow-700":u===1?"bg-gray-100 text-gray-700":u===2?"bg-orange-100 text-orange-700":"bg-muted text-muted-foreground"}`,children:u+1}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium",children:["Ucze #",u+1]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Poziom ",m.current_level]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-bold",children:m.total_points}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"punkt贸w"})]})]},m.user_id))})})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Szczeg贸owe raporty"}),e.jsx(wt,{variant:"2-2-4",children:c.map(m=>e.jsxs(D,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>t(m.to),children:[e.jsx($,{children:e.jsxs(R,{className:"flex items-center gap-2 text-base",children:[e.jsx("span",{className:m.color,children:m.icon}),m.title]})}),e.jsx(P,{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:m.description})})]},m.to))})]}),e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{children:"Ostatnie aktywnoci"})}),e.jsx(P,{children:e.jsx("div",{className:"space-y-2",children:r?.data?.slice(0,10).map(m=>e.jsxs("div",{className:"flex items-center justify-between py-2 border-b last:border-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(H,{variant:m.activities?.type==="quiz"?"default":"secondary",children:m.activities?.type==="quiz"?"Quiz":"Materia"}),e.jsxs("span",{className:"text-sm",children:["Aktywno #",m.activity_id]})]}),e.jsxs("div",{className:"text-right",children:[m.score!==null&&e.jsxs("span",{className:"text-sm font-medium",children:[m.score,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(m.started_at).toLocaleDateString("pl-PL")})]})]},`${m.user_id}-${m.activity_id}`))})})]})]})},tS=()=>{const[t,s]=x.useState("7d"),[n,r]=x.useState("all"),i=Qy()(),[a,o]=x.useState(!0),[l,c]=x.useState([]),[d,m]=x.useState([]),[u,h]=x.useState([]),[p,b]=x.useState([]),f=()=>{const g=new Date,C=new Date;switch(t){case"7d":C.setDate(C.getDate()-7);break;case"30d":C.setDate(C.getDate()-30);break;case"90d":C.setDate(C.getDate()-90);break}return{start:C,end:g}},{start:y,end:w}=f();x.useEffect(()=>{(async()=>{try{o(!0);const[C,A,E,M]=await Promise.all([i.getList({resource:"activity_progress",filters:[{field:"started_at",operator:"gte",value:y.toISOString()}],pagination:{mode:"off"}}),i.getList({resource:"activities",pagination:{mode:"off"},meta:{select:"id, type, topic_id"}}),i.getList({resource:"topics",pagination:{mode:"off"},meta:{select:"id, course_id"}}),i.getList({resource:"courses",filters:[{field:"is_published",operator:"eq",value:!0}],pagination:{mode:"off"}})]);c(C.data),m(A.data),h(E.data),b(M.data)}catch(C){console.error("Error fetching data:",C)}finally{o(!1)}})()},[]);const j=x.useMemo(()=>{if(!l.length||!d.length||!u.length)return[];const g=new Map(d.map(M=>[M.id,{type:M.type,topicId:M.topic_id}])),C=new Map(u.map(M=>[M.id,M.course_id])),A=l.map(M=>{const O=g.get(M.activity_id),Q=O?.topicId?C.get(O.topicId):void 0;return{...M,activityType:O?.type,courseId:Q}});if(n==="all")return A;const E=parseInt(n);return A.filter(M=>M.courseId===E)},[l,d,u,n]),v=x.useMemo(()=>{const g=new Set(j.map(O=>O.user_id)).size,C=j.reduce((O,Q)=>O+(Q.time_spent||0),0),A=g>0?(C/60/g).toFixed(1):"0",E=j.filter(O=>O.completed_at).length,M=j.length>0?Math.round(E/j.length*100):0;return{activeUsers:g,activeUsersChange:12,avgTimeHours:A,avgTimeChange:5,completedActivities:E,completedChange:18,engagementRate:M,engagementChange:3}},[j]),T=x.useMemo(()=>{const g=Math.ceil((w.getTime()-y.getTime())/864e5),C=[];for(let A=0;A<g;A++){const E=new Date(y);E.setDate(E.getDate()+A);const M=E.toISOString().split("T")[0],O=j.filter(L=>L.started_at.startsWith(M)),Q=new Set(O.map(L=>L.user_id)).size;C.push({date:E.toLocaleDateString("pl-PL",{day:"numeric",month:"short"}),users:Q})}return C},[j,y,w]),z=x.useMemo(()=>{const g=j.filter(E=>E.activityType==="quiz").length,C=j.filter(E=>E.activityType==="material").length;return g+C===0?[{name:"Brak danych",value:1,color:"#e5e7eb"}]:[{name:"Quizy",value:g,color:"#8884d8"},{name:"Materiay",value:C,color:"#82ca9d"}].filter(E=>E.value>0)},[j]),k=x.useMemo(()=>{const g=new Map;j.forEach(A=>{const E=g.get(A.user_id)||0;g.set(A.user_id,E+(A.time_spent||0))});const C=[{range:"0-30min",count:0,color:"#94a3b8"},{range:"30-60min",count:0,color:"#60a5fa"},{range:"1-2h",count:0,color:"#818cf8"},{range:"2-5h",count:0,color:"#a78bfa"},{range:"5h+",count:0,color:"#c084fc"}];return g.forEach(A=>{A<=30?C[0].count++:A<=60?C[1].count++:A<=120?C[2].count++:A<=300?C[3].count++:C[4].count++}),C.filter(A=>A.count>0)},[j]),N=x.useMemo(()=>{const g=Math.ceil((w.getTime()-y.getTime())/864e5),C=[];for(let A=0;A<g;A++){const E=new Date(y);E.setDate(E.getDate()+A);const M=E.toISOString().split("T")[0],O=j.filter(F=>F.started_at.startsWith(M)),Q=O.filter(F=>F.completed_at).length,L=O.length,U=L>0?Math.round(Q/L*100):0;C.push({date:E.toLocaleDateString("pl-PL",{day:"numeric",month:"short"}),rate:U,completed:Q,total:L})}return C},[j,y,w]),S=[{label:"Aktywni u偶ytkownicy",value:v.activeUsers.toString(),icon:pe,change:`+${v.activeUsersChange}%`,color:"text-blue-600",bgColor:"bg-blue-50"},{label:"redni czas nauki",value:`${v.avgTimeHours}h`,icon:Te,change:`+${v.avgTimeChange}%`,color:"text-purple-600",bgColor:"bg-purple-50"},{label:"Ukoczone aktywnoci",value:v.completedActivities.toString(),icon:qi,change:`+${v.completedChange}%`,color:"text-green-600",bgColor:"bg-green-50"},{label:"Wska藕nik zaanga偶owania",value:`${v.engagementRate}%`,icon:xt,change:`+${v.engagementChange}%`,color:"text-orange-600",bgColor:"bg-orange-50"}],_=x.useMemo(()=>{if(!p.length||!j.length)return[];const g=new Map;return p.forEach(C=>{const A=typeof C.id=="number"?C.id:parseInt(C.id);isNaN(A)||g.set(A,{title:C.title||"",users:new Set,activities:0,completed:0})}),j.forEach(C=>{const A=C.courseId;if(A&&g.has(A)){const E=g.get(A);E&&(E.users.add(C.user_id),E.activities++,C.completed_at&&E.completed++)}}),Array.from(g.entries()).filter(([C,A])=>A.activities>0).map(([C,A])=>({id:C,title:A.title,users:A.users.size,activities:A.activities,completionRate:A.activities>0?Math.round(A.completed/A.activities*100):0})).sort((C,A)=>A.users-C.users).slice(0,5)},[j,p]);return a?e.jsx(G,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-muted-foreground",children:"adowanie danych..."})})}):e.jsxs(G,{children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Li,{to:"/teacher/reports/overview",children:e.jsxs(I,{variant:"ghost",size:"sm",children:[e.jsx(Ce,{className:"mr-2 h-4 w-4"}),"Powr贸t do centrum raport贸w"]})}),e.jsx("h1",{className:"text-2xl font-bold",children:"Raport zaanga偶owania"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(fe,{value:n,onValueChange:r,children:[e.jsx(me,{className:"w-[200px]",children:e.jsx(xe,{placeholder:"Wybierz kurs"})}),e.jsxs(he,{children:[e.jsx(V,{value:"all",children:"Wszystkie kursy"}),p.map(g=>{const C=typeof g.id=="number"?g.id:parseInt(g.id);return e.jsx(V,{value:C.toString(),children:g.title},C)})]})]}),e.jsxs(fe,{value:t,onValueChange:s,children:[e.jsx(me,{className:"w-[150px]",children:e.jsx(xe,{})}),e.jsxs(he,{children:[e.jsx(V,{value:"7d",children:"Ostatnie 7 dni"}),e.jsx(V,{value:"30d",children:"Ostatnie 30 dni"}),e.jsx(V,{value:"90d",children:"Ostatnie 90 dni"})]})]})]})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4 mb-6",children:S.map((g,C)=>e.jsxs(D,{children:[e.jsxs($,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(R,{className:"text-sm font-medium",children:g.label}),e.jsx("div",{className:`${g.bgColor} p-2 rounded-lg`,children:e.jsx(g.icon,{className:`h-4 w-4 ${g.color}`})})]}),e.jsxs(P,{children:[e.jsx("div",{className:"text-2xl font-bold",children:g.value}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.jsx("span",{className:"text-green-600",children:g.change})," vs. poprzedni okres"]})]})]},C))}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-3 mb-6",children:[e.jsxs(D,{className:"lg:col-span-2",children:[e.jsx($,{children:e.jsx(R,{children:"Aktywni u偶ytkownicy w czasie"})}),e.jsx(P,{children:e.jsx(Fe,{width:"100%",height:300,children:e.jsxs(mo,{data:T,children:[e.jsx(Rt,{strokeDasharray:"3 3"}),e.jsx(St,{dataKey:"date"}),e.jsx(gt,{}),e.jsx(Be,{}),e.jsx(sn,{type:"monotone",dataKey:"users",stroke:"#8884d8",fill:"#8884d8",fillOpacity:.6,name:"Aktywni u偶ytkownicy",isAnimationActive:!1})]},`${T.map(g=>g.users).join("-")}`)})})]}),e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{children:"Typy aktywnoci"})}),e.jsx(P,{children:e.jsx(Fe,{width:"100%",height:300,children:e.jsxs(La,{children:[e.jsx(Oa,{data:z,cx:"50%",cy:"50%",labelLine:!1,label:({name:g,percent:C})=>C!==void 0&&C>0?`${g}: ${(C*100).toFixed(0)}%`:"",outerRadius:80,fill:"#8884d8",dataKey:"value",isAnimationActive:!1,children:z.map((g,C)=>e.jsx(xs,{fill:g.color},`cell-${C}`))}),e.jsx(Be,{})]})})})]})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2 mb-6",children:[e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{children:"Rozkad czasu nauki u偶ytkownik贸w"})}),e.jsx(P,{children:e.jsx(Fe,{width:"100%",height:250,children:e.jsxs(Bi,{data:k,children:[e.jsx(Rt,{strokeDasharray:"3 3"}),e.jsx(St,{dataKey:"range"}),e.jsx(gt,{}),e.jsx(Be,{}),e.jsx(jr,{dataKey:"count",name:"Liczba u偶ytkownik贸w",isAnimationActive:!1,children:k.map((g,C)=>e.jsx(xs,{fill:g.color},`cell-${C}`))})]},`${k.map(g=>g.count).join("-")}`)})})]}),e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{children:"Wska藕nik ukocze w czasie"})}),e.jsx(P,{children:e.jsx(Fe,{width:"100%",height:250,children:e.jsxs(np,{data:N,children:[e.jsx(Rt,{strokeDasharray:"3 3"}),e.jsx(St,{dataKey:"date"}),e.jsx(gt,{}),e.jsx(Be,{content:({active:g,payload:C})=>{if(g&&C&&C.length){const A=C[0].payload;return e.jsxs("div",{className:"bg-white p-2 border rounded shadow-sm",children:[e.jsx("p",{className:"font-medium text-sm",children:A.date}),e.jsxs("p",{className:"text-xs",children:["Wska藕nik: ",A.rate,"%"]}),e.jsxs("p",{className:"text-xs",children:["Ukoczone: ",A.completed,"/",A.total]})]})}return null}}),e.jsx(Nc,{type:"monotone",dataKey:"rate",stroke:"#22c55e",strokeWidth:2,dot:{fill:"#22c55e"},name:"Wska藕nik ukocze %",isAnimationActive:!1})]},`${N.map(g=>g.rate).join("-")}`)})})]})]}),_.length>0&&e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{children:"Zaanga偶owanie wedug kurs贸w"})}),e.jsx(P,{children:e.jsx("div",{className:"space-y-3",children:_.map(g=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:g.title}),e.jsxs("div",{className:"flex gap-4 mt-1 text-sm text-muted-foreground",children:[e.jsxs("span",{children:["U偶ytkownicy: ",g.users]}),e.jsxs("span",{children:["Aktywnoci: ",g.activities]})]})]}),e.jsx("div",{className:"text-right",children:e.jsxs(H,{variant:g.completionRate>=70?"default":"secondary",children:[g.completionRate,"% ukoczonych"]})})]},g.id))})})]}),e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{children:"Kluczowe wnioski"})}),e.jsx(P,{children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Tt,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Trendy"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:v.activeUsers>0?`${v.activeUsers} unikalnych u偶ytkownik贸w aktywnych w wybranym okresie`:"Brak aktywnoci w wybranym okresie"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Wska藕nik ukocze"})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[v.engagementRate,"% rozpocztych aktywnoci zostao ukoczonych"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Je,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"rednie zaanga偶owanie"})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["rednio ",v.avgTimeHours," godzin nauki na u偶ytkownika"]})]})]})})]})]})},sS=()=>{const[t,s]=x.useState("all"),[n,r]=x.useState(null),[i,a]=x.useState("progress"),o={queryOptions:{staleTime:1/0,gcTime:1800*1e3,refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,refetchInterval:!1,retry:0}},{data:l}=Y({resource:"courses",filters:[{field:"is_published",operator:"eq",value:!0}],pagination:{mode:"off"},...o}),{data:c}=Y({resource:"activities",filters:[{field:"is_published",operator:"eq",value:!0}],pagination:{mode:"off"},meta:{select:"id, topic_id, type, topics(id, course_id)"},...o}),{data:d}=Y({resource:"activity_progress",pagination:{mode:"off"},meta:{select:"*, activities(id, topic_id, type, topics(id, course_id))"},...o}),{data:m}=Y({resource:"groups",pagination:{mode:"off"},...o}),{data:u}=Y({resource:"group_members",pagination:{mode:"off"},filters:t!=="all"?[{field:"group_id",operator:"eq",value:parseInt(t)}]:[],...o}),h=x.useMemo(()=>{if(!l?.data||!c?.data||!d?.data)return[];const y=new Map;return l.data.forEach(w=>{const j=typeof w.id=="number"?w.id:parseInt(w.id),T=c.data.filter(M=>M.topics?.course_id===j).length,z=d.data.filter(M=>M.activities?.topics?.course_id===j),k=t!=="all"&&u?.data?z.filter(M=>u.data.some(O=>O.user_id===M.user_id)):z,N=new Set(k.map(M=>M.user_id)),S=new Map,_=new Map;k.forEach(M=>{if(M.completed_at){const O=S.get(M.user_id)||0;S.set(M.user_id,O+1)}if(M.score!==null&&M.score!==void 0){const O=_.get(M.user_id)||[];O.push(Number(M.score)),_.set(M.user_id,O)}});const g=S.size,C=g>0?Array.from(S.values()).reduce((M,O)=>M+O,0)/g:0,A=Array.from(_.values()).flat(),E=A.length>0?Math.round(A.reduce((M,O)=>M+O,0)/A.length):null;y.set(j,{courseId:j,courseTitle:w.title||"",totalActivities:T,completedActivities:Math.round(C),avgScore:E,totalStudents:N.size,activeStudents:g})}),Array.from(y.values()).filter(w=>w.totalActivities>0).sort((w,j)=>{const v=w.totalActivities>0?w.completedActivities/w.totalActivities:0;return(j.totalActivities>0?j.completedActivities/j.totalActivities:0)-v})},[l?.data,c?.data,d?.data,t,u?.data]),p=x.useMemo(()=>{if(!d?.data||!h.length)return[];const y=new Map;h.forEach(j=>{const v=d.data.filter(z=>z.activities?.topics?.course_id===j.courseId);(t!=="all"&&u?.data?v.filter(z=>u.data.some(k=>k.user_id===z.user_id)):v).forEach(z=>{y.has(z.user_id)||y.set(z.user_id,new Map);const k=y.get(z.user_id);k.has(j.courseId)||k.set(j.courseId,{userId:z.user_id,courseId:j.courseId,courseTitle:j.courseTitle,completedActivities:0,totalActivities:j.totalActivities,avgScore:null,lastActivity:null,timeSpent:0});const N=k.get(j.courseId);if(z.completed_at&&N.completedActivities++,z.score!==null&&z.score!==void 0){const S=[];N.avgScore!==null&&S.push(N.avgScore),S.push(Number(z.score)),N.avgScore=Math.round(S.reduce((_,g)=>_+g,0)/S.length)}N.timeSpent+=z.time_spent||0,(!N.lastActivity||new Date(z.started_at)>new Date(N.lastActivity))&&(N.lastActivity=z.started_at)})});const w=[];return y.forEach(j=>{j.forEach(v=>{w.push(v)})}),w.sort((j,v)=>{switch(i){case"progress":{const T=j.totalActivities>0?j.completedActivities/j.totalActivities:0;return(v.totalActivities>0?v.completedActivities/v.totalActivities:0)-T}case"score":return(v.avgScore||0)-(j.avgScore||0);case"activity":return new Date(v.lastActivity||0).getTime()-new Date(j.lastActivity||0).getTime();default:return 0}})},[d?.data,h,t,u?.data,i]),b=x.useMemo(()=>{const y=[{name:"Rozpoczli kurs",value:0,fill:"#8884d8"},{name:"Ukoczyli 25%",value:0,fill:"#83a6ed"},{name:"Ukoczyli 50%",value:0,fill:"#8dd1e1"},{name:"Ukoczyli 75%",value:0,fill:"#82ca9d"},{name:"Ukoczyli 100%",value:0,fill:"#67b26f"}],w=new Map;return p.forEach(j=>{const v=j.totalActivities>0?j.completedActivities/j.totalActivities*100:0,T=w.get(j.userId)||0;w.set(j.userId,Math.max(T,v))}),w.forEach(j=>{j>0&&y[0].value++,j>=25&&y[1].value++,j>=50&&y[2].value++,j>=75&&y[3].value++,j>=100&&y[4].value++}),y},[p]),f=x.useMemo(()=>{const y=new Set(p.map(z=>z.userId)).size,w=new Set(p.filter(z=>z.completedActivities>0).map(z=>z.userId)).size,j=h.length>0?Math.round(h.reduce((z,k)=>z+(k.totalActivities>0?k.completedActivities/k.totalActivities*100:0),0)/h.length):0,v=h.filter(z=>z.avgScore!==null),T=v.length>0?Math.round(v.reduce((z,k)=>z+k.avgScore,0)/v.length):0;return{totalStudents:y,activeStudents:w,avgCompletion:j,avgScore:T}},[p,h]);return e.jsxs(G,{children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Li,{to:"/teacher/reports/overview",children:e.jsxs(I,{variant:"ghost",size:"sm",children:[e.jsx(Ce,{className:"mr-2 h-4 w-4"}),"Powr贸t do centrum raport贸w"]})}),e.jsx("h1",{className:"text-2xl font-bold",children:"Raport postp贸w"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(fe,{value:t,onValueChange:s,children:[e.jsx(me,{className:"w-[200px]",children:e.jsx(xe,{placeholder:"Wybierz grup"})}),e.jsxs(he,{children:[e.jsx(V,{value:"all",children:"Wszystkie grupy"}),m?.data?.map(y=>e.jsx(V,{value:y.id?.toString()||"",children:y.name||"Bez nazwy"},y.id||"unknown"))]})]}),e.jsxs(I,{variant:"outline",size:"sm",children:[e.jsx(ep,{className:"mr-2 h-4 w-4"}),"Eksportuj"]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4 mb-6",children:[e.jsxs(D,{children:[e.jsxs($,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(R,{className:"text-sm font-medium",children:"Wszyscy uczniowie"}),e.jsx(pe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(P,{children:[e.jsx("div",{className:"text-2xl font-bold",children:f.totalStudents}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"w wybranych grupach"})]})]}),e.jsxs(D,{children:[e.jsxs($,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(R,{className:"text-sm font-medium",children:"Aktywni uczniowie"}),e.jsx(xt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(P,{children:[e.jsx("div",{className:"text-2xl font-bold",children:f.activeStudents}),e.jsx("p",{className:"text-xs text-muted-foreground",children:f.totalStudents>0?`${Math.round(f.activeStudents/f.totalStudents*100)}% wszystkich`:"0% wszystkich"})]})]}),e.jsxs(D,{children:[e.jsxs($,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(R,{className:"text-sm font-medium",children:"redni postp"}),e.jsx(ye,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(P,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[f.avgCompletion,"%"]}),e.jsx(Qt,{value:f.avgCompletion,className:"mt-2"})]})]}),e.jsxs(D,{children:[e.jsxs($,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(R,{className:"text-sm font-medium",children:"redni wynik"}),e.jsx(Se,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(P,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[f.avgScore,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"z ukoczonych quiz贸w"})]})]})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2 mb-6",children:[e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{children:"Postp wedug kurs贸w"})}),e.jsx(P,{children:e.jsx(Fe,{width:"100%",height:300,children:e.jsxs(Bi,{data:h,layout:"vertical",children:[e.jsx(Rt,{strokeDasharray:"3 3"}),e.jsx(St,{type:"number",domain:[0,100]}),e.jsx(gt,{dataKey:"courseTitle",type:"category",width:120,tick:{fontSize:12}}),e.jsx(Be,{formatter:y=>`${y}%`,content:({active:y,payload:w})=>{if(y&&w&&w.length){const j=w[0].payload;return e.jsxs("div",{className:"bg-white p-2 border rounded shadow-sm",children:[e.jsx("p",{className:"font-medium text-sm",children:j.courseTitle}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Ukoczono: ",j.completedActivities,"/",j.totalActivities," aktywnoci"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Aktywnych: ",j.activeStudents,"/",j.totalStudents," uczni贸w"]}),j.avgScore!==null&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["redni wynik: ",j.avgScore,"%"]})]})}return null}}),e.jsx(jr,{dataKey:y=>y.totalActivities>0?Math.round(y.completedActivities/y.totalActivities*100):0,fill:"#8884d8",name:"Postp",isAnimationActive:!1})]},`${h.map(y=>y.courseId).join("-")}`)})})]}),e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{children:"Lejek ukocze"})}),e.jsx(P,{children:e.jsx(Fe,{width:"100%",height:300,children:e.jsxs(Tb,{children:[e.jsx(Be,{}),e.jsxs(_b,{dataKey:"value",data:b,isAnimationActive:!1,children:[e.jsx(Ab,{position:"center",fill:"#fff"}),b.map((y,w)=>e.jsx(xs,{fill:y.fill},`cell-${w}`))]})]})})})]})]}),e.jsxs(D,{children:[e.jsx($,{children:e.jsxs(R,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Szczeg贸owe postpy uczni贸w"}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(fe,{value:i,onValueChange:y=>a(y),children:[e.jsx(me,{className:"w-[150px]",children:e.jsx(xe,{})}),e.jsxs(he,{children:[e.jsx(V,{value:"progress",children:"Sortuj wg postpu"}),e.jsx(V,{value:"score",children:"Sortuj wg wyniku"}),e.jsx(V,{value:"activity",children:"Sortuj wg aktywnoci"})]})]})})]})}),e.jsxs(P,{children:[e.jsx("div",{className:"rounded-md border",children:e.jsxs(In,{children:[e.jsx(En,{children:e.jsxs(_t,{children:[e.jsx(de,{children:"Ucze"}),e.jsx(de,{children:"Kurs"}),e.jsx(de,{children:"Postp"}),e.jsx(de,{children:"redni wynik"}),e.jsx(de,{children:"Czas nauki"}),e.jsx(de,{children:"Ostatnia aktywno"})]})}),e.jsx(Ln,{children:p.slice(0,20).map((y,w)=>{const j=y.totalActivities>0?Math.round(y.completedActivities/y.totalActivities*100):0;return e.jsxs(_t,{children:[e.jsxs(ue,{className:"font-medium",children:["Ucze #",w+1]}),e.jsx(ue,{children:y.courseTitle}),e.jsx(ue,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Qt,{value:j,className:"w-[60px]"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[j,"%"]})]})}),e.jsx(ue,{children:y.avgScore!==null?e.jsxs(H,{variant:y.avgScore>=70?"default":"secondary",children:[y.avgScore,"%"]}):e.jsx("span",{className:"text-muted-foreground",children:"-"})}),e.jsxs(ue,{children:[Math.floor(y.timeSpent/60),"h ",y.timeSpent%60,"m"]}),e.jsx(ue,{children:y.lastActivity?new Date(y.lastActivity).toLocaleDateString("pl-PL"):"-"})]},`${y.userId}-${y.courseId}`)})})]})}),p.length>20&&e.jsx("div",{className:"mt-4 text-center",children:e.jsxs(I,{variant:"outline",size:"sm",children:["Zobacz wszystkich (",p.length,")"]})})]})]})]})},hx=["#94a3b8","#60a5fa","#818cf8","#a78bfa","#c084fc","#e879f9","#f472b6","#fb923c","#fbbf24","#fde047"],Mu=t=>{const s=Math.min(Math.floor((t-1)/10),9);return hx[s]},nS=()=>{const[t,s]=x.useState("all"),[n,r]=x.useState("30d"),[i,a]=x.useState(!1),o=()=>{const k=new Date,N=new Date;switch(n){case"7d":N.setDate(N.getDate()-7);break;case"30d":N.setDate(N.getDate()-30);break;case"90d":N.setDate(N.getDate()-90);break}return{start:N,end:k}},{start:l}=o(),c={queryOptions:{staleTime:1/0,gcTime:1800*1e3,refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,refetchInterval:!1,retry:0}},{data:d}=Y({resource:"user_stats",pagination:{mode:"off"},sorters:[{field:"total_points",order:"desc"}],meta:{select:"*, users(full_name, email, role)"},...c}),{data:m}=Y({resource:"groups",pagination:{mode:"off"},...c}),{data:u}=Y({resource:"group_members",filters:t!=="all"?[{field:"group_id",operator:"eq",value:parseInt(t)}]:[],pagination:{mode:"off"},...c}),{data:h}=Y({resource:"activity_progress",filters:[{field:"started_at",operator:"gte",value:l.toISOString()}],pagination:{mode:"off"},meta:{select:"*, activities(type)"},...c}),p=x.useMemo(()=>{let k=d?.data||[];if(k=k.filter(N=>!N.users?.role||N.users.role==="student"),t!=="all"&&u?.data){const N=u.data.map(S=>S.user_id);k=k.filter(S=>N.includes(S.user_id))}if(i){const N=new Date;N.setDate(N.getDate()-7),k=k.filter(S=>new Date(S.last_active)>N)}return k},[d?.data,t,u?.data,i]),b=x.useMemo(()=>{const k=p.length,N=p.reduce((C,A)=>C+A.total_points,0),S=k>0?Math.round(p.reduce((C,A)=>C+A.current_level,0)/k):0,_=p.filter(C=>C.daily_streak>0).length,g=Math.max(...p.map(C=>C.daily_streak),0);return{totalUsers:k,totalPoints:N,avgLevel:S,activeStreaks:_,maxStreak:g}},[p]),f=x.useMemo(()=>{const k=new Map;return p.forEach(N=>{const S=Math.floor((N.current_level-1)/10)*10+1;k.set(S,(k.get(S)||0)+1)}),Array.from(k.entries()).map(([N,S])=>({level:`${N}-${N+9}`,count:S,percentage:p.length>0?Math.round(S/p.length*100):0})).sort((N,S)=>parseInt(N.level)-parseInt(S.level))},[p]),y=x.useMemo(()=>p.slice(0,10),[p]),w=x.useMemo(()=>{if(!h?.data)return[];const k=new Map;return h.data.forEach(N=>{if(N.activities?.type==="quiz"&&N.completed_at){const S=k.get(N.user_id)||0;k.set(N.user_id,S+1)}}),p.map(N=>({points:N.total_points,quizzes:k.get(N.user_id)||0,level:N.current_level,streak:N.daily_streak,timeHours:Math.round((N.total_time_spent||0)/60)}))},[p,h?.data]),j=x.useMemo(()=>{const k=[{range:"0",count:0},{range:"1-3",count:0},{range:"4-7",count:0},{range:"8-14",count:0},{range:"15-30",count:0},{range:"30+",count:0}];return p.forEach(N=>{N.daily_streak===0?k[0].count++:N.daily_streak<=3?k[1].count++:N.daily_streak<=7?k[2].count++:N.daily_streak<=14?k[3].count++:N.daily_streak<=30?k[4].count++:k[5].count++}),k},[p]),v=x.useMemo(()=>{if(!h?.data)return[];const k=new Map,N=[];for(let S=13;S>=0;S--){const _=new Date;_.setDate(_.getDate()-S);const g=_.toISOString().split("T")[0];N.push(g),k.set(g,{points:0,activities:0})}return h.data.forEach(S=>{const _=S.started_at.split("T")[0];if(k.has(_)){const g=k.get(_);g.activities++,S.activities?.type==="material"&&S.completed_at?g.points+=10:S.activities?.type==="quiz"&&S.score!==null&&S.score!==void 0&&(g.points+=Math.round(20+S.score/100*30))}}),N.map(S=>({date:new Date(S+"T00:00:00").toLocaleDateString("pl-PL",{day:"numeric",month:"short"}),points:k.get(S)?.points||0}))},[h?.data]),T=x.useMemo(()=>{if(!h?.data)return[];let k=0,N=0;const S=p.filter(g=>g.daily_streak>0).length*5,_=p.filter(g=>g.current_level>1).length*50;return h.data.forEach(g=>{g.activities?.type==="quiz"&&g.score!==null&&g.score!==void 0?k+=Math.round(20+g.score/100*30):g.activities?.type==="material"&&g.completed_at&&(N+=10)}),[{type:"Ukoczone quizy",points:k,color:"#8884d8"},{type:"Materiay",points:N,color:"#82ca9d"},{type:"Codzienne logowanie",points:S,color:"#ffc658"},{type:"Awans poziom贸w",points:_,color:"#ff8042"}].filter(g=>g.points>0).sort((g,C)=>C.points-g.points)},[h?.data,p]),z=x.useMemo(()=>{if(!h?.data)return[];const k=new Map;return h.data.forEach(N=>{N.activities?.type==="quiz"&&N.completed_at&&k.set(N.user_id,(k.get(N.user_id)||0)+1)}),y.map(N=>({...N,quizzesCompleted:k.get(N.user_id)||0}))},[y,h?.data]);return e.jsxs(G,{children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Li,{to:"/teacher/reports/overview",children:e.jsxs(I,{variant:"ghost",size:"sm",children:[e.jsx(Ce,{className:"mr-2 h-4 w-4"}),"Powr贸t do centrum raport贸w"]})}),e.jsx("h1",{className:"text-2xl font-bold",children:"Raport gamifikacji"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(fe,{value:t,onValueChange:s,children:[e.jsx(me,{className:"w-[200px]",children:e.jsx(xe,{placeholder:"Wybierz grup"})}),e.jsxs(he,{children:[e.jsx(V,{value:"all",children:"Wszystkie grupy"}),m?.data?.map(k=>e.jsx(V,{value:k.id.toString(),children:k.name},k.id))]})]}),e.jsxs(fe,{value:n,onValueChange:r,children:[e.jsx(me,{className:"w-[150px]",children:e.jsx(xe,{})}),e.jsxs(he,{children:[e.jsx(V,{value:"7d",children:"Ostatnie 7 dni"}),e.jsx(V,{value:"30d",children:"Ostatnie 30 dni"}),e.jsx(V,{value:"90d",children:"Ostatnie 90 dni"})]})]}),e.jsx(I,{variant:i?"default":"outline",size:"sm",onClick:()=>a(!i),children:"Tylko aktywni"})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-5 mb-6",children:[e.jsxs(D,{children:[e.jsxs($,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(R,{className:"text-sm font-medium",children:"Uczniowie"}),e.jsx($e,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(P,{children:[e.jsx("div",{className:"text-2xl font-bold",children:b.totalUsers}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"w rankingu"})]})]}),e.jsxs(D,{children:[e.jsxs($,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(R,{className:"text-sm font-medium",children:"czne punkty"}),e.jsx(Sn,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(P,{children:[e.jsx("div",{className:"text-2xl font-bold",children:b.totalPoints.toLocaleString("pl-PL")}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"zdobytych"})]})]}),e.jsxs(D,{children:[e.jsxs($,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(R,{className:"text-sm font-medium",children:"redni poziom"}),e.jsx(tp,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(P,{children:[e.jsx("div",{className:"text-2xl font-bold",children:b.avgLevel}),e.jsx(Qt,{value:b.avgLevel/99*100,className:"mt-2 h-1"})]})]}),e.jsxs(D,{children:[e.jsxs($,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(R,{className:"text-sm font-medium",children:"Aktywne serie"}),e.jsx(fs,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(P,{children:[e.jsx("div",{className:"text-2xl font-bold",children:b.activeStreaks}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"uczni贸w"})]})]}),e.jsxs(D,{children:[e.jsxs($,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(R,{className:"text-sm font-medium",children:"Najdu偶sza seria"}),e.jsx(Ye,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(P,{children:[e.jsx("div",{className:"text-2xl font-bold",children:b.maxStreak}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"dni"})]})]})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-3 mb-6",children:[e.jsxs(D,{className:"lg:col-span-2",children:[e.jsx($,{children:e.jsxs(R,{className:"flex items-center gap-2",children:[e.jsx($e,{className:"h-5 w-5 text-yellow-600"}),"Top 10 uczni贸w"]})}),e.jsx(P,{children:e.jsx("div",{className:"space-y-3",children:z.map((k,N)=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-sm font-bold
                      ${N===0?"bg-yellow-100 text-yellow-700 ring-2 ring-yellow-500":N===1?"bg-gray-100 text-gray-700 ring-2 ring-gray-400":N===2?"bg-orange-100 text-orange-700 ring-2 ring-orange-500":"bg-muted text-muted-foreground"}`,children:N+1}),e.jsx(gi,{children:e.jsx(ji,{className:"text-xs",children:k.users?.full_name?k.users.full_name.split(" ").map(S=>S[0]).join("").toUpperCase():`U${N+1}`})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:k.users?.full_name||`Ucze #${N+1}`}),e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsxs(H,{variant:"outline",className:"text-xs",style:{borderColor:Mu(k.current_level),color:Mu(k.current_level)},children:["Poziom ",k.current_level]}),k.daily_streak>0&&e.jsxs(H,{variant:"secondary",className:"text-xs",children:[e.jsx(fs,{className:"w-3 h-3 mr-1"}),k.daily_streak," dni"]}),k.perfect_scores>0&&e.jsxs(H,{variant:"secondary",className:"text-xs",children:[e.jsx(Sn,{className:"w-3 h-3 mr-1"}),k.perfect_scores," perfect"]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-lg font-bold",children:k.total_points.toLocaleString("pl-PL")}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"punkt贸w"})]})]},k.user_id))})})]}),e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{children:"Rozkad poziom贸w"})}),e.jsx(P,{children:e.jsx(Fe,{width:"100%",height:300,children:e.jsxs(La,{children:[e.jsx(Oa,{data:f,cx:"50%",cy:"50%",labelLine:!1,label:({percentage:k})=>k>0?`${k}%`:"",outerRadius:80,fill:"#8884d8",dataKey:"count",isAnimationActive:!1,children:f.map((k,N)=>e.jsx(xs,{fill:hx[N]},`cell-${N}`))}),e.jsx(Be,{}),e.jsx(lr,{formatter:(k,N)=>N?.payload&&"level"in N.payload?`Poziom ${N.payload.level}`:""})]})})})]})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2 mb-6",children:[e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{children:"Punkty vs Ukoczone quizy"})}),e.jsx(P,{children:e.jsx(Fe,{width:"100%",height:300,children:e.jsxs(rp,{children:[e.jsx(Rt,{strokeDasharray:"3 3"}),e.jsx(St,{dataKey:"quizzes",name:"Ukoczone quizy"}),e.jsx(gt,{dataKey:"points",name:"Punkty"}),e.jsx(ip,{dataKey:"level",range:[50,200]}),e.jsx(Be,{cursor:{strokeDasharray:"3 3"}}),e.jsx(ap,{name:"Uczniowie",data:w,fill:"#8884d8",isAnimationActive:!1})]})})})]}),e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{children:"Rozkad daily streaks"})}),e.jsx(P,{children:e.jsx(Fe,{width:"100%",height:300,children:e.jsxs(Bi,{data:j,children:[e.jsx(Rt,{strokeDasharray:"3 3"}),e.jsx(St,{dataKey:"range"}),e.jsx(gt,{}),e.jsx(Be,{}),e.jsx(jr,{dataKey:"count",fill:"#fbbf24",name:"Liczba uczni贸w",isAnimationActive:!1,children:j.map((k,N)=>e.jsx(xs,{fill:N===0?"#94a3b8":N<=2?"#fbbf24":N<=4?"#f97316":"#ef4444"},`cell-${N}`))})]},`${j.map(k=>k.count).join("-")}`)})})]})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{children:"Zdobywane punkty w czasie"})}),e.jsx(P,{children:e.jsx(Fe,{width:"100%",height:250,children:e.jsxs(np,{data:v,children:[e.jsx(Rt,{strokeDasharray:"3 3"}),e.jsx(St,{dataKey:"date"}),e.jsx(gt,{}),e.jsx(Be,{}),e.jsx(Nc,{type:"monotone",dataKey:"points",stroke:"#8884d8",strokeWidth:2,dot:{fill:"#8884d8"},name:"Punkty",isAnimationActive:!1})]},`${v.map(k=>k.points).join("-")}`)})})]}),e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{children:"殴r贸da punkt贸w"})}),e.jsx(P,{children:e.jsx(Fe,{width:"100%",height:250,children:e.jsxs(La,{children:[e.jsx(Oa,{data:T,cx:"50%",cy:"50%",labelLine:!1,label:({value:k})=>k!==void 0&&k>0?`${k.toLocaleString("pl-PL")}`:"",outerRadius:80,fill:"#8884d8",dataKey:"points",isAnimationActive:!1,children:T.map((k,N)=>e.jsx(xs,{fill:k.color},`cell-${N}`))}),e.jsx(Be,{}),e.jsx(lr,{})]})})})]})]}),e.jsxs(D,{className:"mt-6 bg-gradient-to-r from-purple-50 to-blue-50 dark:from-purple-950/20 dark:to-blue-950/20",children:[e.jsx($,{children:e.jsxs(R,{className:"flex items-center gap-2",children:[e.jsx(Rs,{className:"h-5 w-5 text-purple-600"}),"Kluczowe osignicia"]})}),e.jsx(P,{children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Najaktywniejszy ucze"})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[z[0]?.quizzesCompleted||0," ukoczonych quiz贸w"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xt,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Najwikszy wzrost"})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["+",Math.round(b.totalPoints*.15).toLocaleString("pl-PL")," punkt贸w w tym okresie"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(fs,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Zaanga偶owanie"})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[b.totalUsers>0?Math.round(b.activeStreaks/b.totalUsers*100):0,"% uczni贸w ma aktywn seri"]})]})]})})]})]})},Yr={veryActive:"#22c55e",active:"#3b82f6",moderate:"#f59e0b",lowActivity:"#ef4444",inactive:"#6b7280"},mt={champions:"#8b5cf6",loyalists:"#3b82f6",potentials:"#10b981",newUsers:"#f59e0b",atRisk:"#ef4444",dormant:"#6b7280"},rS=()=>{const[t,s]=x.useState("30d"),[n,r]=x.useState("all"),[i,a]=x.useState("all"),o=x.useMemo(()=>({staleTime:1/0,gcTime:1800*1e3,refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,refetchInterval:1e4,retry:0}),[]),{startISO:l}=x.useMemo(()=>{const g=new Date,C=new Date(g);switch(t){case"7d":C.setDate(C.getDate()-7);break;case"30d":C.setDate(C.getDate()-30);break;case"90d":C.setDate(C.getDate()-90);break}return C.setHours(0,0,0,0),{startISO:C.toISOString(),endISO:g.toISOString()}},[t]),c=x.useMemo(()=>n!=="all"?[{field:"role",operator:"eq",value:n}]:[],[n]),d=x.useMemo(()=>({select:"*, users!user_stats_user_id_fkey(email, full_name)"}),[]),m=x.useMemo(()=>({select:"*, activities(type)"}),[]),u=x.useMemo(()=>[{field:"started_at",operator:"gte",value:l}],[l]),{data:h}=Y({resource:"users",pagination:{mode:"off"},filters:c,queryOptions:o}),{data:p}=Y({resource:"user_stats",pagination:{mode:"off"},meta:d,queryOptions:o}),{data:b}=Y({resource:"activity_progress",filters:u,pagination:{mode:"off"},meta:m,queryOptions:o}),f=x.useMemo(()=>{if(!h?.data||!p?.data||!b?.data)return[];const g=new Map(p.data.map(A=>[A.user_id,A])),C=new Map;return b.data.forEach(A=>{const E=C.get(A.user_id)||[];E.push(A),C.set(A.user_id,E)}),h.data.map(A=>{const E=g.get(A.id),M=C.get(A.id)||[];let O;const Q=E?.last_active?Math.floor((Date.now()-new Date(E.last_active).getTime())/(1e3*60*60*24)):999;E?Q>30?O="dormant":Q>14?O="atRisk":E.total_points<100&&Q<7?O="newUsers":E.total_points>1e3&&E.daily_streak>7?O="champions":E.daily_streak>3?O="loyalists":O="potentials":O="dormant";const L=M.filter(F=>typeof F.score=="number"),U=L.length?Math.round(L.reduce((F,ae)=>F+ae.score,0)/L.length):null;return{...A,stats:E,activities:M,segment:O,daysSinceLastActive:Q,avgScore:U}})},[h?.data,p?.data,b?.data]),y=x.useMemo(()=>i==="all"?f:f.filter(g=>g.segment===i),[f,i]),w=x.useMemo(()=>{const g=y.length,C=y.filter(L=>L.is_active).length,A=y.filter(L=>L.daysSinceLastActive<=7).length,E=y.filter(L=>L.stats),M=E.length?Math.round(E.reduce((L,U)=>L+(U.stats?.current_level||0),0)/E.length):0,O=E.filter(L=>(L.stats?.daily_streak||0)>0).length,Q=E.length?Math.round(E.reduce((L,U)=>L+(U.stats?.total_time_spent||0),0)/E.length/60):0;return{total:g,active:C,activePercent:g>0?Math.round(C/g*100):0,activeLastWeek:A,activeLastWeekPercent:g>0?Math.round(A/g*100):0,avgLevel:M,withStreaks:O,streakPercent:g>0?Math.round(O/g*100):0,avgTimeHours:Q}},[y]),j=x.useMemo(()=>{const g=[{name:"Champions",key:"champions",count:0,color:mt.champions,description:"Wysokie punkty, aktywna seria"},{name:"Lojalici",key:"loyalists",count:0,color:mt.loyalists,description:"Regularna aktywno"},{name:"Potencjalni",key:"potentials",count:0,color:mt.potentials,description:"Niska regularno"},{name:"Nowi",key:"newUsers",count:0,color:mt.newUsers,description:"Niedawno doczyli"},{name:"Zagro偶eni",key:"atRisk",count:0,color:mt.atRisk,description:"Spadek aktywnoci"},{name:"Nieaktywni",key:"dormant",count:0,color:mt.dormant,description:"Brak aktywnoci >30 dni"}],C={};return f.forEach(A=>{C[A.segment]=(C[A.segment]||0)+1}),g.map(A=>({...A,count:C[A.key]||0})).filter(A=>A.count>0)},[f]),v=x.useMemo(()=>{const g=[{name:"Champions",key:"champions",count:0,color:mt.champions,description:"Wysokie punkty, aktywna seria"},{name:"Lojalici",key:"loyalists",count:0,color:mt.loyalists,description:"Regularna aktywno"},{name:"Potencjalni",key:"potentials",count:0,color:mt.potentials,description:"Niska regularno"},{name:"Nowi",key:"newUsers",count:0,color:mt.newUsers,description:"Niedawno doczyli"},{name:"Zagro偶eni",key:"atRisk",count:0,color:mt.atRisk,description:"Spadek aktywnoci"},{name:"Nieaktywni",key:"dormant",count:0,color:mt.dormant,description:"Brak aktywnoci >30 dni"}],C={};return f.forEach(A=>{C[A.segment]=(C[A.segment]||0)+1}),g.map(A=>({...A,count:C[A.key]||0}))},[f]),T=x.useMemo(()=>{const g=[{name:"Bardzo aktywni",range:"Codziennie",count:0,color:Yr.veryActive},{name:"Aktywni",range:"2-6 dni/tydz",count:0,color:Yr.active},{name:"Umiarkowani",range:"1 dzie/tydz",count:0,color:Yr.moderate},{name:"Niska aktywno",range:"<1 dzie/tydz",count:0,color:Yr.lowActivity},{name:"Nieaktywni",range:"Brak",count:0,color:Yr.inactive}];return y.forEach(C=>{!C.stats||C.daysSinceLastActive>30?g[4].count++:C.daysSinceLastActive<=1?g[0].count++:C.daysSinceLastActive<=3?g[1].count++:C.daysSinceLastActive<=7?g[2].count++:g[3].count++}),g},[y]),z=x.useMemo(()=>{const g=new Map;return b?.data?.forEach(A=>{const E=A.started_at.slice(0,10),M=g.get(E)||new Set;M.add(A.user_id),g.set(E,M)}),Array.from(g.keys()).sort().slice(-30).map(A=>({date:new Date(A).toLocaleDateString("pl-PL",{day:"numeric",month:"short"}),activeUsers:g.get(A)?.size||0,newUsers:y.filter(E=>E.created_at?.slice(0,10)===A).length}))},[b?.data,y]),k=x.useMemo(()=>y.filter(g=>g.stats&&(g.stats.total_time_spent||0)>0).map(g=>({timeHours:Math.round((g.stats.total_time_spent||0)/60),points:g.stats.total_points,level:g.stats.current_level,streak:g.stats.daily_streak,segment:g.segment})),[y]),N=x.useMemo(()=>y.filter(g=>g.stats).sort((g,C)=>(C.stats?.total_points||0)-(g.stats?.total_points||0)).slice(0,10),[y]),S=x.useMemo(()=>{const g=new Map,C=4;return y.forEach(A=>{const E=new Date(A.created_at);E.setHours(0,0,0,0),E.setDate(E.getDate()-E.getDay());const M=E.toISOString().slice(0,10);g.has(M)||g.set(M,{total:0,retained:Array(C).fill(0)});const O=g.get(M);O.total++;for(let Q=0;Q<C;Q++){const L=new Date(E);L.setDate(L.getDate()+Q*7);const U=new Date(L);U.setDate(U.getDate()+7),A.activities.some(ae=>{const B=new Date(ae.started_at);return B>=L&&B<U})&&O.retained[Q]++}}),Array.from(g.entries()).map(([A,E])=>({cohort:new Date(A).toLocaleDateString("pl-PL",{day:"numeric",month:"short"}),week0:100,week1:E.total>0?Math.round(E.retained[1]/E.total*100):0,week2:E.total>0?Math.round(E.retained[2]/E.total*100):0,week3:E.total>0?Math.round(E.retained[3]/E.total*100):0,total:E.total})).slice(-4)},[y]),_=[{label:"Wszyscy u偶ytkownicy",value:w.total.toString(),subValue:`${w.activePercent}% aktywnych`,icon:pe,color:"text-blue-600",bgColor:"bg-blue-50"},{label:"Aktywni w ostatnim tygodniu",value:w.activeLastWeek.toString(),subValue:`${w.activeLastWeekPercent}% wszystkich`,icon:fb,color:"text-green-600",bgColor:"bg-green-50"},{label:"redni poziom",value:w.avgLevel.toString(),subValue:`${w.avgTimeHours}h rednio`,icon:Rs,color:"text-purple-600",bgColor:"bg-purple-50"},{label:"Z aktywn seri",value:w.withStreaks.toString(),subValue:`${w.streakPercent}% wszystkich`,icon:Ye,color:"text-orange-600",bgColor:"bg-orange-50"}];return e.jsxs(G,{children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Li,{to:"/teacher/reports/overview",children:e.jsxs(I,{variant:"ghost",size:"sm",children:[e.jsx(Ce,{className:"mr-2 h-4 w-4"}),"Powr贸t do centrum raport贸w"]})}),e.jsx("h1",{className:"text-2xl font-bold",children:"Analiza u偶ytkownik贸w"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(fe,{value:n,onValueChange:r,children:[e.jsx(me,{className:"w-[150px]",children:e.jsx(xe,{})}),e.jsxs(he,{children:[e.jsx(V,{value:"all",children:"Wszystkie role"}),e.jsx(V,{value:"student",children:"Uczniowie"}),e.jsx(V,{value:"teacher",children:"Nauczyciele"}),e.jsx(V,{value:"admin",children:"Administratorzy"})]})]}),e.jsxs(fe,{value:i,onValueChange:a,children:[e.jsx(me,{className:"w-[180px]",children:e.jsx(xe,{})}),e.jsxs(he,{children:[e.jsx(V,{value:"all",children:"Wszystkie segmenty"}),v.map(g=>e.jsxs(V,{value:g.key,children:[g.name," (",g.count,")"]},g.key))]})]}),e.jsxs(fe,{value:t,onValueChange:s,children:[e.jsx(me,{className:"w-[150px]",children:e.jsx(xe,{})}),e.jsxs(he,{children:[e.jsx(V,{value:"7d",children:"Ostatnie 7 dni"}),e.jsx(V,{value:"30d",children:"Ostatnie 30 dni"}),e.jsx(V,{value:"90d",children:"Ostatnie 90 dni"})]})]})]})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4 mb-6",children:_.map((g,C)=>e.jsxs(D,{children:[e.jsxs($,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(R,{className:"text-sm font-medium",children:g.label}),e.jsx("div",{className:`${g.bgColor} p-2 rounded-lg`,children:e.jsx(g.icon,{className:`h-4 w-4 ${g.color}`})})]}),e.jsxs(P,{children:[e.jsx("div",{className:"text-2xl font-bold",children:g.value}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:g.subValue})]})]},C))}),e.jsxs(zc,{defaultValue:"segments",className:"space-y-4",children:[e.jsxs(ho,{className:"grid w-full grid-cols-5",children:[e.jsx(Kt,{value:"segments",children:"Segmentacja"}),e.jsx(Kt,{value:"activity",children:"Aktywno"}),e.jsx(Kt,{value:"performance",children:"Wyniki"}),e.jsx(Kt,{value:"retention",children:"Retencja"}),e.jsx(Kt,{value:"leaderboard",children:"Ranking"})]}),e.jsxs(Gt,{value:"segments",className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{children:"Segmentacja u偶ytkownik贸w"})}),e.jsx(P,{children:j.length===0?e.jsx("div",{className:"text-sm text-muted-foreground p-6 border rounded-lg",children:"Brak danych do wywietlenia dla wybranego zakresu."}):e.jsx(Fe,{width:"100%",height:300,children:e.jsxs(La,{children:[e.jsx(Oa,{data:j,cx:"50%",cy:"50%",outerRadius:100,dataKey:"count",label:({name:g,percent:C})=>C!==void 0?`${g}: ${(C*100).toFixed(0)}%`:g,isAnimationActive:!1,children:j.map((g,C)=>e.jsx(xs,{fill:g.color},`cell-${C}`))}),e.jsx(Be,{})]})})})]}),e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{children:"Charakterystyka segment贸w"})}),e.jsx(P,{children:e.jsx("div",{className:"space-y-3",children:v.map(g=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:g.color}}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:g.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:g.description})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-lg font-bold",children:g.count}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"u偶ytkownik贸w"})]})]},g.key))})})]})]}),e.jsxs(D,{children:[e.jsx($,{children:e.jsxs(R,{className:"flex items-center gap-2",children:[e.jsx(Yd,{className:"h-5 w-5 text-orange-600"}),"Kluczowe obserwacje"]})}),e.jsx(P,{children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[v.find(g=>g.key==="atRisk")?.count?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-orange-600",children:[e.jsx(xb,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:"U偶ytkownicy zagro偶eni"})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[v.find(g=>g.key==="atRisk")?.count," u偶ytkownik贸w wymaga uwagi  rozwa偶 wysanie powiadomie motywacyjnych"]})]}):null,v.find(g=>g.key==="champions")?.count?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-purple-600",children:[e.jsx(Rs,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Champions do wykorzystania"})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[v.find(g=>g.key==="champions")?.count," najaktywniejszych u偶ytkownik贸w  mog by mentorami lub ambasadorami"]})]}):null,v.find(g=>g.key==="newUsers")?.count?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[e.jsx(pe,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Nowi u偶ytkownicy"})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[v.find(g=>g.key==="newUsers")?.count," nowych u偶ytkownik贸w  upewnij si, 偶e maj dobre wsparcie onboardingowe"]})]}):null]})})]})]}),e.jsxs(Gt,{value:"activity",className:"space-y-4",children:[e.jsx("div",{className:"grid gap-6 lg:grid-cols-2",children:e.jsxs(D,{className:"lg:col-span-2",children:[e.jsx($,{children:e.jsx(R,{children:"Wzorzec aktywnoci u偶ytkownik贸w"})}),e.jsx(P,{children:e.jsx(Fe,{width:"100%",height:300,children:e.jsxs(mo,{data:z,children:[e.jsx(Rt,{strokeDasharray:"3 3"}),e.jsx(St,{dataKey:"date"}),e.jsx(gt,{}),e.jsx(Be,{}),e.jsx(lr,{}),e.jsx(sn,{type:"monotone",dataKey:"activeUsers",stackId:"1",stroke:"#3b82f6",fill:"#3b82f6",fillOpacity:.6,name:"Aktywni u偶ytkownicy",isAnimationActive:!1}),e.jsx(sn,{type:"monotone",dataKey:"newUsers",stackId:"1",stroke:"#10b981",fill:"#10b981",fillOpacity:.6,name:"Nowi u偶ytkownicy",isAnimationActive:!1})]})})})]})}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{children:"Poziomy aktywnoci"})}),e.jsx(P,{children:e.jsx(Fe,{width:"100%",height:250,children:e.jsxs(Bi,{data:T,children:[e.jsx(Rt,{strokeDasharray:"3 3"}),e.jsx(St,{dataKey:"name"}),e.jsx(gt,{}),e.jsx(Be,{}),e.jsx(jr,{dataKey:"count",name:"U偶ytkownicy",isAnimationActive:!1,children:T.map((g,C)=>e.jsx(xs,{fill:g.color},`cell-${C}`))})]})})})]}),e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{children:"Metryki zaanga偶owania"})}),e.jsxs(P,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(qi,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:"rednia czstotliwo logowania"})]}),e.jsx(H,{variant:"outline",children:"3.2 dni/tydzie"})]}),e.jsx(Qt,{value:64,className:"h-2"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:"redni czas sesji"})]}),e.jsx(H,{variant:"outline",children:"24 min"})]}),e.jsx(Qt,{value:48,className:"h-2"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ye,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:"Ukoczenia na u偶ytkownika"})]}),e.jsx(H,{variant:"outline",children:"7.8 aktywnoci"})]}),e.jsx(Qt,{value:78,className:"h-2"})]})]})]})]})]}),e.jsxs(Gt,{value:"performance",className:"space-y-4",children:[e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{children:"Punkty vs Czas nauki"})}),e.jsx(P,{children:e.jsx(Fe,{width:"100%",height:400,children:e.jsxs(rp,{children:[e.jsx(Rt,{strokeDasharray:"3 3"}),e.jsx(St,{dataKey:"timeHours",name:"Czas nauki (h)"}),e.jsx(gt,{dataKey:"points",name:"Punkty"}),e.jsx(ip,{dataKey:"level",range:[50,400]}),e.jsx(Be,{cursor:{strokeDasharray:"3 3"}}),e.jsx(lr,{}),e.jsx(ap,{name:"U偶ytkownicy",data:k,fill:"#8884d8",isAnimationActive:!1,children:k.map((g,C)=>e.jsx(xs,{fill:mt[g.segment]||"#8884d8"},`cell-${C}`))})]})})})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{children:"Rozkad wynik贸w"})}),e.jsx(P,{children:e.jsx("div",{className:"space-y-4",children:[{label:"90-100%",count:y.filter(g=>g.avgScore!==null&&g.avgScore>=90).length,color:"#22c55e"},{label:"80-89%",count:y.filter(g=>g.avgScore!==null&&g.avgScore>=80&&g.avgScore<90).length,color:"#84cc16"},{label:"70-79%",count:y.filter(g=>g.avgScore!==null&&g.avgScore>=70&&g.avgScore<80).length,color:"#eab308"},{label:"60-69%",count:y.filter(g=>g.avgScore!==null&&g.avgScore>=60&&g.avgScore<70).length,color:"#f97316"},{label:"<60%",count:y.filter(g=>g.avgScore!==null&&g.avgScore<60).length,color:"#ef4444"}].map(g=>{const C=y.filter(E=>E.avgScore!==null).length,A=C>0?g.count/C*100:0;return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:g.label}),e.jsxs("span",{className:"font-medium",children:[g.count," u偶ytkownik贸w"]})]}),e.jsx("div",{className:"relative h-8 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:"absolute left-0 top-0 h-full transition-all duration-500",style:{width:`${A}%`,backgroundColor:g.color}})})]},g.label)})})})]}),e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{children:"Wska藕niki sukcesu"})}),e.jsx(P,{children:e.jsx(Fe,{width:"100%",height:250,children:e.jsxs(Db,{cx:"50%",cy:"50%",innerRadius:"10%",outerRadius:"90%",data:[{name:"Ukoczenia",value:68,fill:"#8884d8"},{name:"Zdawalno",value:74,fill:"#82ca9d"},{name:"Zaanga偶owanie",value:82,fill:"#ffc658"}],children:[e.jsx(Pb,{dataKey:"value",isAnimationActive:!1}),e.jsx(lr,{}),e.jsx(Be,{})]})})})]})]})]}),e.jsxs(Gt,{value:"retention",className:"space-y-4",children:[e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{children:"Analiza kohortowa retencji"})}),e.jsxs(P,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(In,{children:[e.jsx(En,{children:e.jsxs(_t,{children:[e.jsx(de,{children:"Kohorta"}),e.jsx(de,{className:"text-center",children:"Tydzie 0"}),e.jsx(de,{className:"text-center",children:"Tydzie 1"}),e.jsx(de,{className:"text-center",children:"Tydzie 2"}),e.jsx(de,{className:"text-center",children:"Tydzie 3"}),e.jsx(de,{className:"text-center",children:"Liczba u偶ytkownik贸w"})]})}),e.jsx(Ln,{children:S.map(g=>e.jsxs(_t,{children:[e.jsx(ue,{className:"font-medium",children:g.cohort}),e.jsx(ue,{className:"text-center",children:e.jsxs("div",{className:"inline-flex items-center justify-center w-16 h-8 rounded",style:{backgroundColor:`rgba(34, 197, 94, ${g.week0/100})`},children:[g.week0,"%"]})}),e.jsx(ue,{className:"text-center",children:e.jsxs("div",{className:"inline-flex items-center justify-center w-16 h-8 rounded",style:{backgroundColor:`rgba(34, 197, 94, ${g.week1/100})`},children:[g.week1,"%"]})}),e.jsx(ue,{className:"text-center",children:e.jsxs("div",{className:"inline-flex items-center justify-center w-16 h-8 rounded",style:{backgroundColor:`rgba(34, 197, 94, ${g.week2/100})`},children:[g.week2,"%"]})}),e.jsx(ue,{className:"text-center",children:e.jsxs("div",{className:"inline-flex items-center justify-center w-16 h-8 rounded",style:{backgroundColor:`rgba(34, 197, 94, ${g.week3/100})`},children:[g.week3,"%"]})}),e.jsx(ue,{className:"text-center",children:g.total})]},g.cohort))})]})}),e.jsx("div",{className:"mt-4 p-4 bg-muted rounded-lg",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.jsx("strong",{children:"Interpretacja:"})," Wartoci pokazuj procent u偶ytkownik贸w z danej kohorty, kt贸rzy byli aktywni w kolejnych tygodniach po doczeniu."]})})]})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{children:"Czynniki wpywajce na retencj"})}),e.jsx(P,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Os,{className:"h-5 w-5 text-purple-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:"Ukoczenie pierwszego quizu"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"+42% retencji po 30 dniach"})]})]}),e.jsx(H,{variant:"default",children:"Kluczowy"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Se,{className:"h-5 w-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:"Osignicie 100 punkt贸w"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"+28% retencji po 30 dniach"})]})]}),e.jsx(H,{variant:"secondary",children:"Wa偶ny"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(pe,{className:"h-5 w-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:"Doczenie do grupy"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"+15% retencji po 30 dniach"})]})]}),e.jsx(H,{variant:"outline",children:"Pomocny"})]})]})})]}),e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{children:"Prognoza churn"})}),e.jsx(P,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl font-bold text-orange-600 mb-2",children:v.find(g=>g.key==="atRisk")?.count||0}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"u偶ytkownik贸w zagro偶onych odejciem"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"G贸wne przyczyny:"}),e.jsxs("ul",{className:"text-sm text-muted-foreground space-y-1",children:[e.jsx("li",{children:" Brak aktywnoci powy偶ej 14 dni (78%)"}),e.jsx("li",{children:" Niskie wyniki quiz贸w (45%)"}),e.jsx("li",{children:" Brak postp贸w w kursie (34%)"}),e.jsx("li",{children:" Utrata daily streak (23%)"})]})]}),e.jsxs(I,{className:"w-full",variant:"outline",children:[e.jsx(Yd,{className:"mr-2 h-4 w-4"}),"Wygeneruj kampani reaktywacyjn"]})]})})]})]})]}),e.jsxs(Gt,{value:"leaderboard",className:"space-y-4",children:[e.jsxs(D,{children:[e.jsx($,{children:e.jsxs(R,{className:"flex items-center gap-2",children:[e.jsx($e,{className:"h-5 w-5 text-yellow-600"}),"Top 10 u偶ytkownik贸w"]})}),e.jsx(P,{children:e.jsx("div",{className:"space-y-3",children:N.map((g,C)=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-sm font-bold
                        ${C===0?"bg-yellow-100 text-yellow-700 ring-2 ring-yellow-500":C===1?"bg-gray-100 text-gray-700 ring-2 ring-gray-400":C===2?"bg-orange-100 text-orange-700 ring-2 ring-orange-500":"bg-muted text-muted-foreground"}`,children:C+1}),e.jsx(gi,{children:e.jsx(ji,{className:"text-xs",children:g.full_name?.split(" ").map(A=>A[0]).join("")||g.email.substring(0,2).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:g.full_name||`U偶ytkownik ${C+1}`}),e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsx(H,{variant:"outline",className:"text-xs",style:{borderColor:mt[g.segment]||"#8884d8",color:mt[g.segment]||"#8884d8"},children:v.find(A=>A.key===g.segment)?.name||g.segment}),e.jsxs(H,{variant:"secondary",className:"text-xs",children:["Poziom ",g.stats?.current_level||0]}),g.stats&&g.stats.daily_streak>0&&e.jsxs(H,{variant:"secondary",className:"text-xs",children:[e.jsx(Ye,{className:"w-3 h-3 mr-1"}),g.stats.daily_streak," dni"]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-lg font-bold",children:g.stats?.total_points.toLocaleString("pl-PL")||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"punkt贸w"})]})]},g.id))})})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{className:"text-base",children:"Najbardziej zaanga偶owani"})}),e.jsx(P,{children:e.jsx("div",{className:"space-y-3",children:y.filter(g=>g.stats).sort((g,C)=>(C.stats?.total_time_spent||0)-(g.stats?.total_time_spent||0)).slice(0,5).map((g,C)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:g.full_name||`U偶ytkownik ${C+1}`}),e.jsxs(H,{variant:"outline",children:[Math.round((g.stats?.total_time_spent||0)/60),"h"]})]},g.id))})})]}),e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{className:"text-base",children:"Najlepsze wyniki"})}),e.jsx(P,{children:e.jsx("div",{className:"space-y-3",children:y.filter(g=>g.avgScore!==null).sort((g,C)=>g.avgScore<C.avgScore?1:-1).slice(0,5).map((g,C)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:g.full_name||`U偶ytkownik ${C+1}`}),e.jsxs(H,{variant:g.avgScore>=80?"default":"secondary",children:[g.avgScore,"%"]})]},g.id))})})]}),e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{className:"text-base",children:"Najdu偶sze serie"})}),e.jsx(P,{children:e.jsx("div",{className:"space-y-3",children:y.filter(g=>g.stats).sort((g,C)=>(C.stats?.daily_streak||0)-(g.stats?.daily_streak||0)).slice(0,5).map((g,C)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:g.full_name||`U偶ytkownik ${C+1}`}),e.jsxs(H,{variant:"outline",children:[e.jsx(Ye,{className:"w-3 h-3 mr-1"}),g.stats?.daily_streak," dni"]})]},g.id))})})]})]})]})]})]})},iS=()=>{const[t,s]=x.useState("30d"),[n,r]=x.useState("all"),[i,a]=x.useState("all"),o={queryOptions:{staleTime:1/0,gcTime:1800*1e3,refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,refetchInterval:!1,retry:0}},l=()=>{const N=new Date,S=new Date;switch(t){case"7d":S.setDate(S.getDate()-7);break;case"30d":S.setDate(S.getDate()-30);break;case"90d":S.setDate(S.getDate()-90);break}return{start:S,end:N}},{start:c}=l(),{data:d}=Y({resource:"questions",pagination:{mode:"off"},...o}),{data:m}=Y({resource:"courses",pagination:{mode:"off"},...o}),{data:u}=Y({resource:"topics",filters:n!=="all"?[{field:"course_id",operator:"eq",value:parseInt(n)}]:[],pagination:{mode:"off"},...o}),{data:h}=Y({resource:"activities",filters:[{field:"type",operator:"eq",value:"quiz"},{field:"is_published",operator:"eq",value:!0}],pagination:{mode:"off"},...o}),{data:p}=Y({resource:"activity_progress",filters:[{field:"started_at",operator:"gte",value:c.toISOString()}],pagination:{mode:"off"},meta:{query:N=>N.not("score","is",null)},...o}),b=x.useMemo(()=>{if(!h?.data||!u?.data||!m?.data)return[];const N=new Map(u.data.map(_=>[_.id,_])),S=new Map(m.data.map(_=>[_.id,_]));return h.data.map(_=>{const g=N.get(_.topic_id),C=g?S.get(g.course_id):void 0;return{..._,topicTitle:g?.title||"",courseId:C?.id,courseTitle:C?.title||""}})},[h?.data,u?.data,m?.data]),f=x.useMemo(()=>{let N=b;return n!=="all"&&(N=N.filter(S=>S.courseId===parseInt(n))),i!=="all"&&(N=N.filter(S=>S.topic_id===parseInt(i))),N},[b,n,i]),y=x.useMemo(()=>{if(!p?.data)return[];const N=f.map(S=>S.id);return p.data.filter(S=>N.includes(S.activity_id)&&S.score!==null&&S.score!==void 0)},[p?.data,f]),w=x.useMemo(()=>{const N=new Map;return f.forEach(S=>{const _=y.filter(g=>g.activity_id===S.id);if(_.length>0){const g=_.filter(E=>E.score!==null&&E.score!==void 0).map(E=>E.score);if(g.length===0)return;const C=Math.round(g.reduce((E,M)=>E+M,0)/g.length),A=Math.round(g.filter(E=>E>=(S.passing_score||70)).length/g.length*100);N.set(S.id,{activityId:S.id,activityTitle:S.title,topicTitle:S.topicTitle,courseTitle:S.courseTitle,attempts:_.length,avgScore:C,minScore:Math.min(...g),maxScore:Math.max(...g),passRate:A,passingScore:S.passing_score||70})}}),Array.from(N.values()).sort((S,_)=>S.avgScore-_.avgScore)},[f,y]),j=x.useMemo(()=>{const N=y.length,S=y.filter(M=>M.score!==null&&M.score!==void 0).map(M=>M.score),_=S.length>0?Math.round(S.reduce((M,O)=>M+O,0)/S.length):0,g=y.filter(M=>{if(M.score===null||M.score===void 0)return!1;const Q=f.find(L=>L.id===M.activity_id)?.passing_score||70;return M.score>=Q}).length,C=N>0?Math.round(g/N*100):0;return{totalAttempts:N,avgScore:_,avgScoreChange:3,passRate:C,passRateChange:5,uniqueStudents:new Set(y.map(M=>M.user_id)).size,totalQuizzes:f.length}},[y,f]),v=x.useMemo(()=>{const N=[{range:"0-20%",count:0,color:"#ef4444"},{range:"21-40%",count:0,color:"#f97316"},{range:"41-60%",count:0,color:"#eab308"},{range:"61-80%",count:0,color:"#84cc16"},{range:"81-100%",count:0,color:"#22c55e"}];return y.forEach(S=>{const _=S.score||0;_<=20?N[0].count++:_<=40?N[1].count++:_<=60?N[2].count++:_<=80?N[3].count++:N[4].count++}),N},[y]),T=x.useMemo(()=>{const N=new Map;return y.forEach(S=>{const _=f.find(g=>g.id===S.activity_id);if(_?.topicTitle&&S.score!==null&&S.score!==void 0){const g=N.get(_.topicTitle)||{scores:[],topic:_.topicTitle};g.scores.push(S.score),N.set(_.topicTitle,g)}}),Array.from(N.values()).map(({topic:S,scores:_})=>({topic:S.length>20?S.substring(0,20)+"...":S,avgScore:Math.round(_.reduce((g,C)=>g+C,0)/_.length),attempts:_.length})).slice(0,8)},[y,f]),z=x.useMemo(()=>{const N=new Map;return y.forEach(S=>{const _=new Date(S.started_at).toLocaleDateString("pl-PL"),g=N.get(_)||[];S.score!==null&&S.score!==void 0&&(g.push(S.score),N.set(_,g))}),Array.from(N.entries()).map(([S,_])=>({date:S,avgScore:Math.round(_.reduce((g,C)=>g+C,0)/_.length),attempts:_.length,minScore:Math.min(..._),maxScore:Math.max(..._)})).sort((S,_)=>new Date(S.date).getTime()-new Date(_.date).getTime()).slice(-14)},[y]),k=x.useMemo(()=>{if(!d?.data||!w.length)return[];const N=w.slice(0,5),S=[];return N.forEach(_=>{d.data.filter(C=>C.activity_id===_.activityId).sort((C,A)=>C.order_index-A.order_index).forEach((C,A)=>{let E="medium";_.avgScore<30?E="very-hard":_.avgScore<50?E="hard":_.avgScore<70?E="medium":E="easy",S.push({questionId:C.id,question:C.question,activityTitle:_.activityTitle,quizAttempts:_.attempts,avgQuizScore:_.avgScore,difficulty:E})})}),S.sort((_,g)=>_.avgQuizScore-g.avgQuizScore).slice(0,10)},[d?.data,w]);return e.jsxs(G,{children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Li,{to:"/teacher/reports/overview",children:e.jsxs(I,{variant:"ghost",size:"sm",children:[e.jsx(Ce,{className:"mr-2 h-4 w-4"}),"Powr贸t do centrum raport贸w"]})}),e.jsx("h1",{className:"text-2xl font-bold",children:"Raport wynik贸w"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(fe,{value:n,onValueChange:r,children:[e.jsx(me,{className:"w-[200px]",children:e.jsx(xe,{placeholder:"Wybierz kurs"})}),e.jsxs(he,{children:[e.jsx(V,{value:"all",children:"Wszystkie kursy"}),m?.data?.map(N=>e.jsx(V,{value:N.id.toString(),children:N.title},N.id))]})]}),e.jsxs(fe,{value:i,onValueChange:a,disabled:n==="all",children:[e.jsx(me,{className:"w-[200px]",children:e.jsx(xe,{placeholder:"Wybierz temat"})}),e.jsxs(he,{children:[e.jsx(V,{value:"all",children:"Wszystkie tematy"}),u?.data?.map(N=>e.jsx(V,{value:N.id.toString(),children:N.title},N.id))]})]}),e.jsxs(fe,{value:t,onValueChange:s,children:[e.jsx(me,{className:"w-[150px]",children:e.jsx(xe,{})}),e.jsxs(he,{children:[e.jsx(V,{value:"7d",children:"Ostatnie 7 dni"}),e.jsx(V,{value:"30d",children:"Ostatnie 30 dni"}),e.jsx(V,{value:"90d",children:"Ostatnie 90 dni"})]})]}),e.jsxs(I,{variant:"outline",size:"sm",children:[e.jsx(ep,{className:"mr-2 h-4 w-4"}),"Eksportuj"]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4 mb-6",children:[e.jsxs(D,{children:[e.jsxs($,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(R,{className:"text-sm font-medium",children:"redni wynik"}),e.jsx(Se,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(P,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[j.avgScore,"%"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.jsxs("span",{className:j.avgScoreChange>0?"text-green-600":"text-red-600",children:[j.avgScoreChange>0?e.jsx(xt,{className:"inline h-3 w-3"}):e.jsx(gb,{className:"inline h-3 w-3"})," ",Math.abs(j.avgScoreChange),"%"]})," ","vs. poprzedni okres"]})]})]}),e.jsxs(D,{children:[e.jsxs($,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(R,{className:"text-sm font-medium",children:"Wska藕nik zdawalnoci"}),e.jsx(gr,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(P,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[j.passRate,"%"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.jsxs("span",{className:j.passRateChange>0?"text-green-600":"text-red-600",children:[j.passRateChange>0?"+":"",j.passRateChange,"%"]})," ","vs. poprzedni okres"]})]})]}),e.jsxs(D,{children:[e.jsxs($,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(R,{className:"text-sm font-medium",children:"Liczba podej"}),e.jsx(at,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(P,{children:[e.jsx("div",{className:"text-2xl font-bold",children:j.totalAttempts}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[j.uniqueStudents," unikalnych uczni贸w"]})]})]}),e.jsxs(D,{children:[e.jsxs($,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(R,{className:"text-sm font-medium",children:"Liczba quiz贸w"}),e.jsx(Se,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(P,{children:[e.jsx("div",{className:"text-2xl font-bold",children:j.totalQuizzes}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"aktywnych w okresie"})]})]})]}),e.jsxs(zc,{defaultValue:"distribution",className:"space-y-4",children:[e.jsxs(ho,{children:[e.jsx(Kt,{value:"distribution",children:"Rozkad wynik贸w"}),e.jsx(Kt,{value:"topics",children:"Wyniki wedug temat贸w"}),e.jsx(Kt,{value:"trend",children:"Trend w czasie"}),e.jsx(Kt,{value:"difficult",children:"Najtrudniejsze pytania"})]}),e.jsx(Gt,{value:"distribution",className:"space-y-4",children:e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{children:"Rozkad wynik贸w"})}),e.jsx(P,{children:e.jsx(Fe,{width:"100%",height:300,children:e.jsxs(Bi,{data:v,children:[e.jsx(Rt,{strokeDasharray:"3 3"}),e.jsx(St,{dataKey:"range"}),e.jsx(gt,{}),e.jsx(Be,{}),e.jsx(jr,{dataKey:"count",name:"Liczba wynik贸w",isAnimationActive:!1,children:v.map((N,S)=>e.jsx(xs,{fill:N.color},`cell-${S}`))})]})})})]}),e.jsxs(D,{children:[e.jsx($,{children:e.jsxs(R,{className:"flex items-center gap-2",children:[e.jsx(yt,{className:"h-4 w-4 text-orange-600"}),"Quizy wymagajce uwagi"]})}),e.jsx(P,{children:e.jsx("div",{className:"space-y-3",children:w.slice(0,5).map(N=>e.jsxs("div",{className:"space-y-2 pb-3 border-b last:border-0",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-sm",children:N.activityTitle}),e.jsx("p",{className:"text-xs text-muted-foreground",children:N.topicTitle})]}),e.jsxs(H,{variant:N.avgScore<50?"destructive":"secondary",children:[N.avgScore,"%"]})]}),e.jsxs("div",{className:"flex gap-4 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Zdawalno: ",N.passRate,"%"]}),e.jsxs("span",{children:["Pr贸by: ",N.attempts]}),e.jsxs("span",{children:["Min/Max: ",N.minScore,"%/",N.maxScore,"%"]})]})]},N.activityId))})})]})]})}),e.jsx(Gt,{value:"topics",className:"space-y-4",children:e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{children:"rednie wyniki wedug temat贸w"})}),e.jsx(P,{children:e.jsx(Fe,{width:"100%",height:400,children:e.jsxs(Mb,{data:T,children:[e.jsx(Ib,{}),e.jsx(Eb,{dataKey:"topic",tick:{fontSize:12}}),e.jsx(Lb,{domain:[0,100]}),e.jsx(Ob,{name:"redni wynik",dataKey:"avgScore",stroke:"#8884d8",fill:"#8884d8",fillOpacity:.6,isAnimationActive:!1}),e.jsx(Be,{})]})})})]}),e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{children:"Szczeg贸owe wyniki"})}),e.jsx(P,{children:e.jsxs(In,{children:[e.jsx(En,{children:e.jsxs(_t,{children:[e.jsx(de,{children:"Temat"}),e.jsx(de,{className:"text-right",children:"redni wynik"}),e.jsx(de,{className:"text-right",children:"Liczba pr贸b"})]})}),e.jsx(Ln,{children:T.map(N=>e.jsxs(_t,{children:[e.jsx(ue,{className:"font-medium",children:N.topic}),e.jsx(ue,{className:"text-right",children:e.jsxs(H,{variant:N.avgScore>=70?"default":"secondary",children:[N.avgScore,"%"]})}),e.jsx(ue,{className:"text-right",children:N.attempts})]},N.topic))})]})})]})]})}),e.jsx(Gt,{value:"trend",className:"space-y-4",children:e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{children:"Trend wynik贸w w czasie"})}),e.jsx(P,{children:e.jsx(Fe,{width:"100%",height:400,children:e.jsxs(Rb,{data:z,children:[e.jsx(Rt,{strokeDasharray:"3 3"}),e.jsx(St,{dataKey:"date"}),e.jsx(gt,{}),e.jsx(Be,{}),e.jsx(lr,{}),e.jsx(sn,{type:"monotone",dataKey:"maxScore",fill:"#8884d8",stroke:"#8884d8",fillOpacity:.2,name:"Max",isAnimationActive:!1}),e.jsx(sn,{type:"monotone",dataKey:"minScore",fill:"#82ca9d",stroke:"#82ca9d",fillOpacity:.2,name:"Min",isAnimationActive:!1}),e.jsx(Nc,{type:"monotone",dataKey:"avgScore",stroke:"#ff7300",strokeWidth:3,name:"rednia",dot:{fill:"#ff7300"},isAnimationActive:!1}),e.jsx(jr,{dataKey:"attempts",fill:"#ffc658",name:"Liczba pr贸b",yAxisId:"right",isAnimationActive:!1}),e.jsx(gt,{yAxisId:"right",orientation:"right"})]})})})]})}),e.jsx(Gt,{value:"difficult",className:"space-y-4",children:e.jsxs(D,{children:[e.jsx($,{children:e.jsxs(R,{className:"flex items-center gap-2",children:[e.jsx(yt,{className:"h-5 w-5 text-red-600"}),"Najtrudniejsze pytania"]})}),e.jsxs(P,{children:[e.jsx("div",{className:"space-y-4",children:k.length>0?k.map((N,S)=>e.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs(H,{variant:"outline",children:["#",S+1]}),e.jsxs(H,{variant:N.difficulty==="very-hard"?"destructive":N.difficulty==="hard"?"secondary":"default",children:["Quiz: ",N.avgQuizScore,"% rednio"]})]}),e.jsx("p",{className:"text-sm font-medium",children:N.question}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Z quizu: ",N.activityTitle,"  ",N.quizAttempts," podej"]})]})}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"redni wynik quizu"}),e.jsxs("p",{className:"font-medium",children:[N.avgQuizScore,"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Liczba podej"}),e.jsx("p",{className:"font-medium",children:N.quizAttempts})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Poziom trudnoci"}),e.jsx(H,{variant:N.difficulty==="very-hard"?"destructive":N.difficulty==="hard"?"secondary":N.difficulty==="medium"?"outline":"default",children:N.difficulty==="very-hard"?"Bardzo trudne":N.difficulty==="hard"?"Trudne":N.difficulty==="medium"?"rednie":"atwe"})]})]})]},N.questionId)):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx("p",{children:"Brak danych o pytaniach w wybranym okresie."}),e.jsx("p",{className:"text-sm mt-2",children:"Upewnij si, 偶e wybrane quizy maj pytania."})]})}),e.jsx("div",{className:"mt-4 p-4 bg-muted rounded-lg",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.jsx("strong",{children:"Wskaz贸wka:"})," Rozwa偶 dodanie dodatkowych materia贸w lub wyjanie do pyta z niskim wska藕nikiem poprawnych odpowiedzi."]})})]})]})})]})]})},aS={name:"reports",list:"/teacher/reports/overview",meta:{label:"Raporty",icon:e.jsx(gr,{className:"h-4 w-4"})}},Iu={name:"reports-engagement",list:"/teacher/reports/engagement",meta:{label:"Zaanga偶owanie"}},Eu={name:"reports-progress",list:"/teacher/reports/progress",meta:{label:"Postpy"}},Lu={name:"reports-performance",list:"/teacher/reports/performance",meta:{label:"Wyniki"}},Ou={name:"reports-gamification",list:"/teacher/reports/gamification",meta:{label:"Gamifikacja"}},Ru={name:"reports-summary",list:"/teacher/reports/summary",meta:{label:"U偶ytkownicy"}},oS=[e.jsx(W,{path:"reports",element:e.jsx(as,{to:"overview",replace:!0})},"reports-root-redirect"),e.jsx(W,{path:"reports/overview",element:e.jsx(eS,{})},"reports-overview"),e.jsx(W,{path:"reports/engagement",element:e.jsx(tS,{})},"reports-engagement"),e.jsx(W,{path:"reports/progress",element:e.jsx(sS,{})},"reports-progress"),e.jsx(W,{path:"reports/performance",element:e.jsx(iS,{})},"reports-performance"),e.jsx(W,{path:"reports/gamification",element:e.jsx(nS,{})},"reports-gamification"),e.jsx(W,{path:"reports/summary",element:e.jsx(rS,{})},"reports-summary")],lS={id:"course-structure-wizard",title:"Kreator struktury kursu",schema:{step1:{title:"Podstawowe informacje o kursie",type:"object",properties:{courseType:{type:"select",title:"Typ kursu",options:[{value:"matura",label:"Kurs maturalny"},{value:"academic",label:"Kurs akademicki"},{value:"professional",label:"Kurs zawodowy"},{value:"hobby",label:"Kurs hobbystyczny"},{value:"certification",label:"Kurs certyfikacyjny"}]},subject:{type:"text",title:"Przedmiot/Dziedzina",placeholder:"np. Matematyka, Programowanie Python, Jzyk angielski"},level:{type:"select",title:"Poziom kursu",options:[{value:"basic",label:"Podstawowy"},{value:"extended",label:"Rozszerzony"},{value:"beginner",label:"Pocztkujcy"},{value:"intermediate",label:"redniozaawansowany"},{value:"advanced",label:"Zaawansowany"}]},duration:{type:"select",title:"Planowany czas trwania",options:[{value:"1month",label:"1 miesic"},{value:"3months",label:"3 miesice"},{value:"6months",label:"6 miesicy"},{value:"1year",label:"1 rok"},{value:"2years",label:"2 lata"}]},curriculum:{type:"textarea",title:"Podstawa programowa",placeholder:"Opcjonalnie - wklej podstaw programow"}},required:["courseType","subject","level","duration"]},step2:{title:"Analiza wymaga",type:"object",properties:{courseTitle:{type:"text",title:"Proponowany tytu kursu",readOnly:!0},description:{type:"textarea",title:"Opis kursu",readOnly:!0},objectives:{type:"tags",title:"Cele kursu",readOnly:!0},targetAudience:{type:"text",title:"Grupa docelowa",readOnly:!0},prerequisites:{type:"tags",title:"Wymagania wstpne",readOnly:!0},estimatedHours:{type:"number",title:"Szacowana liczba godzin",readOnly:!0},topicsCount:{type:"number",title:"Liczba g贸wnych temat贸w",readOnly:!0}}},step3:{title:"Dostosowanie struktury",type:"object",properties:{courseTitle:{type:"text",title:"Tytu kursu",placeholder:"np. Matematyka - Przygotowanie do matury"},description:{type:"textarea",title:"Opis kursu",rows:4},topicsPerWeek:{type:"number",title:"Liczba temat贸w na tydzie",min:1,max:7}},required:["courseTitle","description","topicsPerWeek"]},step4:{title:"Podgld struktury",type:"object",properties:{structure:{type:"array",title:"Struktura kursu",readOnly:!0}}},step5:{title:"Tworzenie kursu",type:"object",properties:{courseName:{type:"text",title:"Ostateczna nazwa kursu"},iconEmoji:{type:"text",title:"Emoji ikona",placeholder:"np.   "},isPublished:{type:"checkbox",title:"Opublikuj od razu"}},required:["courseName"]}}},cS={id:"analyze-course-requirements",name:"Analiza wymaga kursu",config:{endpoint:"https://diesel-power-backend.onrender.com/api/chat"},prompt:{system:"Jeste ekspertem od projektowania kurs贸w edukacyjnych i program贸w nauczania.",user:`
Przeanalizuj wymagania dla kursu:
Typ: {{courseType}}
Przedmiot: {{subject}}
Poziom: {{level}}
Czas trwania: {{duration}}
{{#if curriculum}}
Podstawa programowa/Sylabus:
{{curriculum}}
{{/if}}

Wygeneruj JSON:
{
  "courseTitle": "<tytu kursu odpowiedni do typu i poziomu>",
  "description": "<szczeg贸owy opis kursu 100-200 s贸w>",
  "objectives": ["cel1", "cel2", "cel3", "cel4", "cel5"],
  "targetAudience": "<opis grupy docelowej>",
  "prerequisites": ["wymaganie1", "wymaganie2"],
  "estimatedHours": <liczba godzin>,
  "topicsCount": <liczba g贸wnych temat贸w>
}

Wymagania:
{{#if curriculum}}
- CILE przestrzegaj podanej podstawy programowej/sylabusa
- Uwzgldnij wszystkie wymagania szczeg贸owe
{{/if}}
- Dla kurs贸w maturalnych: zgodno z wymaganiami egzaminacyjnymi
- CourseTitle: profesjonalny i opisowy
- Description: zawiera zakres materiau i metodyk
- Objectives: 5-8 konkretnych, mierzalnych cel贸w
- Prerequisites: realistyczne wymagania (mo偶e by pusta tablica)
- EstimatedHours: realistyczna liczba godzin
- TopicsCount: odpowiednia liczba temat贸w do czasu trwania
    `,responseFormat:"json"},inputMapping:t=>({courseType:t.courseType,subject:t.subject,level:t.level,duration:t.duration,curriculum:t.curriculum||""}),outputMapping:(t,s)=>({...s,courseTitle:t.courseTitle,description:t.description,objectives:t.objectives,targetAudience:t.targetAudience,prerequisites:t.prerequisites,estimatedHours:t.estimatedHours,topicsCount:t.topicsCount}),validation:t=>!!(t.courseTitle&&t.description&&t.objectives&&t.topicsCount)},dS={id:"generate-course-structure",name:"Generowanie struktury kursu",config:{endpoint:"https://diesel-power-backend.onrender.com/api/chat"},prompt:{system:"Jeste ekspertem od tworzenia program贸w nauczania. Tworzysz TYLKO list temat贸w z tytuami i kr贸tkimi opisami.",user:`
    Stw贸rz list temat贸w dla kursu:
    
    Tytu: {{courseTitle}}
    Opis: {{description}}
    Przedmiot: {{subject}}
    Poziom: {{level}}
    Typ: {{courseType}}
    Tematy na tydzie: {{topicsPerWeek}}
    {{#if curriculum}}
    Podstawa programowa:
    {{curriculum}}
    {{/if}}
    
    Wygeneruj TYLKO TEMATY - sam tytu i kr贸tki opis. NIE dodawaj wicze, quiz贸w, materia贸w.
    {{#if curriculum}}
    MUSISZ uwzgldni wszystkie zagadnienia z podstawy programowej.
    {{/if}}
    
    Wygeneruj JSON:
    {
      "structure": [
        {
          "weekNumber": 1,
          "topics": [
            {
              "title": "<tytu tematu>",
              "description": "<kr贸tki opis tematu - max 2 zdania>"
            }
          ]
        }
      ],
      "summary": {
        "totalWeeks": <liczba>,
        "totalTopics": <liczba>
      }
    }
    
    Wygeneruj 4-8 tygodni w zale偶noci od kursu. Ka偶dy tydzie ma {{topicsPerWeek}} temat贸w.
    Tematy powinny tworzy logiczn progresj od podstaw do zaawansowanych.
    `,responseFormat:"json"},inputMapping:t=>({courseTitle:t.courseTitle,description:t.description,subject:t.subject,level:t.level,courseType:t.courseType,topicsPerWeek:t.topicsPerWeek,curriculum:t.curriculum||""}),outputMapping:(t,s)=>({...s,structure:t.structure,summary:t.summary}),validation:t=>!!(t.structure&&Array.isArray(t.structure)&&t.structure.length>0)},Bt={subject:{minLength:3,errorMessage:"Przedmiot jest wymagany (3-100 znak贸w)"},courseTitle:{minLength:5,errorMessage:"Tytu jest wymagany (5-200 znak贸w)"},description:{minLength:50,errorMessage:"Opis jest wymagany (50-1000 znak贸w)"},topicsPerWeek:{min:1,max:7,errorMessage:"Liczba temat贸w na tydzie musi by midzy 1 a 7"}},Pr={steps:{1:{title:"Jaki kurs chcesz stworzy?",description:"Okrel typ, przedmiot i poziom - AI stworzy kompletn struktur kursu",button:"Analizuj wymagania",loading:"Analizuj wymagania..."},2:{title:"Analiza wymaga kursu",description:"AI przeanalizowaa wymagania i zaproponowaa parametry kursu",success:" Analiza zakoczona pomylnie"},3:{title:"Podstawowe informacje o kursie",description:"Podaj tytu, opis i tempo nauki",button:"Generuj tematy",loading:"Generuj tematy...",loadingInfo:" AI tworzy list temat贸w kursu..."},4:{title:"Edycja struktury kursu",description:"Mo偶esz doda lub usun tematy przed utworzeniem kursu"},5:{title:"Tworzenie kursu",description:"Ostatnie poprawki przed utworzeniem kursu",saveInfo:" Zostanie utworzony kurs z list temat贸w. Materiay i quizy mo偶esz doda p贸藕niej.",button:"Utw贸rz kurs",loading:"Tworz kurs...",success:" Kurs zosta utworzony pomylnie! Przekierowuj..."}},dashboard:{title:"Generator struktury kursu",description:"Tw贸rz kompletne kursy z pomoc AI"},errors:{subjectRequired:"Podaj przedmiot kursu",analysisError:"Bd analizy wymaga:",generationError:"Bd generowania struktury:",saveError:"Wystpi bd podczas tworzenia kursu",unexpectedError:"Wystpi nieoczekiwany bd"}},Lt={dashboard:"/teacher/course-structure",step1:"/teacher/course-structure/step1",step2:"/teacher/course-structure/step2",step3:"/teacher/course-structure/step3",step4:"/teacher/course-structure/step4",step5:"/teacher/course-structure/step5",courses:"/teacher/courses"},uS=()=>{const t=se(),{getData:s}=Ke(),{data:n}=We(),[r,i]=x.useState(!1),a=s("course-structure-wizard"),{dashboard:o}=Pr,{data:l}=Y({resource:"courses",pagination:{mode:"off"},filters:n?.vendor_id?[{field:"vendor_id",operator:"eq",value:n.vendor_id}]:[],meta:{select:"*, topics(count)"}}),c=l?.data||[],d=a&&a.courseTitle;return e.jsxs(G,{children:[e.jsx(_e,{title:o.title,description:o.description}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs(D,{className:"hover:shadow-lg transition-all cursor-pointer border-2 hover:border-purple-400 flex flex-col",onClick:()=>t(Lt.step1),children:[e.jsxs($,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:e.jsx(Tr,{className:"w-8 h-8 text-purple-600"})}),e.jsx(le,{className:"w-5 h-5 text-gray-400"})]}),e.jsx(R,{children:"Stw贸rz nowy kurs"}),e.jsx(Oe,{children:"Wygeneruj kompletn struktur kursu od podstaw"})]}),e.jsxs(P,{className:"flex-1 flex flex-col",children:[e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"w-4 h-4 text-purple-600"}),e.jsx("span",{children:"15-20 minut"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ye,{className:"w-4 h-4 text-purple-600"}),e.jsx("span",{children:"Pena struktura"})]})]}),e.jsx("div",{className:"mt-auto pt-4",children:e.jsxs("div",{className:"inline-flex items-center text-sm font-medium text-purple-600",children:["Rozpocznij tworzenie",e.jsx(le,{className:"w-4 h-4 ml-1"})]})})]})]}),e.jsxs(D,{className:"hover:shadow-lg transition-all cursor-pointer border-2 hover:border-blue-400 flex flex-col",onClick:()=>i(!r),children:[e.jsxs($,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:e.jsx(Ea,{className:"w-8 h-8 text-blue-600"})}),e.jsx(le,{className:"w-5 h-5 text-gray-400"})]}),e.jsx(R,{children:"Rozwi istniejcy kurs"}),e.jsx(Oe,{children:"Dodaj nowe tematy do istniejcego kursu z pomoc AI"})]}),e.jsxs(P,{className:"flex-1 flex flex-col",children:[e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ie,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{children:"Dodaj tematy"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Tt,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{children:"Rozszerz program"})]})]}),e.jsx("div",{className:"mt-auto pt-4",children:e.jsxs("div",{className:"inline-flex items-center text-sm font-medium text-blue-600",children:["Wybierz kurs",e.jsx(le,{className:"w-4 h-4 ml-1"})]})})]})]})]}),r&&c.length>0&&e.jsxs(D,{className:"border-2 border-blue-200",children:[e.jsxs($,{children:[e.jsx(R,{children:"Wybierz kurs do rozszerzenia"}),e.jsx(Oe,{children:"Kliknij na kurs, aby doda nowe tematy z pomoc AI"})]}),e.jsx(P,{children:e.jsx("div",{className:"space-y-2",children:c.map(m=>e.jsxs("div",{className:"p-4 border rounded-lg hover:bg-gray-50 cursor-pointer flex justify-between items-center",onClick:()=>t(`/teacher/course-structure/edit/${m.id}`),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:m.icon_emoji}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:m.title}),e.jsxs("p",{className:"text-sm text-gray-600",children:[m.topics?.[0]?.count||0," temat贸w"]})]})]}),e.jsx(le,{className:"w-5 h-5 text-gray-400"})]},m.id))})})]}),d&&e.jsxs(D,{className:"hover:shadow-lg transition-shadow border-2 border-gray-200",children:[e.jsx($,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(R,{className:"text-lg",children:"Ostatnia struktura"}),e.jsx(Oe,{children:"Kontynuuj prac nad swoim kursem"})]}),e.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm",children:"Wygenerowana"})]})}),e.jsx(P,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Tytu kursu"}),e.jsx("p",{className:"font-medium text-gray-900",children:a.courseTitle})]}),a.subject&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Przedmiot"}),e.jsx("p",{className:"text-gray-900",children:a.subject})]}),a.summary&&e.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-3 border-t",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-indigo-600",children:a.summary.totalWeeks}),e.jsx("div",{className:"text-sm text-gray-600",children:"tygodni"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:a.summary.totalTopics}),e.jsx("div",{className:"text-sm text-gray-600",children:"temat贸w"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[e.jsxs(I,{variant:"outline",onClick:()=>t(Lt.step4),className:"flex-1",children:[e.jsx(Je,{className:"w-4 h-4 mr-2"}),"Podgld"]}),e.jsxs(I,{variant:"outline",onClick:()=>t(Lt.step3),className:"flex-1",children:[e.jsx(Ea,{className:"w-4 h-4 mr-2"}),"Edytuj"]}),e.jsxs(I,{variant:"outline",onClick:()=>t(Lt.step1),className:"flex-1",children:[e.jsx(xr,{className:"w-4 h-4 mr-2"}),"Nowa"]})]})]})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(D,{className:"hover:shadow-lg transition-shadow cursor-pointer border-2 border-blue-200 group",onClick:()=>t("/teacher/courses"),children:[e.jsxs($,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:e.jsx(ye,{className:"w-6 h-6 text-blue-600"})}),e.jsx(le,{className:"w-5 h-5 text-gray-400 group-hover:translate-x-1 transition-transform"})]}),e.jsx(R,{className:"text-lg",children:"Kursy"}),e.jsx(Oe,{children:"Zobacz wszystkie kursy"})]}),e.jsx(P,{children:e.jsx("p",{className:"text-xs text-gray-500 group-hover:text-blue-600 transition-colors",children:"Kliknij aby przej "})})]}),e.jsxs(D,{className:"hover:shadow-lg transition-shadow cursor-pointer border-2 border-purple-200 group",onClick:()=>t("/teacher/educational-material"),children:[e.jsxs($,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:e.jsx(tn,{className:"w-6 h-6 text-purple-600"})}),e.jsx(le,{className:"w-5 h-5 text-gray-400 group-hover:translate-x-1 transition-transform"})]}),e.jsx(R,{className:"text-lg",children:"Materiay"}),e.jsx(Oe,{children:"Kreator materia贸w"})]}),e.jsx(P,{children:e.jsx("p",{className:"text-xs text-gray-500 group-hover:text-purple-600 transition-colors",children:"Kliknij aby przej "})})]}),e.jsxs(D,{className:"hover:shadow-lg transition-shadow cursor-pointer border-2 border-green-200 group",onClick:()=>t("/teacher/quiz-wizard"),children:[e.jsxs($,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:e.jsx(Tt,{className:"w-6 h-6 text-green-600"})}),e.jsx(le,{className:"w-5 h-5 text-gray-400 group-hover:translate-x-1 transition-transform"})]}),e.jsx(R,{className:"text-lg",children:"Quizy"}),e.jsx(Oe,{children:"Kreator quiz贸w"})]}),e.jsx(P,{children:e.jsx("p",{className:"text-xs text-gray-500 group-hover:text-green-600 transition-colors",children:"Kliknij aby przej "})})]})]})]})]})},Hi=({step:t})=>{const s=se(),n=t/5*100;return e.jsxs(e.Fragment,{children:[e.jsx(I,{variant:"ghost",size:"icon",className:"absolute top-4 right-4 hover:bg-gray-100",onClick:()=>s("/teacher/course-structure"),children:e.jsx(dt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-violet-600 text-white p-8 space-y-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h1",{className:"text-4xl font-black tracking-tight",children:"GENERATOR KURSU"}),e.jsxs("h2",{className:"text-2xl font-light",children:["Zaprojektujmy ",e.jsx("span",{className:"font-bold",children:"struktur kursu"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{children:["Krok ",t," z 5"]}),e.jsxs("span",{children:[n,"%"]})]}),e.jsx(Qt,{value:n,className:"h-2 bg-purple-300"})]})]})]})},Zi=({title:t,description:s})=>e.jsxs("header",{className:"mb-8",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2 flex items-center gap-3",children:t}),e.jsx("p",{className:"text-gray-600",children:s})]}),mS=()=>{const t=se(),{register:s,setData:n}=Ke(),[r,i]=x.useState(""),[a,o]=x.useState(""),[l,c]=x.useState(""),[d,m]=x.useState(""),[u,h]=x.useState(""),[p,b]=x.useState({}),f=Pn("course-structure-wizard","analyze-course-requirements"),{steps:y,errors:w}=Pr;x.useEffect(()=>(s(lS),f.registerOperation(cS),()=>{f.unregisterOperation()}),[]);const j=()=>{const z={};return r||(z.courseType="Wybierz typ kursu"),(!a.trim()||a.length<Bt.subject.minLength)&&(z.subject=Bt.subject.errorMessage),l||(z.level="Wybierz poziom kursu"),d||(z.duration="Wybierz czas trwania"),b(z),Object.keys(z).length===0},v=async()=>{if(j())try{const z={courseType:r,subject:a.trim(),level:l,duration:d,curriculum:u.trim()};n("course-structure-wizard",z),await f.executeOperation(z),t(Lt.step2)}catch(z){console.error(w.analysisError,z)}},T=r==="matura"||r==="academic";return e.jsx(G,{children:e.jsxs(D,{className:"border-2 shadow-lg",children:[e.jsx(Hi,{step:1}),e.jsxs(P,{className:"p-8",children:[e.jsx(Zi,{title:y[1].title,description:y[1].description}),f.error&&e.jsxs(ge,{variant:"destructive",className:"mb-6",children:[e.jsx(yt,{className:"h-4 w-4"}),e.jsxs(je,{children:[w.analysisError," ",f.error]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(re,{htmlFor:"courseType",children:"Typ kursu"}),e.jsxs(fe,{value:r,onValueChange:i,disabled:f.loading,children:[e.jsx(me,{className:p.courseType?"border-red-500":"",children:e.jsx(xe,{placeholder:"Wybierz typ kursu..."})}),e.jsxs(he,{children:[e.jsx(V,{value:"matura",children:"Kurs maturalny"}),e.jsx(V,{value:"academic",children:"Kurs akademicki"}),e.jsx(V,{value:"professional",children:"Kurs zawodowy"}),e.jsx(V,{value:"hobby",children:"Kurs hobbystyczny"}),e.jsx(V,{value:"certification",children:"Kurs certyfikacyjny"})]})]}),p.courseType&&e.jsx("p",{className:"text-sm text-red-600",children:p.courseType})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(re,{htmlFor:"subject",children:"Przedmiot/Dziedzina"}),e.jsx(Z,{id:"subject",type:"text",value:a,onChange:z=>o(z.target.value),placeholder:"np. Matematyka, Programowanie Python, Jzyk angielski",disabled:f.loading,className:p.subject?"border-red-500":""}),p.subject&&e.jsx("p",{className:"text-sm text-red-600",children:p.subject})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(re,{htmlFor:"level",children:"Poziom kursu"}),e.jsxs(fe,{value:l,onValueChange:c,disabled:f.loading,children:[e.jsx(me,{className:p.level?"border-red-500":"",children:e.jsx(xe,{placeholder:"Wybierz poziom..."})}),e.jsx(he,{children:r==="matura"?e.jsxs(e.Fragment,{children:[e.jsx(V,{value:"basic",children:"Podstawowy"}),e.jsx(V,{value:"extended",children:"Rozszerzony"})]}):e.jsxs(e.Fragment,{children:[e.jsx(V,{value:"beginner",children:"Pocztkujcy"}),e.jsx(V,{value:"intermediate",children:"redniozaawansowany"}),e.jsx(V,{value:"advanced",children:"Zaawansowany"})]})})]}),p.level&&e.jsx("p",{className:"text-sm text-red-600",children:p.level})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(re,{htmlFor:"duration",children:"Planowany czas trwania"}),e.jsxs(fe,{value:d,onValueChange:m,disabled:f.loading,children:[e.jsx(me,{className:p.duration?"border-red-500":"",children:e.jsx(xe,{placeholder:"Wybierz czas trwania..."})}),e.jsxs(he,{children:[e.jsx(V,{value:"1month",children:"1 miesic"}),e.jsx(V,{value:"3months",children:"3 miesice"}),e.jsx(V,{value:"6months",children:"6 miesicy"}),e.jsx(V,{value:"1year",children:"1 rok"}),e.jsx(V,{value:"2years",children:"2 lata"})]})]}),p.duration&&e.jsx("p",{className:"text-sm text-red-600",children:p.duration})]}),T&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs(re,{htmlFor:"curriculum",children:["Podstawa programowa",e.jsx("span",{className:"text-gray-500 text-sm ml-2",children:"(opcjonalnie [TODO] uzupenij DB o zarzdzanie podstaw programow)"})]}),e.jsx(bt,{id:"curriculum",value:u,onChange:z=>h(z.target.value),placeholder:r==="matura"?"Wklej fragmenty podstawy programowej MEN, kt贸re chcesz uwzgldni w kursie...":"Wklej sylabus lub program nauczania...",disabled:f.loading,rows:4,className:"font-mono text-sm"}),e.jsxs(ge,{className:"bg-blue-50 border-blue-200",children:[e.jsx(qt,{className:"h-4 w-4 text-blue-600"}),e.jsx(je,{className:"text-blue-800 text-sm",children:r==="matura"?"Dodanie podstawy programowej pomo偶e AI stworzy kurs zgodny z wymaganiami egzaminacyjnymi.":"Dodanie sylabusa pomo偶e AI lepiej dopasowa tematy do wymaga uczelni."})]})]}),e.jsx(I,{onClick:v,disabled:f.loading,className:"w-full bg-purple-600 hover:bg-purple-700 text-white",size:"lg",children:f.loading?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),y[1].loading]}):e.jsxs(e.Fragment,{children:[e.jsx(rt,{className:"w-4 h-4 mr-2"}),y[1].button]})})]})]})]})})},hS=()=>{const t=se(),{getData:s}=Ke(),n=s("course-structure-wizard"),{steps:r}=Pr;return e.jsx(G,{children:e.jsxs(D,{className:"border-2 shadow-lg",children:[e.jsx(Hi,{step:2}),e.jsxs(P,{className:"p-8",children:[e.jsx(Zi,{title:r[2].title,description:r[2].description}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(ge,{className:"bg-green-50 border-green-200",children:[e.jsx(Re,{className:"h-4 w-4 text-green-600"}),e.jsx(je,{className:"text-green-800",children:r[2].success})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(D,{className:"bg-gray-50 border-gray-200",children:e.jsxs(P,{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Proponowany tytu"}),e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:n.courseTitle})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Opis kursu"}),e.jsx("div",{className:"text-gray-800 whitespace-pre-wrap",children:n.description})]})]})}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(D,{className:"border-purple-200 bg-purple-50/50",children:e.jsx(P,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Se,{className:"w-5 h-5 text-purple-600 mt-1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Cele kursu"}),e.jsx("ul",{className:"space-y-1",children:n.objectives?.map((i,a)=>e.jsxs("li",{className:"text-sm text-gray-700",children:[" ",i]},a))})]})]})})}),e.jsx(D,{className:"border-blue-200 bg-blue-50/50",children:e.jsx(P,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(pe,{className:"w-5 h-5 text-blue-600 mt-1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Grupa docelowa"}),e.jsx("p",{className:"text-sm text-gray-700",children:n.targetAudience})]})]})})})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsx(D,{children:e.jsxs(P,{className:"p-4 text-center",children:[e.jsx(Te,{className:"w-8 h-8 text-indigo-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:n.estimatedHours}),e.jsx("div",{className:"text-sm text-gray-600",children:"godzin"})]})}),e.jsx(D,{children:e.jsxs(P,{className:"p-4 text-center",children:[e.jsx(ye,{className:"w-8 h-8 text-purple-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:n.topicsCount}),e.jsx("div",{className:"text-sm text-gray-600",children:"temat贸w"})]})}),e.jsx(D,{children:e.jsxs(P,{className:"p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Wymagania"}),n.prerequisites?.length>0?e.jsx("ul",{className:"space-y-1",children:n.prerequisites.map((i,a)=>e.jsxs("li",{className:"text-sm text-gray-700",children:[" ",i]},a))}):e.jsx("span",{className:"text-sm text-gray-500",children:"Brak wymaga"})]})})]})]}),e.jsxs("div",{className:"flex justify-between pt-6",children:[e.jsx(I,{variant:"outline",onClick:()=>t(Lt.step1),children:"Wstecz"}),e.jsx(I,{onClick:()=>t(Lt.step3),className:"bg-purple-600 hover:bg-purple-700",children:"Kontynuuj"})]})]})]})]})})},pS=()=>{const t=se(),{getData:s,setData:n}=Ke(),r=s("course-structure-wizard"),[i,a]=x.useState(r.courseTitle||""),[o,l]=x.useState(r.description||""),[c,d]=x.useState(2),[m,u]=x.useState({}),h=Pn("course-structure-wizard","generate-course-structure"),{steps:p,errors:b}=Pr;x.useEffect(()=>(h.registerOperation(dS),()=>{h.unregisterOperation()}),[]);const f=()=>{const w={};return(!i.trim()||i.length<Bt.courseTitle.minLength)&&(w.courseTitle=Bt.courseTitle.errorMessage),(!o.trim()||o.length<Bt.description.minLength)&&(w.description=Bt.description.errorMessage),(!c||c<Bt.topicsPerWeek.min||c>Bt.topicsPerWeek.max)&&(w.topicsPerWeek=Bt.topicsPerWeek.errorMessage),u(w),Object.keys(w).length===0},y=async()=>{if(f())try{const w={...r,courseTitle:i.trim(),description:o.trim(),topicsPerWeek:c};n("course-structure-wizard",w),await h.executeOperation(w),t(Lt.step4)}catch(w){console.error(b.generationError,w)}};return e.jsx(G,{children:e.jsxs(D,{className:"border-2 shadow-lg",children:[e.jsx(Hi,{step:3}),e.jsxs(P,{className:"p-8",children:[e.jsx(Zi,{title:p[3].title,description:p[3].description}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(re,{htmlFor:"courseTitle",children:["Tytu kursu ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(Z,{id:"courseTitle",value:i,onChange:w=>a(w.target.value),placeholder:"np. Matematyka - Przygotowanie do matury",className:m.courseTitle?"border-red-500":""}),m.courseTitle&&e.jsx("p",{className:"text-sm text-red-600",children:m.courseTitle})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(re,{htmlFor:"description",children:["Opis kursu ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(bt,{id:"description",value:o,onChange:w=>l(w.target.value),placeholder:"Szczeg贸owy opis kursu...",rows:4,className:m.description?"border-red-500":""}),m.description&&e.jsx("p",{className:"text-sm text-red-600",children:m.description}),e.jsxs("p",{className:"text-sm text-gray-500",children:[o.length," / ",Bt.description.minLength," znak贸w minimum"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(re,{htmlFor:"topicsPerWeek",children:["Liczba temat贸w na tydzie ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(Z,{id:"topicsPerWeek",type:"number",value:c,onChange:w=>d(parseInt(w.target.value)||0),min:Bt.topicsPerWeek.min,max:Bt.topicsPerWeek.max,className:m.topicsPerWeek?"border-red-500":""}),m.topicsPerWeek&&e.jsx("p",{className:"text-sm text-red-600",children:m.topicsPerWeek}),e.jsx("p",{className:"text-sm text-gray-500",children:"Okrela tempo realizacji kursu"})]}),h.loading&&e.jsxs(ge,{className:"bg-purple-50 border-purple-200",children:[e.jsx(qt,{className:"h-4 w-4 text-purple-600"}),e.jsx(je,{className:"text-purple-800",children:p[3].loadingInfo})]}),e.jsxs("div",{className:"flex justify-between pt-6",children:[e.jsx(I,{variant:"outline",onClick:()=>t(Lt.step2),children:"Wstecz"}),e.jsx(I,{onClick:y,disabled:h.loading,className:"bg-purple-600 hover:bg-purple-700",children:h.loading?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),p[3].loading]}):e.jsxs(e.Fragment,{children:[e.jsx(rt,{className:"w-4 h-4 mr-2"}),p[3].button]})})]})]})]})]})})},fS=()=>{const t=se(),{getData:s}=Ke(),n=s("course-structure-wizard"),{steps:r}=Pr,i=n.structure||[];return e.jsx(G,{children:e.jsxs(D,{className:"border-2 shadow-lg",children:[e.jsx(Hi,{step:4}),e.jsxs(P,{className:"p-8",children:[e.jsx(Zi,{title:e.jsxs(e.Fragment,{children:[e.jsx(Je,{className:"w-8 h-8 text-purple-600"}),e.jsx("span",{children:r[4].title})]}),description:r[4].description}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(D,{className:"bg-gradient-to-r from-purple-50 to-violet-50 border-purple-200",children:e.jsxs(P,{className:"p-6",children:[e.jsx("h4",{className:"font-semibold text-lg mb-3",children:n.courseTitle}),e.jsx("p",{className:"text-gray-600 mb-6",children:n.description}),n.summary&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(Tt,{className:"w-8 h-8 text-indigo-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-indigo-600",children:i.length||n.summary.totalWeeks}),e.jsx("div",{className:"text-sm text-gray-600",children:"tygodni"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(ye,{className:"w-8 h-8 text-purple-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:i.reduce((a,o)=>a+o.topics.length,0)}),e.jsx("div",{className:"text-sm text-gray-600",children:"temat贸w"})]})]})]})}),e.jsx("h4",{className:"font-semibold text-lg",children:"Struktura kursu - podgld"}),e.jsx("div",{className:"space-y-4",children:i?.map((a,o)=>e.jsxs(D,{className:"overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-indigo-50 to-purple-50 px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Tt,{className:"w-5 h-5 text-indigo-600"}),e.jsxs("h5",{className:"font-medium",children:["Tydzie ",a.weekNumber]}),e.jsxs(H,{variant:"secondary",children:[a.topics.length," ",a.topics.length===1?"temat":"temat贸w"]})]})}),e.jsx(P,{className:"p-4 space-y-3",children:a.topics.map((l,c)=>e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border-l-4 border-purple-200",children:[e.jsx("h6",{className:"font-medium text-gray-900 mb-2",children:l.title}),l.description&&e.jsx("p",{className:"text-sm text-gray-600",children:l.description})]},c))})]},o))}),e.jsxs(ge,{className:"bg-blue-50 border-blue-200",children:[e.jsx(qt,{className:"h-4 w-4 text-blue-600"}),e.jsx(je,{className:"text-blue-800",children:"Po utworzeniu kursu bdziesz m贸g dodawa nowe tematy w dowolnym momencie korzystajc z generatora AI."})]}),e.jsxs("div",{className:"flex justify-between pt-6",children:[e.jsx(I,{variant:"outline",onClick:()=>t(Lt.step3),children:"Wstecz"}),e.jsx(I,{onClick:()=>t(Lt.step5),className:"bg-purple-600 hover:bg-purple-700",children:"Przejd藕 do utworzenia kursu"})]})]})]})]})})},xS=()=>{const t=se(),{getData:s,setData:n}=Ke(),{mutate:r}=os(),{mutate:i}=os(),{data:a}=We(),o=s("course-structure-wizard"),[l,c]=x.useState(o.courseTitle||""),[d,m]=x.useState(""),[u,h]=x.useState(!1),[p,b]=x.useState(!1),[f,y]=x.useState(!1),{steps:w,errors:j}=Pr,v=async()=>{if(!l.trim()){K.error("Nazwa kursu jest wymagana");return}if(!a?.vendor_id){K.error("Brak informacji o vendor_id. Skontaktuj si z administratorem.");return}b(!0),y(!1);try{r({resource:"courses",values:{vendor_id:a.vendor_id,title:l.trim(),description:o.description,icon_emoji:d,is_published:u}},{onSuccess:async z=>{const k=z.data.id;let N=1;try{for(const S of o.structure)for(const _ of S.topics)await new Promise((g,C)=>{i({resource:"topics",values:{course_id:k,title:_.title,position:N++,is_published:!1}},{onSuccess:g,onError:C})});n("course-structure-wizard",{...o,courseName:l.trim(),courseId:k,saved:!0}),b(!1),y(!0),setTimeout(()=>{t(`${Lt.courses}/show/${k}`)},2e3)}catch(S){b(!1),console.error("Bd podczas tworzenia temat贸w:",S),K.error("Wystpi bd podczas tworzenia struktury kursu")}},onError:z=>{b(!1),console.error(j.saveError,z),z?.code==="42501"?K.error("Brak uprawnie do tworzenia kurs贸w. Sprawd藕 swoje uprawnienia."):z?.code==="23505"?K.error("Kurs o takiej nazwie ju偶 istnieje."):K.error(j.saveError)}})}catch(z){b(!1),console.error(j.unexpectedError,z),K.error(j.unexpectedError)}},T=()=>{switch(o.courseType){case"matura":return"";case"academic":return"锔";case"professional":return"";case"hobby":return"";case"certification":return"";default:return""}};return ne.useEffect(()=>{m(T())},[o.courseType]),e.jsx(G,{children:e.jsxs(D,{className:"border-2 shadow-lg",children:[e.jsx(Hi,{step:5}),e.jsxs(P,{className:"p-8",children:[e.jsx(Zi,{title:e.jsxs(e.Fragment,{children:[e.jsx(fr,{className:"w-8 h-8 text-purple-600"}),e.jsx("span",{children:w[5].title})]}),description:w[5].description}),f&&e.jsxs(ge,{className:"mb-6 bg-green-50 border-green-200",children:[e.jsx(Re,{className:"h-4 w-4 text-green-600"}),e.jsx(je,{className:"text-green-800",children:w[5].success})]}),e.jsxs("form",{className:"space-y-6",onSubmit:z=>{z.preventDefault(),v()},children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(re,{htmlFor:"courseName",children:["Nazwa kursu ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(Z,{id:"courseName",type:"text",value:l,onChange:z=>c(z.target.value),placeholder:"np. Matematyka - Kurs maturalny poziom rozszerzony"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(re,{htmlFor:"iconEmoji",children:"Emoji ikona"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Z,{id:"iconEmoji",type:"text",value:d,onChange:z=>m(z.target.value),placeholder:"np.   ",className:"flex-1",maxLength:5}),e.jsx("div",{className:"flex gap-1",children:["","","","锔","","","",""].map(z=>e.jsx(I,{type:"button",variant:"outline",size:"sm",onClick:()=>m(z),className:"w-10 h-10 hover:bg-purple-50",children:z},z))})]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Wybierz emoji z listy lub wpisz wasne"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ct,{id:"isPublished",checked:u,onCheckedChange:z=>h(z)}),e.jsx("label",{htmlFor:"isPublished",className:"text-sm cursor-pointer",children:"Opublikuj kurs od razu (uczniowie bd mogli go zobaczy)"})]}),e.jsx(D,{className:"bg-gradient-to-r from-purple-50 to-violet-50 border-purple-200",children:e.jsxs(P,{className:"p-4",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Co zostanie utworzone:"}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-700",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(Re,{className:"w-4 h-4 text-green-600 mt-0.5"}),e.jsxs("span",{children:['Kurs "',l||o.courseTitle,'" z penym opisem']})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(Re,{className:"w-4 h-4 text-green-600 mt-0.5"}),e.jsxs("span",{children:[o.summary?.totalTopics||0," temat贸w rozo偶onych na ",o.summary?.totalWeeks||0," tygodni"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(Re,{className:"w-4 h-4 text-green-600 mt-0.5"}),e.jsx("span",{children:"Struktura gotowa do wypenienia materiaami i quizami"})]})]})]})}),e.jsx(ge,{className:"bg-purple-50 border-purple-200",children:e.jsx(je,{className:"text-purple-800",children:w[5].saveInfo})}),e.jsx(Mn,{}),e.jsxs("footer",{className:"flex justify-between gap-4",children:[e.jsxs(I,{type:"button",variant:"outline",onClick:()=>t(Lt.step4),disabled:p,className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"w-4 h-4"}),"Wstecz"]}),e.jsx(I,{type:"submit",disabled:p||f,className:"flex items-center gap-2 min-w-[160px] bg-purple-600 hover:bg-purple-700",children:p?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),w[5].loading]}):e.jsxs(e.Fragment,{children:[e.jsx(Ui,{className:"w-4 h-4"}),w[5].button]})})]})]})]})]})})},gS=()=>{const{id:t}=vt(),s=se(),[n,r]=x.useState(""),[i,a]=x.useState(1),[o,l]=x.useState([]),{data:c,isLoading:d}=Xe({resource:"courses",id:t}),{data:m,refetch:u}=Y({resource:"topics",filters:[{field:"course_id",operator:"eq",value:t}],sorters:[{field:"position",order:"asc"}]}),h=c?.data,p=m?.data||[],b=Pn("course-structure-edit","add-new-topics"),{mutate:f}=os();x.useEffect(()=>(b.registerOperation({id:"add-new-topics",name:"Dodawanie nowych temat贸w",config:{endpoint:"https://diesel-power-backend.onrender.com/api/chat"},prompt:{system:"Jeste ekspertem od rozszerzania program贸w nauczania. Dodajesz nowe tematy zachowujc sp贸jno z istniejcym kursem.",user:`
Kurs: {{courseTitle}}
Opis: {{courseDescription}}
Istniejce tematy: {{existingTopics}}

Wymagania u偶ytkownika: {{requirements}}
Numer tygodnia dla nowych temat贸w: {{weekNumber}}

Wygeneruj 2-5 nowych temat贸w kt贸re:
1. S sp贸jne z dotychczasowym programem
2. Rozszerzaj kurs o nowe zagadnienia
3. Zachowuj odpowiedni poziom trudnoci
4. Nie duplikuj istniejcych temat贸w

JSON:
{
  "newTopics": [
    {
      "title": "<tytu tematu>",
      "description": "<opis 1-2 zdania>",
      "weekNumber": {{weekNumber}}
    }
  ],
  "reasoning": "<wyjanienie dlaczego te tematy s odpowiednie>"
}
        `,responseFormat:"json"},inputMapping:j=>{const v=c?.data,T=m?.data||[];return{courseTitle:v?.title||"",courseDescription:v?.description||"",existingTopics:T.map(z=>z.title).join(", "),requirements:j.requirements,weekNumber:j.weekNumber}},outputMapping:j=>j,validation:j=>!!(j.newTopics&&Array.isArray(j.newTopics))}),()=>{b.unregisterOperation()}),[]);const y=async()=>{if(!n.trim()){K.error("Opisz jakie tematy chcesz doda");return}try{const j=await b.executeOperation({requirements:n,weekNumber:i});j?.newTopics&&(l(j.newTopics),K.success(`Wygenerowano ${j.newTopics.length} nowych temat贸w`))}catch(j){console.error("Bd generowania temat贸w:",j),K.error("Wystpi bd podczas generowania temat贸w")}},w=async()=>{if(o.length!==0)try{let j=p.length+1;for(const v of o)await new Promise((T,z)=>{f({resource:"topics",values:{course_id:t,title:v.title,position:j++,is_published:!1}},{onSuccess:T,onError:z})});K.success("Tematy zostay dodane do kursu"),await u(),l([]),r("")}catch(j){console.error("Bd zapisywania temat贸w:",j),K.error("Wystpi bd podczas zapisywania temat贸w")}};return d?e.jsx(G,{children:e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"})})}):e.jsx(G,{children:e.jsxs(D,{className:"border-2 shadow-lg",children:[e.jsx($,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(R,{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:h?.icon_emoji}),"Rozszerzanie kursu: ",h?.title]}),e.jsxs(I,{variant:"ghost",onClick:()=>s(-1),children:[e.jsx(Ce,{className:"w-4 h-4 mr-2"}),"Powr贸t"]})]})}),e.jsxs(P,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-medium mb-3",children:["Obecna struktura kursu (",p.length," temat贸w)"]}),e.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto border rounded-lg p-3",children:p.map((j,v)=>e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg flex items-center gap-3",children:[e.jsxs("span",{className:"text-sm text-gray-500 font-mono",children:["#",v+1]}),e.jsx("span",{className:"font-medium",children:j.title})]},j.id))})]}),e.jsxs("div",{className:"space-y-4 border-t pt-6",children:[e.jsx("h3",{className:"font-medium",children:"Dodaj nowe tematy z pomoc AI"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(re,{children:"Opisz jakie tematy chcesz doda"}),e.jsx(bt,{value:n,onChange:j=>r(j.target.value),placeholder:"np. Dodaj zaawansowane tematy z analizy matematycznej, caki i pochodne, lub tematy zwizane z uczeniem maszynowym...",rows:4,className:"font-sans"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(re,{children:"Tydzie dla nowych temat贸w"}),e.jsx(Z,{type:"number",value:i,onChange:j=>a(parseInt(j.target.value)||1),className:"w-24",min:"1"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Okrel, w kt贸rym tygodniu maj si znale藕 nowe tematy"})]}),e.jsxs(ge,{className:"bg-blue-50 border-blue-200",children:[e.jsx(qt,{className:"h-4 w-4 text-blue-600"}),e.jsx(je,{className:"text-blue-800",children:"AI przeanalizuje istniejcy kurs i zaproponuje nowe tematy kt贸re naturalnie rozszerzaj program"})]}),e.jsx(I,{onClick:y,disabled:b.loading||!n.trim(),className:"w-full bg-purple-600 hover:bg-purple-700",children:b.loading?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Generuj tematy..."]}):e.jsxs(e.Fragment,{children:[e.jsx(rt,{className:"w-4 h-4 mr-2"}),"Generuj tematy"]})})]}),o.length>0&&e.jsxs("div",{className:"space-y-4 border-t pt-6",children:[e.jsxs("h3",{className:"font-medium",children:["Wygenerowane tematy (Tydzie ",i,")"]}),e.jsx("div",{className:"space-y-2",children:o.map((j,v)=>e.jsxs("div",{className:"p-4 bg-purple-50 rounded-lg border border-purple-200",children:[e.jsx("h4",{className:"font-medium text-purple-900",children:j.title}),j.description&&e.jsx("p",{className:"text-sm text-purple-700 mt-1",children:j.description})]},v))}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(I,{variant:"outline",onClick:()=>l([]),className:"flex-1",children:"Anuluj"}),e.jsxs(I,{onClick:w,className:"flex-1 bg-green-600 hover:bg-green-700",children:[e.jsx(Ie,{className:"w-4 h-4 mr-2"}),"Dodaj tematy do kursu"]})]})]})]})]})})},jS=[e.jsx(W,{path:"/course-structure",element:e.jsx(uS,{})},"course-dashboard"),e.jsx(W,{path:"/course-structure/step1",element:e.jsx(mS,{})},"course-step1"),e.jsx(W,{path:"/course-structure/step2",element:e.jsx(hS,{})},"course-step2"),e.jsx(W,{path:"/course-structure/step3",element:e.jsx(pS,{})},"course-step3"),e.jsx(W,{path:"/course-structure/step4",element:e.jsx(fS,{})},"course-step4"),e.jsx(W,{path:"/course-structure/step5",element:e.jsx(xS,{})},"course-step5"),e.jsx(W,{path:"/course-structure/edit/:id",element:e.jsx(gS,{})},"course-edit")],$u={name:"course-structure",list:"/course-structure",create:"/course-structure/step1",meta:{canDelete:!1,label:"Generator kurs贸w",icon:e.jsx(Fi,{className:"h-4 w-4"})}},yS={id:"educational-material-wizard",title:"Kreator materia贸w edukacyjnych",schema:{step1:{title:"Podstawowe informacje",type:"object",properties:{subject:{type:"text",title:"Temat materiau",placeholder:"np. Wprowadzenie do programowania w Python"},targetLevel:{type:"select",title:"Poziom zaawansowania",options:[{value:"beginner",label:"Pocztkujcy"},{value:"intermediate",label:"redniozaawansowany"},{value:"advanced",label:"Zaawansowany"}]},ageGroup:{type:"select",title:"Grupa wiekowa",options:[{value:"7-10",label:"7-10 lat (szkoa podstawowa)"},{value:"11-14",label:"11-14 lat (klasy 4-8)"},{value:"15-18",label:"15-18 lat (szkoa rednia)"},{value:"18+",label:"18+ (doroli)"}]}},required:["subject","targetLevel","ageGroup"]},step2:{title:"Analiza tematu",type:"object",properties:{keyTopics:{type:"tags",title:"Kluczowe zagadnienia",readOnly:!0},learningObjectives:{type:"textarea",title:"Cele nauczania",readOnly:!0},prerequisites:{type:"tags",title:"Wymagania wstpne",readOnly:!0},estimatedDuration:{type:"number",title:"Szacowany czas (min)",readOnly:!0}}},step3:{title:"Dostosowanie cel贸w",type:"object",properties:{learningObjectives:{type:"textarea",title:"Cele nauczania (edytowalne)",placeholder:"Dostosuj cele nauczania...",rows:6},materialType:{type:"select",title:"Typ materiau",options:[{value:"lesson",label:"Lekcja z teori (w kontekscie materia贸w 藕r贸dowych)"},{value:"source_material",label:"Materiay 藕r贸dowe"},{value:"context",label:"Dane wejciowe - naprowadzamy na obszar tematu"}]}},required:["learningObjectives","materialType"]},step4:{title:"Podgld materiau",type:"object",properties:{title:{type:"text",title:"Tytu materiau",readOnly:!0},content:{type:"textarea",title:"Tre materiau",readOnly:!0}}},step5:{title:"Dodaj pytania kontrolne",type:"object",properties:{addQuizzes:{type:"boolean",title:"Doda pytania kontrolne?"},quizContent:{type:"textarea",title:"Pytania kontrolne",placeholder:"Tutaj dodasz pytania w formacie YAML..."}}},step6:{title:"Finalizacja",type:"object",properties:{courseId:{type:"select",title:"Wybierz kurs",placeholder:"Wybierz kurs..."},topicId:{type:"select",title:"Wybierz temat",placeholder:"Najpierw wybierz kurs..."},activityTitle:{type:"text",title:"Tytu aktywnoci",placeholder:"np. Wprowadzenie do zmiennych"},activityType:{type:"select",title:"Typ aktywnoci",options:[{value:"material",label:"Materia edukacyjny"},{value:"quiz",label:"Quiz sprawdzajcy"}]},content:{type:"textarea",title:"Tre materiau",placeholder:"Edytuj wygenerowan tre...",rows:15},duration:{type:"number",title:"Czas trwania (min)",placeholder:"15"}},required:["courseId","topicId","activityTitle","activityType","content"]}}},bS={id:"analyze-topic",name:"Analiza tematu edukacyjnego",config:{endpoint:"https://diesel-power-backend.onrender.com/api/chat"},prompt:{system:"Jeste ekspertem od edukacji i tworzenia materia贸w dydaktycznych w metodyce ODKRYWCZEJ. Analizujesz tematy pod ktem tworzenia interaktywnych materia贸w z pytaniami kontrolnymi.",user:`Przeanalizuj temat edukacyjny i zaplanuj struktur materiau w metodyce ODKRYWCZEJ:

Temat: {{subject}}
Poziom: {{targetLevel}}
Grupa wiekowa: {{ageGroup}}

Wygeneruj JSON z planem materiau:
{
  "keyTopics": ["temat1", "temat2", "temat3", "temat4", "temat5"],
  "learningObjectives": "<szczeg贸owe cele nauczania - co dokadnie ucze bdzie umia po przejciu materiau>",
  "prerequisites": ["wymaganie1", "wymaganie2"],
  "estimatedDuration": <liczba minut>
}

WA呕NE WYMAGANIA:
1. KeyTopics (5-7 temat贸w):
   - Ka偶dy temat = osobna sekcja w materiale
   - Uporzdkuj od podstaw do zaawansowanych
   - Ka偶dy temat musi by na tyle konkretny, aby mo偶na byo stworzy pytanie kontrolne
   
2. LearningObjectives (150-250 s贸w):
   - Konkretne, mierzalne umiejtnoci
   - U偶yj czasownik贸w: "bdzie potrafi", "zrozumie", "nauczy si"
   - Uwzgldnij zar贸wno wiedz teoretyczn jak i praktyczne zastosowanie
   
3. Prerequisites:
   - Dla pocztkujcych: mo偶e by puste []
   - Dla redniozaawansowanych: 2-3 wymagania
   - Dla zaawansowanych: 3-5 wymaga
   
4. EstimatedDuration:
   - Pocztkujcy: 20-40 minut
   - redniozaawansowany: 30-60 minut  
   - Zaawansowany: 45-90 minut
   - Uwzgldnij czas na przemylenie pyta kontrolnych`,responseFormat:"json"},inputMapping:t=>({subject:t.subject,targetLevel:t.targetLevel,ageGroup:t.ageGroup}),outputMapping:(t,s)=>({...s,keyTopics:t.keyTopics,learningObjectives:t.learningObjectives,prerequisites:t.prerequisites,estimatedDuration:t.estimatedDuration}),validation:t=>!!(t.keyTopics&&Array.isArray(t.keyTopics)&&t.keyTopics.length>=3&&t.learningObjectives&&t.estimatedDuration)},wS={id:"generate-material",name:"Generowanie materiau edukacyjnego",config:{endpoint:"https://diesel-power-backend.onrender.com/api/chat"},prompt:{system:"Jeste dowiadczonym nauczycielem tworzcym anga偶ujce materiay edukacyjne w metodzie ODKRYWCZEJ. Nie u偶ywaj metodyki podawczej!!!, bazujc na technice Feynmana.",user:`Wygeneruj materia edukacyjny na podstawie danych:

Dane wejciowe:
- Temat: {{subject}}
- Poziom: {{targetLevel}}
- Grupa wiekowa: {{ageGroup}}
- Cele nauczania: {{learningObjectives}}
- Typ materiau: {{materialType}}
- Kluczowe zagadnienia: {{keyTopics}}

TYPY MATERIAW:

1. Jeli materialType = "lesson" (Lekcja z teori w kontekscie materia贸w 藕r贸dowych):
   - Wyjanij teori odwoujc si do praktycznych 藕r贸de
   - Pokazuj jak teoria czy si z rzeczywistymi materiaami
   - U偶ywaj przykad贸w z dokumentacji, ksi偶ek, artyku贸w

2. Jeli materialType = "source_material" (Materiay 藕r贸dowe):
   - Skoncentruj si na analizie konkretnych materia贸w
   - Om贸w fragmenty kodu, dokumentacji, przykady
   - Wyjanij jak czyta i interpretowa 藕r贸da

3. Jeli materialType = "context" (Dane wejciowe - naprowadzanie):
   - U偶ywaj przykad贸w z dokumentacji, ksi偶ek, artyku贸w
   - Wprowad藕 ucznia w temat od podstaw
   - Wyjanij kontekst i to zagadnienia z wykorzystaniem metodyki ODKRYWCZEJ,
   - Przygotuj grunt pod gbsze zrozumienie

STRUKTURA MATERIAU:
1. U偶yj nag贸wk贸w ## dla ka偶dej sekcji (NIE #, tylko ##)
2. Stw贸rz 4-6 sekcji odpowiadajcych kluczowym zagadnieniom
3. Ka偶da sekcja powinna mie 200-400 s贸w, wprowadzenie i podsumowanie max 100-150 sow
4. U偶ywaj list, przykad贸w, pogrubie dla lepszej czytelnoci
5. NIE DODAWAJ sekcji z wiczeniami - to osobne moduy w systemie

KRYTYCZNE: Zwr贸 TYLKO czysty JSON bez 偶adnych dodatkowych znak贸w, bez blok贸w kodu markdown:
{
  "title": "<atrakcyjny tytu max 80 znak贸w>",
  "content": "<cay materia w Markdown z sekcjami ##>"
}

DOSTOSOWANIE DO WIEKU:
- 7-10 lat: Prosty jzyk, du偶o przykad贸w, kr贸tkie zdania
- 11-14 lat: redni poziom, ciekawostki, przystpne wyjanienia
- 15-18 lat: Bardziej zo偶ony jzyk, praktyczne zastosowania
- 18+: Profesjonalny jzyk, gboka analiza`,responseFormat:"json"},inputMapping:t=>({subject:t.subject,targetLevel:t.targetLevel,ageGroup:t.ageGroup,learningObjectives:t.learningObjectives,materialType:t.materialType,keyTopics:Array.isArray(t.keyTopics)?t.keyTopics.join(", "):t.keyTopics}),outputMapping:(t,s)=>{console.log("Output mapping - received llmResult:",t);let n=t.content;n&&(n=n.replace(/##\s*wiczenia[\s\S]*?(?=##|$)/gi,""),n=n.replace(/##\s*Zadania[\s\S]*?(?=##|$)/gi,""),n=n.replace(/##\s*Sprawd藕 swoj wiedz[\s\S]*?(?=##|$)/gi,""),n=n.replace(/##\s*Podsumowanie[\s\S]*?(?=##|$)/gi,""),n=n.replace(/##\s*Zakoczenie[\s\S]*?(?=##|$)/gi,""),n=n.trim());const r={...s,title:t.title,content:n};return console.log("Output mapping - mapped data:",r),r},validation:t=>{if(console.log("Validating LLM result:",t),!t.title)return console.error("Validation failed: missing title"),!1;if(!t.content)return console.error("Validation failed: missing content"),!1;const s=t.content.match(/^##\s+/gm);return!s||s.length<4?(console.error(`Validation failed: not enough sections (found ${s?.length||0}, need at least 4)`),!1):(console.log("Validation passed!"),!0)}},It={subject:{minLength:5,errorMessage:"Temat jest wymagany (5-200 znak贸w)"},activityTitle:{minLength:3,maxLength:100,errorMessage:"Tytu jest wymagany (3-100 znak贸w)"},content:{minLength:100,errorMessage:"Tre materiau jest wymagana (min. 100 znak贸w)"},duration:{min:5,max:180,errorMessage:"Czas trwania musi by midzy 5 a 180 minut"}},$n={steps:{1:{title:"O czym chcesz stworzy materia?",description:"Podaj temat, poziom zaawansowania i grup docelow - AI pomo偶e stworzy anga偶ujcy materia edukacyjny",button:"Analizuj temat",loading:"Analizuj temat..."},2:{title:"Analiza tematu",description:"AI przeanalizowaa temat i zaproponowaa struktur materiau",success:" Analiza zakoczona pomylnie"},3:{title:"Dostosuj cele i typ materiau",description:"Mo偶esz zmodyfikowa cele nauczania i wybra typ materiau do wygenerowania",button:"Generuj materia",loading:"Generuj materia...",loadingInfo:" AI tworzy spersonalizowany materia edukacyjny..."},4:{title:"Podgld wygenerowanego materiau",description:"AI przygotowaa kompletny materia edukacyjny",info:" W nastpnym kroku mo偶esz doda pytania kontrolne."},5:{title:"Dodaj pytania kontrolne",description:"Mo偶esz opcjonalnie doda pytania kontrolne do wybranych sekcji materiau",info:" Pytania kontrolne pomagaj uczniom lepiej zrozumie materia",button:"Przejd藕 dalej"},6:{title:"Zapisz materia w kursie",description:"Wybierz kurs i temat, nastpnie dostosuj materia przed zapisaniem",saveInfo:" Materia zostanie zapisany jako nowa aktywno w wybranym temacie",button:"Zapisz materia",loading:"Zapisuj...",success:" Materia zosta zapisany pomylnie! Przekierowuj do kursu..."}},dashboard:{title:"Kreator materia贸w edukacyjnych",description:"Tw贸rz anga偶ujce materiay z pomoc AI",features:["Automatyczna analiza tematu","Dostosowanie do wieku uczni贸w","Generowanie cel贸w nauczania","Formatowanie Markdown","Integracja z kursami"]},errors:{subjectRequired:"Podaj temat materiau",analysisError:"Bd analizy tematu:",generationError:"Bd generowania materiau:",saveError:"Wystpi bd podczas zapisu",unexpectedError:"Wystpi nieoczekiwany bd",noCourses:"Nie znaleziono 偶adnych kurs贸w",noTopics:"Wybierz najpierw kurs"}},pt={dashboard:"/teacher/educational-material",step1:"/teacher/educational-material/step1",step2:"/teacher/educational-material/step2",step3:"/teacher/educational-material/step3",step4:"/teacher/educational-material/step4",step5:"/teacher/educational-material/step5",step6:"/teacher/educational-material/step6",courses:"/teacher/courses"},vS=()=>{const t=se(),{getData:s}=Ke(),n=s("educational-material-wizard"),{dashboard:r}=$n,i=n&&n.title;return e.jsxs(G,{children:[e.jsx(_e,{title:r.title,description:r.description}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs(D,{className:"hover:shadow-lg transition-all cursor-pointer border-2 hover:border-purple-400 flex flex-col",onClick:()=>t(pt.step1),children:[e.jsxs($,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:e.jsx(Tr,{className:"w-8 h-8 text-purple-600"})}),e.jsx(le,{className:"w-5 h-5 text-gray-400"})]}),e.jsx(R,{children:"Stw贸rz nowy materia"}),e.jsx(Oe,{children:"Wygeneruj kompletny materia edukacyjny z pomoc AI"})]}),e.jsxs(P,{className:"flex-1 flex flex-col",children:[e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"w-4 h-4 text-purple-600"}),e.jsx("span",{children:"5-10 minut"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(it,{className:"w-4 h-4 text-purple-600"}),e.jsx("span",{children:"Pena tre"})]})]}),e.jsx("div",{className:"mt-auto pt-4",children:e.jsxs("div",{className:"inline-flex items-center text-sm font-medium text-purple-600",children:["Rozpocznij tworzenie",e.jsx(le,{className:"w-4 h-4 ml-1"})]})})]})]}),e.jsxs(D,{className:"hover:shadow-lg transition-all border-2 border-gray-200 flex flex-col",children:[e.jsxs($,{children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:e.jsx(Se,{className:"w-8 h-8 text-blue-600"})})}),e.jsx(R,{children:"Funkcje AI"}),e.jsx(Oe,{children:"Co potrafi kreator materia贸w"})]}),e.jsx(P,{className:"flex-1",children:e.jsx("div",{className:"space-y-2",children:r.features.map((a,o)=>e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Ve,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),e.jsx("span",{children:a})]},o))})})]})]}),i&&e.jsxs(D,{className:"hover:shadow-lg transition-shadow border-2 border-gray-200",children:[e.jsx($,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(R,{className:"text-lg",children:"Ostatni materia"}),e.jsx(Oe,{children:"Kontynuuj prac nad materiaem"})]}),e.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm",children:"Wygenerowany"})]})}),e.jsx(P,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Tytu materiau"}),e.jsx("p",{className:"font-medium text-gray-900",children:n.title})]}),n.subject&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Temat"}),e.jsx("p",{className:"text-gray-900",children:n.subject})]}),n.targetLevel&&e.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-3 border-t",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-indigo-600",children:n.targetLevel==="beginner"?"Pocztkujcy":n.targetLevel==="intermediate"?"redni":"Zaawansowany"}),e.jsx("div",{className:"text-sm text-gray-600",children:"poziom"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:n.estimatedDuration||30}),e.jsx("div",{className:"text-sm text-gray-600",children:"minut"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[e.jsxs(I,{variant:"outline",onClick:()=>t(pt.step4),className:"flex-1",children:[e.jsx(Je,{className:"w-4 h-4 mr-2"}),"Podgld"]}),e.jsxs(I,{variant:"outline",onClick:()=>t(pt.step5),className:"flex-1",children:[e.jsx(Ea,{className:"w-4 h-4 mr-2"}),"Edytuj"]}),e.jsxs(I,{variant:"outline",onClick:()=>t(pt.step1),className:"flex-1",children:[e.jsx(xr,{className:"w-4 h-4 mr-2"}),"Nowy"]})]})]})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(D,{className:"hover:shadow-lg transition-shadow cursor-pointer border-2 border-blue-200 group",onClick:()=>t("/teacher/courses"),children:[e.jsxs($,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:e.jsx(ye,{className:"w-6 h-6 text-blue-600"})}),e.jsx(le,{className:"w-5 h-5 text-gray-400 group-hover:translate-x-1 transition-transform"})]}),e.jsx(R,{className:"text-lg",children:"Kursy"}),e.jsx(Oe,{children:"Zobacz wszystkie kursy"})]}),e.jsx(P,{children:e.jsx("p",{className:"text-xs text-gray-500 group-hover:text-blue-600 transition-colors",children:"Kliknij aby przej "})})]}),e.jsxs(D,{className:"hover:shadow-lg transition-shadow cursor-pointer border-2 border-purple-200 group",onClick:()=>t("/teacher/course-structure"),children:[e.jsxs($,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:e.jsx(tn,{className:"w-6 h-6 text-purple-600"})}),e.jsx(le,{className:"w-5 h-5 text-gray-400 group-hover:translate-x-1 transition-transform"})]}),e.jsx(R,{className:"text-lg",children:"Generator kurs贸w"}),e.jsx(Oe,{children:"Kreator struktury"})]}),e.jsx(P,{children:e.jsx("p",{className:"text-xs text-gray-500 group-hover:text-purple-600 transition-colors",children:"Kliknij aby przej "})})]}),e.jsxs(D,{className:"hover:shadow-lg transition-shadow cursor-pointer border-2 border-green-200 group",onClick:()=>t("/teacher/quiz-wizard"),children:[e.jsxs($,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:e.jsx(Tt,{className:"w-6 h-6 text-green-600"})}),e.jsx(le,{className:"w-5 h-5 text-gray-400 group-hover:translate-x-1 transition-transform"})]}),e.jsx(R,{className:"text-lg",children:"Quizy"}),e.jsx(Oe,{children:"Kreator quiz贸w"})]}),e.jsx(P,{children:e.jsx("p",{className:"text-xs text-gray-500 group-hover:text-green-600 transition-colors",children:"Kliknij aby przej "})})]})]})]})]})},Mr=({step:t})=>{const s=se(),n=t/5*100;return e.jsxs(e.Fragment,{children:[e.jsx(I,{variant:"ghost",size:"icon",className:"absolute top-4 right-4 hover:bg-gray-100",onClick:()=>s("/teacher/educational-material"),children:e.jsx(dt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-violet-600 text-white p-8 space-y-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h1",{className:"text-4xl font-black tracking-tight",children:"KREATOR MATERIAW"}),e.jsxs("h2",{className:"text-2xl font-light",children:["Stw贸rzmy razem ",e.jsx("span",{className:"font-bold",children:"anga偶ujcy materia"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{children:["Krok ",t," z 5"]}),e.jsxs("span",{children:[n,"%"]})]}),e.jsx(Qt,{value:n,className:"h-2 bg-purple-300"})]})]})]})},Ir=({title:t,description:s})=>e.jsxs("header",{className:"mb-8",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2 flex items-center gap-3",children:t}),e.jsx("p",{className:"text-gray-600",children:s})]}),NS=()=>{const t=se(),{register:s,setData:n,getData:r}=Ke(),i=r("educational-material-wizard"),[a,o]=x.useState(""),[l,c]=x.useState(""),[d,m]=x.useState(""),[u,h]=x.useState(""),[p,b]=x.useState(""),[f,y]=x.useState({}),[w,j]=x.useState(null),[v,T]=x.useState(!1),z=Pn("educational-material-wizard","analyze-topic"),{steps:k,errors:N}=$n,{data:S,isLoading:_}=Y({resource:"courses",meta:{select:"*, topics(*)"},sorters:[{field:"created_at",order:"desc"}]}),g=S?.data?.find(M=>M.id.toString()===a),C=g?.topics||[];x.useEffect(()=>(s(yS),z.registerOperation(bS),()=>{z.unregisterOperation()}),[]),x.useEffect(()=>{if(!v&&S?.data){let M="",O="",Q="";const L=sessionStorage.getItem("wizardContext");if(L)try{const U=JSON.parse(L);j(U),U.courseId&&(M=U.courseId.toString()),U.topicId&&(O=U.topicId.toString()),U.topicTitle&&(Q=U.topicTitle)}catch(U){console.error("Error parsing wizard context:",U)}!M&&i&&(i.courseId&&(M=i.courseId.toString()),i.topicId&&(O=i.topicId.toString()),i.subject&&(Q=i.subject),i.targetLevel&&h(i.targetLevel),i.ageGroup&&b(i.ageGroup)),M&&o(M),O&&c(O),Q&&m(Q),T(!0)}},[S,v,i]),x.useEffect(()=>{if(l&&C.length>0){const M=C.find(O=>O.id.toString()===l);M&&m(M.title)}},[l,C]);const A=()=>{const M={};return a||(M.courseId="Wybierz kurs"),l||(M.topicId="Wybierz temat z kursu"),(!d.trim()||d.length<It.subject.minLength)&&(M.subject=It.subject.errorMessage),u||(M.targetLevel="Wybierz poziom zaawansowania"),p||(M.ageGroup="Wybierz grup wiekow"),y(M),Object.keys(M).length===0},E=async()=>{if(A())try{const M={courseId:parseInt(a),topicId:parseInt(l),subject:d.trim(),targetLevel:u,ageGroup:p,courseTitle:g?.title,topicTitle:C.find(O=>O.id.toString()===l)?.title};n("educational-material-wizard",M),await z.executeOperation(M),t(pt.step2)}catch(M){console.error(N.analysisError,M)}};return e.jsx(G,{children:e.jsxs(D,{className:"border-2 shadow-lg",children:[e.jsx(Mr,{step:1}),e.jsxs(P,{className:"p-8",children:[e.jsx(Ir,{title:k[1].title,description:k[1].description}),w&&e.jsxs(ge,{className:"mb-6 bg-blue-50 border-blue-200",children:[e.jsx(qt,{className:"h-4 w-4 text-blue-600"}),e.jsxs(je,{className:"text-blue-800",children:["Tworzysz materia dla: ",e.jsx("strong",{children:w.courseTitle}),w.topicTitle&&e.jsxs(e.Fragment,{children:["  ",e.jsx("strong",{children:w.topicTitle})]})]})]}),z.error&&e.jsxs(ge,{variant:"destructive",className:"mb-6",children:[e.jsx(yt,{className:"h-4 w-4"}),e.jsxs(je,{children:[N.analysisError," ",z.error]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(D,{className:"border-2 border-purple-200 bg-purple-50/50",children:e.jsxs(P,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(ye,{className:"w-5 h-5 text-purple-600"}),e.jsx("h3",{className:"font-semibold",children:"Wybierz miejsce w kursie"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(re,{htmlFor:"courseId",children:["Kurs ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(fe,{value:a,onValueChange:M=>{o(M),c(""),m("")},disabled:z.loading||_,children:[e.jsx(me,{className:f.courseId?"border-red-500":"",children:e.jsx(xe,{placeholder:"Wybierz kurs..."})}),e.jsx(he,{children:S?.data?.map(M=>e.jsx(V,{value:M.id.toString(),children:e.jsxs("div",{className:"flex items-center gap-2",children:[M.icon_emoji&&e.jsx("span",{children:M.icon_emoji}),e.jsx("span",{children:M.title}),!M.is_published&&e.jsx("span",{className:"text-xs text-muted-foreground",children:"(szkic)"})]})},M.id))})]}),f.courseId&&e.jsx("p",{className:"text-sm text-red-600",children:f.courseId})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(re,{htmlFor:"topicId",children:["Temat ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(fe,{value:l,onValueChange:c,disabled:!a||z.loading,children:[e.jsx(me,{className:f.topicId?"border-red-500":"",children:e.jsx(xe,{placeholder:a?"Wybierz temat...":"Najpierw wybierz kurs..."})}),e.jsx(he,{children:C.sort((M,O)=>M.position-O.position).map(M=>e.jsx(V,{value:M.id.toString(),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{children:[M.position,". ",M.title]}),M.is_published===!1&&e.jsx("span",{className:"text-xs text-muted-foreground",children:"(szkic)"})]})},M.id))})]}),f.topicId&&e.jsx("p",{className:"text-sm text-red-600",children:f.topicId})]})]})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(re,{htmlFor:"subject",children:"Temat materiau"}),e.jsx(Z,{id:"subject",type:"text",value:d,onChange:M=>m(M.target.value),placeholder:"np. Wprowadzenie do programowania w Python",disabled:z.loading,className:f.subject?"border-red-500":""}),f.subject&&e.jsx("p",{className:"text-sm text-red-600",children:f.subject}),e.jsx("p",{className:"text-sm text-gray-500",children:"Mo偶esz dostosowa temat materiau lub pozostawi sugerowany"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(re,{htmlFor:"targetLevel",children:"Poziom zaawansowania"}),e.jsxs(fe,{value:u,onValueChange:h,disabled:z.loading,children:[e.jsx(me,{className:f.targetLevel?"border-red-500":"",children:e.jsx(xe,{placeholder:"Wybierz poziom..."})}),e.jsxs(he,{children:[e.jsx(V,{value:"beginner",children:"Pocztkujcy"}),e.jsx(V,{value:"intermediate",children:"redniozaawansowany"}),e.jsx(V,{value:"advanced",children:"Zaawansowany"})]})]}),f.targetLevel&&e.jsx("p",{className:"text-sm text-red-600",children:f.targetLevel})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(re,{htmlFor:"ageGroup",children:"Grupa wiekowa"}),e.jsxs(fe,{value:p,onValueChange:b,disabled:z.loading,children:[e.jsx(me,{className:f.ageGroup?"border-red-500":"",children:e.jsx(xe,{placeholder:"Wybierz grup wiekow..."})}),e.jsxs(he,{children:[e.jsx(V,{value:"7-10",children:"7-10 lat (szkoa podstawowa)"}),e.jsx(V,{value:"11-14",children:"11-14 lat (klasy 4-8)"}),e.jsx(V,{value:"15-18",children:"15-18 lat (szkoa rednia)"}),e.jsx(V,{value:"18+",children:"18+ (doroli)"})]})]}),f.ageGroup&&e.jsx("p",{className:"text-sm text-red-600",children:f.ageGroup})]}),e.jsx(I,{onClick:E,disabled:z.loading,className:"w-full bg-purple-600 hover:bg-purple-700 text-white",size:"lg",children:z.loading?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),k[1].loading]}):e.jsxs(e.Fragment,{children:[e.jsx(rt,{className:"w-4 h-4 mr-2"}),k[1].button]})})]})]})]})})},kS=()=>{const t=se(),{getData:s}=Ke(),n=s("educational-material-wizard"),{steps:r}=$n;return e.jsx(G,{children:e.jsxs(D,{className:"border-2 shadow-lg",children:[e.jsx(Mr,{step:2}),e.jsxs(P,{className:"p-8",children:[e.jsx(Ir,{title:r[2].title,description:r[2].description}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(ge,{className:"bg-green-50 border-green-200",children:[e.jsx(Re,{className:"h-4 w-4 text-green-600"}),e.jsx(je,{className:"text-green-800",children:r[2].success})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(D,{className:"bg-gray-50 border-gray-200",children:e.jsxs(P,{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Temat"}),e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:n.subject})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Cele nauczania"}),e.jsx("div",{className:"text-gray-800 whitespace-pre-wrap",children:n.learningObjectives})]})]})}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(D,{className:"border-purple-200 bg-purple-50/50",children:e.jsx(P,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Se,{className:"w-5 h-5 text-purple-600 mt-1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Kluczowe zagadnienia"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:n.keyTopics?.map((i,a)=>e.jsx("span",{className:"px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm",children:i},a))})]})]})})}),e.jsx(D,{className:"border-blue-200 bg-blue-50/50",children:e.jsx(P,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Te,{className:"w-5 h-5 text-blue-600 mt-1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Informacje"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Czas trwania:"})," ",n.estimatedDuration," minut"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Poziom:"})," ",n.targetLevel==="beginner"?"Pocztkujcy":n.targetLevel==="intermediate"?"redniozaawansowany":"Zaawansowany"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Grupa wiekowa:"})," ",n.ageGroup]})]})]})]})})})]}),e.jsx(D,{children:e.jsxs(P,{className:"p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Wymagania wstpne"}),n.prerequisites?.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:n.prerequisites.map((i,a)=>e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm",children:i},a))}):e.jsx("span",{className:"text-sm text-gray-500",children:"Brak wymaga wstpnych"})]})})]}),e.jsxs("div",{className:"flex justify-between pt-6",children:[e.jsx(I,{variant:"outline",onClick:()=>t(pt.step1),children:"Wstecz"}),e.jsx(I,{onClick:()=>t(pt.step3),className:"bg-purple-600 hover:bg-purple-700",children:"Kontynuuj"})]})]})]})]})})},zS=()=>{const t=se(),{getData:s,setData:n}=Ke(),r=s("educational-material-wizard"),[i,a]=x.useState(r.learningObjectives||""),[o,l]=x.useState(r.materialType||"lesson"),[c,d]=x.useState({}),m=Pn("educational-material-wizard","generate-material"),{steps:u,errors:h}=$n;x.useEffect(()=>(m.registerOperation(wS),()=>{m.unregisterOperation()}),[]);const p=()=>{const f={};return i.trim()||(f.learningObjectives="Cele nauczania s wymagane"),o||(f.materialType="Wybierz typ materiau"),d(f),Object.keys(f).length===0},b=async()=>{if(p())try{const f={...r,learningObjectives:i.trim(),materialType:o};n("educational-material-wizard",f);const y=await m.executeOperation(f);y?(console.log("Material generated successfully:",y),t(pt.step4)):(console.error("No result from LLM operation"),d({general:"Nie udao si wygenerowa materiau - brak wyniku"}))}catch(f){console.error("Full error details:",f);const y=f.message||f.toString()||"Nieznany bd";console.error(h.generationError,y),d({general:`${h.generationError} ${y}`})}};return e.jsx(G,{children:e.jsxs(D,{className:"border-2 shadow-lg",children:[e.jsx(Mr,{step:3}),e.jsxs(P,{className:"p-8",children:[e.jsx(Ir,{title:u[3].title,description:u[3].description}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(re,{htmlFor:"learningObjectives",children:["Cele nauczania ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(bt,{id:"learningObjectives",value:i,onChange:f=>a(f.target.value),placeholder:"Dostosuj cele nauczania...",rows:6,className:c.learningObjectives?"border-red-500":""}),c.learningObjectives&&e.jsx("p",{className:"text-sm text-red-600",children:c.learningObjectives}),e.jsx("p",{className:"text-sm text-gray-500",children:"Mo偶esz edytowa automatycznie wygenerowane cele"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(re,{htmlFor:"materialType",children:["Typ materiau ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(fe,{value:o,onValueChange:l,children:[e.jsx(me,{className:c.materialType?"border-red-500":"",children:e.jsx(xe,{placeholder:"Wybierz typ materiau..."})}),e.jsxs(he,{children:[e.jsx(V,{value:"lesson",children:"Lekcja z teori (w kontekscie materia贸w 藕r贸dowych)"}),e.jsx(V,{value:"source_material",children:"Materiay 藕r贸dowe"}),e.jsx(V,{value:"context",children:"Dane wejciowe - naprowadzamy na obszar tematu"})]})]}),c.materialType&&e.jsx("p",{className:"text-sm text-red-600",children:c.materialType})]}),m.loading&&e.jsxs(ge,{className:"bg-purple-50 border-purple-200",children:[e.jsx(qt,{className:"h-4 w-4 text-purple-600"}),e.jsx(je,{className:"text-purple-800",children:u[3].loadingInfo})]}),(m.error||c.general)&&e.jsx(ge,{variant:"destructive",children:e.jsx(je,{children:c.general||m.error})}),e.jsxs("div",{className:"flex justify-between pt-6",children:[e.jsx(I,{variant:"outline",onClick:()=>t(pt.step2),children:"Wstecz"}),e.jsx(I,{onClick:b,disabled:m.loading,className:"bg-purple-600 hover:bg-purple-700",children:m.loading?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),u[3].loading]}):e.jsxs(e.Fragment,{children:[e.jsx(rt,{className:"w-4 h-4 mr-2"}),u[3].button]})})]})]})]})]})})},SS=()=>{const t=se(),{getData:s}=Ke(),n=s("educational-material-wizard"),{steps:r}=$n;return e.jsx(G,{children:e.jsxs(D,{className:"border-2 shadow-lg",children:[e.jsx(Mr,{step:4}),e.jsxs(P,{className:"p-8",children:[e.jsx(Ir,{title:e.jsxs(e.Fragment,{children:[e.jsx(Je,{className:"w-8 h-8 text-purple-600"}),e.jsx("span",{children:r[4].title})]}),description:r[4].description}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(D,{className:"bg-gradient-to-r from-purple-50 to-violet-50 border-purple-200",children:e.jsxs(P,{className:"p-6",children:[e.jsx("h4",{className:"font-semibold text-lg mb-3",children:n.title}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(it,{className:"w-8 h-8 text-indigo-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-indigo-600",children:n.materialType==="lesson"?"Lekcja":n.materialType==="source_material"?"Materiay 藕r贸dowe":"Kontekst"}),e.jsx("div",{className:"text-sm text-gray-600",children:"typ materiau"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(ye,{className:"w-8 h-8 text-purple-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:n.estimatedDuration}),e.jsx("div",{className:"text-sm text-gray-600",children:"minut"})]})]})]})}),e.jsx("h4",{className:"font-semibold text-lg",children:"Tre materiau - podgld"}),e.jsxs(D,{className:"overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-indigo-50 to-purple-50 px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(it,{className:"w-5 h-5 text-indigo-600"}),e.jsx("h5",{className:"font-medium",children:"G贸wna tre"}),e.jsxs(H,{variant:"secondary",children:[n.content?.length||0," znak贸w"]})]})}),e.jsx(P,{className:"p-4",children:e.jsx("div",{className:"prose prose-sm max-w-none max-h-96 overflow-y-auto",children:e.jsx(Ma,{children:n.content})})})]}),e.jsxs(ge,{className:"bg-blue-50 border-blue-200",children:[e.jsx(qt,{className:"h-4 w-4 text-blue-600"}),e.jsx(je,{className:"text-blue-800",children:r[4].info})]}),e.jsxs("div",{className:"flex justify-between pt-6",children:[e.jsx(I,{variant:"outline",onClick:()=>t(pt.step3),children:"Wstecz"}),e.jsx(I,{onClick:()=>t(pt.step5),className:"bg-purple-600 hover:bg-purple-700",children:"Przejd藕 do zapisywania"})]})]})]})]})})},CS=()=>{const t=se(),{getData:s,setData:n}=Ke(),r=s("educational-material-wizard"),{steps:i}=$n,[a,o]=x.useState(!1),[l,c]=x.useState([]),d=ne.useMemo(()=>{if(!r.content)return[];const y=r.content.match(/^##\s+(.+)$/gm);return y?y.map(w=>w.replace(/^##\s+/,"")):[]},[r.content]),m=()=>{const y={sectionIndex:0,sectionTitle:d[0]||"",question:"",options:["","","",""],answerIndex:0};c([...l,y])},u=y=>{c(l.filter((w,j)=>j!==y))},h=(y,w,j)=>{const v=[...l];v[y]={...v[y],[w]:j},c(v)},p=(y,w,j)=>{const v=[...l];v[y].options[w]=j,c(v)},b=()=>{if(!a||l.length===0)return r.content;let y=r.content;return[...l].sort((j,v)=>v.sectionIndex-j.sectionIndex).forEach(j=>{if(j.question&&j.options.every(v=>v)){const v=`

\`\`\`quiz
question: "${j.question}"
options:
${j.options.map(k=>`  - "${k}"`).join(`
`)}
answerIndex: ${j.answerIndex}
\`\`\``,T=`## ${d[j.sectionIndex]}`,z=y.indexOf(T);if(z!==-1){const k=y.indexOf(`
##`,z+1),N=k!==-1?k:y.length;y=y.slice(0,N)+v+y.slice(N)}}}),y},f=()=>{const y=b();n("educational-material-wizard",{...r,content:y,quizzesAdded:a&&l.length>0}),t(pt.step6)};return e.jsx(G,{children:e.jsxs(D,{className:"border-2 shadow-lg",children:[e.jsx(Mr,{step:5}),e.jsxs(P,{className:"p-8",children:[e.jsx(Ir,{title:i[5].title,description:i[5].description}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(ge,{className:"bg-blue-50 border-blue-200",children:[e.jsx(qt,{className:"h-4 w-4 text-blue-600"}),e.jsx(je,{className:"text-blue-800",children:i[5].info})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-gray-50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(at,{className:"w-5 h-5 text-purple-600"}),e.jsx(re,{htmlFor:"add-quizzes",className:"text-base font-medium cursor-pointer",children:"Doda pytania kontrolne do materiau?"})]}),e.jsx(es,{id:"add-quizzes",checked:a,onCheckedChange:o})]}),a&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h4",{className:"font-semibold",children:"Pytania kontrolne"}),e.jsxs(I,{type:"button",variant:"outline",size:"sm",onClick:m,disabled:l.length>=3,children:[e.jsx(Ie,{className:"w-4 h-4 mr-2"}),"Dodaj pytanie"]})]}),l.length===0?e.jsx(D,{className:"border-dashed",children:e.jsx(P,{className:"p-8 text-center text-gray-500",children:'Kliknij "Dodaj pytanie" aby stworzy pierwsze pytanie kontrolne'})}):e.jsx("div",{className:"space-y-6",children:l.map((y,w)=>e.jsx(D,{className:"border-purple-200",children:e.jsxs(P,{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("h5",{className:"font-medium text-purple-700",children:["Pytanie ",w+1]}),e.jsx(I,{type:"button",variant:"ghost",size:"sm",onClick:()=>u(w),children:e.jsx(ls,{className:"w-4 h-4 teaxt-red-500"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(re,{children:"Sekcja"}),e.jsx("select",{className:"w-full p-2 border rounded",value:y.sectionIndex,onChange:j=>h(w,"sectionIndex",parseInt(j.target.value)),children:d.map((j,v)=>e.jsx("option",{value:v,children:j},v))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(re,{children:"Pytanie"}),e.jsx(bt,{placeholder:"Wpisz tre pytania...",value:y.question,onChange:j=>h(w,"question",j.target.value),rows:2})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(re,{children:"Opcje odpowiedzi"}),y.options.map((j,v)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:`correct-${w}`,checked:y.answerIndex===v,onChange:()=>h(w,"answerIndex",v)}),e.jsx("input",{type:"text",className:"flex-1 p-2 border rounded",placeholder:`Opcja ${v+1}`,value:j,onChange:T=>p(w,v,T.target.value)})]},v))]})]})},w))})]}),l.length>0&&e.jsxs(ge,{className:"bg-green-50 border-green-200",children:[e.jsx(hp,{className:"text-green-800",children:"Format YAML"}),e.jsx(je,{className:"text-green-700 font-mono text-xs whitespace-pre",children:`\`\`\`quiz
question: "Tre pytania?"
options:
  - "Opcja 1"
  - "Opcja 2"
  - "Opcja 3"
  - "Opcja 4"
answerIndex: 0
\`\`\``})]})]}),e.jsxs("div",{className:"flex justify-between pt-6",children:[e.jsx(I,{variant:"outline",onClick:()=>t(pt.step4),children:"Wstecz"}),e.jsx(I,{onClick:f,className:"bg-purple-600 hover:bg-purple-700",children:i[5].button})]})]})]})]})})},TS=()=>{const t=se(),{getData:s,setData:n}=Ke(),{mutate:r}=os(),i=s("educational-material-wizard"),[a,o]=x.useState(i.title||""),[l,c]=x.useState(i.content||""),[d,m]=x.useState(i.estimatedDuration||30),[u,h]=x.useState({}),[p,b]=x.useState(!1),[f,y]=x.useState(!1),{steps:w,errors:j}=$n,{data:v}=Y({resource:"activities",filters:[{field:"topic_id",operator:"eq",value:i.topicId}],sorters:[{field:"position",order:"desc"}],pagination:{pageSize:1},queryOptions:{enabled:!!i.topicId}}),T=v?.data?.[0]?.position?v.data[0].position+1:1,z=()=>{const N={};return(!a.trim()||a.length<It.activityTitle.minLength)&&(N.activityTitle=It.activityTitle.errorMessage),(!l.trim()||l.length<It.content.minLength)&&(N.content=It.content.errorMessage),(!d||d<It.duration.min||d>It.duration.max)&&(N.duration=It.duration.errorMessage),h(N),Object.keys(N).length===0},k=async()=>{if(z()){b(!0),y(!1);try{r({resource:"activities",values:{topic_id:i.topicId,type:"material",title:a.trim(),content:l.trim(),position:T,duration_min:d,is_published:!1}},{onSuccess:N=>{n("educational-material-wizard",{...i,activityTitle:a.trim(),content:l.trim(),activityId:N.data.id,saved:!0}),b(!1),y(!0);const S=sessionStorage.getItem("returnUrl");setTimeout(()=>{sessionStorage.removeItem("wizardContext"),S?(sessionStorage.removeItem("returnUrl"),t(S)):t(`${pt.courses}/show/${i.courseId}?expanded=${i.topicId}`)},1e3)},onError:N=>{b(!1),console.error(j.saveError,N),N?.code==="42501"?K.error("Brak uprawnie do tworzenia materia贸w. Sprawd藕 swoje uprawnienia."):N?.code==="23505"?K.error("Materia o takiej nazwie ju偶 istnieje."):K.error(j.saveError)}})}catch(N){b(!1),console.error(j.unexpectedError,N),K.error(j.unexpectedError)}}};return e.jsx(G,{children:e.jsxs(D,{className:"border-2 shadow-lg",children:[e.jsx(Mr,{step:6}),e.jsxs(P,{className:"p-8",children:[e.jsx(Ir,{title:e.jsxs(e.Fragment,{children:[e.jsx(it,{className:"w-8 h-8 text-purple-600"}),e.jsx("span",{children:w[6].title})]}),description:w[6].description}),f&&e.jsxs(ge,{className:"mb-6 bg-green-50 border-green-200",children:[e.jsx(Re,{className:"h-4 w-4 text-green-600"}),e.jsx(je,{className:"text-green-800",children:w[6].success})]}),e.jsxs("form",{className:"space-y-6",onSubmit:N=>{N.preventDefault(),k()},children:[e.jsx(D,{className:"bg-gradient-to-r from-purple-50 to-violet-50 border-purple-200",children:e.jsxs(P,{className:"p-4",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Miejsce docelowe materiau:"}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-700",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(Re,{className:"w-4 h-4 text-green-600 mt-0.5"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Kurs:"})," ",i.courseTitle]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(Re,{className:"w-4 h-4 text-green-600 mt-0.5"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Temat:"})," ",i.topicTitle]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(Re,{className:"w-4 h-4 text-green-600 mt-0.5"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Pozycja:"})," ",T]})]}),i.quizzesAdded&&e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(Re,{className:"w-4 h-4 text-green-600 mt-0.5"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Pytania kontrolne:"})," Dodane"]})]})]})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(re,{htmlFor:"activityTitle",children:["Tytu aktywnoci ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(Z,{id:"activityTitle",type:"text",value:a,onChange:N=>o(N.target.value),placeholder:"np. Wprowadzenie do zmiennych",maxLength:It.activityTitle.maxLength,className:u.activityTitle?"border-red-500":""}),u.activityTitle&&e.jsx("p",{className:"text-sm text-red-600",children:u.activityTitle})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(re,{htmlFor:"duration",children:["Czas trwania (min) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(Z,{id:"duration",type:"number",value:d,onChange:N=>m(parseInt(N.target.value)||0),min:It.duration.min,max:It.duration.max,className:`w-24 ${u.duration?"border-red-500":""}`}),u.duration&&e.jsx("p",{className:"text-sm text-red-600",children:u.duration}),e.jsx("p",{className:"text-sm text-gray-500",children:"Okrel przewidywany czas realizacji materiau"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(re,{htmlFor:"content",children:["Tre materiau ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(bt,{id:"content",value:l,onChange:N=>c(N.target.value),placeholder:"Tre materiau w formacie Markdown...",rows:15,className:`font-mono text-sm ${u.content?"border-red-500":""}`}),u.content&&e.jsx("p",{className:"text-sm text-red-600",children:u.content}),e.jsxs("p",{className:"text-sm text-gray-500",children:[l.length," znak贸w (minimum ",It.content.minLength,")"]})]}),e.jsx(ge,{className:"bg-purple-50 border-purple-200",children:e.jsx(je,{className:"text-purple-800",children:w[6].saveInfo})}),e.jsx(Mn,{}),e.jsxs("footer",{className:"flex justify-between gap-4",children:[e.jsxs(I,{type:"button",variant:"outline",onClick:()=>t(pt.step5),disabled:p,className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"w-4 h-4"}),"Wstecz"]}),e.jsx(I,{type:"submit",disabled:p||f,className:"flex items-center gap-2 min-w-[160px] bg-purple-600 hover:bg-purple-700",children:p?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),w[6].loading]}):e.jsxs(e.Fragment,{children:[e.jsx(Ui,{className:"w-4 h-4"}),w[6].button]})})]})]})]})]})})},_S=[e.jsx(W,{path:"/educational-material",element:e.jsx(vS,{})},"material-dashboard"),e.jsx(W,{path:"/educational-material/step1",element:e.jsx(NS,{})},"material-step1"),e.jsx(W,{path:"/educational-material/step2",element:e.jsx(kS,{})},"material-step2"),e.jsx(W,{path:"/educational-material/step3",element:e.jsx(zS,{})},"material-step3"),e.jsx(W,{path:"/educational-material/step4",element:e.jsx(SS,{})},"material-step4"),e.jsx(W,{path:"/educational-material/step5",element:e.jsx(CS,{})},"material-step5"),e.jsx(W,{path:"/educational-material/step6",element:e.jsx(TS,{})},"material-step6")],qu={name:"educational-materials",list:"/educational-material",create:"/educational-material/step1",meta:{canDelete:!1,label:"Kreator materia贸w",icon:e.jsx(Fi,{className:"h-4 w-4"})}},AS={id:"quiz-wizard",title:"Kreator quiz贸w",schema:{step1:{title:"Podstawowe informacje o quizie",type:"object",properties:{topic:{type:"text",title:"Temat quizu",placeholder:"np. Podstawy programowania w Python"},difficulty:{type:"select",title:"Poziom trudnoci",options:[{value:"easy",label:"atwy"},{value:"medium",label:"redni"},{value:"hard",label:"Trudny"}]},questionsCount:{type:"number",title:"Liczba pyta",placeholder:"10",min:5,max:30},questionTypes:{type:"multiselect",title:"Typy pyta",options:[{value:"single",label:"Jednokrotny wyb贸r"},{value:"multiple",label:"Wielokrotny wyb贸r"},{value:"truefalse",label:"Prawda/Fasz"}]}},required:["topic","difficulty","questionsCount"]},step2:{title:"Analiza tematu",type:"object",properties:{keyTopics:{type:"tags",title:"Kluczowe zagadnienia",readOnly:!0},learningObjectives:{type:"textarea",title:"Cele sprawdzajce",readOnly:!0},suggestedTime:{type:"number",title:"Sugerowany czas (min)",readOnly:!0},passingScore:{type:"number",title:"Pr贸g zaliczenia (%)",readOnly:!0}}},step3:{title:"Parametry quizu",type:"object",properties:{quizTitle:{type:"text",title:"Tytu quizu",placeholder:"np. Test wiedzy - Zmienne i typy danych"},passingScore:{type:"number",title:"Pr贸g zaliczenia (%)",placeholder:"70",min:50,max:100},timeLimit:{type:"number",title:"Limit czasu (min)",placeholder:"Pozostaw puste dla braku limitu",min:5,max:180},maxAttempts:{type:"number",title:"Maksymalna liczba podej",placeholder:"Pozostaw puste dla nieograniczonej liczby",min:1,max:10},shuffleQuestions:{type:"checkbox",title:"Losowa kolejno pyta"},showExplanations:{type:"checkbox",title:"Pokazuj wyjanienia po odpowiedzi"}},required:["quizTitle","passingScore"]},step4:{title:"Podgld wygenerowanych pyta",type:"object",properties:{questions:{type:"array",title:"Lista pyta",readOnly:!0}}},step5:{title:"Finalizacja i zapis",type:"object",properties:{courseId:{type:"select",title:"Wybierz kurs",placeholder:"Wybierz kurs..."},topicId:{type:"select",title:"Wybierz temat",placeholder:"Najpierw wybierz kurs..."},finalTitle:{type:"text",title:"Ostateczny tytu",placeholder:"Tytu quizu"},questions:{type:"array",title:"Pytania do edycji"}},required:["courseId","topicId","finalTitle"]}}},DS={id:"analyze-quiz-topic",name:"Analiza tematu quizu",config:{endpoint:"https://diesel-power-backend.onrender.com/api/chat"},prompt:{system:"Jeste ekspertem od tworzenia test贸w i quiz贸w edukacyjnych.",user:`
Przeanalizuj temat dla quizu:
Temat: {{topic}}
Poziom trudnoci: {{difficulty}}
Liczba pyta: {{questionsCount}}
{{#if basedOnMaterial}}
Quiz bdzie generowany z materiau: {{materialTitle}}
{{/if}}

Wygeneruj JSON:
{
  "quizTitle": "<sugerowany tytu quizu>",
  "keyTopics": ["zagadnienie1", "zagadnienie2", "zagadnienie3"],
  "learningObjectives": "<cele sprawdzajce - co quiz ma zweryfikowa>",
  "suggestedTime": <liczba minut>,
  "passingScore": <pr贸g zaliczenia w %>
}

Wymagania:
- QuizTitle: kr贸tki, opisowy tytu quizu (max 80 znak贸w)
- KeyTopics: 5-10 kluczowych zagadnie do sprawdzenia
- LearningObjectives: konkretne umiejtnoci do weryfikacji (50-150 s贸w)
- SuggestedTime: 1-3 minuty na pytanie
- PassingScore: 60-80% w zale偶noci od trudnoci
{{#if basedOnMaterial}}
- Dla quizu z materiau: tytu powinien zawiera "Quiz: " + nazwa materiau
{{/if}}
    `,responseFormat:"json"},inputMapping:t=>({topic:t.topic,difficulty:t.difficulty,questionsCount:t.questionsCount,basedOnMaterial:t.basedOnMaterial||!1,materialTitle:t.materialTitle||""}),outputMapping:(t,s)=>({...s,quizTitle:t.quizTitle,keyTopics:t.keyTopics,learningObjectives:t.learningObjectives,suggestedTime:t.suggestedTime,passingScore:t.passingScore}),validation:t=>!!(t.quizTitle&&t.keyTopics&&t.learningObjectives&&t.suggestedTime&&t.passingScore)},PS={id:"generate-quiz-questions",name:"Generowanie pyta quizowych",config:{endpoint:"https://diesel-power-backend.onrender.com/api/chat"},prompt:{system:"Jeste ekspertem od tworzenia pyta testowych. Tworzysz rzetelne, dobrze sformuowane pytania sprawdzajce wiedz.",user:`
Stw贸rz pytania quizowe dla tematu: {{topic}}

Tytu quizu: {{quizTitle}}
Poziom trudnoci: {{difficulty}}
Liczba pyta: {{questionsCount}}
Typy pyta: {{questionTypes}}
Kluczowe zagadnienia: {{keyTopics}}
Cele: {{learningObjectives}}

Wygeneruj JSON z tablic pyta:
{
  "questions": [
    {
      "question": "<tre pytania>",
      "type": "single|multiple|truefalse",
      "options": [
        {"text": "<tre opcji>", "is_correct": true/false},
        {"text": "<tre opcji>", "is_correct": true/false}
      ],
      "explanation": "<wyjanienie poprawnej odpowiedzi>",
      "points": <liczba punkt贸w 1-5>
    }
  ]
}

Wymagania:
- Pytania oparte na wiedzy og贸lnej z danego tematu
- Pytania jasne i jednoznaczne  
- 4 opcje dla single/multiple, 2 dla true/false
- Dokadnie jedna poprawna dla single, 1-3 dla multiple
- Wyjanienia edukacyjne (30-100 s贸w)
- Punkty: atwe=1-2, rednie=2-3, trudne=3-5
- R贸偶norodno typ贸w pyta
- Pokrycie wszystkich kluczowych zagadnie
- GENERUJ PRAWDZIWE PYTANIA Z PODANEGO TEMATU
    `,responseFormat:"json"},inputMapping:t=>({topic:t.topic,quizTitle:t.quizTitle||"",difficulty:t.difficulty,questionsCount:t.questionsCount,questionTypes:Array.isArray(t.questionTypes)?t.questionTypes.join(", "):t.questionTypes||"single, multiple, truefalse",keyTopics:Array.isArray(t.keyTopics)?t.keyTopics.join(", "):t.keyTopics,learningObjectives:t.learningObjectives}),outputMapping:(t,s)=>({...s,questions:t.questions}),validation:t=>!!(t.questions&&Array.isArray(t.questions)&&t.questions.length>0)},MS={id:"generate-quiz-from-material",name:"Generowanie pyta z materiau",config:{endpoint:"https://diesel-power-backend.onrender.com/api/chat"},prompt:{system:"Jeste ekspertem od tworzenia pyta testowych. Tworzysz pytania WYCZNIE na podstawie dostarczonego materiau.",user:`
Stw贸rz pytania quizowe TYLKO I WYCZNIE na podstawie poni偶szego materiau:

MATERIA 殴RDOWY:
{{materialContent}}

PARAMETRY QUIZU:
Tytu: {{quizTitle}}
Poziom trudnoci: {{difficulty}}
Liczba pyta: {{questionsCount}}
Typy pyta: {{questionTypes}}

Wygeneruj JSON z tablic pyta:
{
  "questions": [
    {
      "question": "<tre pytania>",
      "type": "single|multiple|truefalse",
      "options": [
        {"text": "<tre opcji>", "is_correct": true/false},
        {"text": "<tre opcji>", "is_correct": true/false}
      ],
      "explanation": "<wyjanienie poprawnej odpowiedzi>",
      "points": <liczba punkt贸w 1-5>
    }
  ]
}

WA呕NE WYMAGANIA:
- WSZYSTKIE pytania musz by oparte WYCZNIE na treci materiau
- NIE dodawaj pyta o rzeczach nieopisanych w materiale
- Cytuj lub parafrazuj fragmenty materiau w pytaniach
- Wyjanienia musz odwoywa si do konkretnych fragment贸w materiau
- Jeli materia nie zawiera wystarczajcych informacji dla {{questionsCount}} pyta, wygeneruj mniej pyta
- Pytania musz sprawdza zrozumienie treci z materiau
- 4 opcje dla single/multiple, 2 dla true/false
- Dokadnie jedna poprawna dla single, 1-3 dla multiple
- Punkty: atwe=1-2, rednie=2-3, trudne=3-5
    `,responseFormat:"json"},inputMapping:t=>({materialContent:t.materialContent,quizTitle:t.quizTitle||"",difficulty:t.difficulty,questionsCount:t.questionsCount,questionTypes:Array.isArray(t.questionTypes)?t.questionTypes.join(", "):t.questionTypes||"single, multiple, truefalse"}),outputMapping:(t,s)=>({...s,questions:t.questions}),validation:t=>!!(t.questions&&Array.isArray(t.questions)&&t.questions.length>0)},we={topic:{minLength:5,errorMessage:"Temat jest wymagany (5-200 znak贸w)"},quizTitle:{minLength:5,maxLength:100,errorMessage:"Tytu jest wymagany (5-100 znak贸w)"},questionsCount:{min:5,max:30,errorMessage:"Liczba pyta musi by midzy 5 a 30"},passingScore:{min:50,max:100,errorMessage:"Pr贸g zaliczenia musi by midzy 50% a 100%"},timeLimit:{min:5,max:180,errorMessage:"Limit czasu musi by midzy 5 a 180 minut"},maxAttempts:{min:1,max:10,errorMessage:"Liczba podej musi by midzy 1 a 10"}},Er={steps:{1:{title:"Jaki quiz chcesz stworzy?",description:"Podaj temat, poziom trudnoci i liczb pyta - AI wygeneruje profesjonalny quiz",button:"Analizuj temat",loading:"Analizuj temat..."},2:{title:"Analiza tematu quizu",description:"AI przeanalizowaa temat i zaproponowaa parametry quizu",success:" Analiza zakoczona pomylnie"},3:{title:"Skonfiguruj parametry quizu",description:"Dostosuj ustawienia quizu wedug swoich potrzeb",button:"Generuj pytania",loading:"Generuj pytania...",loadingInfo:" AI tworzy zestaw pyta dostosowanych do tematu..."},4:{title:"Podgld wygenerowanych pyta",description:"AI przygotowaa kompletny zestaw pyta",info:" W nastpnym kroku bdziesz m贸g edytowa pytania i wybra kurs."},5:{title:"Zapisz quiz w kursie",description:"Wybierz kurs i temat, sprawd藕 pytania przed zapisaniem",saveInfo:" Quiz zostanie zapisany jako nowa aktywno z wygenerowanymi pytaniami",button:"Zapisz quiz",loading:"Zapisuj...",success:" Quiz zosta zapisany pomylnie! Przekierowuj do zarzdzania pytaniami..."}},dashboard:{title:"Kreator quiz贸w",description:"Tw贸rz profesjonalne testy sprawdzajce z pomoc AI",features:["Automatyczna analiza tematu","Generowanie r贸偶nych typ贸w pyta","Dostosowanie poziomu trudnoci","Inteligentne wyjanienia odpowiedzi","Konfiguracja parametr贸w quizu","Edycja i dostosowanie pyta"]},errors:{topicRequired:"Podaj temat quizu",analysisError:"Bd analizy tematu:",generationError:"Bd generowania pyta:",saveError:"Wystpi bd podczas zapisu",unexpectedError:"Wystpi nieoczekiwany bd",noCourses:"Nie znaleziono 偶adnych kurs贸w",noTopics:"Wybierz najpierw kurs",noQuestions:"Brak pyta do zapisania",materialRequired:"Wybierz materia 藕r贸dowy"}},Ot={dashboard:"/teacher/quiz-wizard",step1:"/teacher/quiz-wizard/step1",step2:"/teacher/quiz-wizard/step2",step3:"/teacher/quiz-wizard/step3",step4:"/teacher/quiz-wizard/step4",step5:"/teacher/quiz-wizard/step5",questions:"/teacher/questions/manage",courses:"/teacher/courses"},IS=()=>{const t=se(),{getData:s}=Ke(),n=s("quiz-wizard"),{dashboard:r}=Er,i=n&&n.quizTitle;return e.jsxs(G,{children:[e.jsx(_e,{title:r.title,description:r.description}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs(D,{className:"hover:shadow-lg transition-all cursor-pointer border-2 hover:border-blue-400 flex flex-col",onClick:()=>t(Ot.step1),children:[e.jsxs($,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:e.jsx(Tr,{className:"w-8 h-8 text-blue-600"})}),e.jsx(le,{className:"w-5 h-5 text-gray-400"})]}),e.jsx(R,{children:"Stw贸rz nowy quiz"}),e.jsx(Oe,{children:"Wygeneruj profesjonalny test sprawdzajcy z pomoc AI"})]}),e.jsxs(P,{className:"flex-1 flex flex-col",children:[e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{children:"5-10 minut"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Os,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{children:"Inteligentne pytania"})]})]}),e.jsx("div",{className:"mt-auto pt-4",children:e.jsxs("div",{className:"inline-flex items-center text-sm font-medium text-blue-600",children:["Rozpocznij tworzenie",e.jsx(le,{className:"w-4 h-4 ml-1"})]})})]})]}),e.jsxs(D,{className:"hover:shadow-lg transition-all border-2 border-gray-200 flex flex-col",children:[e.jsxs($,{children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:e.jsx(Se,{className:"w-8 h-8 text-purple-600"})})}),e.jsx(R,{children:"Funkcje AI"}),e.jsx(Oe,{children:"Co potrafi kreator quiz贸w"})]}),e.jsx(P,{className:"flex-1",children:e.jsx("div",{className:"space-y-2",children:r.features.map((a,o)=>e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Ve,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),e.jsx("span",{children:a})]},o))})})]})]}),i&&e.jsxs(D,{className:"hover:shadow-lg transition-shadow border-2 border-gray-200",children:[e.jsx($,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(R,{className:"text-lg",children:"Ostatni quiz"}),e.jsx(Oe,{children:"Kontynuuj prac nad quizem"})]}),e.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm",children:"Wygenerowany"})]})}),e.jsx(P,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Tytu quizu"}),e.jsx("p",{className:"font-medium text-gray-900",children:n.quizTitle})]}),n.topic&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Temat"}),e.jsx("p",{className:"text-gray-900",children:n.topic})]}),n.questions&&e.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-3 border-t",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-indigo-600",children:n.questions.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"pyta"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[n.passingScore||70,"%"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"pr贸g zaliczenia"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[e.jsxs(I,{variant:"outline",onClick:()=>t(Ot.step4),className:"flex-1",children:[e.jsx(Je,{className:"w-4 h-4 mr-2"}),"Podgld"]}),e.jsxs(I,{variant:"outline",onClick:()=>t(Ot.step5),className:"flex-1",children:[e.jsx(Ea,{className:"w-4 h-4 mr-2"}),"Edytuj"]}),e.jsxs(I,{variant:"outline",onClick:()=>t(Ot.step1),className:"flex-1",children:[e.jsx(xr,{className:"w-4 h-4 mr-2"}),"Nowy"]})]})]})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(D,{className:"hover:shadow-lg transition-shadow cursor-pointer border-2 border-blue-200 group",onClick:()=>t("/teacher/activities"),children:[e.jsxs($,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:e.jsx(at,{className:"w-6 h-6 text-blue-600"})}),e.jsx(le,{className:"w-5 h-5 text-gray-400 group-hover:translate-x-1 transition-transform"})]}),e.jsx(R,{className:"text-lg",children:"Aktywnoci"}),e.jsx(Oe,{children:"Wszystkie quizy i materiay"})]}),e.jsx(P,{children:e.jsx("p",{className:"text-xs text-gray-500 group-hover:text-blue-600 transition-colors",children:"Kliknij aby przej "})})]}),e.jsxs(D,{className:"hover:shadow-lg transition-shadow cursor-pointer border-2 border-purple-200 group",onClick:()=>t("/teacher/questions"),children:[e.jsxs($,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:e.jsx(Xs,{className:"w-6 h-6 text-purple-600"})}),e.jsx(le,{className:"w-5 h-5 text-gray-400 group-hover:translate-x-1 transition-transform"})]}),e.jsx(R,{className:"text-lg",children:"Pytania"}),e.jsx(Oe,{children:"Zarzdzaj pytaniami"})]}),e.jsx(P,{children:e.jsx("p",{className:"text-xs text-gray-500 group-hover:text-purple-600 transition-colors",children:"Kliknij aby przej "})})]}),e.jsxs(D,{className:"hover:shadow-lg transition-shadow cursor-pointer border-2 border-green-200 group",onClick:()=>t("/teacher/reports"),children:[e.jsxs($,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:e.jsx($e,{className:"w-6 h-6 text-green-600"})}),e.jsx(le,{className:"w-5 h-5 text-gray-400 group-hover:translate-x-1 transition-transform"})]}),e.jsx(R,{className:"text-lg",children:"Wyniki"}),e.jsx(Oe,{children:"Statystyki quiz贸w"})]}),e.jsx(P,{children:e.jsx("p",{className:"text-xs text-gray-500 group-hover:text-green-600 transition-colors",children:"Kliknij aby przej "})})]})]})]})]})},Yi=({step:t})=>{const s=se(),n=t/5*100;return e.jsxs(e.Fragment,{children:[e.jsx(I,{variant:"ghost",size:"icon",className:"absolute top-4 right-4 hover:bg-gray-100",onClick:()=>s("/teacher/quiz-wizard"),children:e.jsx(dt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-cyan-600 text-white p-8 space-y-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h1",{className:"text-4xl font-black tracking-tight",children:"KREATOR QUIZW"}),e.jsxs("h2",{className:"text-2xl font-light",children:["Tw贸rzmy razem ",e.jsx("span",{className:"font-bold",children:"sprawdzian wiedzy"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{children:["Krok ",t," z 5"]}),e.jsxs("span",{children:[n,"%"]})]}),e.jsx(Qt,{value:n,className:"h-2 bg-blue-300"})]})]})]})},Ji=({title:t,description:s})=>e.jsxs("header",{className:"mb-8",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2 flex items-center gap-3",children:t}),e.jsx("p",{className:"text-gray-600",children:s})]}),ES=()=>{const t=se(),{register:s,setData:n}=Ke(),[r,i]=x.useState(""),[a,o]=x.useState(""),[l,c]=x.useState(""),[d,m]=x.useState(""),[u,h]=x.useState(10),[p,b]=x.useState(["single","multiple"]),[f,y]=x.useState("general"),[w,j]=x.useState(""),[v,T]=x.useState({}),[z,k]=x.useState(null),N=Pn("quiz-wizard","analyze-quiz-topic"),{steps:S,errors:_}=Er,{data:g,isLoading:C}=Y({resource:"courses",meta:{select:"*, topics(*)"},sorters:[{field:"created_at",order:"desc"}]}),{data:A,isLoading:E}=Xe({resource:"activities",id:z?.materialId||0,queryOptions:{enabled:!!z?.materialId}}),{data:M,isLoading:O}=Y({resource:"activities",filters:[{field:"topic_id",operator:"eq",value:a?parseInt(a):void 0},{field:"type",operator:"eq",value:"material"}],sorters:[{field:"position",order:"asc"}],queryOptions:{enabled:!!a}}),Q=g?.data?.find(B=>B.id.toString()===r),L=Q?.topics||[];x.useEffect(()=>{s(AS),N.registerOperation(DS);const B=sessionStorage.getItem("wizardContext");if(B){const ee=JSON.parse(B);k(ee),ee.courseId&&i(ee.courseId.toString()),ee.topicId&&o(ee.topicId.toString()),ee.topicTitle&&c(ee.topicTitle),ee.materialId&&(y("material"),j(ee.materialId.toString()))}return()=>{N.unregisterOperation()}},[]),x.useEffect(()=>{if(a&&L.length>0){const B=L.find(ee=>ee.id.toString()===a);B&&!l&&c(B.title)}},[a,L]);const U=()=>{const B={};return r||(B.courseId="Wybierz kurs"),a||(B.topicId="Wybierz temat z kursu"),(!l.trim()||l.length<we.topic.minLength)&&(B.topic=we.topic.errorMessage),d||(B.difficulty="Wybierz poziom trudnoci"),(!u||u<we.questionsCount.min||u>we.questionsCount.max)&&(B.questionsCount=we.questionsCount.errorMessage),p.length===0&&(B.questionTypes="Wybierz przynajmniej jeden typ pyta"),f==="material"&&!w&&(B.materialId=_.materialRequired),T(B),Object.keys(B).length===0},F=async()=>{if(U())try{const B={courseId:parseInt(r),topicId:parseInt(a),topic:l.trim(),difficulty:d,questionsCount:u,questionTypes:p,courseTitle:Q?.title,topicTitle:L.find(ee=>ee.id.toString()===a)?.title,quizSource:f};if(f==="material"&&w){const ee=M?.data?.find(et=>et.id.toString()===w);ee&&(B.materialContent=ee.content,B.materialTitle=ee.title,B.materialId=parseInt(w),B.basedOnMaterial=!0)}else z?.materialId&&A?.data&&(B.materialContent=A.data.content,B.materialTitle=A.data.title,B.materialId=z.materialId,B.basedOnMaterial=!0);n("quiz-wizard",B),await N.executeOperation(B),t(Ot.step2)}catch(B){console.error(_.analysisError,B)}},ae=B=>{b(ee=>ee.includes(B)?ee.filter(et=>et!==B):[...ee,B])};return e.jsx(G,{children:e.jsxs(D,{className:"border-2 shadow-lg",children:[e.jsx(Yi,{step:1}),e.jsxs(P,{className:"p-8",children:[e.jsx(Ji,{title:S[1].title,description:S[1].description}),z?.materialId&&A&&e.jsxs(ge,{className:"mb-6 bg-blue-50 border-blue-200",children:[e.jsx(it,{className:"h-4 w-4 text-blue-600"}),e.jsxs(je,{className:"text-blue-800",children:[e.jsx("strong",{children:"Generujesz quiz na podstawie materiau:"}),e.jsx("br",{}),e.jsx("span",{className:"text-sm",children:A.data.title}),e.jsx("br",{}),e.jsx("span",{className:"text-xs text-muted-foreground mt-1",children:"Pytania bd generowane z treci tego materiau"})]})]}),z&&!z.materialId&&e.jsxs(ge,{className:"mb-6",children:[e.jsx(qt,{className:"h-4 w-4"}),e.jsxs(je,{children:["Tworzysz quiz dla: ",e.jsx("strong",{children:z.courseTitle}),z.topicTitle&&e.jsxs(e.Fragment,{children:["  ",e.jsx("strong",{children:z.topicTitle})]})]})]}),N.error&&e.jsxs(ge,{variant:"destructive",className:"mb-6",children:[e.jsx(yt,{className:"h-4 w-4"}),e.jsxs(je,{children:[_.analysisError," ",N.error]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(D,{className:"border-2 border-blue-200 bg-blue-50/50",children:e.jsxs(P,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(ye,{className:"w-5 h-5 text-blue-600"}),e.jsx("h3",{className:"font-semibold",children:"Wybierz miejsce w kursie"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(re,{htmlFor:"courseId",children:["Kurs ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(fe,{value:r,onValueChange:B=>{i(B),o(""),j("")},disabled:N.loading||C||!!z?.courseId,children:[e.jsx(me,{className:v.courseId?"border-red-500":"",children:e.jsx(xe,{placeholder:"Wybierz kurs..."})}),e.jsx(he,{children:g?.data?.map(B=>e.jsx(V,{value:B.id.toString(),children:e.jsxs("div",{className:"flex items-center gap-2",children:[B.icon_emoji&&e.jsx("span",{children:B.icon_emoji}),B.title]})},B.id))})]}),v.courseId&&e.jsx("p",{className:"text-sm text-red-600",children:v.courseId})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(re,{htmlFor:"topicId",children:["Temat ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(fe,{value:a,onValueChange:B=>{o(B),j("")},disabled:!r||N.loading||!!z?.topicId,children:[e.jsx(me,{className:v.topicId?"border-red-500":"",children:e.jsx(xe,{placeholder:r?"Wybierz temat...":"Najpierw wybierz kurs..."})}),e.jsx(he,{children:L.sort((B,ee)=>B.position-ee.position).map(B=>e.jsxs(V,{value:B.id.toString(),children:[B.position,". ",B.title]},B.id))})]}),v.topicId&&e.jsx("p",{className:"text-sm text-red-600",children:v.topicId})]})]})]})}),a&&!z?.materialId&&e.jsxs("div",{children:[e.jsx(re,{children:"殴r贸do pyta"}),e.jsxs(zc,{value:f,onValueChange:B=>y(B),children:[e.jsxs(ho,{className:"grid w-full grid-cols-2",children:[e.jsx(Kt,{value:"general",children:"Wiedza og贸lna"}),e.jsx(Kt,{value:"material",children:"Z materiau"})]}),e.jsx(Gt,{value:"general",children:e.jsx(D,{children:e.jsx(P,{className:"pt-6",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Pytania bd generowane na podstawie og贸lnej wiedzy z wybranego tematu"})})})}),e.jsx(Gt,{value:"material",children:e.jsx(D,{children:e.jsx(P,{className:"pt-6",children:O?e.jsx("div",{className:"flex justify-center py-4",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary"})}):M?.data?.length===0?e.jsxs(ge,{children:[e.jsx(yt,{className:"h-4 w-4"}),e.jsx(je,{children:"Brak materia贸w w tym temacie. Najpierw dodaj materia edukacyjny."})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsxs(re,{htmlFor:"materialId",children:["Wybierz materia ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(fe,{value:w,onValueChange:j,disabled:N.loading,children:[e.jsx(me,{className:v.materialId?"border-red-500":"",children:e.jsx(xe,{placeholder:"Wybierz materia..."})}),e.jsx(he,{children:M?.data?.map(B=>e.jsx(V,{value:B.id.toString(),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(it,{className:"w-4 h-4"}),e.jsxs("span",{children:[B.position,". ",B.title]})]})},B.id))})]}),v.materialId&&e.jsx("p",{className:"text-sm text-red-600",children:v.materialId}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Pytania bd tworzone WYCZNIE z treci wybranego materiau"})]})})})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(re,{htmlFor:"topic",children:"Temat quizu"}),e.jsx(Z,{id:"topic",type:"text",value:l,onChange:B=>c(B.target.value),placeholder:"np. Podstawy programowania w Python",disabled:N.loading,className:v.topic?"border-red-500":""}),v.topic&&e.jsx("p",{className:"text-sm text-red-600",children:v.topic}),e.jsx("p",{className:"text-sm text-gray-500",children:z?.materialId||f==="material"?"Quiz bdzie generowany z treci materiau":"Mo偶esz dostosowa temat quizu lub pozostawi sugerowany"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(re,{htmlFor:"difficulty",children:"Poziom trudnoci"}),e.jsxs(fe,{value:d,onValueChange:m,disabled:N.loading,children:[e.jsx(me,{className:v.difficulty?"border-red-500":"",children:e.jsx(xe,{placeholder:"Wybierz poziom..."})}),e.jsxs(he,{children:[e.jsx(V,{value:"easy",children:"atwy"}),e.jsx(V,{value:"medium",children:"redni"}),e.jsx(V,{value:"hard",children:"Trudny"})]})]}),v.difficulty&&e.jsx("p",{className:"text-sm text-red-600",children:v.difficulty})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(re,{htmlFor:"questionsCount",children:"Liczba pyta"}),e.jsx(Z,{id:"questionsCount",type:"number",value:u,onChange:B=>h(parseInt(B.target.value)||0),min:we.questionsCount.min,max:we.questionsCount.max,disabled:N.loading,className:v.questionsCount?"border-red-500":""}),v.questionsCount&&e.jsx("p",{className:"text-sm text-red-600",children:v.questionsCount})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(re,{children:"Typy pyta"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ct,{id:"single",checked:p.includes("single"),onCheckedChange:()=>ae("single"),disabled:N.loading}),e.jsx("label",{htmlFor:"single",className:"text-sm cursor-pointer",children:"Jednokrotny wyb贸r"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ct,{id:"multiple",checked:p.includes("multiple"),onCheckedChange:()=>ae("multiple"),disabled:N.loading}),e.jsx("label",{htmlFor:"multiple",className:"text-sm cursor-pointer",children:"Wielokrotny wyb贸r"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ct,{id:"truefalse",checked:p.includes("truefalse"),onCheckedChange:()=>ae("truefalse"),disabled:N.loading}),e.jsx("label",{htmlFor:"truefalse",className:"text-sm cursor-pointer",children:"Prawda/Fasz"})]})]}),v.questionTypes&&e.jsx("p",{className:"text-sm text-red-600",children:v.questionTypes})]}),e.jsx(I,{onClick:F,disabled:N.loading||E&&!!z?.materialId,className:"w-full bg-blue-600 hover:bg-blue-700 text-white",size:"lg",children:N.loading?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),z?.materialId||f==="material"?"Analizuj materia...":S[1].loading]}):e.jsxs(e.Fragment,{children:[e.jsx(rt,{className:"w-4 h-4 mr-2"}),S[1].button]})})]})]})]})})},LS=()=>{const t=se(),{getData:s}=Ke(),n=s("quiz-wizard"),{steps:r}=Er,i=o=>{switch(o){case"easy":return"atwy";case"medium":return"redni";case"hard":return"Trudny";default:return o}},a=o=>{switch(o){case"single":return"Jednokrotny wyb贸r";case"multiple":return"Wielokrotny wyb贸r";case"truefalse":return"Prawda/Fasz";default:return o}};return e.jsx(G,{children:e.jsxs(D,{className:"border-2 shadow-lg",children:[e.jsx(Yi,{step:2}),e.jsxs(P,{className:"p-8",children:[e.jsx(Ji,{title:r[2].title,description:r[2].description}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(ge,{className:"bg-green-50 border-green-200",children:[e.jsx(Re,{className:"h-4 w-4 text-green-600"}),e.jsx(je,{className:"text-green-800",children:r[2].success})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(D,{className:"bg-gray-50 border-gray-200",children:e.jsxs(P,{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Temat"}),e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:n.topic})]}),n.basedOnMaterial&&n.materialTitle&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Materia 藕r贸dowy"}),e.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-blue-800",children:[e.jsx(it,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:n.materialTitle})]}),e.jsx("p",{className:"text-sm text-blue-600 mt-1",children:"Pytania bd generowane wycznie z treci tego materiau"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Cele sprawdzajce"}),e.jsx("div",{className:"text-gray-800 whitespace-pre-wrap",children:n.learningObjectives})]})]})}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(D,{className:"border-purple-200 bg-purple-50/50",children:e.jsx(P,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Se,{className:"w-5 h-5 text-purple-600 mt-1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Kluczowe zagadnienia"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:n.keyTopics?.map((o,l)=>e.jsx("span",{className:"px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm",children:o},l))}),n.basedOnMaterial&&e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"* Zagadnienia wyodrbnione z materiau 藕r贸dowego"})]})]})})}),e.jsx(D,{className:"border-blue-200 bg-blue-50/50",children:e.jsx(P,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Te,{className:"w-5 h-5 text-blue-600 mt-1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Parametry quizu"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Poziom:"})," ",i(n.difficulty)]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Liczba pyta:"})," ",n.questionsCount]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Typy pyta:"})," ",n.questionTypes?.map(o=>a(o)).join(", ")]})]})]})]})})})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsx(D,{children:e.jsxs(P,{className:"p-4 text-center",children:[e.jsx(Te,{className:"w-8 h-8 text-indigo-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:n.suggestedTime}),e.jsx("div",{className:"text-sm text-gray-600",children:"minut"})]})}),e.jsx(D,{children:e.jsxs(P,{className:"p-4 text-center",children:[e.jsx(Se,{className:"w-8 h-8 text-purple-600 mx-auto mb-2"}),e.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[n.passingScore,"%"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"pr贸g zaliczenia"})]})}),e.jsx(D,{children:e.jsxs(P,{className:"p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Lokalizacja"}),e.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[e.jsx("p",{children:n.courseTitle}),e.jsxs("p",{className:"text-xs",children:[" ",n.topicTitle]})]})]})})]})]}),e.jsxs("div",{className:"flex justify-between pt-6",children:[e.jsx(I,{variant:"outline",onClick:()=>t(Ot.step1),children:"Wstecz"}),e.jsx(I,{onClick:()=>t(Ot.step3),className:"bg-blue-600 hover:bg-blue-700",children:"Kontynuuj"})]})]})]})]})})},OS=()=>{const t=se(),{getData:s,setData:n}=Ke(),r=s("quiz-wizard"),[i,a]=x.useState(r.quizTitle||""),[o,l]=x.useState(r.passingScore||70),[c,d]=x.useState(r.timeLimit||""),[m,u]=x.useState(r.maxAttempts||""),[h,p]=x.useState(!1),[b,f]=x.useState(!0),[y,w]=x.useState({}),j=Pn("quiz-wizard",r.basedOnMaterial?"generate-quiz-from-material":"generate-quiz-questions"),{steps:v,errors:T}=Er;x.useEffect(()=>{const N=r.basedOnMaterial?MS:PS;return j.registerOperation(N),()=>{j.unregisterOperation()}},[r.basedOnMaterial]);const z=()=>{const N={};return(!i.trim()||i.length<we.quizTitle.minLength)&&(N.quizTitle=we.quizTitle.errorMessage),(!o||o<we.passingScore.min||o>we.passingScore.max)&&(N.passingScore=we.passingScore.errorMessage),c&&(parseInt(c)<we.timeLimit.min||parseInt(c)>we.timeLimit.max)&&(N.timeLimit=we.timeLimit.errorMessage),m&&(parseInt(m)<we.maxAttempts.min||parseInt(m)>we.maxAttempts.max)&&(N.maxAttempts=we.maxAttempts.errorMessage),w(N),Object.keys(N).length===0},k=async()=>{if(z())try{const N={...r,quizTitle:i.trim(),passingScore:o,timeLimit:c?parseInt(c):null,maxAttempts:m?parseInt(m):null,shuffleQuestions:h,showExplanations:b};n("quiz-wizard",N),await j.executeOperation(N),t(Ot.step4)}catch(N){console.error(T.generationError,N)}};return e.jsx(G,{children:e.jsxs(D,{className:"border-2 shadow-lg",children:[e.jsx(Yi,{step:3}),e.jsxs(P,{className:"p-8",children:[e.jsx(Ji,{title:v[3].title,description:v[3].description}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(re,{htmlFor:"quizTitle",children:["Tytu quizu ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(Z,{id:"quizTitle",value:i,onChange:N=>a(N.target.value),placeholder:"np. Test wiedzy - Zmienne i typy danych",className:y.quizTitle?"border-red-500":""}),y.quizTitle&&e.jsx("p",{className:"text-sm text-red-600",children:y.quizTitle})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(re,{htmlFor:"passingScore",children:["Pr贸g zaliczenia (%) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(Z,{id:"passingScore",type:"number",value:o,onChange:N=>l(parseInt(N.target.value)||0),min:we.passingScore.min,max:we.passingScore.max,className:y.passingScore?"border-red-500":""}),y.passingScore&&e.jsx("p",{className:"text-sm text-red-600",children:y.passingScore})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(re,{htmlFor:"timeLimit",children:"Limit czasu (min)"}),e.jsx(Z,{id:"timeLimit",type:"number",value:c,onChange:N=>d(N.target.value),placeholder:"Pozostaw puste dla braku limitu",min:we.timeLimit.min,max:we.timeLimit.max,className:y.timeLimit?"border-red-500":""}),y.timeLimit&&e.jsx("p",{className:"text-sm text-red-600",children:y.timeLimit})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(re,{htmlFor:"maxAttempts",children:"Maksymalna liczba podej"}),e.jsx(Z,{id:"maxAttempts",type:"number",value:m,onChange:N=>u(N.target.value),placeholder:"Pozostaw puste dla nieograniczonej liczby",min:we.maxAttempts.min,max:we.maxAttempts.max,className:y.maxAttempts?"border-red-500":""}),y.maxAttempts&&e.jsx("p",{className:"text-sm text-red-600",children:y.maxAttempts})]}),e.jsx(D,{className:"border-gray-200",children:e.jsxs(P,{className:"pt-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ct,{id:"shuffleQuestions",checked:h,onCheckedChange:N=>p(N)}),e.jsx("label",{htmlFor:"shuffleQuestions",className:"text-sm cursor-pointer",children:"Losowa kolejno pyta"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ct,{id:"showExplanations",checked:b,onCheckedChange:N=>f(N)}),e.jsx("label",{htmlFor:"showExplanations",className:"text-sm cursor-pointer",children:"Pokazuj wyjanienia po odpowiedzi"})]})]})}),r.basedOnMaterial&&e.jsxs(ge,{className:"bg-blue-50 border-blue-200",children:[e.jsx(qt,{className:"h-4 w-4 text-blue-600"}),e.jsxs(je,{className:"text-blue-800",children:[e.jsx("strong",{children:"Uwaga:"}),' Pytania bd generowane wycznie z treci materiau "',r.materialTitle,'". AI utworzy tylko pytania, na kt贸re odpowiedzi znajduj si w materiale.']})]}),j.loading&&e.jsxs(ge,{className:"bg-purple-50 border-purple-200",children:[e.jsx(qt,{className:"h-4 w-4 text-purple-600"}),e.jsx(je,{className:"text-purple-800",children:r.basedOnMaterial?" AI analizuje materia i generuje pytania na podstawie jego treci...":v[3].loadingInfo})]}),e.jsxs("div",{className:"flex justify-between pt-6",children:[e.jsx(I,{variant:"outline",onClick:()=>t(Ot.step2),children:"Wstecz"}),e.jsx(I,{onClick:k,disabled:j.loading,className:"bg-blue-600 hover:bg-blue-700",children:j.loading?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),v[3].loading]}):e.jsxs(e.Fragment,{children:[e.jsx(rt,{className:"w-4 h-4 mr-2"}),v[3].button]})})]})]})]})]})})},RS=()=>{const t=se(),{getData:s}=Ke(),n=s("quiz-wizard"),{steps:r}=Er,i=o=>{switch(o){case"single":return"Jednokrotny wyb贸r";case"multiple":return"Wielokrotny wyb贸r";case"truefalse":return"Prawda/Fasz";default:return o}},a=o=>{switch(o){case"single":return"default";case"multiple":return"secondary";case"truefalse":return"outline";default:return"default"}};return e.jsx(G,{children:e.jsxs(D,{className:"border-2 shadow-lg",children:[e.jsx(Yi,{step:4}),e.jsxs(P,{className:"p-8",children:[e.jsx(Ji,{title:e.jsxs(e.Fragment,{children:[e.jsx(Je,{className:"w-8 h-8 text-blue-600"}),e.jsx("span",{children:r[4].title})]}),description:r[4].description}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(D,{className:"bg-gradient-to-r from-blue-50 to-cyan-50 border-blue-200",children:e.jsxs(P,{className:"p-6",children:[e.jsx("h4",{className:"font-semibold text-lg mb-3",children:n.quizTitle}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(at,{className:"w-8 h-8 text-indigo-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-indigo-600",children:n.questions?.length||0}),e.jsx("div",{className:"text-sm text-gray-600",children:"pyta"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(Se,{className:"w-8 h-8 text-purple-600 mx-auto mb-2"}),e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[n.passingScore,"%"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"pr贸g zaliczenia"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(Te,{className:"w-8 h-8 text-blue-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:n.timeLimit||""}),e.jsx("div",{className:"text-sm text-gray-600",children:"minut"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-2",children:"cznie"}),e.jsx("div",{className:"text-2xl font-bold text-green-600",children:n.questions?.reduce((o,l)=>o+l.points,0)||0}),e.jsx("div",{className:"text-sm text-gray-600",children:"punkt贸w"})]})]})]})}),e.jsx("h4",{className:"font-semibold text-lg",children:"Lista pyta - podgld"}),e.jsx("div",{className:"space-y-4",children:n.questions?.map((o,l)=>e.jsxs(D,{className:"overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-gray-50 to-gray-100 px-4 py-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("h5",{className:"font-medium",children:["Pytanie ",l+1]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(H,{variant:a(o.type),children:i(o.type)}),e.jsxs(H,{variant:"outline",children:[o.points," pkt"]})]})]})}),e.jsxs(P,{className:"p-4 space-y-3",children:[e.jsx("p",{className:"text-gray-700",children:o.question}),e.jsx("div",{className:"space-y-2",children:o.options?.map((c,d)=>e.jsxs("div",{className:`flex items-center gap-2 p-2 rounded ${c.is_correct?"bg-green-50 border border-green-200":"bg-gray-50"}`,children:[c.is_correct?e.jsx(Ve,{className:"w-4 h-4 text-green-600 flex-shrink-0"}):e.jsx(dt,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),e.jsx("span",{className:c.is_correct?"font-medium":"",children:c.text})]},d))}),o.explanation&&e.jsx("div",{className:"bg-blue-50 p-3 rounded border border-blue-200",children:e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Wyjanienie:"})," ",o.explanation]})})]})]},l))}),e.jsxs(ge,{className:"bg-blue-50 border-blue-200",children:[e.jsx(qt,{className:"h-4 w-4 text-blue-600"}),e.jsx(je,{className:"text-blue-800",children:r[4].info})]}),e.jsxs("div",{className:"flex justify-between pt-6",children:[e.jsx(I,{variant:"outline",onClick:()=>t(Ot.step3),children:"Wstecz"}),e.jsx(I,{onClick:()=>t(Ot.step5),className:"bg-blue-600 hover:bg-blue-700",children:"Przejd藕 do zapisywania"})]})]})]})]})})},$S=()=>{const t=se(),{getData:s,setData:n}=Ke(),{mutate:r}=os(),{mutate:i}=os(),a=s("quiz-wizard"),[o,l]=x.useState(a.quizTitle||""),[c,d]=x.useState({}),[m,u]=x.useState(!1),[h,p]=x.useState(!1),{steps:b,errors:f}=Er,{data:y}=Y({resource:"activities",filters:[{field:"topic_id",operator:"eq",value:a.topicId}],sorters:[{field:"position",order:"desc"}],pagination:{pageSize:1},queryOptions:{enabled:!!a.topicId}}),w=y?.data?.[0]?.position?y.data[0].position+1:1;x.useEffect(()=>{(!a.courseId||!a.topicId||!a.questions)&&(K.error("Brak danych z poprzednich krok贸w. Wracam do pocztku..."),t(Ot.step1))},[a,t]);const j=()=>{const T={};return(!o.trim()||o.length<we.quizTitle.minLength)&&(T.finalTitle=we.quizTitle.errorMessage),(!a.questions||a.questions.length===0)&&(T.questions=f.noQuestions),d(T),Object.keys(T).length===0},v=async()=>{if(j()){u(!0),p(!1);try{r({resource:"activities",values:{topic_id:parseInt(a.topicId),type:"quiz",title:o.trim(),position:w,duration_min:a.suggestedTime||a.timeLimit||30,is_published:!1,passing_score:a.passingScore,time_limit:a.timeLimit||null,max_attempts:a.maxAttempts||null}},{onSuccess:async T=>{const z=T.data.id;try{for(let N=0;N<a.questions.length;N++){const S=a.questions[N];await new Promise((_,g)=>{i({resource:"questions",values:{activity_id:z,question:S.question,explanation:S.explanation,points:S.points,position:N+1,options:S.options.map((C,A)=>({id:A+1,text:C.text,is_correct:C.is_correct}))}},{onSuccess:_,onError:g})})}n("quiz-wizard",{...a,finalTitle:o.trim(),activityId:z,saved:!0}),u(!1),p(!0);const k=sessionStorage.getItem("returnUrl");setTimeout(()=>{sessionStorage.removeItem("wizardContext"),k?(sessionStorage.removeItem("returnUrl"),t(k)):t(`/teacher/courses/show/${a.courseId}?expanded=${a.topicId}`)},1e3)}catch(k){u(!1),p(!1),console.error("Bd podczas zapisywania pyta:",k),K.error("Wystpi bd podczas zapisywania pyta. Spr贸buj ponownie.")}},onError:T=>{u(!1),p(!1),console.error(f.saveError,T),T?.code==="42501"?K.error("Brak uprawnie do tworzenia quiz贸w. Sprawd藕 swoje uprawnienia."):T?.code==="23505"?K.error("Quiz o takiej nazwie ju偶 istnieje."):K.error(f.saveError)}})}catch(T){u(!1),p(!1),console.error(f.unexpectedError,T),K.error(f.unexpectedError)}}};return e.jsx(G,{children:e.jsxs(D,{className:"border-2 shadow-lg",children:[e.jsx(Yi,{step:5}),e.jsxs(P,{className:"p-8",children:[e.jsx(Ji,{title:e.jsxs(e.Fragment,{children:[e.jsx(at,{className:"w-8 h-8 text-blue-600"}),e.jsx("span",{children:b[5].title})]}),description:b[5].description}),h&&e.jsxs(ge,{className:"mb-6 bg-green-50 border-green-200",children:[e.jsx(Re,{className:"h-4 w-4 text-green-600"}),e.jsx(je,{className:"text-green-800",children:b[5].success})]}),e.jsxs("form",{className:"space-y-6",onSubmit:T=>{T.preventDefault(),v()},children:[e.jsx(D,{className:"bg-gradient-to-r from-blue-50 to-cyan-50 border-blue-200",children:e.jsxs(P,{className:"p-4",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Lokalizacja quizu:"}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-700",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(Re,{className:"w-4 h-4 text-green-600 mt-0.5"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Kurs:"})," ",a.courseTitle]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(Re,{className:"w-4 h-4 text-green-600 mt-0.5"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Temat:"})," ",a.topicTitle]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(Re,{className:"w-4 h-4 text-green-600 mt-0.5"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Pozycja:"})," ",w]})]})]})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(re,{htmlFor:"finalTitle",children:["Tytu quizu ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(Z,{id:"finalTitle",type:"text",value:o,onChange:T=>l(T.target.value),placeholder:"Tytu quizu",maxLength:we.quizTitle.maxLength,className:c.finalTitle?"border-red-500":""}),c.finalTitle&&e.jsx("p",{className:"text-sm text-red-600",children:c.finalTitle}),e.jsx("p",{className:"text-sm text-gray-500",children:"Mo偶esz dostosowa tytu quizu przed zapisaniem"})]}),e.jsx(D,{children:e.jsxs(P,{className:"p-4",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Podsumowanie quizu"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Liczba pyta:"}),e.jsx("span",{className:"ml-2 font-medium",children:a.questions?.length||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Pr贸g zaliczenia:"}),e.jsxs("span",{className:"ml-2 font-medium",children:[a.passingScore,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Limit czasu:"}),e.jsx("span",{className:"ml-2 font-medium",children:a.timeLimit?`${a.timeLimit} min`:"Brak"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"czna liczba punkt贸w:"}),e.jsx("span",{className:"ml-2 font-medium",children:a.questions?.reduce((T,z)=>T+z.points,0)||0})]})]})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h4",{className:"font-medium",children:["Pytania (",a.questions?.length||0,")"]}),e.jsx(D,{className:"max-h-64 overflow-hidden",children:e.jsx(P,{className:"p-0",children:e.jsx("div",{className:"overflow-y-auto max-h-64",children:a.questions?.map((T,z)=>e.jsxs("div",{className:"flex items-center justify-between p-3 hover:bg-gray-50 border-b",children:[e.jsxs("span",{className:"text-sm truncate flex-1",children:[z+1,". ",T.question]}),e.jsxs(H,{variant:"outline",className:"ml-2",children:[T.points," pkt"]})]},z))})})})]}),e.jsxs(ge,{className:"bg-yellow-50 border-yellow-200",children:[e.jsx(yt,{className:"h-4 w-4 text-yellow-800"}),e.jsx(je,{className:"text-yellow-800",children:"Po zapisaniu bdziesz m贸g edytowa pytania w panelu zarzdzania quizem"})]}),e.jsx(ge,{className:"bg-blue-50 border-blue-200",children:e.jsx(je,{className:"text-blue-800",children:b[5].saveInfo})}),e.jsx(Mn,{}),e.jsxs("footer",{className:"flex justify-between gap-4",children:[e.jsxs(I,{type:"button",variant:"outline",onClick:()=>t(Ot.step4),disabled:m,className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"w-4 h-4"}),"Wstecz"]}),e.jsx(I,{type:"submit",disabled:m||h,className:"flex items-center gap-2 min-w-[160px] bg-blue-600 hover:bg-blue-700",children:m?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),b[5].loading]}):e.jsxs(e.Fragment,{children:[e.jsx(Ui,{className:"w-4 h-4"}),b[5].button]})})]})]})]})]})})},qS=[e.jsx(W,{path:"/quiz-wizard",element:e.jsx(IS,{})},"quiz-dashboard"),e.jsx(W,{path:"/quiz-wizard/step1",element:e.jsx(ES,{})},"quiz-step1"),e.jsx(W,{path:"/quiz-wizard/step2",element:e.jsx(LS,{})},"quiz-step2"),e.jsx(W,{path:"/quiz-wizard/step3",element:e.jsx(OS,{})},"quiz-step3"),e.jsx(W,{path:"/quiz-wizard/step4",element:e.jsx(RS,{})},"quiz-step4"),e.jsx(W,{path:"/quiz-wizard/step5",element:e.jsx($S,{})},"quiz-step5")],Fu={name:"quiz-wizard",list:"/quiz-wizard",create:"/quiz-wizard/step1",meta:{canDelete:!1,label:"Kreator quiz贸w",icon:e.jsx(Fi,{className:"h-4 w-4"})}},FS=()=>{const{activityId:t}=vt();se();const[s,n]=x.useState(null),[r,i]=x.useState(!1),{data:a,isLoading:o}=Xe({resource:"activities",id:t,meta:{select:"*, topics(*, courses(*))"}}),{data:l,isLoading:c,refetch:d}=Y({resource:"questions",filters:[{field:"activity_id",operator:"eq",value:parseInt(t)}],sorters:[{field:"position",order:"asc"}],pagination:{mode:"off"}}),{mutate:m}=os(),{mutate:u}=Cr(),{mutate:h}=zn();if(o||c)return e.jsx(G,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const p=a?.data,b=l?.data||[];return e.jsxs(G,{children:[e.jsx(Tn,{}),e.jsxs(X,{children:[e.jsx(_e,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(at,{className:"w-6 h-6 text-blue-500"}),"Pytania quizu"]}),description:e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-medium",children:p?.title}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[p?.topics?.courses?.title,"  Temat"," ",p?.topics?.position,": ",p?.topics?.title]})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(H,{variant:"outline",className:"text-base px-3 py-1",children:[b.length," ",b.length===1?"pytanie":"pyta"]}),e.jsxs(I,{onClick:()=>i(!0),disabled:r,children:[e.jsx(Ie,{className:"w-4 h-4 mr-2"}),"Dodaj pytanie"]})]})]}),e.jsx(D,{className:"bg-muted/50",children:e.jsx(P,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Pr贸g zaliczenia:"}),e.jsxs("span",{className:"ml-2 font-medium",children:[p?.passing_score||70,"%"]})]}),p?.time_limit&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Limit czasu:"}),e.jsxs("span",{className:"ml-2 font-medium",children:[p.time_limit," min"]})]}),p?.max_attempts&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Max. pr贸b:"}),e.jsx("span",{className:"ml-2 font-medium",children:p.max_attempts})]})]})})}),r&&e.jsx(Uu,{activityId:parseInt(t),position:b.length+1,onSave:f=>{m({resource:"questions",values:f},{onSuccess:()=>{K.success("Pytanie zostao dodane"),i(!1),d()}})},onCancel:()=>i(!1)}),e.jsx("div",{className:"space-y-4",children:b.map(f=>e.jsx("div",{children:s===f.id?e.jsx(Uu,{question:f,activityId:parseInt(t),position:f.position,onSave:y=>{u({resource:"questions",id:f.id,values:y},{onSuccess:()=>{K.success("Pytanie zostao zaktualizowane"),n(null),d()}})},onCancel:()=>n(null)}):e.jsxs(D,{children:[e.jsx($,{children:e.jsxs(X,{children:[e.jsxs(R,{className:"text-base",children:[e.jsxs("span",{className:"text-muted-foreground mr-2",children:["#",f.position]}),f.question]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(H,{variant:"outline",children:[f.points," pkt"]}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>n(f.id),children:e.jsx(ks,{className:"w-3 h-3"})}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>{confirm("Czy na pewno chcesz usun to pytanie?")&&h({resource:"questions",id:f.id},{onSuccess:()=>{K.success("Pytanie zostao usunite"),d()}})},children:e.jsx(ls,{className:"w-3 h-3 text-red-600"})})]})]})}),e.jsxs(P,{children:[e.jsx("div",{className:"space-y-2",children:f.options.map((y,w)=>e.jsxs("div",{className:`flex items-center gap-2 p-2 rounded ${y.is_correct?"bg-green-50 dark:bg-green-950/30 border border-green-200 dark:border-green-800":""}`,children:[y.is_correct?e.jsx(Ve,{className:"w-4 h-4 text-green-600"}):e.jsx(dt,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:y.is_correct?"font-medium":"",children:y.text})]},y.id||w))}),f.explanation&&e.jsxs("div",{className:"mt-4 p-3 bg-muted rounded",children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:"Wyjanienie:"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:f.explanation})]})]})]})},f.id))}),b.length===0&&!r&&e.jsx(D,{children:e.jsxs(P,{className:"text-center py-12",children:[e.jsx(at,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground/50"}),e.jsx("p",{className:"text-lg font-medium text-muted-foreground mb-4",children:"Quiz nie ma jeszcze 偶adnych pyta"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-6",children:"Dodaj pierwsze pytanie, aby uczniowie mogli rozwiza quiz"}),e.jsxs(I,{onClick:()=>i(!0),children:[e.jsx(Ie,{className:"w-4 h-4 mr-2"}),"Dodaj pierwsze pytanie"]})]})}),b.length>0&&e.jsxs("div",{className:"flex justify-between items-center pt-6 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["cznie punkt贸w: ",b.reduce((f,y)=>f+y.points,0)]}),e.jsx(Tn,{variant:"outline",children:"Zakocz edycj"})]})]})},Uu=({question:t,activityId:s,position:n,onSave:r,onCancel:i})=>{const[a,o]=x.useState({question:t?.question||"",explanation:t?.explanation||"",points:t?.points||1,position:n,options:t?.options||[{text:"",is_correct:!1},{text:"",is_correct:!1},{text:"",is_correct:!1},{text:"",is_correct:!1}]}),l=()=>{if(!a.question.trim()){K.error("Pytanie jest wymagane");return}const m=a.options.filter(h=>h.text.trim());if(m.length<2){K.error("Dodaj przynajmniej 2 odpowiedzi");return}if(m.filter(h=>h.is_correct).length===0){K.error("Zaznacz przynajmniej jedn poprawn odpowied藕");return}r({activity_id:s,question:a.question,explanation:a.explanation||null,points:a.points,position:a.position,options:m.map((h,p)=>({...h,position:p+1}))})},c=()=>{a.options.length<6&&o({...a,options:[...a.options,{text:"",is_correct:!1}]})},d=m=>{if(a.options.length>2){const u=a.options.filter((h,p)=>p!==m);o({...a,options:u})}};return e.jsxs(D,{className:"border-primary",children:[e.jsx($,{children:e.jsx(R,{children:t?"Edytuj pytanie":"Nowe pytanie"})}),e.jsxs(P,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Tre pytania"}),e.jsx(bt,{placeholder:"Wprowad藕 tre pytania...",value:a.question,onChange:m=>o({...a,question:m.target.value}),className:"mt-1",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Liczba punkt贸w"}),e.jsx(Z,{type:"number",min:"1",value:a.points,onChange:m=>o({...a,points:parseInt(m.target.value)||1}),className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Pozycja"}),e.jsx(Z,{type:"number",min:"1",value:a.position,onChange:m=>o({...a,position:parseInt(m.target.value)||1}),className:"mt-1"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Odpowiedzi"}),a.options.length<6&&e.jsxs(I,{type:"button",size:"sm",variant:"outline",onClick:c,children:[e.jsx(Ie,{className:"w-3 h-3 mr-1"}),"Dodaj opcj"]})]}),e.jsx("div",{className:"space-y-2",children:a.options.map((m,u)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ct,{checked:m.is_correct,onCheckedChange:h=>{const p=[...a.options];p[u].is_correct=h,o({...a,options:p})}}),e.jsx(Z,{placeholder:`Odpowied藕 ${u+1}`,value:m.text,onChange:h=>{const p=[...a.options];p[u].text=h.target.value,o({...a,options:p})},className:"flex-1"}),a.options.length>2&&e.jsx(I,{type:"button",variant:"ghost",size:"sm",onClick:()=>d(u),children:e.jsx(dt,{className:"w-4 h-4"})})]},u))}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Zaznacz checkbox przy poprawnych odpowiedziach. Mo偶esz zaznaczy wicej ni偶 jedn."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Wyjanienie (opcjonalne)"}),e.jsx(bt,{placeholder:"Wyjanienie poprawnej odpowiedzi...",value:a.explanation,onChange:m=>o({...a,explanation:m.target.value}),className:"mt-1",rows:3})]}),e.jsxs(X,{children:[e.jsxs(I,{variant:"outline",onClick:i,children:[e.jsx(dt,{className:"w-4 h-4 mr-2"}),"Anuluj"]}),e.jsxs(I,{onClick:l,children:[e.jsx(Ui,{className:"w-4 h-4 mr-2"}),"Zapisz pytanie"]})]})]})]})},US=()=>{const[t]=so(),s=se(),n=t.get("activity_id"),{data:r,isLoading:i}=Y({resource:"questions",filters:[{field:"activity_id",operator:"eq",value:parseInt(n)}],sorters:[{field:"position",order:"desc"}],pagination:{mode:"off"}}),[a,o]=x.useState({question:"",explanation:"",points:1,position:1,options:[{text:"",is_correct:!1},{text:"",is_correct:!1},{text:"",is_correct:!1},{text:"",is_correct:!1}]});x.useEffect(()=>{if(r?.data){const f=r.data.reduce((y,w)=>Math.max(y,w.position||0),0);o(y=>({...y,position:f+1}))}},[r]);const{data:l,isLoading:c}=Xe({resource:"activities",id:n,meta:{select:"*, topics(*, courses(*))"}}),{mutate:d,isLoading:m}=os();if(!n)return e.jsx(G,{children:e.jsx(D,{children:e.jsx(P,{className:"text-center py-12",children:e.jsx("p",{className:"text-lg font-medium text-muted-foreground",children:"Brak ID aktywnoci"})})})});if(c||i)return e.jsx(G,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const u=l?.data;if(!u||u.type!=="quiz")return e.jsx(G,{children:e.jsx(D,{children:e.jsx(P,{className:"text-center py-12",children:e.jsx("p",{className:"text-lg font-medium text-muted-foreground",children:"Nieprawidowa aktywno lub aktywno nie jest quizem"})})})});const h=()=>{if(!a.question.trim()){K.error("Pytanie jest wymagane");return}const f=a.options.filter(w=>w.text.trim());if(f.length<2){K.error("Dodaj przynajmniej 2 odpowiedzi");return}if(f.filter(w=>w.is_correct).length===0){K.error("Zaznacz przynajmniej jedn poprawn odpowied藕");return}d({resource:"questions",values:{activity_id:parseInt(n),question:a.question,explanation:a.explanation||null,points:a.points,position:a.position,options:f.map((w,j)=>({id:j+1,text:w.text,is_correct:w.is_correct}))}},{onSuccess:()=>{K.success("Pytanie zostao dodane"),s(`/teacher/questions/manage/${n}`)},onError:w=>{console.error("Bd podczas dodawania pytania:",w);const j=w?.code||w?.statusCode,v=w?.message||w?.error?.message;j==="23505"||j===23505?v?.includes("position")?K.error("Pytanie o tej pozycji ju偶 istnieje. Zmie pozycj na inn warto."):K.error("Wystpi konflikt z istniejcymi danymi. Sprawd藕 pozycj pytania."):j==="23503"||j===23503?K.error("Nieprawidowe powizanie z aktywnoci."):j==="22P02"||j===22002?K.error("Nieprawidowy format danych."):v?K.error(`Bd: ${v}`):K.error("Wystpi nieoczekiwany bd. Spr贸buj ponownie.")}})},p=()=>{a.options.length<6&&o({...a,options:[...a.options,{text:"",is_correct:!1}]})},b=f=>{if(a.options.length>2){const y=a.options.filter((w,j)=>j!==f);o({...a,options:y})}};return e.jsxs(G,{children:[e.jsx(Tn,{}),e.jsx(X,{children:e.jsx(_e,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(at,{className:"w-6 h-6 text-blue-500"}),"Dodaj pytanie do quizu"]}),description:e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-medium",children:u?.title}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[u?.topics?.courses?.title,"  Temat"," ",u?.topics?.position,": ",u?.topics?.title]})]})})}),e.jsxs(D,{children:[e.jsx($,{children:e.jsx(R,{children:"Nowe pytanie"})}),e.jsxs(P,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Tre pytania"}),e.jsx(bt,{placeholder:"Wprowad藕 tre pytania...",value:a.question,onChange:f=>o({...a,question:f.target.value}),className:"mt-1",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Liczba punkt贸w"}),e.jsx(Z,{type:"number",min:"1",value:a.points,onChange:f=>o({...a,points:parseInt(f.target.value)||1}),className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Pozycja"}),e.jsx(Z,{type:"number",min:"1",value:a.position,onChange:f=>o({...a,position:parseInt(f.target.value)||1}),className:"mt-1"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Odpowiedzi"}),a.options.length<6&&e.jsxs(I,{type:"button",size:"sm",variant:"outline",onClick:p,children:[e.jsx(Ie,{className:"w-3 h-3 mr-1"}),"Dodaj opcj"]})]}),e.jsx("div",{className:"space-y-2",children:a.options.map((f,y)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ct,{checked:f.is_correct,onCheckedChange:w=>{const j=[...a.options];j[y].is_correct=w,o({...a,options:j})}}),e.jsx(Z,{placeholder:`Odpowied藕 ${y+1}`,value:f.text,onChange:w=>{const j=[...a.options];j[y].text=w.target.value,o({...a,options:j})},className:"flex-1"}),a.options.length>2&&e.jsx(I,{type:"button",variant:"ghost",size:"sm",onClick:()=>b(y),children:e.jsx(dt,{className:"w-4 h-4"})})]},y))}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Zaznacz checkbox przy poprawnych odpowiedziach. Mo偶esz zaznaczy wicej ni偶 jedn."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Wyjanienie (opcjonalne)"}),e.jsx(bt,{placeholder:"Wyjanienie poprawnej odpowiedzi...",value:a.explanation,onChange:f=>o({...a,explanation:f.target.value}),className:"mt-1",rows:3})]}),e.jsxs(X,{children:[e.jsxs(I,{variant:"outline",onClick:()=>s(`/teacher/questions/manage/${n}`),children:[e.jsx(dt,{className:"w-4 h-4 mr-2"}),"Anuluj"]}),e.jsxs(I,{onClick:h,disabled:m,children:[e.jsx(Ui,{className:"w-4 h-4 mr-2"}),m?"Zapisywanie...":"Zapisz pytanie"]})]})]})]})]})},BS=[e.jsx(W,{path:"/questions/manage/:activityId",element:e.jsx(FS,{})},"questions-manage"),e.jsx(W,{path:"/questions/create",element:e.jsx(US,{})},"questions-create")],VS=[{id:"course-structure",title:"Generator struktury kursu",description:"Stw贸rz kompletn struktur kursu z harmonogramem i tematami",icon:fr,path:"/teacher/course-structure",color:"from-indigo-50 to-blue-50",borderColor:"border-indigo-200",iconBg:"bg-indigo-100",iconColor:"text-indigo-600",buttonBg:"bg-indigo-600 hover:bg-indigo-700",features:["Automatyczna analiza wymaga","Generowanie harmonogramu","Podzia na tygodnie i tematy","Zgodno z podstaw programow"],estimatedTime:"15-20 min",targetAudience:"Tw贸rcy nowych kurs贸w"},{id:"educational-material",title:"Kreator materia贸w edukacyjnych",description:"Generuj anga偶ujce materiay dydaktyczne dostosowane do wieku uczni贸w",icon:ye,path:"/teacher/educational-material",color:"from-purple-50 to-pink-50",borderColor:"border-purple-200",iconBg:"bg-purple-100",iconColor:"text-purple-600",buttonBg:"bg-purple-600 hover:bg-purple-700",features:["Materiay dostosowane do wieku","wiczenia praktyczne","Formatowanie Markdown","Integracja z istniejcymi kursami"],estimatedTime:"10-15 min",targetAudience:"Nauczyciele wszystkich poziom贸w"},{id:"quiz-wizard",title:"Kreator quiz贸w",description:"Tw贸rz profesjonalne testy sprawdzajce z r贸偶nymi typami pyta",icon:Os,path:"/teacher/quiz-wizard",color:"from-blue-50 to-cyan-50",borderColor:"border-blue-200",iconBg:"bg-blue-100",iconColor:"text-blue-600",buttonBg:"bg-blue-600 hover:bg-blue-700",features:["R贸偶ne typy pyta","Automatyczne wyjanienia","Konfiguracja parametr贸w","Inteligentne punktowanie"],estimatedTime:"10-15 min",targetAudience:"Do sprawdzania wiedzy"}],WS=()=>{const t=se();return e.jsxs(G,{children:[e.jsx(_e,{title:"Narzdzia AI dla nauczycieli",description:"Wykorzystaj sztuczn inteligencj do tworzenia wysokiej jakoci materia贸w edukacyjnych"}),e.jsx("div",{className:"mb-8 p-6 bg-gradient-to-r from-violet-50 to-purple-50 rounded-lg border border-purple-200",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:e.jsx(rt,{className:"w-8 h-8 text-purple-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Przyspiesz tworzenie materia贸w z AI"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Nasze narzdzia AI pomagaj tworzy spersonalizowane materiay edukacyjne w uamku czasu potrzebnego na tradycyjne przygotowanie. Ka偶dy kreator prowadzi Ci krok po kroku przez proces tworzenia."}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"w-4 h-4 text-purple-600"}),e.jsx("span",{children:"Oszczdno czasu do 80%"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"w-4 h-4 text-purple-600"}),e.jsx("span",{children:"Dostosowane do programu nauczania"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"w-4 h-4 text-purple-600"}),e.jsx("span",{children:"Personalizacja dla r贸偶nych grup"})]})]})]})]})}),e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:VS.map(s=>{const n=s.icon;return e.jsxs(D,{className:`hover:shadow-lg transition-shadow cursor-pointer border-2 ${s.borderColor}`,onClick:()=>t(s.path),children:[e.jsxs($,{children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("div",{className:`p-3 rounded-lg ${s.iconBg}`,children:e.jsx(n,{className:`w-6 h-6 ${s.iconColor}`})}),e.jsx(le,{className:"w-5 h-5 text-gray-400"})]}),e.jsx(R,{className:"text-lg",children:s.title}),e.jsx(Oe,{children:s.description})]}),e.jsx(P,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-700 mb-2",children:"G贸wne funkcje:"}),e.jsx("ul",{className:"space-y-1",children:s.features.slice(0,3).map((r,i)=>e.jsxs("li",{className:"text-xs text-gray-600 flex items-start gap-1",children:[e.jsx("span",{className:"text-green-500 mt-0.5",children:""}),e.jsx("span",{children:r})]},i))})]}),e.jsxs("div",{className:"flex justify-between items-center pt-3 border-t",children:[e.jsxs("div",{className:"text-xs text-gray-500",children:[e.jsx(Te,{className:"w-3 h-3 inline mr-1"}),s.estimatedTime]}),e.jsxs(I,{size:"sm",className:`${s.buttonBg} text-white`,children:[e.jsx(Fi,{className:"w-3 h-3 mr-1"}),"Rozpocznij"]})]})]})})]},s.id)})}),e.jsxs("div",{className:"mt-8 p-6 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx(at,{className:"w-5 h-5 text-blue-600"}),"Wskaz贸wki dla najlepszych rezultat贸w"]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 text-sm text-gray-700",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium mb-1",children:"Przed rozpoczciem:"}),e.jsxs("ul",{className:"space-y-1 text-gray-600",children:[e.jsx("li",{children:" Przygotuj podstawowe informacje o kursie"}),e.jsx("li",{children:" Okrel grup docelow i poziom"}),e.jsx("li",{children:" Zaplanuj cele edukacyjne"})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium mb-1",children:"Podczas tworzenia:"}),e.jsxs("ul",{className:"space-y-1 text-gray-600",children:[e.jsx("li",{children:" Sprawdzaj podgldy na ka偶dym etapie"}),e.jsx("li",{children:" Dostosuj wygenerowane treci do potrzeb"}),e.jsx("li",{children:" Zapisuj regularnie postpy"})]})]})]})]})]})},KS=[e.jsx(W,{path:"ai-tools",element:e.jsx(WS,{})},"ai-tools")],GS=[...lw,...Nk,...Ck,...KS,...F1,...BS,...jS,..._S,...qS,...Q1,...J1,...oS],QS=()=>e.jsx(to,{children:e.jsxs(W,{element:e.jsx(aw,{children:e.jsx(fc,{})}),children:[e.jsx(W,{index:!0,element:e.jsx(as,{to:"dashboard/overview",replace:!0})}),e.jsx(W,{path:"dashboard",element:e.jsx(as,{to:"dashboard/overview",replace:!0})}),GS]})}),HS=x.lazy(()=>Promise.resolve({default:QS})),px=({text:t,colorClass:s})=>e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-background",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`inline-block h-12 w-12 animate-spin rounded-full border-4 border-current border-r-transparent ${s}`}),e.jsx("p",{className:"mt-4 text-muted-foreground",children:t})]})}),ZS=({children:t})=>{const{data:s,isLoading:n}=We();return n||!s?e.jsx(px,{text:"Sprawdzanie uprawnie...",colorClass:"border-indigo-600"}):["teacher","admin"].includes(s.role)?e.jsx(e.Fragment,{children:t}):e.jsx(as,{to:"/student/dashboard",replace:!0})},YS=e.jsx(W,{path:"/teacher/*",element:e.jsx(yc,{fallback:e.jsx(bc,{to:"/login"}),children:e.jsx(ZS,{children:e.jsx(x.Suspense,{fallback:e.jsx(px,{text:"adowanie panelu nauczyciela...",colorClass:"border-indigo-600"}),children:e.jsx(HS,{})})})},"teacher-auth")});class JS{constructor(){_s(this,"stats",{points:0,level:1,streak:0,idle_rate:1,next_level_points:200,quizzes_completed:0,perfect_scores:0,total_time:0,rank:0});_s(this,"listeners",new Set);_s(this,"channel",null);_s(this,"userId",null)}subscribe(s){return this.listeners.add(s),s(this.stats),()=>{this.listeners.delete(s)}}notify(){this.listeners.forEach(s=>s(this.stats))}async fetchStats(s){if(s)try{const{data:n,error:r}=await J.rpc("get_my_stats");if(r)throw r;n&&(console.log("Fetched stats from DB:",n),this.stats={points:n.points||0,level:n.level||1,streak:n.streak||0,idle_rate:n.idle_rate||1,next_level_points:n.next_level_points||200,quizzes_completed:n.quizzes_completed||0,perfect_scores:n.perfect_scores||0,total_time:n.total_time||0,rank:n.rank||0},this.notify())}catch(n){console.error("Error fetching stats:",n)}}setupSubscription(s){this.userId===s&&this.channel||(this.channel&&this.userId!==s&&(console.log("Closing old subscription for user:",this.userId),J.removeChannel(this.channel),this.channel=null),this.userId=s,console.log("Setting up global stats subscription for user:",s),this.channel=J.channel(`global-user-stats-${s}`).on("postgres_changes",{event:"*",schema:"public",table:"user_stats",filter:`user_id=eq.${s}`},n=>{console.log("user_stats change received:",n),this.fetchStats(s)}).on("postgres_changes",{event:"INSERT",schema:"public",table:"gamification_log",filter:`user_id=eq.${s}`},n=>{console.log("gamification_log INSERT received:",n),setTimeout(()=>this.fetchStats(s),300)}).subscribe(n=>{console.log("Global subscription status:",n)}),this.fetchStats(s))}cleanup(){this.channel&&(console.log("Cleaning up global subscription"),J.removeChannel(this.channel),this.channel=null,this.userId=null)}}const il=new JS,qn=()=>{const{data:t}=We(),[s,n]=x.useState({points:0,level:1,streak:0,idle_rate:1,next_level_points:200,quizzes_completed:0,perfect_scores:0,total_time:0,rank:0}),[r,i]=x.useState(!0);x.useEffect(()=>t?.id?(il.setupSubscription(t.id),il.subscribe(l=>{n(l),i(!1)})):void 0,[t?.id]);const a=x.useCallback(async()=>{t?.id&&(i(!0),await il.fetchStats(t.id),i(!1))},[t?.id]);return{stats:s,isLoading:r,refetch:a}},As=new Map,Xi=(t,s,n)=>{const r=n?.cacheKey||`${t}-${JSON.stringify(s)}`,[i,a]=x.useState(()=>As.get(r)||null),[o,l]=x.useState(!As.has(r)),[c,d]=x.useState(null),m=x.useCallback(async(h=!1)=>{if(n?.enabled!==!1){if(!h&&As.has(r)){a(As.get(r)),l(!1);return}try{l(!0),d(null);const{data:p,error:b}=await J.rpc(t,s);if(b)throw b;As.set(r,p),a(p),n?.onSuccess?.(p)}catch(p){d(p),n?.onError?.(p)}finally{l(!1)}}},[t,r,JSON.stringify(s),n?.enabled]);x.useEffect(()=>{m()},[m]);const u=x.useCallback(()=>{As.delete(r)},[r]);return{data:i,isLoading:o,error:c,refetch:()=>m(!0),invalidate:u}},ci=t=>{t?Array.from(As.keys()).forEach(s=>{s.includes(t)&&As.delete(s)}):As.clear()},XS=(t,s)=>{const[n,r]=x.useState([]),[i,a]=x.useState(!0),[o,l]=x.useState(null),c=x.useCallback(async()=>{if(s?.enabled!==!1)try{a(!0),l(null);let d=J.from(t).select(s?.select||"*");s?.filters?.forEach(h=>{switch(h.operator){case"eq":d=d.eq(h.field,h.value);break;case"in":d=d.in(h.field,h.value);break;case"contains":d=d.ilike(h.field,`%${h.value}%`);break}}),s?.sorts?.forEach(h=>{d=d.order(h.field,{ascending:h.order==="asc"})}),s?.limit&&(d=d.limit(s.limit));const{data:m,error:u}=await d;if(u)throw u;r(m||[])}catch(d){l(d)}finally{a(!1)}},[t,JSON.stringify(s)]);return x.useEffect(()=>{c()},[c]),{data:n,isLoading:i,error:o,refetch:c}},Bu=({onClose:t,variant:s="sidebar"})=>{const{mutate:n}=no(),{data:r}=We(),i=Ei(),{stats:a}=qn(),o=[{path:"/student/dashboard",label:"G贸wna",icon:jb},{path:"/student/gamification",label:"Ulepszenia",icon:_l},{path:"/student/leaderboard",label:"Ranking",icon:$e},{path:"/student/achievements",label:"Osignicia",icon:Rs},{path:"/student/profile",label:"Profil",icon:Ia}],l=()=>{t&&t()};return s==="bottom"?e.jsx("div",{className:"grid grid-cols-5 gap-1 p-1.5",children:o.map(c=>{const d=i.pathname===c.path;return e.jsxs(hr,{to:c.path,className:({isActive:m})=>q("relative flex flex-col items-center justify-center gap-1 rounded-lg p-3 transition-colors",m?"text-primary":"text-muted-foreground hover:text-foreground hover:bg-muted/50"),children:[e.jsx(c.icon,{className:"h-5 w-5"}),e.jsx("span",{className:"text-[11px] font-medium",children:c.label}),d&&e.jsx("i",{"aria-hidden":!0,className:"pointer-events-none absolute inset-x-6 -bottom-[3px] h-1 rounded-full bg-primary/70"})]},c.path)})}):e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsxs("div",{className:"h-16 px-6 border-b relative grid place-items-center justify-start overflow-hidden",children:[e.jsx("i",{"aria-hidden":!0,className:"absolute -right-10 -top-10 w-28 h-28 rounded-3xl bg-gradient-to-br from-primary/10 via-secondary/10 to-accent/10 rotate-45"}),e.jsxs("div",{className:"flex items-center gap-3 relative z-10",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-primary to-secondary text-white grid place-items-center shadow",children:e.jsx(tn,{className:"w-5 h-5"})}),e.jsx("strong",{className:"text-lg",children:"Smart Up"})]}),t&&e.jsx(I,{variant:"ghost",size:"sm",onClick:t,className:"absolute right-4 lg:hidden",children:e.jsx(dt,{className:"h-4 w-4"})})]}),e.jsx("section",{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-12 h-12 rounded-2xl bg-gradient-to-br from-primary/10 to-secondary/10 text-primary grid place-items-center font-bold",children:r?.full_name?.charAt(0)||"U"}),e.jsx("div",{className:"absolute -bottom-1 -right-1 w-6 h-6 rounded-full bg-secondary text-white text-xs grid place-items-center font-bold",children:a.level})]}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"font-semibold truncate",children:r?.full_name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Poziom ",a.level,"  ",a.streak," dni"]})]})]})}),e.jsx("section",{className:"px-6 -mt-2 mb-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("article",{className:"rounded-xl border p-3 bg-primary/5 border-primary/10",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Ye,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Punkty"})]}),e.jsx("p",{className:"text-lg font-bold",children:Math.floor(a.points)}),e.jsxs("p",{className:"text-xs text-primary",children:["+",a.idle_rate,"/h"]})]}),e.jsxs("article",{className:"rounded-xl border p-3 bg-destructive/5 border-destructive/10",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(fs,{className:"w-4 h-4 text-destructive"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Seria"})]}),e.jsx("p",{className:"text-lg font-bold",children:a.streak}),e.jsx("p",{className:"text-xs text-destructive",children:"dni z rzdu"})]})]})}),e.jsx(yr,{className:"flex-1 px-4",children:e.jsx("nav",{className:"space-y-1",children:o.map(c=>e.jsxs(hr,{to:c.path,onClick:l,className:({isActive:d})=>q("relative w-full flex items-center gap-3 px-4 h-11 rounded-xl transition-colors",d?"bg-primary text-primary-foreground":"hover:bg-muted/50 text-muted-foreground hover:text-foreground"),children:[e.jsx(c.icon,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:c.label})]},c.path))})}),e.jsx(Mn,{}),e.jsxs("footer",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"px-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground mb-2",children:[e.jsxs("span",{children:["Poziom ",a.level]}),e.jsxs("span",{children:["Poziom ",a.level+1]})]}),e.jsx("div",{className:"h-1.5 rounded-full bg-muted overflow-hidden",children:e.jsx("div",{className:"h-full rounded-full bg-gradient-to-r from-primary via-secondary to-accent",style:{width:`${Math.max(0,Math.min(100,a.points%100))}%`}})})]}),e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>{n(),t&&t()},className:"w-full justify-center text-destructive border-destructive/30 bg-destructive/5 hover:bg-destructive/10",children:[e.jsx(lo,{className:"mr-2 h-4 w-4"}),"Wyloguj"]})]})]})},e2=()=>e.jsx("div",{"aria-hidden":!0,className:"pointer-events-none fixed inset-0 z-0 overflow-hidden p-0 lg:p-2.5 lg:pb-28 pt-0",children:e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("div",{className:"absolute inset-0 bg-background rounded-3xl"}),e.jsxs("div",{className:"absolute inset-0 rounded-3xl overflow-hidden",children:[e.jsx("div",{className:"absolute w-[50vw] h-[50vh] bottom-0 left-0 translate-y-[25%] -translate-x-[25%] bg-orange rounded-full blur-[150px] opacity-70 dark:opacity-40"}),e.jsx("div",{className:"absolute w-[30vw] h-[30vh] bottom-0 left-1/2 -translate-x-1/2 translate-y-[20%] bg-yellow rounded-full blur-[100px] opacity-60 dark:opacity-30"}),e.jsx("div",{className:"absolute w-[50vw] h-[50vh] bottom-0 right-0 translate-y-[25%] translate-x-[25%] bg-purple rounded-full blur-[150px] opacity-70 dark:opacity-40"})]})]})}),t2=({stats:t,theme:s,onToggleTheme:n})=>{const[r,i]=x.useState(!1),{data:a}=We(),{mutate:o}=no(),l=x.useMemo(()=>Math.floor(t.points),[t.points]);return e.jsx("header",{className:"sticky top-0 z-30 h-16 bg-card/80 backdrop-blur supports-[backdrop-filter]:bg-card/60 border-b shadow-sm hidden lg:block",children:e.jsxs("div",{className:"mx-auto max-w-6xl h-full px-4 lg:px-8 flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-3 min-w-0",children:e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-base sm:text-lg font-semibold truncate",children:"Dashboard"}),e.jsxs("p",{className:"text-xs text-muted-foreground truncate",children:["Witaj, ",a?.full_name?.split(" ")[0],"!"]})]})}),e.jsxs("div",{className:"flex items-center gap-2 lg:gap-3",children:[e.jsxs("button",{className:"relative p-2.5 rounded-xl hover:bg-muted focus-ring h-11 w-11 grid place-items-center","aria-label":"Powiadomienia",children:[e.jsx(sp,{className:"w-5 h-5 text-muted-foreground"}),e.jsx("span",{className:"absolute top-1.5 right-1.5 w-2 h-2 bg-destructive rounded-full"})]}),e.jsxs("div",{className:"flex items-center gap-2 px-3 lg:px-4 h-11 rounded-xl border bg-primary/10 border-primary/20",children:[e.jsx(Ye,{className:"w-4 h-4 text-primary animate-pulse"}),e.jsx("span",{className:"font-semibold text-sm lg:text-base tabular-nums min-w-[3ch] text-right",children:l.toLocaleString("pl-PL")}),e.jsxs("span",{className:"hidden md:block text-xs text-primary",children:["+",t.idle_rate,"/h"]})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>i(!r),className:"flex items-center gap-2 px-1.5 h-11 rounded-xl hover:bg-muted focus-ring","aria-haspopup":"menu","aria-expanded":r,children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-9 h-9 lg:w-10 lg:h-10 rounded-xl bg-gradient-to-br from-primary to-secondary text-white grid place-items-center font-bold",children:a?.full_name?.charAt(0)||"U"}),e.jsx("div",{className:"absolute -bottom-0.5 -right-0.5 w-4 h-4 lg:w-5 lg:h-5 rounded-full bg-accent text-white text-[10px] lg:text-xs grid place-items-center border-2 border-card",children:t.level})]}),e.jsx(Xt,{className:"w-4 h-4 text-muted-foreground"})]}),r&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>i(!1),"aria-hidden":"true"}),e.jsxs("menu",{className:"absolute right-0 mt-2 w-64 bg-card rounded-xl border shadow-soft-lg z-50 overflow-hidden",children:[e.jsxs("section",{className:"p-4 border-b",children:[e.jsx("p",{className:"font-semibold truncate",children:a?.full_name}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:a?.email})]}),e.jsxs("ul",{className:"p-2",children:[e.jsx("li",{children:e.jsxs("button",{onClick:()=>{n(),i(!1)},className:"w-full flex items-center gap-3 px-3 h-11 rounded-lg text-foreground/80 hover:text-foreground hover:bg-muted transition-colors",children:[s==="dark"?e.jsx(yb,{className:"w-4 h-4"}):e.jsx(bb,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:s==="dark"?"Tryb jasny":"Tryb ciemny"})]})}),e.jsx("li",{children:e.jsxs("button",{onClick:()=>{window.location.href="/student/profile",i(!1)},className:"w-full flex items-center gap-3 px-3 h-11 rounded-lg text-foreground/80 hover:text-foreground hover:bg-muted transition-colors",children:[e.jsx(Ia,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Profil"})]})}),e.jsx("li",{children:e.jsxs("button",{onClick:()=>{window.location.href="/student/settings",i(!1)},className:"w-full flex items-center gap-3 px-3 h-11 rounded-lg text-foreground/80 hover:text-foreground hover:bg-muted transition-colors",children:[e.jsx(vc,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Ustawienia"})]})}),e.jsx("li",{children:e.jsxs("button",{onClick:()=>{window.location.href="/student/help",i(!1)},className:"w-full flex items-center gap-3 px-3 h-11 rounded-lg text-foreground/80 hover:text-foreground hover:bg-muted transition-colors",children:[e.jsx(at,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Pomoc"})]})}),e.jsx("li",{children:e.jsxs("button",{onClick:()=>{o(),i(!1)},className:"w-full flex items-center gap-3 px-3 h-11 rounded-lg text-destructive hover:bg-destructive/10 transition-colors",children:[e.jsx(lo,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Wyloguj"})]})})]})]})]})]})]})]})})},s2=({children:t})=>{const[s,n]=x.useState(!1),[r,i]=x.useState(()=>{const c=localStorage.getItem("theme");return c==="light"||c==="dark"?c:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}),{stats:a}=qn();x.useEffect(()=>{document.documentElement.classList.toggle("dark",r==="dark"),localStorage.setItem("theme",r)},[r]);const o=()=>{i(r==="dark"?"light":"dark")},l=()=>{n(!s)};return e.jsxs("div",{className:"min-h-screen bg-background relative overflow-x-hidden",children:[e.jsx(e2,{}),e.jsxs("div",{className:"flex relative",children:[s&&e.jsx("div",{className:"fixed inset-0 z-40 bg-black/30 dark:bg-black/50 backdrop-blur-sm lg:hidden",onClick:()=>n(!1)}),e.jsx("aside",{className:`
            h-screen w-80 transform transition-transform duration-300 ease-in-out
            fixed left-0 top-0 z-50
            ${s?"translate-x-0":"-translate-x-full"}
            lg:translate-x-0 lg:w-72
            bg-card/95 backdrop-blur-xl border-r
          `,children:e.jsx(Bu,{onClose:()=>n(!1)})}),e.jsxs("main",{className:"flex-1 lg:ml-72 min-w-0 relative z-10",children:[e.jsx("div",{className:"fixed top-0 left-72 right-0 z-30 hidden lg:block",children:e.jsx(t2,{stats:a,theme:r,onToggleTheme:o})}),e.jsxs("div",{className:"sticky top-0 z-30 flex h-16 items-center border-b bg-card/80 backdrop-blur supports-[backdrop-filter]:bg-card/60 px-4 lg:hidden",children:[e.jsx(I,{variant:"ghost",size:"sm",onClick:l,className:"mr-2",children:e.jsx(Ri,{className:"h-6 w-6"})}),e.jsx("span",{className:"font-semibold bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent",children:"Smart Up"})]}),e.jsx("div",{className:"min-h-[calc(100vh-4rem)] pb-32 lg:pb-24 lg:pt-16",children:t})]})]}),e.jsx("nav",{"aria-label":"Nawigacja dolna",className:"fixed py-3.5 bottom-0 z-40 left-0 right-0 lg:left-72 bg-card/95 backdrop-blur-xl border-t",children:e.jsx(Bu,{variant:"bottom"})})]})},Kc=x.createContext({});function Gc(t){const s=x.useRef(null);return s.current===null&&(s.current=t()),s.current}const Qc=typeof window<"u",fx=Qc?x.useLayoutEffect:x.useEffect,So=x.createContext(null);function Hc(t,s){t.indexOf(s)===-1&&t.push(s)}function Zc(t,s){const n=t.indexOf(s);n>-1&&t.splice(n,1)}const $s=(t,s,n)=>n>s?s:n<t?t:n;let Yc=()=>{};const qs={},xx=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function gx(t){return typeof t=="object"&&t!==null}const jx=t=>/^0[^.\s]+$/u.test(t);function Jc(t){let s;return()=>(s===void 0&&(s=t()),s)}const Zt=t=>t,n2=(t,s)=>n=>s(t(n)),ea=(...t)=>t.reduce(n2),Si=(t,s,n)=>{const r=s-t;return r===0?1:(n-t)/r};class Xc{constructor(){this.subscriptions=[]}add(s){return Hc(this.subscriptions,s),()=>Zc(this.subscriptions,s)}notify(s,n,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](s,n,r);else for(let a=0;a<i;a++){const o=this.subscriptions[a];o&&o(s,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const gs=t=>t*1e3,js=t=>t/1e3;function yx(t,s){return s?t*(1e3/s):0}const bx=(t,s,n)=>(((1-3*n+3*s)*t+(3*n-6*s))*t+3*s)*t,r2=1e-7,i2=12;function a2(t,s,n,r,i){let a,o,l=0;do o=s+(n-s)/2,a=bx(o,r,i)-t,a>0?n=o:s=o;while(Math.abs(a)>r2&&++l<i2);return o}function ta(t,s,n,r){if(t===s&&n===r)return Zt;const i=a=>a2(a,0,1,t,n);return a=>a===0||a===1?a:bx(i(a),s,r)}const wx=t=>s=>s<=.5?t(2*s)/2:(2-t(2*(1-s)))/2,vx=t=>s=>1-t(1-s),Nx=ta(.33,1.53,.69,.99),ed=vx(Nx),kx=wx(ed),zx=t=>(t*=2)<1?.5*ed(t):.5*(2-Math.pow(2,-10*(t-1))),td=t=>1-Math.sin(Math.acos(t)),Sx=vx(td),Cx=wx(td),o2=ta(.42,0,1,1),l2=ta(0,0,.58,1),Tx=ta(.42,0,.58,1),c2=t=>Array.isArray(t)&&typeof t[0]!="number",_x=t=>Array.isArray(t)&&typeof t[0]=="number",d2={linear:Zt,easeIn:o2,easeInOut:Tx,easeOut:l2,circIn:td,circInOut:Cx,circOut:Sx,backIn:ed,backInOut:kx,backOut:Nx,anticipate:zx},u2=t=>typeof t=="string",Vu=t=>{if(_x(t)){Yc(t.length===4);const[s,n,r,i]=t;return ta(s,n,r,i)}else if(u2(t))return d2[t];return t},ha=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function m2(t,s){let n=new Set,r=new Set,i=!1,a=!1;const o=new WeakSet;let l={delta:0,timestamp:0,isProcessing:!1};function c(m){o.has(m)&&(d.schedule(m),t()),m(l)}const d={schedule:(m,u=!1,h=!1)=>{const b=h&&i?n:r;return u&&o.add(m),b.has(m)||b.add(m),m},cancel:m=>{r.delete(m),o.delete(m)},process:m=>{if(l=m,i){a=!0;return}i=!0,[n,r]=[r,n],n.forEach(c),n.clear(),i=!1,a&&(a=!1,d.process(m))}};return d}const h2=40;function Ax(t,s){let n=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},a=()=>n=!0,o=ha.reduce((v,T)=>(v[T]=m2(a),v),{}),{setup:l,read:c,resolveKeyframes:d,preUpdate:m,update:u,preRender:h,render:p,postRender:b}=o,f=()=>{const v=qs.useManualTiming?i.timestamp:performance.now();n=!1,qs.useManualTiming||(i.delta=r?1e3/60:Math.max(Math.min(v-i.timestamp,h2),1)),i.timestamp=v,i.isProcessing=!0,l.process(i),c.process(i),d.process(i),m.process(i),u.process(i),h.process(i),p.process(i),b.process(i),i.isProcessing=!1,n&&s&&(r=!1,t(f))},y=()=>{n=!0,r=!0,i.isProcessing||t(f)};return{schedule:ha.reduce((v,T)=>{const z=o[T];return v[T]=(k,N=!1,S=!1)=>(n||y(),z.schedule(k,N,S)),v},{}),cancel:v=>{for(let T=0;T<ha.length;T++)o[ha[T]].cancel(v)},state:i,steps:o}}const{schedule:Ae,cancel:nn,state:st,steps:al}=Ax(typeof requestAnimationFrame<"u"?requestAnimationFrame:Zt,!0);let ka;function p2(){ka=void 0}const zt={now:()=>(ka===void 0&&zt.set(st.isProcessing||qs.useManualTiming?st.timestamp:performance.now()),ka),set:t=>{ka=t,queueMicrotask(p2)}},Dx=t=>s=>typeof s=="string"&&s.startsWith(t),sd=Dx("--"),f2=Dx("var(--"),nd=t=>f2(t)?x2.test(t.split("/*")[0].trim()):!1,x2=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Lr={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},Ci={...Lr,transform:t=>$s(0,1,t)},pa={...Lr,default:1},di=t=>Math.round(t*1e5)/1e5,rd=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function g2(t){return t==null}const j2=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,id=(t,s)=>n=>!!(typeof n=="string"&&j2.test(n)&&n.startsWith(t)||s&&!g2(n)&&Object.prototype.hasOwnProperty.call(n,s)),Px=(t,s,n)=>r=>{if(typeof r!="string")return r;const[i,a,o,l]=r.match(rd);return{[t]:parseFloat(i),[s]:parseFloat(a),[n]:parseFloat(o),alpha:l!==void 0?parseFloat(l):1}},y2=t=>$s(0,255,t),ol={...Lr,transform:t=>Math.round(y2(t))},gn={test:id("rgb","red"),parse:Px("red","green","blue"),transform:({red:t,green:s,blue:n,alpha:r=1})=>"rgba("+ol.transform(t)+", "+ol.transform(s)+", "+ol.transform(n)+", "+di(Ci.transform(r))+")"};function b2(t){let s="",n="",r="",i="";return t.length>5?(s=t.substring(1,3),n=t.substring(3,5),r=t.substring(5,7),i=t.substring(7,9)):(s=t.substring(1,2),n=t.substring(2,3),r=t.substring(3,4),i=t.substring(4,5),s+=s,n+=n,r+=r,i+=i),{red:parseInt(s,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const ql={test:id("#"),parse:b2,transform:gn.transform},sa=t=>({test:s=>typeof s=="string"&&s.endsWith(t)&&s.split(" ").length===1,parse:parseFloat,transform:s=>`${s}${t}`}),Qs=sa("deg"),ys=sa("%"),te=sa("px"),w2=sa("vh"),v2=sa("vw"),Wu={...ys,parse:t=>ys.parse(t)/100,transform:t=>ys.transform(t*100)},Xn={test:id("hsl","hue"),parse:Px("hue","saturation","lightness"),transform:({hue:t,saturation:s,lightness:n,alpha:r=1})=>"hsla("+Math.round(t)+", "+ys.transform(di(s))+", "+ys.transform(di(n))+", "+di(Ci.transform(r))+")"},Ue={test:t=>gn.test(t)||ql.test(t)||Xn.test(t),parse:t=>gn.test(t)?gn.parse(t):Xn.test(t)?Xn.parse(t):ql.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?gn.transform(t):Xn.transform(t),getAnimatableNone:t=>{const s=Ue.parse(t);return s.alpha=0,Ue.transform(s)}},N2=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function k2(t){return isNaN(t)&&typeof t=="string"&&(t.match(rd)?.length||0)+(t.match(N2)?.length||0)>0}const Mx="number",Ix="color",z2="var",S2="var(",Ku="${}",C2=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Ti(t){const s=t.toString(),n=[],r={color:[],number:[],var:[]},i=[];let a=0;const l=s.replace(C2,c=>(Ue.test(c)?(r.color.push(a),i.push(Ix),n.push(Ue.parse(c))):c.startsWith(S2)?(r.var.push(a),i.push(z2),n.push(c)):(r.number.push(a),i.push(Mx),n.push(parseFloat(c))),++a,Ku)).split(Ku);return{values:n,split:l,indexes:r,types:i}}function Ex(t){return Ti(t).values}function Lx(t){const{split:s,types:n}=Ti(t),r=s.length;return i=>{let a="";for(let o=0;o<r;o++)if(a+=s[o],i[o]!==void 0){const l=n[o];l===Mx?a+=di(i[o]):l===Ix?a+=Ue.transform(i[o]):a+=i[o]}return a}}const T2=t=>typeof t=="number"?0:Ue.test(t)?Ue.getAnimatableNone(t):t;function _2(t){const s=Ex(t);return Lx(t)(s.map(T2))}const rn={test:k2,parse:Ex,createTransformer:Lx,getAnimatableNone:_2};function ll(t,s,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(s-t)*6*n:n<1/2?s:n<2/3?t+(s-t)*(2/3-n)*6:t}function A2({hue:t,saturation:s,lightness:n,alpha:r}){t/=360,s/=100,n/=100;let i=0,a=0,o=0;if(!s)i=a=o=n;else{const l=n<.5?n*(1+s):n+s-n*s,c=2*n-l;i=ll(c,l,t+1/3),a=ll(c,l,t),o=ll(c,l,t-1/3)}return{red:Math.round(i*255),green:Math.round(a*255),blue:Math.round(o*255),alpha:r}}function Wa(t,s){return n=>n>0?s:t}const Pe=(t,s,n)=>t+(s-t)*n,cl=(t,s,n)=>{const r=t*t,i=n*(s*s-r)+r;return i<0?0:Math.sqrt(i)},D2=[ql,gn,Xn],P2=t=>D2.find(s=>s.test(t));function Gu(t){const s=P2(t);if(!s)return!1;let n=s.parse(t);return s===Xn&&(n=A2(n)),n}const Qu=(t,s)=>{const n=Gu(t),r=Gu(s);if(!n||!r)return Wa(t,s);const i={...n};return a=>(i.red=cl(n.red,r.red,a),i.green=cl(n.green,r.green,a),i.blue=cl(n.blue,r.blue,a),i.alpha=Pe(n.alpha,r.alpha,a),gn.transform(i))},Fl=new Set(["none","hidden"]);function M2(t,s){return Fl.has(t)?n=>n<=0?t:s:n=>n>=1?s:t}function I2(t,s){return n=>Pe(t,s,n)}function ad(t){return typeof t=="number"?I2:typeof t=="string"?nd(t)?Wa:Ue.test(t)?Qu:O2:Array.isArray(t)?Ox:typeof t=="object"?Ue.test(t)?Qu:E2:Wa}function Ox(t,s){const n=[...t],r=n.length,i=t.map((a,o)=>ad(a)(a,s[o]));return a=>{for(let o=0;o<r;o++)n[o]=i[o](a);return n}}function E2(t,s){const n={...t,...s},r={};for(const i in n)t[i]!==void 0&&s[i]!==void 0&&(r[i]=ad(t[i])(t[i],s[i]));return i=>{for(const a in r)n[a]=r[a](i);return n}}function L2(t,s){const n=[],r={color:0,var:0,number:0};for(let i=0;i<s.values.length;i++){const a=s.types[i],o=t.indexes[a][r[a]],l=t.values[o]??0;n[i]=l,r[a]++}return n}const O2=(t,s)=>{const n=rn.createTransformer(s),r=Ti(t),i=Ti(s);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?Fl.has(t)&&!i.values.length||Fl.has(s)&&!r.values.length?M2(t,s):ea(Ox(L2(r,i),i.values),n):Wa(t,s)};function Rx(t,s,n){return typeof t=="number"&&typeof s=="number"&&typeof n=="number"?Pe(t,s,n):ad(t)(t,s)}const R2=t=>{const s=({timestamp:n})=>t(n);return{start:(n=!0)=>Ae.update(s,n),stop:()=>nn(s),now:()=>st.isProcessing?st.timestamp:zt.now()}},$x=(t,s,n=10)=>{let r="";const i=Math.max(Math.round(s/n),2);for(let a=0;a<i;a++)r+=Math.round(t(a/(i-1))*1e4)/1e4+", ";return`linear(${r.substring(0,r.length-2)})`},Ka=2e4;function od(t){let s=0;const n=50;let r=t.next(s);for(;!r.done&&s<Ka;)s+=n,r=t.next(s);return s>=Ka?1/0:s}function $2(t,s=100,n){const r=n({...t,keyframes:[0,s]}),i=Math.min(od(r),Ka);return{type:"keyframes",ease:a=>r.next(i*a).value/s,duration:js(i)}}const q2=5;function qx(t,s,n){const r=Math.max(s-q2,0);return yx(n-t(r),s-r)}const Le={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},dl=.001;function F2({duration:t=Le.duration,bounce:s=Le.bounce,velocity:n=Le.velocity,mass:r=Le.mass}){let i,a,o=1-s;o=$s(Le.minDamping,Le.maxDamping,o),t=$s(Le.minDuration,Le.maxDuration,js(t)),o<1?(i=d=>{const m=d*o,u=m*t,h=m-n,p=Ul(d,o),b=Math.exp(-u);return dl-h/p*b},a=d=>{const u=d*o*t,h=u*n+n,p=Math.pow(o,2)*Math.pow(d,2)*t,b=Math.exp(-u),f=Ul(Math.pow(d,2),o);return(-i(d)+dl>0?-1:1)*((h-p)*b)/f}):(i=d=>{const m=Math.exp(-d*t),u=(d-n)*t+1;return-dl+m*u},a=d=>{const m=Math.exp(-d*t),u=(n-d)*(t*t);return m*u});const l=5/t,c=B2(i,a,l);if(t=gs(t),isNaN(c))return{stiffness:Le.stiffness,damping:Le.damping,duration:t};{const d=Math.pow(c,2)*r;return{stiffness:d,damping:o*2*Math.sqrt(r*d),duration:t}}}const U2=12;function B2(t,s,n){let r=n;for(let i=1;i<U2;i++)r=r-t(r)/s(r);return r}function Ul(t,s){return t*Math.sqrt(1-s*s)}const V2=["duration","bounce"],W2=["stiffness","damping","mass"];function Hu(t,s){return s.some(n=>t[n]!==void 0)}function K2(t){let s={velocity:Le.velocity,stiffness:Le.stiffness,damping:Le.damping,mass:Le.mass,isResolvedFromDuration:!1,...t};if(!Hu(t,W2)&&Hu(t,V2))if(t.visualDuration){const n=t.visualDuration,r=2*Math.PI/(n*1.2),i=r*r,a=2*$s(.05,1,1-(t.bounce||0))*Math.sqrt(i);s={...s,mass:Le.mass,stiffness:i,damping:a}}else{const n=F2(t);s={...s,...n,mass:Le.mass},s.isResolvedFromDuration=!0}return s}function Ga(t=Le.visualDuration,s=Le.bounce){const n=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:s}:t;let{restSpeed:r,restDelta:i}=n;const a=n.keyframes[0],o=n.keyframes[n.keyframes.length-1],l={done:!1,value:a},{stiffness:c,damping:d,mass:m,duration:u,velocity:h,isResolvedFromDuration:p}=K2({...n,velocity:-js(n.velocity||0)}),b=h||0,f=d/(2*Math.sqrt(c*m)),y=o-a,w=js(Math.sqrt(c/m)),j=Math.abs(y)<5;r||(r=j?Le.restSpeed.granular:Le.restSpeed.default),i||(i=j?Le.restDelta.granular:Le.restDelta.default);let v;if(f<1){const z=Ul(w,f);v=k=>{const N=Math.exp(-f*w*k);return o-N*((b+f*w*y)/z*Math.sin(z*k)+y*Math.cos(z*k))}}else if(f===1)v=z=>o-Math.exp(-w*z)*(y+(b+w*y)*z);else{const z=w*Math.sqrt(f*f-1);v=k=>{const N=Math.exp(-f*w*k),S=Math.min(z*k,300);return o-N*((b+f*w*y)*Math.sinh(S)+z*y*Math.cosh(S))/z}}const T={calculatedDuration:p&&u||null,next:z=>{const k=v(z);if(p)l.done=z>=u;else{let N=z===0?b:0;f<1&&(N=z===0?gs(b):qx(v,z,k));const S=Math.abs(N)<=r,_=Math.abs(o-k)<=i;l.done=S&&_}return l.value=l.done?o:k,l},toString:()=>{const z=Math.min(od(T),Ka),k=$x(N=>T.next(z*N).value,z,30);return z+"ms "+k},toTransition:()=>{}};return T}Ga.applyToOptions=t=>{const s=$2(t,100,Ga);return t.ease=s.ease,t.duration=gs(s.duration),t.type="keyframes",t};function Bl({keyframes:t,velocity:s=0,power:n=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:a=500,modifyTarget:o,min:l,max:c,restDelta:d=.5,restSpeed:m}){const u=t[0],h={done:!1,value:u},p=S=>l!==void 0&&S<l||c!==void 0&&S>c,b=S=>l===void 0?c:c===void 0||Math.abs(l-S)<Math.abs(c-S)?l:c;let f=n*s;const y=u+f,w=o===void 0?y:o(y);w!==y&&(f=w-u);const j=S=>-f*Math.exp(-S/r),v=S=>w+j(S),T=S=>{const _=j(S),g=v(S);h.done=Math.abs(_)<=d,h.value=h.done?w:g};let z,k;const N=S=>{p(h.value)&&(z=S,k=Ga({keyframes:[h.value,b(h.value)],velocity:qx(v,S,h.value),damping:i,stiffness:a,restDelta:d,restSpeed:m}))};return N(0),{calculatedDuration:null,next:S=>{let _=!1;return!k&&z===void 0&&(_=!0,T(S),N(S)),z!==void 0&&S>=z?k.next(S-z):(!_&&T(S),h)}}}function G2(t,s,n){const r=[],i=n||qs.mix||Rx,a=t.length-1;for(let o=0;o<a;o++){let l=i(t[o],t[o+1]);if(s){const c=Array.isArray(s)?s[o]||Zt:s;l=ea(c,l)}r.push(l)}return r}function Q2(t,s,{clamp:n=!0,ease:r,mixer:i}={}){const a=t.length;if(Yc(a===s.length),a===1)return()=>s[0];if(a===2&&s[0]===s[1])return()=>s[1];const o=t[0]===t[1];t[0]>t[a-1]&&(t=[...t].reverse(),s=[...s].reverse());const l=G2(s,r,i),c=l.length,d=m=>{if(o&&m<t[0])return s[0];let u=0;if(c>1)for(;u<t.length-2&&!(m<t[u+1]);u++);const h=Si(t[u],t[u+1],m);return l[u](h)};return n?m=>d($s(t[0],t[a-1],m)):d}function H2(t,s){const n=t[t.length-1];for(let r=1;r<=s;r++){const i=Si(0,s,r);t.push(Pe(n,1,i))}}function Z2(t){const s=[0];return H2(s,t.length-1),s}function Y2(t,s){return t.map(n=>n*s)}function J2(t,s){return t.map(()=>s||Tx).splice(0,t.length-1)}function ui({duration:t=300,keyframes:s,times:n,ease:r="easeInOut"}){const i=c2(r)?r.map(Vu):Vu(r),a={done:!1,value:s[0]},o=Y2(n&&n.length===s.length?n:Z2(s),t),l=Q2(o,s,{ease:Array.isArray(i)?i:J2(s,i)});return{calculatedDuration:t,next:c=>(a.value=l(c),a.done=c>=t,a)}}const X2=t=>t!==null;function ld(t,{repeat:s,repeatType:n="loop"},r,i=1){const a=t.filter(X2),l=i<0||s&&n!=="loop"&&s%2===1?0:a.length-1;return!l||r===void 0?a[l]:r}const eC={decay:Bl,inertia:Bl,tween:ui,keyframes:ui,spring:Ga};function Fx(t){typeof t.type=="string"&&(t.type=eC[t.type])}class cd{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(s=>{this.resolve=s})}notifyFinished(){this.resolve()}then(s,n){return this.finished.then(s,n)}}const tC=t=>t/100;class dd extends cd{constructor(s){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:n}=this.options;n&&n.updatedAt!==zt.now()&&this.tick(zt.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=s,this.initAnimation(),this.play(),s.autoplay===!1&&this.pause()}initAnimation(){const{options:s}=this;Fx(s);const{type:n=ui,repeat:r=0,repeatDelay:i=0,repeatType:a,velocity:o=0}=s;let{keyframes:l}=s;const c=n||ui;c!==ui&&typeof l[0]!="number"&&(this.mixKeyframes=ea(tC,Rx(l[0],l[1])),l=[0,100]);const d=c({...s,keyframes:l});a==="mirror"&&(this.mirroredGenerator=c({...s,keyframes:[...l].reverse(),velocity:-o})),d.calculatedDuration===null&&(d.calculatedDuration=od(d));const{calculatedDuration:m}=d;this.calculatedDuration=m,this.resolvedDuration=m+i,this.totalDuration=this.resolvedDuration*(r+1)-i,this.generator=d}updateTime(s){const n=Math.round(s-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(s,n=!1){const{generator:r,totalDuration:i,mixKeyframes:a,mirroredGenerator:o,resolvedDuration:l,calculatedDuration:c}=this;if(this.startTime===null)return r.next(0);const{delay:d=0,keyframes:m,repeat:u,repeatType:h,repeatDelay:p,type:b,onUpdate:f,finalKeyframe:y}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,s):this.speed<0&&(this.startTime=Math.min(s-i/this.speed,this.startTime)),n?this.currentTime=s:this.updateTime(s);const w=this.currentTime-d*(this.playbackSpeed>=0?1:-1),j=this.playbackSpeed>=0?w<0:w>i;this.currentTime=Math.max(w,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=i);let v=this.currentTime,T=r;if(u){const S=Math.min(this.currentTime,i)/l;let _=Math.floor(S),g=S%1;!g&&S>=1&&(g=1),g===1&&_--,_=Math.min(_,u+1),!!(_%2)&&(h==="reverse"?(g=1-g,p&&(g-=p/l)):h==="mirror"&&(T=o)),v=$s(0,1,g)*l}const z=j?{done:!1,value:m[0]}:T.next(v);a&&(z.value=a(z.value));let{done:k}=z;!j&&c!==null&&(k=this.playbackSpeed>=0?this.currentTime>=i:this.currentTime<=0);const N=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&k);return N&&b!==Bl&&(z.value=ld(m,this.options,y,this.speed)),f&&f(z.value),N&&this.finish(),z}then(s,n){return this.finished.then(s,n)}get duration(){return js(this.calculatedDuration)}get time(){return js(this.currentTime)}set time(s){s=gs(s),this.currentTime=s,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=s:this.driver&&(this.startTime=this.driver.now()-s/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(s){this.updateTime(zt.now());const n=this.playbackSpeed!==s;this.playbackSpeed=s,n&&(this.time=js(this.currentTime))}play(){if(this.isStopped)return;const{driver:s=R2,startTime:n}=this.options;this.driver||(this.driver=s(i=>this.tick(i))),this.options.onPlay?.();const r=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=r):this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime||(this.startTime=n??r),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(zt.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(s){return this.startTime=0,this.tick(s,!0)}attachTimeline(s){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),s.observe(this)}}function sC(t){for(let s=1;s<t.length;s++)t[s]??(t[s]=t[s-1])}const jn=t=>t*180/Math.PI,Vl=t=>{const s=jn(Math.atan2(t[1],t[0]));return Wl(s)},nC={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:Vl,rotateZ:Vl,skewX:t=>jn(Math.atan(t[1])),skewY:t=>jn(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},Wl=t=>(t=t%360,t<0&&(t+=360),t),Zu=Vl,Yu=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),Ju=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),rC={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:Yu,scaleY:Ju,scale:t=>(Yu(t)+Ju(t))/2,rotateX:t=>Wl(jn(Math.atan2(t[6],t[5]))),rotateY:t=>Wl(jn(Math.atan2(-t[2],t[0]))),rotateZ:Zu,rotate:Zu,skewX:t=>jn(Math.atan(t[4])),skewY:t=>jn(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function Kl(t){return t.includes("scale")?1:0}function Gl(t,s){if(!t||t==="none")return Kl(s);const n=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,i;if(n)r=rC,i=n;else{const l=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=nC,i=l}if(!i)return Kl(s);const a=r[s],o=i[1].split(",").map(aC);return typeof a=="function"?a(o):o[a]}const iC=(t,s)=>{const{transform:n="none"}=getComputedStyle(t);return Gl(n,s)};function aC(t){return parseFloat(t.trim())}const Or=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Rr=new Set(Or),Xu=t=>t===Lr||t===te,oC=new Set(["x","y","z"]),lC=Or.filter(t=>!oC.has(t));function cC(t){const s=[];return lC.forEach(n=>{const r=t.getValue(n);r!==void 0&&(s.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),s}const Nn={width:({x:t},{paddingLeft:s="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(s)-parseFloat(n),height:({y:t},{paddingTop:s="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(s)-parseFloat(n),top:(t,{top:s})=>parseFloat(s),left:(t,{left:s})=>parseFloat(s),bottom:({y:t},{top:s})=>parseFloat(s)+(t.max-t.min),right:({x:t},{left:s})=>parseFloat(s)+(t.max-t.min),x:(t,{transform:s})=>Gl(s,"x"),y:(t,{transform:s})=>Gl(s,"y")};Nn.translateX=Nn.x;Nn.translateY=Nn.y;const kn=new Set;let Ql=!1,Hl=!1,Zl=!1;function Ux(){if(Hl){const t=Array.from(kn).filter(r=>r.needsMeasurement),s=new Set(t.map(r=>r.element)),n=new Map;s.forEach(r=>{const i=cC(r);i.length&&(n.set(r,i),r.render())}),t.forEach(r=>r.measureInitialState()),s.forEach(r=>{r.render();const i=n.get(r);i&&i.forEach(([a,o])=>{r.getValue(a)?.set(o)})}),t.forEach(r=>r.measureEndState()),t.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}Hl=!1,Ql=!1,kn.forEach(t=>t.complete(Zl)),kn.clear()}function Bx(){kn.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(Hl=!0)})}function dC(){Zl=!0,Bx(),Ux(),Zl=!1}class ud{constructor(s,n,r,i,a,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...s],this.onComplete=n,this.name=r,this.motionValue=i,this.element=a,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(kn.add(this),Ql||(Ql=!0,Ae.read(Bx),Ae.resolveKeyframes(Ux))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:s,name:n,element:r,motionValue:i}=this;if(s[0]===null){const a=i?.get(),o=s[s.length-1];if(a!==void 0)s[0]=a;else if(r&&n){const l=r.readValue(n,o);l!=null&&(s[0]=l)}s[0]===void 0&&(s[0]=o),i&&a===void 0&&i.set(s[0])}sC(s)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(s=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,s),kn.delete(this)}cancel(){this.state==="scheduled"&&(kn.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const uC=t=>t.startsWith("--");function mC(t,s,n){uC(s)?t.style.setProperty(s,n):t.style[s]=n}const hC=Jc(()=>window.ScrollTimeline!==void 0),pC={};function fC(t,s){const n=Jc(t);return()=>pC[s]??n()}const Vx=fC(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),ri=([t,s,n,r])=>`cubic-bezier(${t}, ${s}, ${n}, ${r})`,em={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:ri([0,.65,.55,1]),circOut:ri([.55,0,1,.45]),backIn:ri([.31,.01,.66,-.59]),backOut:ri([.33,1.53,.69,.99])};function Wx(t,s){if(t)return typeof t=="function"?Vx()?$x(t,s):"ease-out":_x(t)?ri(t):Array.isArray(t)?t.map(n=>Wx(n,s)||em.easeOut):em[t]}function xC(t,s,n,{delay:r=0,duration:i=300,repeat:a=0,repeatType:o="loop",ease:l="easeOut",times:c}={},d=void 0){const m={[s]:n};c&&(m.offset=c);const u=Wx(l,i);Array.isArray(u)&&(m.easing=u);const h={delay:r,duration:i,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:a+1,direction:o==="reverse"?"alternate":"normal"};return d&&(h.pseudoElement=d),t.animate(m,h)}function Kx(t){return typeof t=="function"&&"applyToOptions"in t}function gC({type:t,...s}){return Kx(t)&&Vx()?t.applyToOptions(s):(s.duration??(s.duration=300),s.ease??(s.ease="easeOut"),s)}class jC extends cd{constructor(s){if(super(),this.finishedTime=null,this.isStopped=!1,!s)return;const{element:n,name:r,keyframes:i,pseudoElement:a,allowFlatten:o=!1,finalKeyframe:l,onComplete:c}=s;this.isPseudoElement=!!a,this.allowFlatten=o,this.options=s,Yc(typeof s.type!="string");const d=gC(s);this.animation=xC(n,r,i,d,a),d.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const m=ld(i,this.options,l,this.speed);this.updateMotionValue?this.updateMotionValue(m):mC(n,r,m),this.animation.cancel()}c?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:s}=this;s==="idle"||s==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const s=this.animation.effect?.getComputedTiming?.().duration||0;return js(Number(s))}get time(){return js(Number(this.animation.currentTime)||0)}set time(s){this.finishedTime=null,this.animation.currentTime=gs(s)}get speed(){return this.animation.playbackRate}set speed(s){s<0&&(this.finishedTime=null),this.animation.playbackRate=s}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(s){this.animation.startTime=s}attachTimeline({timeline:s,observe:n}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,s&&hC()?(this.animation.timeline=s,Zt):n(this)}}const Gx={anticipate:zx,backInOut:kx,circInOut:Cx};function yC(t){return t in Gx}function bC(t){typeof t.ease=="string"&&yC(t.ease)&&(t.ease=Gx[t.ease])}const tm=10;class wC extends jC{constructor(s){bC(s),Fx(s),super(s),s.startTime&&(this.startTime=s.startTime),this.options=s}updateMotionValue(s){const{motionValue:n,onUpdate:r,onComplete:i,element:a,...o}=this.options;if(!n)return;if(s!==void 0){n.set(s);return}const l=new dd({...o,autoplay:!1}),c=gs(this.finishedTime??this.time);n.setWithVelocity(l.sample(c-tm).value,l.sample(c).value,tm),l.stop()}}const sm=(t,s)=>s==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(rn.test(t)||t==="0")&&!t.startsWith("url("));function vC(t){const s=t[0];if(t.length===1)return!0;for(let n=0;n<t.length;n++)if(t[n]!==s)return!0}function NC(t,s,n,r){const i=t[0];if(i===null)return!1;if(s==="display"||s==="visibility")return!0;const a=t[t.length-1],o=sm(i,s),l=sm(a,s);return!o||!l?!1:vC(t)||(n==="spring"||Kx(n))&&r}function Yl(t){t.duration=0,t.type}const kC=new Set(["opacity","clipPath","filter","transform"]),zC=Jc(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function SC(t){const{motionValue:s,name:n,repeatDelay:r,repeatType:i,damping:a,type:o}=t;if(!(s?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:d}=s.owner.getProps();return zC()&&n&&kC.has(n)&&(n!=="transform"||!d)&&!c&&!r&&i!=="mirror"&&a!==0&&o!=="inertia"}const CC=40;class TC extends cd{constructor({autoplay:s=!0,delay:n=0,type:r="keyframes",repeat:i=0,repeatDelay:a=0,repeatType:o="loop",keyframes:l,name:c,motionValue:d,element:m,...u}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=zt.now();const h={autoplay:s,delay:n,type:r,repeat:i,repeatDelay:a,repeatType:o,name:c,motionValue:d,element:m,...u},p=m?.KeyframeResolver||ud;this.keyframeResolver=new p(l,(b,f,y)=>this.onKeyframesResolved(b,f,h,!y),c,d,m),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(s,n,r,i){this.keyframeResolver=void 0;const{name:a,type:o,velocity:l,delay:c,isHandoff:d,onUpdate:m}=r;this.resolvedAt=zt.now(),NC(s,a,o,l)||((qs.instantAnimations||!c)&&m?.(ld(s,r,n)),s[0]=s[s.length-1],Yl(r),r.repeat=0);const h={startTime:i?this.resolvedAt?this.resolvedAt-this.createdAt>CC?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...r,keyframes:s},p=!d&&SC(h)?new wC({...h,element:h.motionValue.owner.current}):new dd(h);p.finished.then(()=>this.notifyFinished()).catch(Zt),this.pendingTimeline&&(this.stopTimeline=p.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=p}get finished(){return this._animation?this.animation.finished:this._finished}then(s,n){return this.finished.finally(s).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),dC()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(s){this.animation.time=s}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(s){this.animation.speed=s}get startTime(){return this.animation.startTime}attachTimeline(s){return this._animation?this.stopTimeline=this.animation.attachTimeline(s):this.pendingTimeline=s,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const _C=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function AC(t){const s=_C.exec(t);if(!s)return[,];const[,n,r,i]=s;return[`--${n??r}`,i]}function Qx(t,s,n=1){const[r,i]=AC(t);if(!r)return;const a=window.getComputedStyle(s).getPropertyValue(r);if(a){const o=a.trim();return xx(o)?parseFloat(o):o}return nd(i)?Qx(i,s,n+1):i}function md(t,s){return t?.[s]??t?.default??t}const Hx=new Set(["width","height","top","left","right","bottom",...Or]),DC={test:t=>t==="auto",parse:t=>t},Zx=t=>s=>s.test(t),Yx=[Lr,te,ys,Qs,v2,w2,DC],nm=t=>Yx.find(Zx(t));function PC(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||jx(t):!0}const MC=new Set(["brightness","contrast","saturate","opacity"]);function IC(t){const[s,n]=t.slice(0,-1).split("(");if(s==="drop-shadow")return t;const[r]=n.match(rd)||[];if(!r)return t;const i=n.replace(r,"");let a=MC.has(s)?1:0;return r!==n&&(a*=100),s+"("+a+i+")"}const EC=/\b([a-z-]*)\(.*?\)/gu,Jl={...rn,getAnimatableNone:t=>{const s=t.match(EC);return s?s.map(IC).join(" "):t}},rm={...Lr,transform:Math.round},LC={rotate:Qs,rotateX:Qs,rotateY:Qs,rotateZ:Qs,scale:pa,scaleX:pa,scaleY:pa,scaleZ:pa,skew:Qs,skewX:Qs,skewY:Qs,distance:te,translateX:te,translateY:te,translateZ:te,x:te,y:te,z:te,perspective:te,transformPerspective:te,opacity:Ci,originX:Wu,originY:Wu,originZ:te},hd={borderWidth:te,borderTopWidth:te,borderRightWidth:te,borderBottomWidth:te,borderLeftWidth:te,borderRadius:te,radius:te,borderTopLeftRadius:te,borderTopRightRadius:te,borderBottomRightRadius:te,borderBottomLeftRadius:te,width:te,maxWidth:te,height:te,maxHeight:te,top:te,right:te,bottom:te,left:te,padding:te,paddingTop:te,paddingRight:te,paddingBottom:te,paddingLeft:te,margin:te,marginTop:te,marginRight:te,marginBottom:te,marginLeft:te,backgroundPositionX:te,backgroundPositionY:te,...LC,zIndex:rm,fillOpacity:Ci,strokeOpacity:Ci,numOctaves:rm},OC={...hd,color:Ue,backgroundColor:Ue,outlineColor:Ue,fill:Ue,stroke:Ue,borderColor:Ue,borderTopColor:Ue,borderRightColor:Ue,borderBottomColor:Ue,borderLeftColor:Ue,filter:Jl,WebkitFilter:Jl},Jx=t=>OC[t];function Xx(t,s){let n=Jx(t);return n!==Jl&&(n=rn),n.getAnimatableNone?n.getAnimatableNone(s):void 0}const RC=new Set(["auto","none","0"]);function $C(t,s,n){let r=0,i;for(;r<t.length&&!i;){const a=t[r];typeof a=="string"&&!RC.has(a)&&Ti(a).values.length&&(i=t[r]),r++}if(i&&n)for(const a of s)t[a]=Xx(n,i)}class qC extends ud{constructor(s,n,r,i,a){super(s,n,r,i,a,!0)}readKeyframes(){const{unresolvedKeyframes:s,element:n,name:r}=this;if(!n||!n.current)return;super.readKeyframes();for(let c=0;c<s.length;c++){let d=s[c];if(typeof d=="string"&&(d=d.trim(),nd(d))){const m=Qx(d,n.current);m!==void 0&&(s[c]=m),c===s.length-1&&(this.finalKeyframe=d)}}if(this.resolveNoneKeyframes(),!Hx.has(r)||s.length!==2)return;const[i,a]=s,o=nm(i),l=nm(a);if(o!==l)if(Xu(o)&&Xu(l))for(let c=0;c<s.length;c++){const d=s[c];typeof d=="string"&&(s[c]=parseFloat(d))}else Nn[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:s,name:n}=this,r=[];for(let i=0;i<s.length;i++)(s[i]===null||PC(s[i]))&&r.push(i);r.length&&$C(s,r,n)}measureInitialState(){const{element:s,unresolvedKeyframes:n,name:r}=this;if(!s||!s.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Nn[r](s.measureViewportBox(),window.getComputedStyle(s.current)),n[0]=this.measuredOrigin;const i=n[n.length-1];i!==void 0&&s.getValue(r,i).jump(i,!1)}measureEndState(){const{element:s,name:n,unresolvedKeyframes:r}=this;if(!s||!s.current)return;const i=s.getValue(n);i&&i.jump(this.measuredOrigin,!1);const a=r.length-1,o=r[a];r[a]=Nn[n](s.measureViewportBox(),window.getComputedStyle(s.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),this.removedTransforms?.length&&this.removedTransforms.forEach(([l,c])=>{s.getValue(l).set(c)}),this.resolveNoneKeyframes()}}function FC(t,s,n){if(t instanceof EventTarget)return[t];if(typeof t=="string"){let r=document;const i=n?.[t]??r.querySelectorAll(t);return i?Array.from(i):[]}return Array.from(t)}const eg=(t,s)=>s&&typeof t=="number"?s.transform(t):t;function tg(t){return gx(t)&&"offsetHeight"in t}const im=30,UC=t=>!isNaN(parseFloat(t));class BC{constructor(s,n={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=r=>{const i=zt.now();if(this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const a of this.dependents)a.dirty()},this.hasAnimated=!1,this.setCurrent(s),this.owner=n.owner}setCurrent(s){this.current=s,this.updatedAt=zt.now(),this.canTrackVelocity===null&&s!==void 0&&(this.canTrackVelocity=UC(this.current))}setPrevFrameValue(s=this.current){this.prevFrameValue=s,this.prevUpdatedAt=this.updatedAt}onChange(s){return this.on("change",s)}on(s,n){this.events[s]||(this.events[s]=new Xc);const r=this.events[s].add(n);return s==="change"?()=>{r(),Ae.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const s in this.events)this.events[s].clear()}attach(s,n){this.passiveEffect=s,this.stopPassiveEffect=n}set(s){this.passiveEffect?this.passiveEffect(s,this.updateAndNotify):this.updateAndNotify(s)}setWithVelocity(s,n,r){this.set(n),this.prev=void 0,this.prevFrameValue=s,this.prevUpdatedAt=this.updatedAt-r}jump(s,n=!0){this.updateAndNotify(s),this.prev=s,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(s){this.dependents||(this.dependents=new Set),this.dependents.add(s)}removeDependent(s){this.dependents&&this.dependents.delete(s)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const s=zt.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||s-this.updatedAt>im)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,im);return yx(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(s){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=s(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function vr(t,s){return new BC(t,s)}const{schedule:pd}=Ax(queueMicrotask,!1),rs={x:!1,y:!1};function sg(){return rs.x||rs.y}function VC(t){return t==="x"||t==="y"?rs[t]?null:(rs[t]=!0,()=>{rs[t]=!1}):rs.x||rs.y?null:(rs.x=rs.y=!0,()=>{rs.x=rs.y=!1})}function ng(t,s){const n=FC(t),r=new AbortController,i={passive:!0,...s,signal:r.signal};return[n,i,()=>r.abort()]}function am(t){return!(t.pointerType==="touch"||sg())}function WC(t,s,n={}){const[r,i,a]=ng(t,n),o=l=>{if(!am(l))return;const{target:c}=l,d=s(c,l);if(typeof d!="function"||!c)return;const m=u=>{am(u)&&(d(u),c.removeEventListener("pointerleave",m))};c.addEventListener("pointerleave",m,i)};return r.forEach(l=>{l.addEventListener("pointerenter",o,i)}),a}const rg=(t,s)=>s?t===s?!0:rg(t,s.parentElement):!1,fd=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,KC=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function GC(t){return KC.has(t.tagName)||t.tabIndex!==-1}const za=new WeakSet;function om(t){return s=>{s.key==="Enter"&&t(s)}}function ul(t,s){t.dispatchEvent(new PointerEvent("pointer"+s,{isPrimary:!0,bubbles:!0}))}const QC=(t,s)=>{const n=t.currentTarget;if(!n)return;const r=om(()=>{if(za.has(n))return;ul(n,"down");const i=om(()=>{ul(n,"up")}),a=()=>ul(n,"cancel");n.addEventListener("keyup",i,s),n.addEventListener("blur",a,s)});n.addEventListener("keydown",r,s),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),s)};function lm(t){return fd(t)&&!sg()}function HC(t,s,n={}){const[r,i,a]=ng(t,n),o=l=>{const c=l.currentTarget;if(!lm(l))return;za.add(c);const d=s(c,l),m=(p,b)=>{window.removeEventListener("pointerup",u),window.removeEventListener("pointercancel",h),za.has(c)&&za.delete(c),lm(p)&&typeof d=="function"&&d(p,{success:b})},u=p=>{m(p,c===window||c===document||n.useGlobalTarget||rg(c,p.target))},h=p=>{m(p,!1)};window.addEventListener("pointerup",u,i),window.addEventListener("pointercancel",h,i)};return r.forEach(l=>{(n.useGlobalTarget?window:l).addEventListener("pointerdown",o,i),tg(l)&&(l.addEventListener("focus",d=>QC(d,i)),!GC(l)&&!l.hasAttribute("tabindex")&&(l.tabIndex=0))}),a}function ig(t){return gx(t)&&"ownerSVGElement"in t}function ZC(t){return ig(t)&&t.tagName==="svg"}const lt=t=>!!(t&&t.getVelocity),YC=[...Yx,Ue,rn],JC=t=>YC.find(Zx(t)),xd=x.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});class XC extends x.Component{getSnapshotBeforeUpdate(s){const n=this.props.childRef.current;if(n&&s.isPresent&&!this.props.isPresent){const r=n.offsetParent,i=tg(r)&&r.offsetWidth||0,a=this.props.sizeRef.current;a.height=n.offsetHeight||0,a.width=n.offsetWidth||0,a.top=n.offsetTop,a.left=n.offsetLeft,a.right=i-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function eT({children:t,isPresent:s,anchorX:n,root:r}){const i=x.useId(),a=x.useRef(null),o=x.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:l}=x.useContext(xd);return x.useInsertionEffect(()=>{const{width:c,height:d,top:m,left:u,right:h}=o.current;if(s||!a.current||!c||!d)return;const p=n==="left"?`left: ${u}`:`right: ${h}`;a.current.dataset.motionPopId=i;const b=document.createElement("style");l&&(b.nonce=l);const f=r??document.head;return f.appendChild(b),b.sheet&&b.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${c}px !important;
            height: ${d}px !important;
            ${p}px !important;
            top: ${m}px !important;
          }
        `),()=>{f.contains(b)&&f.removeChild(b)}},[s]),e.jsx(XC,{isPresent:s,childRef:a,sizeRef:o,children:x.cloneElement(t,{ref:a})})}const tT=({children:t,initial:s,isPresent:n,onExitComplete:r,custom:i,presenceAffectsLayout:a,mode:o,anchorX:l,root:c})=>{const d=Gc(sT),m=x.useId();let u=!0,h=x.useMemo(()=>(u=!1,{id:m,initial:s,isPresent:n,custom:i,onExitComplete:p=>{d.set(p,!0);for(const b of d.values())if(!b)return;r&&r()},register:p=>(d.set(p,!1),()=>d.delete(p))}),[n,d,r]);return a&&u&&(h={...h}),x.useMemo(()=>{d.forEach((p,b)=>d.set(b,!1))},[n]),x.useEffect(()=>{!n&&!d.size&&r&&r()},[n]),o==="popLayout"&&(t=e.jsx(eT,{isPresent:n,anchorX:l,root:c,children:t})),e.jsx(So.Provider,{value:h,children:t})};function sT(){return new Map}function ag(t=!0){const s=x.useContext(So);if(s===null)return[!0,null];const{isPresent:n,onExitComplete:r,register:i}=s,a=x.useId();x.useEffect(()=>{if(t)return i(a)},[t]);const o=x.useCallback(()=>t&&r&&r(a),[a,r,t]);return!n&&r?[!1,o]:[!0]}const fa=t=>t.key||"";function cm(t){const s=[];return x.Children.forEach(t,n=>{x.isValidElement(n)&&s.push(n)}),s}const nT=({children:t,custom:s,initial:n=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:a="sync",propagate:o=!1,anchorX:l="left",root:c})=>{const[d,m]=ag(o),u=x.useMemo(()=>cm(t),[t]),h=o&&!d?[]:u.map(fa),p=x.useRef(!0),b=x.useRef(u),f=Gc(()=>new Map),[y,w]=x.useState(u),[j,v]=x.useState(u);fx(()=>{p.current=!1,b.current=u;for(let k=0;k<j.length;k++){const N=fa(j[k]);h.includes(N)?f.delete(N):f.get(N)!==!0&&f.set(N,!1)}},[j,h.length,h.join("-")]);const T=[];if(u!==y){let k=[...u];for(let N=0;N<j.length;N++){const S=j[N],_=fa(S);h.includes(_)||(k.splice(N,0,S),T.push(S))}return a==="wait"&&T.length&&(k=T),v(cm(k)),w(u),null}const{forceRender:z}=x.useContext(Kc);return e.jsx(e.Fragment,{children:j.map(k=>{const N=fa(k),S=o&&!d?!1:u===j||h.includes(N),_=()=>{if(f.has(N))f.set(N,!0);else return;let g=!0;f.forEach(C=>{C||(g=!1)}),g&&(z?.(),v(b.current),o&&m?.(),r&&r())};return e.jsx(tT,{isPresent:S,initial:!p.current||n?void 0:!1,custom:s,presenceAffectsLayout:i,mode:a,root:c,onExitComplete:S?void 0:_,anchorX:l,children:k},N)})})},og=x.createContext({strict:!1}),dm={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Nr={};for(const t in dm)Nr[t]={isEnabled:s=>dm[t].some(n=>!!s[n])};function rT(t){for(const s in t)Nr[s]={...Nr[s],...t[s]}}const iT=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Qa(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||iT.has(t)}let lg=t=>!Qa(t);function aT(t){typeof t=="function"&&(lg=s=>s.startsWith("on")?!Qa(s):t(s))}try{aT(require("@emotion/is-prop-valid").default)}catch{}function oT(t,s,n){const r={};for(const i in t)i==="values"&&typeof t.values=="object"||(lg(i)||n===!0&&Qa(i)||!s&&!Qa(i)||t.draggable&&i.startsWith("onDrag"))&&(r[i]=t[i]);return r}const Co=x.createContext({});function To(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function _i(t){return typeof t=="string"||Array.isArray(t)}const gd=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],jd=["initial",...gd];function _o(t){return To(t.animate)||jd.some(s=>_i(t[s]))}function cg(t){return!!(_o(t)||t.variants)}function lT(t,s){if(_o(t)){const{initial:n,animate:r}=t;return{initial:n===!1||_i(n)?n:void 0,animate:_i(r)?r:void 0}}return t.inherit!==!1?s:{}}function cT(t){const{initial:s,animate:n}=lT(t,x.useContext(Co));return x.useMemo(()=>({initial:s,animate:n}),[um(s),um(n)])}function um(t){return Array.isArray(t)?t.join(" "):t}const Ai={};function dT(t){for(const s in t)Ai[s]=t[s],sd(s)&&(Ai[s].isCSSVariable=!0)}function dg(t,{layout:s,layoutId:n}){return Rr.has(t)||t.startsWith("origin")||(s||n!==void 0)&&(!!Ai[t]||t==="opacity")}const uT={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},mT=Or.length;function hT(t,s,n){let r="",i=!0;for(let a=0;a<mT;a++){const o=Or[a],l=t[o];if(l===void 0)continue;let c=!0;if(typeof l=="number"?c=l===(o.startsWith("scale")?1:0):c=parseFloat(l)===0,!c||n){const d=eg(l,hd[o]);if(!c){i=!1;const m=uT[o]||o;r+=`${m}(${d}) `}n&&(s[o]=d)}}return r=r.trim(),n?r=n(s,i?"":r):i&&(r="none"),r}function yd(t,s,n){const{style:r,vars:i,transformOrigin:a}=t;let o=!1,l=!1;for(const c in s){const d=s[c];if(Rr.has(c)){o=!0;continue}else if(sd(c)){i[c]=d;continue}else{const m=eg(d,hd[c]);c.startsWith("origin")?(l=!0,a[c]=m):r[c]=m}}if(s.transform||(o||n?r.transform=hT(s,t.transform,n):r.transform&&(r.transform="none")),l){const{originX:c="50%",originY:d="50%",originZ:m=0}=a;r.transformOrigin=`${c} ${d} ${m}`}}const bd=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function ug(t,s,n){for(const r in s)!lt(s[r])&&!dg(r,n)&&(t[r]=s[r])}function pT({transformTemplate:t},s){return x.useMemo(()=>{const n=bd();return yd(n,s,t),Object.assign({},n.vars,n.style)},[s])}function fT(t,s){const n=t.style||{},r={};return ug(r,n,t),Object.assign(r,pT(t,s)),r}function xT(t,s){const n={},r=fT(t,s);return t.drag&&t.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(n.tabIndex=0),n.style=r,n}const gT={offset:"stroke-dashoffset",array:"stroke-dasharray"},jT={offset:"strokeDashoffset",array:"strokeDasharray"};function yT(t,s,n=1,r=0,i=!0){t.pathLength=1;const a=i?gT:jT;t[a.offset]=te.transform(-r);const o=te.transform(s),l=te.transform(n);t[a.array]=`${o} ${l}`}function mg(t,{attrX:s,attrY:n,attrScale:r,pathLength:i,pathSpacing:a=1,pathOffset:o=0,...l},c,d,m){if(yd(t,l,d),c){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:u,style:h}=t;u.transform&&(h.transform=u.transform,delete u.transform),(h.transform||u.transformOrigin)&&(h.transformOrigin=u.transformOrigin??"50% 50%",delete u.transformOrigin),h.transform&&(h.transformBox=m?.transformBox??"fill-box",delete u.transformBox),s!==void 0&&(u.x=s),n!==void 0&&(u.y=n),r!==void 0&&(u.scale=r),i!==void 0&&yT(u,i,a,o,!1)}const hg=()=>({...bd(),attrs:{}}),pg=t=>typeof t=="string"&&t.toLowerCase()==="svg";function bT(t,s,n,r){const i=x.useMemo(()=>{const a=hg();return mg(a,s,pg(r),t.transformTemplate,t.style),{...a.attrs,style:{...a.style}}},[s]);if(t.style){const a={};ug(a,t.style,t),i.style={...a,...i.style}}return i}const wT=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function wd(t){return typeof t!="string"||t.includes("-")?!1:!!(wT.indexOf(t)>-1||/[A-Z]/u.test(t))}function vT(t,s,n,{latestValues:r},i,a=!1){const l=(wd(t)?bT:xT)(s,r,i,t),c=oT(s,typeof t=="string",a),d=t!==x.Fragment?{...c,...l,ref:n}:{},{children:m}=s,u=x.useMemo(()=>lt(m)?m.get():m,[m]);return x.createElement(t,{...d,children:u})}function mm(t){const s=[{},{}];return t?.values.forEach((n,r)=>{s[0][r]=n.get(),s[1][r]=n.getVelocity()}),s}function vd(t,s,n,r){if(typeof s=="function"){const[i,a]=mm(r);s=s(n!==void 0?n:t.custom,i,a)}if(typeof s=="string"&&(s=t.variants&&t.variants[s]),typeof s=="function"){const[i,a]=mm(r);s=s(n!==void 0?n:t.custom,i,a)}return s}function Sa(t){return lt(t)?t.get():t}function NT({scrapeMotionValuesFromProps:t,createRenderState:s},n,r,i){return{latestValues:kT(n,r,i,t),renderState:s()}}function kT(t,s,n,r){const i={},a=r(t,{});for(const h in a)i[h]=Sa(a[h]);let{initial:o,animate:l}=t;const c=_o(t),d=cg(t);s&&d&&!c&&t.inherit!==!1&&(o===void 0&&(o=s.initial),l===void 0&&(l=s.animate));let m=n?n.initial===!1:!1;m=m||o===!1;const u=m?l:o;if(u&&typeof u!="boolean"&&!To(u)){const h=Array.isArray(u)?u:[u];for(let p=0;p<h.length;p++){const b=vd(t,h[p]);if(b){const{transitionEnd:f,transition:y,...w}=b;for(const j in w){let v=w[j];if(Array.isArray(v)){const T=m?v.length-1:0;v=v[T]}v!==null&&(i[j]=v)}for(const j in f)i[j]=f[j]}}}return i}const fg=t=>(s,n)=>{const r=x.useContext(Co),i=x.useContext(So),a=()=>NT(t,s,r,i);return n?a():Gc(a)};function Nd(t,s,n){const{style:r}=t,i={};for(const a in r)(lt(r[a])||s.style&&lt(s.style[a])||dg(a,t)||n?.getValue(a)?.liveStyle!==void 0)&&(i[a]=r[a]);return i}const zT=fg({scrapeMotionValuesFromProps:Nd,createRenderState:bd});function xg(t,s,n){const r=Nd(t,s,n);for(const i in t)if(lt(t[i])||lt(s[i])){const a=Or.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[a]=t[i]}return r}const ST=fg({scrapeMotionValuesFromProps:xg,createRenderState:hg}),CT=Symbol.for("motionComponentSymbol");function er(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function TT(t,s,n){return x.useCallback(r=>{r&&t.onMount&&t.onMount(r),s&&(r?s.mount(r):s.unmount()),n&&(typeof n=="function"?n(r):er(n)&&(n.current=r))},[s])}const kd=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),_T="framerAppearId",gg="data-"+kd(_T),jg=x.createContext({});function AT(t,s,n,r,i){const{visualElement:a}=x.useContext(Co),o=x.useContext(og),l=x.useContext(So),c=x.useContext(xd).reducedMotion,d=x.useRef(null);r=r||o.renderer,!d.current&&r&&(d.current=r(t,{visualState:s,parent:a,props:n,presenceContext:l,blockInitialAnimation:l?l.initial===!1:!1,reducedMotionConfig:c}));const m=d.current,u=x.useContext(jg);m&&!m.projection&&i&&(m.type==="html"||m.type==="svg")&&DT(d.current,n,i,u);const h=x.useRef(!1);x.useInsertionEffect(()=>{m&&h.current&&m.update(n,l)});const p=n[gg],b=x.useRef(!!p&&!window.MotionHandoffIsComplete?.(p)&&window.MotionHasOptimisedAnimation?.(p));return fx(()=>{m&&(h.current=!0,window.MotionIsMounted=!0,m.updateFeatures(),m.scheduleRenderMicrotask(),b.current&&m.animationState&&m.animationState.animateChanges())}),x.useEffect(()=>{m&&(!b.current&&m.animationState&&m.animationState.animateChanges(),b.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(p)}),b.current=!1),m.enteringChildren=void 0)}),m}function DT(t,s,n,r){const{layoutId:i,layout:a,drag:o,dragConstraints:l,layoutScroll:c,layoutRoot:d,layoutCrossfade:m}=s;t.projection=new n(t.latestValues,s["data-framer-portal-id"]?void 0:yg(t.parent)),t.projection.setOptions({layoutId:i,layout:a,alwaysMeasureLayout:!!o||l&&er(l),visualElement:t,animationType:typeof a=="string"?a:"both",initialPromotionConfig:r,crossfade:m,layoutScroll:c,layoutRoot:d})}function yg(t){if(t)return t.options.allowProjection!==!1?t.projection:yg(t.parent)}function ml(t,{forwardMotionProps:s=!1}={},n,r){n&&rT(n);const i=wd(t)?ST:zT;function a(l,c){let d;const m={...x.useContext(xd),...l,layoutId:PT(l)},{isStatic:u}=m,h=cT(l),p=i(l,u);if(!u&&Qc){MT();const b=IT(m);d=b.MeasureLayout,h.visualElement=AT(t,p,m,r,b.ProjectionNode)}return e.jsxs(Co.Provider,{value:h,children:[d&&h.visualElement?e.jsx(d,{visualElement:h.visualElement,...m}):null,vT(t,l,TT(p,h.visualElement,c),p,u,s)]})}a.displayName=`motion.${typeof t=="string"?t:`create(${t.displayName??t.name??""})`}`;const o=x.forwardRef(a);return o[CT]=t,o}function PT({layoutId:t}){const s=x.useContext(Kc).id;return s&&t!==void 0?s+"-"+t:t}function MT(t,s){x.useContext(og).strict}function IT(t){const{drag:s,layout:n}=Nr;if(!s&&!n)return{};const r={...s,...n};return{MeasureLayout:s?.isEnabled(t)||n?.isEnabled(t)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}function ET(t,s){if(typeof Proxy>"u")return ml;const n=new Map,r=(a,o)=>ml(a,o,t,s),i=(a,o)=>r(a,o);return new Proxy(i,{get:(a,o)=>o==="create"?r:(n.has(o)||n.set(o,ml(o,void 0,t,s)),n.get(o))})}function bg({top:t,left:s,right:n,bottom:r}){return{x:{min:s,max:n},y:{min:t,max:r}}}function LT({x:t,y:s}){return{top:s.min,right:t.max,bottom:s.max,left:t.min}}function OT(t,s){if(!s)return t;const n=s({x:t.left,y:t.top}),r=s({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}function hl(t){return t===void 0||t===1}function Xl({scale:t,scaleX:s,scaleY:n}){return!hl(t)||!hl(s)||!hl(n)}function fn(t){return Xl(t)||wg(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function wg(t){return hm(t.x)||hm(t.y)}function hm(t){return t&&t!=="0%"}function Ha(t,s,n){const r=t-n,i=s*r;return n+i}function pm(t,s,n,r,i){return i!==void 0&&(t=Ha(t,i,r)),Ha(t,n,r)+s}function ec(t,s=0,n=1,r,i){t.min=pm(t.min,s,n,r,i),t.max=pm(t.max,s,n,r,i)}function vg(t,{x:s,y:n}){ec(t.x,s.translate,s.scale,s.originPoint),ec(t.y,n.translate,n.scale,n.originPoint)}const fm=.999999999999,xm=1.0000000000001;function RT(t,s,n,r=!1){const i=n.length;if(!i)return;s.x=s.y=1;let a,o;for(let l=0;l<i;l++){a=n[l],o=a.projectionDelta;const{visualElement:c}=a.options;c&&c.props.style&&c.props.style.display==="contents"||(r&&a.options.layoutScroll&&a.scroll&&a!==a.root&&sr(t,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),o&&(s.x*=o.x.scale,s.y*=o.y.scale,vg(t,o)),r&&fn(a.latestValues)&&sr(t,a.latestValues))}s.x<xm&&s.x>fm&&(s.x=1),s.y<xm&&s.y>fm&&(s.y=1)}function tr(t,s){t.min=t.min+s,t.max=t.max+s}function gm(t,s,n,r,i=.5){const a=Pe(t.min,t.max,i);ec(t,s,n,a,r)}function sr(t,s){gm(t.x,s.x,s.scaleX,s.scale,s.originX),gm(t.y,s.y,s.scaleY,s.scale,s.originY)}function Ng(t,s){return bg(OT(t.getBoundingClientRect(),s))}function $T(t,s,n){const r=Ng(t,n),{scroll:i}=s;return i&&(tr(r.x,i.offset.x),tr(r.y,i.offset.y)),r}const jm=()=>({translate:0,scale:1,origin:0,originPoint:0}),nr=()=>({x:jm(),y:jm()}),ym=()=>({min:0,max:0}),qe=()=>({x:ym(),y:ym()}),tc={current:null},kg={current:!1};function qT(){if(kg.current=!0,!!Qc)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),s=()=>tc.current=t.matches;t.addEventListener("change",s),s()}else tc.current=!1}const FT=new WeakMap;function UT(t,s,n){for(const r in s){const i=s[r],a=n[r];if(lt(i))t.addValue(r,i);else if(lt(a))t.addValue(r,vr(i,{owner:t}));else if(a!==i)if(t.hasValue(r)){const o=t.getValue(r);o.liveStyle===!0?o.jump(i):o.hasAnimated||o.set(i)}else{const o=t.getStaticValue(r);t.addValue(r,vr(o!==void 0?o:i,{owner:t}))}}for(const r in n)s[r]===void 0&&t.removeValue(r);return s}const bm=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class BT{scrapeMotionValuesFromProps(s,n,r){return{}}constructor({parent:s,props:n,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:a,visualState:o},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=ud,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const h=zt.now();this.renderScheduledAt<h&&(this.renderScheduledAt=h,Ae.render(this.render,!1,!0))};const{latestValues:c,renderState:d}=o;this.latestValues=c,this.baseTarget={...c},this.initialValues=n.initial?{...c}:{},this.renderState=d,this.parent=s,this.props=n,this.presenceContext=r,this.depth=s?s.depth+1:0,this.reducedMotionConfig=i,this.options=l,this.blockInitialAnimation=!!a,this.isControllingVariants=_o(n),this.isVariantNode=cg(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(s&&s.current);const{willChange:m,...u}=this.scrapeMotionValuesFromProps(n,{},this);for(const h in u){const p=u[h];c[h]!==void 0&&lt(p)&&p.set(c[h])}}mount(s){this.current=s,FT.set(s,this),this.projection&&!this.projection.instance&&this.projection.mount(s),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),kg.current||qT(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:tc.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),nn(this.notifyUpdate),nn(this.render),this.valueSubscriptions.forEach(s=>s()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const s in this.events)this.events[s].clear();for(const s in this.features){const n=this.features[s];n&&(n.unmount(),n.isMounted=!1)}this.current=null}addChild(s){this.children.add(s),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(s)}removeChild(s){this.children.delete(s),this.enteringChildren&&this.enteringChildren.delete(s)}bindToMotionValue(s,n){this.valueSubscriptions.has(s)&&this.valueSubscriptions.get(s)();const r=Rr.has(s);r&&this.onBindTransform&&this.onBindTransform();const i=n.on("change",o=>{this.latestValues[s]=o,this.props.onUpdate&&Ae.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,s,n)),this.valueSubscriptions.set(s,()=>{i(),a&&a(),n.owner&&n.stop()})}sortNodePosition(s){return!this.current||!this.sortInstanceNodePosition||this.type!==s.type?0:this.sortInstanceNodePosition(this.current,s.current)}updateFeatures(){let s="animation";for(s in Nr){const n=Nr[s];if(!n)continue;const{isEnabled:r,Feature:i}=n;if(!this.features[s]&&i&&r(this.props)&&(this.features[s]=new i(this)),this.features[s]){const a=this.features[s];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):qe()}getStaticValue(s){return this.latestValues[s]}setStaticValue(s,n){this.latestValues[s]=n}update(s,n){(s.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=s,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<bm.length;r++){const i=bm[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const a="on"+i,o=s[a];o&&(this.propEventSubscriptions[i]=this.on(i,o))}this.prevMotionValues=UT(this,this.scrapeMotionValuesFromProps(s,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(s){return this.props.variants?this.props.variants[s]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(s){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(s),()=>n.variantChildren.delete(s)}addValue(s,n){const r=this.values.get(s);n!==r&&(r&&this.removeValue(s),this.bindToMotionValue(s,n),this.values.set(s,n),this.latestValues[s]=n.get())}removeValue(s){this.values.delete(s);const n=this.valueSubscriptions.get(s);n&&(n(),this.valueSubscriptions.delete(s)),delete this.latestValues[s],this.removeValueFromRenderState(s,this.renderState)}hasValue(s){return this.values.has(s)}getValue(s,n){if(this.props.values&&this.props.values[s])return this.props.values[s];let r=this.values.get(s);return r===void 0&&n!==void 0&&(r=vr(n===null?void 0:n,{owner:this}),this.addValue(s,r)),r}readValue(s,n){let r=this.latestValues[s]!==void 0||!this.current?this.latestValues[s]:this.getBaseTargetFromProps(this.props,s)??this.readValueFromInstance(this.current,s,this.options);return r!=null&&(typeof r=="string"&&(xx(r)||jx(r))?r=parseFloat(r):!JC(r)&&rn.test(n)&&(r=Xx(s,n)),this.setBaseTarget(s,lt(r)?r.get():r)),lt(r)?r.get():r}setBaseTarget(s,n){this.baseTarget[s]=n}getBaseTarget(s){const{initial:n}=this.props;let r;if(typeof n=="string"||typeof n=="object"){const a=vd(this.props,n,this.presenceContext?.custom);a&&(r=a[s])}if(n&&r!==void 0)return r;const i=this.getBaseTargetFromProps(this.props,s);return i!==void 0&&!lt(i)?i:this.initialValues[s]!==void 0&&r===void 0?void 0:this.baseTarget[s]}on(s,n){return this.events[s]||(this.events[s]=new Xc),this.events[s].add(n)}notify(s,...n){this.events[s]&&this.events[s].notify(...n)}scheduleRenderMicrotask(){pd.render(this.render)}}class zg extends BT{constructor(){super(...arguments),this.KeyframeResolver=qC}sortInstanceNodePosition(s,n){return s.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(s,n){return s.style?s.style[n]:void 0}removeValueFromRenderState(s,{vars:n,style:r}){delete n[s],delete r[s]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:s}=this.props;lt(s)&&(this.childSubscription=s.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function Sg(t,{style:s,vars:n},r,i){const a=t.style;let o;for(o in s)a[o]=s[o];i?.applyProjectionStyles(a,r);for(o in n)a.setProperty(o,n[o])}function VT(t){return window.getComputedStyle(t)}class WT extends zg{constructor(){super(...arguments),this.type="html",this.renderInstance=Sg}readValueFromInstance(s,n){if(Rr.has(n))return this.projection?.isProjecting?Kl(n):iC(s,n);{const r=VT(s),i=(sd(n)?r.getPropertyValue(n):r[n])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(s,{transformPagePoint:n}){return Ng(s,n)}build(s,n,r){yd(s,n,r.transformTemplate)}scrapeMotionValuesFromProps(s,n,r){return Nd(s,n,r)}}const Cg=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function KT(t,s,n,r){Sg(t,s,void 0,r);for(const i in s.attrs)t.setAttribute(Cg.has(i)?i:kd(i),s.attrs[i])}class GT extends zg{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=qe}getBaseTargetFromProps(s,n){return s[n]}readValueFromInstance(s,n){if(Rr.has(n)){const r=Jx(n);return r&&r.default||0}return n=Cg.has(n)?n:kd(n),s.getAttribute(n)}scrapeMotionValuesFromProps(s,n,r){return xg(s,n,r)}build(s,n,r){mg(s,n,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(s,n,r,i){KT(s,n,r,i)}mount(s){this.isSVGTag=pg(s.tagName),super.mount(s)}}const QT=(t,s)=>wd(t)?new GT(s):new WT(s,{allowProjection:t!==x.Fragment});function dr(t,s,n){const r=t.getProps();return vd(r,s,n!==void 0?n:r.custom,t)}const sc=t=>Array.isArray(t);function HT(t,s,n){t.hasValue(s)?t.getValue(s).set(n):t.addValue(s,vr(n))}function ZT(t){return sc(t)?t[t.length-1]||0:t}function YT(t,s){const n=dr(t,s);let{transitionEnd:r={},transition:i={},...a}=n||{};a={...a,...r};for(const o in a){const l=ZT(a[o]);HT(t,o,l)}}function JT(t){return!!(lt(t)&&t.add)}function nc(t,s){const n=t.getValue("willChange");if(JT(n))return n.add(s);if(!n&&qs.WillChange){const r=new qs.WillChange("auto");t.addValue("willChange",r),r.add(s)}}function Tg(t){return t.props[gg]}const XT=t=>t!==null;function e4(t,{repeat:s,repeatType:n="loop"},r){const i=t.filter(XT),a=s&&n!=="loop"&&s%2===1?0:i.length-1;return i[a]}const t4={type:"spring",stiffness:500,damping:25,restSpeed:10},s4=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),n4={type:"keyframes",duration:.8},r4={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},i4=(t,{keyframes:s})=>s.length>2?n4:Rr.has(t)?t.startsWith("scale")?s4(s[1]):t4:r4;function a4({when:t,delay:s,delayChildren:n,staggerChildren:r,staggerDirection:i,repeat:a,repeatType:o,repeatDelay:l,from:c,elapsed:d,...m}){return!!Object.keys(m).length}const zd=(t,s,n,r={},i,a)=>o=>{const l=md(r,t)||{},c=l.delay||r.delay||0;let{elapsed:d=0}=r;d=d-gs(c);const m={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:s.getVelocity(),...l,delay:-d,onUpdate:h=>{s.set(h),l.onUpdate&&l.onUpdate(h)},onComplete:()=>{o(),l.onComplete&&l.onComplete()},name:t,motionValue:s,element:a?void 0:i};a4(l)||Object.assign(m,i4(t,m)),m.duration&&(m.duration=gs(m.duration)),m.repeatDelay&&(m.repeatDelay=gs(m.repeatDelay)),m.from!==void 0&&(m.keyframes[0]=m.from);let u=!1;if((m.type===!1||m.duration===0&&!m.repeatDelay)&&(Yl(m),m.delay===0&&(u=!0)),(qs.instantAnimations||qs.skipAnimations)&&(u=!0,Yl(m),m.delay=0),m.allowFlatten=!l.type&&!l.ease,u&&!a&&s.get()!==void 0){const h=e4(m.keyframes,l);if(h!==void 0){Ae.update(()=>{m.onUpdate(h),m.onComplete()});return}}return l.isSync?new dd(m):new TC(m)};function o4({protectedKeys:t,needsAnimating:s},n){const r=t.hasOwnProperty(n)&&s[n]!==!0;return s[n]=!1,r}function _g(t,s,{delay:n=0,transitionOverride:r,type:i}={}){let{transition:a=t.getDefaultTransition(),transitionEnd:o,...l}=s;r&&(a=r);const c=[],d=i&&t.animationState&&t.animationState.getState()[i];for(const m in l){const u=t.getValue(m,t.latestValues[m]??null),h=l[m];if(h===void 0||d&&o4(d,m))continue;const p={delay:n,...md(a||{},m)},b=u.get();if(b!==void 0&&!u.isAnimating&&!Array.isArray(h)&&h===b&&!p.velocity)continue;let f=!1;if(window.MotionHandoffAnimation){const w=Tg(t);if(w){const j=window.MotionHandoffAnimation(w,m,Ae);j!==null&&(p.startTime=j,f=!0)}}nc(t,m),u.start(zd(m,u,h,t.shouldReduceMotion&&Hx.has(m)?{type:!1}:p,t,f));const y=u.animation;y&&c.push(y)}return o&&Promise.all(c).then(()=>{Ae.update(()=>{o&&YT(t,o)})}),c}function Ag(t,s,n,r=0,i=1){const a=Array.from(t).sort((d,m)=>d.sortNodePosition(m)).indexOf(s),o=t.size,l=(o-1)*r;return typeof n=="function"?n(a,o):i===1?a*r:l-a*r}function rc(t,s,n={}){const r=dr(t,s,n.type==="exit"?t.presenceContext?.custom:void 0);let{transition:i=t.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(i=n.transitionOverride);const a=r?()=>Promise.all(_g(t,r,n)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(c=0)=>{const{delayChildren:d=0,staggerChildren:m,staggerDirection:u}=i;return l4(t,s,c,d,m,u,n)}:()=>Promise.resolve(),{when:l}=i;if(l){const[c,d]=l==="beforeChildren"?[a,o]:[o,a];return c().then(()=>d())}else return Promise.all([a(),o(n.delay)])}function l4(t,s,n=0,r=0,i=0,a=1,o){const l=[];for(const c of t.variantChildren)c.notify("AnimationStart",s),l.push(rc(c,s,{...o,delay:n+(typeof r=="function"?0:r)+Ag(t.variantChildren,c,r,i,a)}).then(()=>c.notify("AnimationComplete",s)));return Promise.all(l)}function c4(t,s,n={}){t.notify("AnimationStart",s);let r;if(Array.isArray(s)){const i=s.map(a=>rc(t,a,n));r=Promise.all(i)}else if(typeof s=="string")r=rc(t,s,n);else{const i=typeof s=="function"?dr(t,s,n.custom):s;r=Promise.all(_g(t,i,n))}return r.then(()=>{t.notify("AnimationComplete",s)})}function Dg(t,s){if(!Array.isArray(s))return!1;const n=s.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(s[r]!==t[r])return!1;return!0}const d4=jd.length;function Pg(t){if(!t)return;if(!t.isControllingVariants){const n=t.parent?Pg(t.parent)||{}:{};return t.props.initial!==void 0&&(n.initial=t.props.initial),n}const s={};for(let n=0;n<d4;n++){const r=jd[n],i=t.props[r];(_i(i)||i===!1)&&(s[r]=i)}return s}const u4=[...gd].reverse(),m4=gd.length;function h4(t){return s=>Promise.all(s.map(({animation:n,options:r})=>c4(t,n,r)))}function p4(t){let s=h4(t),n=wm(),r=!0;const i=c=>(d,m)=>{const u=dr(t,m,c==="exit"?t.presenceContext?.custom:void 0);if(u){const{transition:h,transitionEnd:p,...b}=u;d={...d,...b,...p}}return d};function a(c){s=c(t)}function o(c){const{props:d}=t,m=Pg(t.parent)||{},u=[],h=new Set;let p={},b=1/0;for(let y=0;y<m4;y++){const w=u4[y],j=n[w],v=d[w]!==void 0?d[w]:m[w],T=_i(v),z=w===c?j.isActive:null;z===!1&&(b=y);let k=v===m[w]&&v!==d[w]&&T;if(k&&r&&t.manuallyAnimateOnMount&&(k=!1),j.protectedKeys={...p},!j.isActive&&z===null||!v&&!j.prevProp||To(v)||typeof v=="boolean")continue;const N=f4(j.prevProp,v);let S=N||w===c&&j.isActive&&!k&&T||y>b&&T,_=!1;const g=Array.isArray(v)?v:[v];let C=g.reduce(i(w),{});z===!1&&(C={});const{prevResolvedValues:A={}}=j,E={...A,...C},M=L=>{S=!0,h.has(L)&&(_=!0,h.delete(L)),j.needsAnimating[L]=!0;const U=t.getValue(L);U&&(U.liveStyle=!1)};for(const L in E){const U=C[L],F=A[L];if(p.hasOwnProperty(L))continue;let ae=!1;sc(U)&&sc(F)?ae=!Dg(U,F):ae=U!==F,ae?U!=null?M(L):h.add(L):U!==void 0&&h.has(L)?M(L):j.protectedKeys[L]=!0}j.prevProp=v,j.prevResolvedValues=C,j.isActive&&(p={...p,...C}),r&&t.blockInitialAnimation&&(S=!1);const O=k&&N;S&&(!O||_)&&u.push(...g.map(L=>{const U={type:w};if(typeof L=="string"&&r&&!O&&t.manuallyAnimateOnMount&&t.parent){const{parent:F}=t,ae=dr(F,L);if(F.enteringChildren&&ae){const{delayChildren:B}=ae.transition||{};U.delay=Ag(F.enteringChildren,t,B)}}return{animation:L,options:U}}))}if(h.size){const y={};if(typeof d.initial!="boolean"){const w=dr(t,Array.isArray(d.initial)?d.initial[0]:d.initial);w&&w.transition&&(y.transition=w.transition)}h.forEach(w=>{const j=t.getBaseTarget(w),v=t.getValue(w);v&&(v.liveStyle=!0),y[w]=j??null}),u.push({animation:y})}let f=!!u.length;return r&&(d.initial===!1||d.initial===d.animate)&&!t.manuallyAnimateOnMount&&(f=!1),r=!1,f?s(u):Promise.resolve()}function l(c,d){if(n[c].isActive===d)return Promise.resolve();t.variantChildren?.forEach(u=>u.animationState?.setActive(c,d)),n[c].isActive=d;const m=o(c);for(const u in n)n[u].protectedKeys={};return m}return{animateChanges:o,setActive:l,setAnimateFunction:a,getState:()=>n,reset:()=>{n=wm(),r=!0}}}function f4(t,s){return typeof s=="string"?s!==t:Array.isArray(s)?!Dg(s,t):!1}function pn(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function wm(){return{animate:pn(!0),whileInView:pn(),whileHover:pn(),whileTap:pn(),whileDrag:pn(),whileFocus:pn(),exit:pn()}}class un{constructor(s){this.isMounted=!1,this.node=s}update(){}}class x4 extends un{constructor(s){super(s),s.animationState||(s.animationState=p4(s))}updateAnimationControlsSubscription(){const{animate:s}=this.node.getProps();To(s)&&(this.unmountControls=s.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:s}=this.node.getProps(),{animate:n}=this.node.prevProps||{};s!==n&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let g4=0;class j4 extends un{constructor(){super(...arguments),this.id=g4++}update(){if(!this.node.presenceContext)return;const{isPresent:s,onExitComplete:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||s===r)return;const i=this.node.animationState.setActive("exit",!s);n&&!s&&i.then(()=>{n(this.id)})}mount(){const{register:s,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),s&&(this.unmount=s(this.id))}unmount(){}}const y4={animation:{Feature:x4},exit:{Feature:j4}};function Di(t,s,n,r={passive:!0}){return t.addEventListener(s,n,r),()=>t.removeEventListener(s,n)}function na(t){return{point:{x:t.pageX,y:t.pageY}}}const b4=t=>s=>fd(s)&&t(s,na(s));function mi(t,s,n,r){return Di(t,s,b4(n),r)}const Mg=1e-4,w4=1-Mg,v4=1+Mg,Ig=.01,N4=0-Ig,k4=0+Ig;function ft(t){return t.max-t.min}function z4(t,s,n){return Math.abs(t-s)<=n}function vm(t,s,n,r=.5){t.origin=r,t.originPoint=Pe(s.min,s.max,t.origin),t.scale=ft(n)/ft(s),t.translate=Pe(n.min,n.max,t.origin)-t.originPoint,(t.scale>=w4&&t.scale<=v4||isNaN(t.scale))&&(t.scale=1),(t.translate>=N4&&t.translate<=k4||isNaN(t.translate))&&(t.translate=0)}function hi(t,s,n,r){vm(t.x,s.x,n.x,r?r.originX:void 0),vm(t.y,s.y,n.y,r?r.originY:void 0)}function Nm(t,s,n){t.min=n.min+s.min,t.max=t.min+ft(s)}function S4(t,s,n){Nm(t.x,s.x,n.x),Nm(t.y,s.y,n.y)}function km(t,s,n){t.min=s.min-n.min,t.max=t.min+ft(s)}function pi(t,s,n){km(t.x,s.x,n.x),km(t.y,s.y,n.y)}function Vt(t){return[t("x"),t("y")]}const Eg=({current:t})=>t?t.ownerDocument.defaultView:null,zm=(t,s)=>Math.abs(t-s);function C4(t,s){const n=zm(t.x,s.x),r=zm(t.y,s.y);return Math.sqrt(n**2+r**2)}class Lg{constructor(s,n,{transformPagePoint:r,contextWindow:i=window,dragSnapToOrigin:a=!1,distanceThreshold:o=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=fl(this.lastMoveEventInfo,this.history),p=this.startEvent!==null,b=C4(h.offset,{x:0,y:0})>=this.distanceThreshold;if(!p&&!b)return;const{point:f}=h,{timestamp:y}=st;this.history.push({...f,timestamp:y});const{onStart:w,onMove:j}=this.handlers;p||(w&&w(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),j&&j(this.lastMoveEvent,h)},this.handlePointerMove=(h,p)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=pl(p,this.transformPagePoint),Ae.update(this.updatePoint,!0)},this.handlePointerUp=(h,p)=>{this.end();const{onEnd:b,onSessionEnd:f,resumeAnimation:y}=this.handlers;if(this.dragSnapToOrigin&&y&&y(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const w=fl(h.type==="pointercancel"?this.lastMoveEventInfo:pl(p,this.transformPagePoint),this.history);this.startEvent&&b&&b(h,w),f&&f(h,w)},!fd(s))return;this.dragSnapToOrigin=a,this.handlers=n,this.transformPagePoint=r,this.distanceThreshold=o,this.contextWindow=i||window;const l=na(s),c=pl(l,this.transformPagePoint),{point:d}=c,{timestamp:m}=st;this.history=[{...d,timestamp:m}];const{onSessionStart:u}=n;u&&u(s,fl(c,this.history)),this.removeListeners=ea(mi(this.contextWindow,"pointermove",this.handlePointerMove),mi(this.contextWindow,"pointerup",this.handlePointerUp),mi(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(s){this.handlers=s}end(){this.removeListeners&&this.removeListeners(),nn(this.updatePoint)}}function pl(t,s){return s?{point:s(t.point)}:t}function Sm(t,s){return{x:t.x-s.x,y:t.y-s.y}}function fl({point:t},s){return{point:t,delta:Sm(t,Og(s)),offset:Sm(t,T4(s)),velocity:_4(s,.1)}}function T4(t){return t[0]}function Og(t){return t[t.length-1]}function _4(t,s){if(t.length<2)return{x:0,y:0};let n=t.length-1,r=null;const i=Og(t);for(;n>=0&&(r=t[n],!(i.timestamp-r.timestamp>gs(s)));)n--;if(!r)return{x:0,y:0};const a=js(i.timestamp-r.timestamp);if(a===0)return{x:0,y:0};const o={x:(i.x-r.x)/a,y:(i.y-r.y)/a};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function A4(t,{min:s,max:n},r){return s!==void 0&&t<s?t=r?Pe(s,t,r.min):Math.max(t,s):n!==void 0&&t>n&&(t=r?Pe(n,t,r.max):Math.min(t,n)),t}function Cm(t,s,n){return{min:s!==void 0?t.min+s:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function D4(t,{top:s,left:n,bottom:r,right:i}){return{x:Cm(t.x,n,i),y:Cm(t.y,s,r)}}function Tm(t,s){let n=s.min-t.min,r=s.max-t.max;return s.max-s.min<t.max-t.min&&([n,r]=[r,n]),{min:n,max:r}}function P4(t,s){return{x:Tm(t.x,s.x),y:Tm(t.y,s.y)}}function M4(t,s){let n=.5;const r=ft(t),i=ft(s);return i>r?n=Si(s.min,s.max-r,t.min):r>i&&(n=Si(t.min,t.max-i,s.min)),$s(0,1,n)}function I4(t,s){const n={};return s.min!==void 0&&(n.min=s.min-t.min),s.max!==void 0&&(n.max=s.max-t.min),n}const ic=.35;function E4(t=ic){return t===!1?t=0:t===!0&&(t=ic),{x:_m(t,"left","right"),y:_m(t,"top","bottom")}}function _m(t,s,n){return{min:Am(t,s),max:Am(t,n)}}function Am(t,s){return typeof t=="number"?t:t[s]||0}const L4=new WeakMap;class O4{constructor(s){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=qe(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=s}start(s,{snapToCursor:n=!1,distanceThreshold:r}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const a=u=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(na(u).point)},o=(u,h)=>{const{drag:p,dragPropagation:b,onDragStart:f}=this.getProps();if(p&&!b&&(this.openDragLock&&this.openDragLock(),this.openDragLock=VC(p),!this.openDragLock))return;this.latestPointerEvent=u,this.latestPanInfo=h,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Vt(w=>{let j=this.getAxisMotionValue(w).get()||0;if(ys.test(j)){const{projection:v}=this.visualElement;if(v&&v.layout){const T=v.layout.layoutBox[w];T&&(j=ft(T)*(parseFloat(j)/100))}}this.originPoint[w]=j}),f&&Ae.postRender(()=>f(u,h)),nc(this.visualElement,"transform");const{animationState:y}=this.visualElement;y&&y.setActive("whileDrag",!0)},l=(u,h)=>{this.latestPointerEvent=u,this.latestPanInfo=h;const{dragPropagation:p,dragDirectionLock:b,onDirectionLock:f,onDrag:y}=this.getProps();if(!p&&!this.openDragLock)return;const{offset:w}=h;if(b&&this.currentDirection===null){this.currentDirection=R4(w),this.currentDirection!==null&&f&&f(this.currentDirection);return}this.updateAxis("x",h.point,w),this.updateAxis("y",h.point,w),this.visualElement.render(),y&&y(u,h)},c=(u,h)=>{this.latestPointerEvent=u,this.latestPanInfo=h,this.stop(u,h),this.latestPointerEvent=null,this.latestPanInfo=null},d=()=>Vt(u=>this.getAnimationState(u)==="paused"&&this.getAxisMotionValue(u).animation?.play()),{dragSnapToOrigin:m}=this.getProps();this.panSession=new Lg(s,{onSessionStart:a,onStart:o,onMove:l,onSessionEnd:c,resumeAnimation:d},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:m,distanceThreshold:r,contextWindow:Eg(this.visualElement)})}stop(s,n){const r=s||this.latestPointerEvent,i=n||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!i||!r)return;const{velocity:o}=i;this.startAnimation(o);const{onDragEnd:l}=this.getProps();l&&Ae.postRender(()=>l(r,i))}cancel(){this.isDragging=!1;const{projection:s,animationState:n}=this.visualElement;s&&(s.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(s,n,r){const{drag:i}=this.getProps();if(!r||!xa(s,i,this.currentDirection))return;const a=this.getAxisMotionValue(s);let o=this.originPoint[s]+r[s];this.constraints&&this.constraints[s]&&(o=A4(o,this.constraints[s],this.elastic[s])),a.set(o)}resolveConstraints(){const{dragConstraints:s,dragElastic:n}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,i=this.constraints;s&&er(s)?this.constraints||(this.constraints=this.resolveRefConstraints()):s&&r?this.constraints=D4(r.layoutBox,s):this.constraints=!1,this.elastic=E4(n),i!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Vt(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=I4(r.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:s,onMeasureDragConstraints:n}=this.getProps();if(!s||!er(s))return!1;const r=s.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const a=$T(r,i.root,this.visualElement.getTransformPagePoint());let o=P4(i.layout.layoutBox,a);if(n){const l=n(LT(o));this.hasMutatedConstraints=!!l,l&&(o=bg(l))}return o}startAnimation(s){const{drag:n,dragMomentum:r,dragElastic:i,dragTransition:a,dragSnapToOrigin:o,onDragTransitionEnd:l}=this.getProps(),c=this.constraints||{},d=Vt(m=>{if(!xa(m,n,this.currentDirection))return;let u=c&&c[m]||{};o&&(u={min:0,max:0});const h=i?200:1e6,p=i?40:1e7,b={type:"inertia",velocity:r?s[m]:0,bounceStiffness:h,bounceDamping:p,timeConstant:750,restDelta:1,restSpeed:10,...a,...u};return this.startAxisValueAnimation(m,b)});return Promise.all(d).then(l)}startAxisValueAnimation(s,n){const r=this.getAxisMotionValue(s);return nc(this.visualElement,s),r.start(zd(s,r,0,n,this.visualElement,!1))}stopAnimation(){Vt(s=>this.getAxisMotionValue(s).stop())}pauseAnimation(){Vt(s=>this.getAxisMotionValue(s).animation?.pause())}getAnimationState(s){return this.getAxisMotionValue(s).animation?.state}getAxisMotionValue(s){const n=`_drag${s.toUpperCase()}`,r=this.visualElement.getProps(),i=r[n];return i||this.visualElement.getValue(s,(r.initial?r.initial[s]:void 0)||0)}snapToCursor(s){Vt(n=>{const{drag:r}=this.getProps();if(!xa(n,r,this.currentDirection))return;const{projection:i}=this.visualElement,a=this.getAxisMotionValue(n);if(i&&i.layout){const{min:o,max:l}=i.layout.layoutBox[n];a.set(s[n]-Pe(o,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:s,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!er(n)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};Vt(o=>{const l=this.getAxisMotionValue(o);if(l&&this.constraints!==!1){const c=l.get();i[o]=M4({min:c,max:c},this.constraints[o])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Vt(o=>{if(!xa(o,s,null))return;const l=this.getAxisMotionValue(o),{min:c,max:d}=this.constraints[o];l.set(Pe(c,d,i[o]))})}addListeners(){if(!this.visualElement.current)return;L4.set(this.visualElement,this);const s=this.visualElement.current,n=mi(s,"pointerdown",c=>{const{drag:d,dragListener:m=!0}=this.getProps();d&&m&&this.start(c)}),r=()=>{const{dragConstraints:c}=this.getProps();er(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,a=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),Ae.read(r);const o=Di(window,"resize",()=>this.scalePositionWithinConstraints()),l=i.addEventListener("didUpdate",({delta:c,hasLayoutChanged:d})=>{this.isDragging&&d&&(Vt(m=>{const u=this.getAxisMotionValue(m);u&&(this.originPoint[m]+=c[m].translate,u.set(u.get()+c[m].translate))}),this.visualElement.render())});return()=>{o(),n(),a(),l&&l()}}getProps(){const s=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:a=!1,dragElastic:o=ic,dragMomentum:l=!0}=s;return{...s,drag:n,dragDirectionLock:r,dragPropagation:i,dragConstraints:a,dragElastic:o,dragMomentum:l}}}function xa(t,s,n){return(s===!0||s===t)&&(n===null||n===t)}function R4(t,s=10){let n=null;return Math.abs(t.y)>s?n="y":Math.abs(t.x)>s&&(n="x"),n}class $4 extends un{constructor(s){super(s),this.removeGroupControls=Zt,this.removeListeners=Zt,this.controls=new O4(s)}mount(){const{dragControls:s}=this.node.getProps();s&&(this.removeGroupControls=s.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Zt}unmount(){this.removeGroupControls(),this.removeListeners()}}const Dm=t=>(s,n)=>{t&&Ae.postRender(()=>t(s,n))};class q4 extends un{constructor(){super(...arguments),this.removePointerDownListener=Zt}onPointerDown(s){this.session=new Lg(s,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Eg(this.node)})}createPanHandlers(){const{onPanSessionStart:s,onPanStart:n,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:Dm(s),onStart:Dm(n),onMove:r,onEnd:(a,o)=>{delete this.session,i&&Ae.postRender(()=>i(a,o))}}}mount(){this.removePointerDownListener=mi(this.node.current,"pointerdown",s=>this.onPointerDown(s))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Ca={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function Pm(t,s){return s.max===s.min?0:t/(s.max-s.min)*100}const Jr={correct:(t,s)=>{if(!s.target)return t;if(typeof t=="string")if(te.test(t))t=parseFloat(t);else return t;const n=Pm(t,s.target.x),r=Pm(t,s.target.y);return`${n}% ${r}%`}},F4={correct:(t,{treeScale:s,projectionDelta:n})=>{const r=t,i=rn.parse(t);if(i.length>5)return r;const a=rn.createTransformer(t),o=typeof i[0]!="number"?1:0,l=n.x.scale*s.x,c=n.y.scale*s.y;i[0+o]/=l,i[1+o]/=c;const d=Pe(l,c,.5);return typeof i[2+o]=="number"&&(i[2+o]/=d),typeof i[3+o]=="number"&&(i[3+o]/=d),a(i)}};let xl=!1;class U4 extends x.Component{componentDidMount(){const{visualElement:s,layoutGroup:n,switchLayoutGroup:r,layoutId:i}=this.props,{projection:a}=s;dT(B4),a&&(n.group&&n.group.add(a),r&&r.register&&i&&r.register(a),xl&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),Ca.hasEverUpdated=!0}getSnapshotBeforeUpdate(s){const{layoutDependency:n,visualElement:r,drag:i,isPresent:a}=this.props,{projection:o}=r;return o&&(o.isPresent=a,xl=!0,i||s.layoutDependency!==n||n===void 0||s.isPresent!==a?o.willUpdate():this.safeToRemove(),s.isPresent!==a&&(a?o.promote():o.relegate()||Ae.postRender(()=>{const l=o.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:s}=this.props.visualElement;s&&(s.root.didUpdate(),pd.postRender(()=>{!s.currentAnimation&&s.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:s,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:i}=s;xl=!0,i&&(i.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:s}=this.props;s&&s()}render(){return null}}function Rg(t){const[s,n]=ag(),r=x.useContext(Kc);return e.jsx(U4,{...t,layoutGroup:r,switchLayoutGroup:x.useContext(jg),isPresent:s,safeToRemove:n})}const B4={borderRadius:{...Jr,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Jr,borderTopRightRadius:Jr,borderBottomLeftRadius:Jr,borderBottomRightRadius:Jr,boxShadow:F4};function V4(t,s,n){const r=lt(t)?t:vr(t);return r.start(zd("",r,s,n)),r.animation}const W4=(t,s)=>t.depth-s.depth;class K4{constructor(){this.children=[],this.isDirty=!1}add(s){Hc(this.children,s),this.isDirty=!0}remove(s){Zc(this.children,s),this.isDirty=!0}forEach(s){this.isDirty&&this.children.sort(W4),this.isDirty=!1,this.children.forEach(s)}}function G4(t,s){const n=zt.now(),r=({timestamp:i})=>{const a=i-n;a>=s&&(nn(r),t(a-s))};return Ae.setup(r,!0),()=>nn(r)}const $g=["TopLeft","TopRight","BottomLeft","BottomRight"],Q4=$g.length,Mm=t=>typeof t=="string"?parseFloat(t):t,Im=t=>typeof t=="number"||te.test(t);function H4(t,s,n,r,i,a){i?(t.opacity=Pe(0,n.opacity??1,Z4(r)),t.opacityExit=Pe(s.opacity??1,0,Y4(r))):a&&(t.opacity=Pe(s.opacity??1,n.opacity??1,r));for(let o=0;o<Q4;o++){const l=`border${$g[o]}Radius`;let c=Em(s,l),d=Em(n,l);if(c===void 0&&d===void 0)continue;c||(c=0),d||(d=0),c===0||d===0||Im(c)===Im(d)?(t[l]=Math.max(Pe(Mm(c),Mm(d),r),0),(ys.test(d)||ys.test(c))&&(t[l]+="%")):t[l]=d}(s.rotate||n.rotate)&&(t.rotate=Pe(s.rotate||0,n.rotate||0,r))}function Em(t,s){return t[s]!==void 0?t[s]:t.borderRadius}const Z4=qg(0,.5,Sx),Y4=qg(.5,.95,Zt);function qg(t,s,n){return r=>r<t?0:r>s?1:n(Si(t,s,r))}function Lm(t,s){t.min=s.min,t.max=s.max}function Ut(t,s){Lm(t.x,s.x),Lm(t.y,s.y)}function Om(t,s){t.translate=s.translate,t.scale=s.scale,t.originPoint=s.originPoint,t.origin=s.origin}function Rm(t,s,n,r,i){return t-=s,t=Ha(t,1/n,r),i!==void 0&&(t=Ha(t,1/i,r)),t}function J4(t,s=0,n=1,r=.5,i,a=t,o=t){if(ys.test(s)&&(s=parseFloat(s),s=Pe(o.min,o.max,s/100)-o.min),typeof s!="number")return;let l=Pe(a.min,a.max,r);t===a&&(l-=s),t.min=Rm(t.min,s,n,l,i),t.max=Rm(t.max,s,n,l,i)}function $m(t,s,[n,r,i],a,o){J4(t,s[n],s[r],s[i],s.scale,a,o)}const X4=["x","scaleX","originX"],e_=["y","scaleY","originY"];function qm(t,s,n,r){$m(t.x,s,X4,n?n.x:void 0,r?r.x:void 0),$m(t.y,s,e_,n?n.y:void 0,r?r.y:void 0)}function Fm(t){return t.translate===0&&t.scale===1}function Fg(t){return Fm(t.x)&&Fm(t.y)}function Um(t,s){return t.min===s.min&&t.max===s.max}function t_(t,s){return Um(t.x,s.x)&&Um(t.y,s.y)}function Bm(t,s){return Math.round(t.min)===Math.round(s.min)&&Math.round(t.max)===Math.round(s.max)}function Ug(t,s){return Bm(t.x,s.x)&&Bm(t.y,s.y)}function Vm(t){return ft(t.x)/ft(t.y)}function Wm(t,s){return t.translate===s.translate&&t.scale===s.scale&&t.originPoint===s.originPoint}class s_{constructor(){this.members=[]}add(s){Hc(this.members,s),s.scheduleRender()}remove(s){if(Zc(this.members,s),s===this.prevLead&&(this.prevLead=void 0),s===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(s){const n=this.members.findIndex(i=>s===i);if(n===0)return!1;let r;for(let i=n;i>=0;i--){const a=this.members[i];if(a.isPresent!==!1){r=a;break}}return r?(this.promote(r),!0):!1}promote(s,n){const r=this.lead;if(s!==r&&(this.prevLead=r,this.lead=s,s.show(),r)){r.instance&&r.scheduleRender(),s.scheduleRender(),s.resumeFrom=r,n&&(s.resumeFrom.preserveOpacity=!0),r.snapshot&&(s.snapshot=r.snapshot,s.snapshot.latestValues=r.animationValues||r.latestValues),s.root&&s.root.isUpdating&&(s.isLayoutDirty=!0);const{crossfade:i}=s.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(s=>{const{options:n,resumingFrom:r}=s;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(s=>{s.instance&&s.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function n_(t,s,n){let r="";const i=t.x.translate/s.x,a=t.y.translate/s.y,o=n?.z||0;if((i||a||o)&&(r=`translate3d(${i}px, ${a}px, ${o}px) `),(s.x!==1||s.y!==1)&&(r+=`scale(${1/s.x}, ${1/s.y}) `),n){const{transformPerspective:d,rotate:m,rotateX:u,rotateY:h,skewX:p,skewY:b}=n;d&&(r=`perspective(${d}px) ${r}`),m&&(r+=`rotate(${m}deg) `),u&&(r+=`rotateX(${u}deg) `),h&&(r+=`rotateY(${h}deg) `),p&&(r+=`skewX(${p}deg) `),b&&(r+=`skewY(${b}deg) `)}const l=t.x.scale*s.x,c=t.y.scale*s.y;return(l!==1||c!==1)&&(r+=`scale(${l}, ${c})`),r||"none"}const gl=["","X","Y","Z"],r_=1e3;let i_=0;function jl(t,s,n,r){const{latestValues:i}=s;i[t]&&(n[t]=i[t],s.setStaticValue(t,0),r&&(r[t]=0))}function Bg(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:s}=t.options;if(!s)return;const n=Tg(s);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:i,layoutId:a}=t.options;window.MotionCancelOptimisedAnimation(n,"transform",Ae,!(i||a))}const{parent:r}=t;r&&!r.hasCheckedOptimisedAppear&&Bg(r)}function Vg({attachResizeListener:t,defaultParent:s,measureScroll:n,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(o={},l=s?.()){this.id=i_++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(l_),this.nodes.forEach(m_),this.nodes.forEach(h_),this.nodes.forEach(c_)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new K4)}addEventListener(o,l){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new Xc),this.eventHandlers.get(o).add(l)}notifyListeners(o,...l){const c=this.eventHandlers.get(o);c&&c.notify(...l)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=ig(o)&&!ZC(o),this.instance=o;const{layoutId:l,layout:c,visualElement:d}=this.options;if(d&&!d.current&&d.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(c||l)&&(this.isLayoutDirty=!0),t){let m,u=0;const h=()=>this.root.updateBlockedByResize=!1;Ae.read(()=>{u=window.innerWidth}),t(o,()=>{const p=window.innerWidth;p!==u&&(u=p,this.root.updateBlockedByResize=!0,m&&m(),m=G4(h,250),Ca.hasAnimatedSinceResize&&(Ca.hasAnimatedSinceResize=!1,this.nodes.forEach(Qm)))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&d&&(l||c)&&this.addEventListener("didUpdate",({delta:m,hasLayoutChanged:u,hasRelativeLayoutChanged:h,layout:p})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const b=this.options.transition||d.getDefaultTransition()||j_,{onLayoutAnimationStart:f,onLayoutAnimationComplete:y}=d.getProps(),w=!this.targetLayout||!Ug(this.targetLayout,p),j=!u&&h;if(this.options.layoutRoot||this.resumeFrom||j||u&&(w||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const v={...md(b,"layout"),onPlay:f,onComplete:y};(d.shouldReduceMotion||this.options.layoutRoot)&&(v.delay=0,v.type=!1),this.startAnimation(v),this.setAnimationOrigin(m,j)}else u||Qm(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=p})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),nn(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(p_),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&Bg(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let m=0;m<this.path.length;m++){const u=this.path[m];u.shouldResetTransform=!0,u.updateScroll("snapshot"),u.options.layoutRoot&&u.willUpdate(!1)}const{layoutId:l,layout:c}=this.options;if(l===void 0&&!c)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(Km);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(Gm);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(u_),this.nodes.forEach(a_),this.nodes.forEach(o_)):this.nodes.forEach(Gm),this.clearAllSnapshots();const l=zt.now();st.delta=$s(0,1e3/60,l-st.timestamp),st.timestamp=l,st.isProcessing=!0,al.update.process(st),al.preRender.process(st),al.render.process(st),st.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,pd.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(d_),this.sharedNodes.forEach(f_)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Ae.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Ae.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!ft(this.snapshot.measuredBox.x)&&!ft(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=qe(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(l=!1),l&&this.instance){const c=r(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:c,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!i)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!Fg(this.projectionDelta),c=this.getTransformTemplate(),d=c?c(this.latestValues,""):void 0,m=d!==this.prevTransformTemplateValue;o&&this.instance&&(l||fn(this.latestValues)||m)&&(i(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const l=this.measurePageBox();let c=this.removeElementScroll(l);return o&&(c=this.removeTransform(c)),y_(c),{animationId:this.root.animationId,measuredBox:l,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return qe();const l=o.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(b_))){const{scroll:d}=this.root;d&&(tr(l.x,d.offset.x),tr(l.y,d.offset.y))}return l}removeElementScroll(o){const l=qe();if(Ut(l,o),this.scroll?.wasRoot)return l;for(let c=0;c<this.path.length;c++){const d=this.path[c],{scroll:m,options:u}=d;d!==this.root&&m&&u.layoutScroll&&(m.wasRoot&&Ut(l,o),tr(l.x,m.offset.x),tr(l.y,m.offset.y))}return l}applyTransform(o,l=!1){const c=qe();Ut(c,o);for(let d=0;d<this.path.length;d++){const m=this.path[d];!l&&m.options.layoutScroll&&m.scroll&&m!==m.root&&sr(c,{x:-m.scroll.offset.x,y:-m.scroll.offset.y}),fn(m.latestValues)&&sr(c,m.latestValues)}return fn(this.latestValues)&&sr(c,this.latestValues),c}removeTransform(o){const l=qe();Ut(l,o);for(let c=0;c<this.path.length;c++){const d=this.path[c];if(!d.instance||!fn(d.latestValues))continue;Xl(d.latestValues)&&d.updateSnapshot();const m=qe(),u=d.measurePageBox();Ut(m,u),qm(l,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,m)}return fn(this.latestValues)&&qm(l,this.latestValues),l}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==st.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(o||c&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:m,layoutId:u}=this.options;if(!(!this.layout||!(m||u))){if(this.resolvedRelativeTargetAt=st.timestamp,!this.targetDelta&&!this.relativeTarget){const h=this.getClosestProjectingParent();h&&h.layout&&this.animationProgress!==1?(this.relativeParent=h,this.forceRelativeParentToResolveTarget(),this.relativeTarget=qe(),this.relativeTargetOrigin=qe(),pi(this.relativeTargetOrigin,this.layout.layoutBox,h.layout.layoutBox),Ut(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=qe(),this.targetWithTransforms=qe()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),S4(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Ut(this.target,this.layout.layoutBox),vg(this.target,this.targetDelta)):Ut(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const h=this.getClosestProjectingParent();h&&!!h.resumingFrom==!!this.resumingFrom&&!h.options.layoutScroll&&h.target&&this.animationProgress!==1?(this.relativeParent=h,this.forceRelativeParentToResolveTarget(),this.relativeTarget=qe(),this.relativeTargetOrigin=qe(),pi(this.relativeTargetOrigin,this.target,h.target),Ut(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||Xl(this.parent.latestValues)||wg(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const o=this.getLead(),l=!!this.resumingFrom||this!==o;let c=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===st.timestamp&&(c=!1),c)return;const{layout:d,layoutId:m}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||m))return;Ut(this.layoutCorrected,this.layout.layoutBox);const u=this.treeScale.x,h=this.treeScale.y;RT(this.layoutCorrected,this.treeScale,this.path,l),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=qe());const{target:p}=o;if(!p){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(Om(this.prevProjectionDelta.x,this.projectionDelta.x),Om(this.prevProjectionDelta.y,this.projectionDelta.y)),hi(this.projectionDelta,this.layoutCorrected,p,this.latestValues),(this.treeScale.x!==u||this.treeScale.y!==h||!Wm(this.projectionDelta.x,this.prevProjectionDelta.x)||!Wm(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",p))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.visualElement?.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=nr(),this.projectionDelta=nr(),this.projectionDeltaWithTransform=nr()}setAnimationOrigin(o,l=!1){const c=this.snapshot,d=c?c.latestValues:{},m={...this.latestValues},u=nr();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const h=qe(),p=c?c.source:void 0,b=this.layout?this.layout.source:void 0,f=p!==b,y=this.getStack(),w=!y||y.members.length<=1,j=!!(f&&!w&&this.options.crossfade===!0&&!this.path.some(g_));this.animationProgress=0;let v;this.mixTargetDelta=T=>{const z=T/1e3;Hm(u.x,o.x,z),Hm(u.y,o.y,z),this.setTargetDelta(u),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(pi(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),x_(this.relativeTarget,this.relativeTargetOrigin,h,z),v&&t_(this.relativeTarget,v)&&(this.isProjectionDirty=!1),v||(v=qe()),Ut(v,this.relativeTarget)),f&&(this.animationValues=m,H4(m,d,this.latestValues,z,j,w)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=z},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(nn(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Ae.update(()=>{Ca.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=vr(0)),this.currentAnimation=V4(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:l=>{this.mixTargetDelta(l),o.onUpdate&&o.onUpdate(l)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(r_),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:l,target:c,layout:d,latestValues:m}=o;if(!(!l||!c||!d)){if(this!==o&&this.layout&&d&&Wg(this.options.animationType,this.layout.layoutBox,d.layoutBox)){c=this.target||qe();const u=ft(this.layout.layoutBox.x);c.x.min=o.target.x.min,c.x.max=c.x.min+u;const h=ft(this.layout.layoutBox.y);c.y.min=o.target.y.min,c.y.max=c.y.min+h}Ut(l,c),sr(l,m),hi(this.projectionDeltaWithTransform,this.layoutCorrected,l,m)}}registerSharedNode(o,l){this.sharedNodes.has(o)||this.sharedNodes.set(o,new s_),this.sharedNodes.get(o).add(l);const d=l.options.initialPromotionConfig;l.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(l):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){const{layoutId:o}=this.options;return o?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:o}=this.options;return o?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:l,preserveFollowOpacity:c}={}){const d=this.getStack();d&&d.promote(this,c),o&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let l=!1;const{latestValues:c}=o;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(l=!0),!l)return;const d={};c.z&&jl("z",o,d,this.animationValues);for(let m=0;m<gl.length;m++)jl(`rotate${gl[m]}`,o,d,this.animationValues),jl(`skew${gl[m]}`,o,d,this.animationValues);o.render();for(const m in d)o.setStaticValue(m,d[m]),this.animationValues&&(this.animationValues[m]=d[m]);o.scheduleRender()}applyProjectionStyles(o,l){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const c=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=Sa(l?.pointerEvents)||"",o.transform=c?c(this.latestValues,""):"none";return}const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=Sa(l?.pointerEvents)||""),this.hasProjected&&!fn(this.latestValues)&&(o.transform=c?c({},""):"none",this.hasProjected=!1);return}o.visibility="";const m=d.animationValues||d.latestValues;this.applyTransformsToTarget();let u=n_(this.projectionDeltaWithTransform,this.treeScale,m);c&&(u=c(m,u)),o.transform=u;const{x:h,y:p}=this.projectionDelta;o.transformOrigin=`${h.origin*100}% ${p.origin*100}% 0`,d.animationValues?o.opacity=d===this?m.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:m.opacityExit:o.opacity=d===this?m.opacity!==void 0?m.opacity:"":m.opacityExit!==void 0?m.opacityExit:0;for(const b in Ai){if(m[b]===void 0)continue;const{correct:f,applyTo:y,isCSSVariable:w}=Ai[b],j=u==="none"?m[b]:f(m[b],d);if(y){const v=y.length;for(let T=0;T<v;T++)o[y[T]]=j}else w?this.options.visualElement.renderState.vars[b]=j:o[b]=j}this.options.layoutId&&(o.pointerEvents=d===this?Sa(l?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>o.currentAnimation?.stop()),this.root.nodes.forEach(Km),this.root.sharedNodes.clear()}}}function a_(t){t.updateLayout()}function o_(t){const s=t.resumeFrom?.snapshot||t.snapshot;if(t.isLead()&&t.layout&&s&&t.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:r}=t.layout,{animationType:i}=t.options,a=s.source!==t.layout.source;i==="size"?Vt(m=>{const u=a?s.measuredBox[m]:s.layoutBox[m],h=ft(u);u.min=n[m].min,u.max=u.min+h}):Wg(i,s.layoutBox,n)&&Vt(m=>{const u=a?s.measuredBox[m]:s.layoutBox[m],h=ft(n[m]);u.max=u.min+h,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[m].max=t.relativeTarget[m].min+h)});const o=nr();hi(o,n,s.layoutBox);const l=nr();a?hi(l,t.applyTransform(r,!0),s.measuredBox):hi(l,n,s.layoutBox);const c=!Fg(o);let d=!1;if(!t.resumeFrom){const m=t.getClosestProjectingParent();if(m&&!m.resumeFrom){const{snapshot:u,layout:h}=m;if(u&&h){const p=qe();pi(p,s.layoutBox,u.layoutBox);const b=qe();pi(b,n,h.layoutBox),Ug(p,b)||(d=!0),m.options.layoutRoot&&(t.relativeTarget=b,t.relativeTargetOrigin=p,t.relativeParent=m)}}}t.notifyListeners("didUpdate",{layout:n,snapshot:s,delta:l,layoutDelta:o,hasLayoutChanged:c,hasRelativeLayoutChanged:d})}else if(t.isLead()){const{onExitComplete:n}=t.options;n&&n()}t.options.transition=void 0}function l_(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function c_(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function d_(t){t.clearSnapshot()}function Km(t){t.clearMeasurements()}function Gm(t){t.isLayoutDirty=!1}function u_(t){const{visualElement:s}=t.options;s&&s.getProps().onBeforeLayoutMeasure&&s.notify("BeforeLayoutMeasure"),t.resetTransform()}function Qm(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function m_(t){t.resolveTargetDelta()}function h_(t){t.calcProjection()}function p_(t){t.resetSkewAndRotation()}function f_(t){t.removeLeadSnapshot()}function Hm(t,s,n){t.translate=Pe(s.translate,0,n),t.scale=Pe(s.scale,1,n),t.origin=s.origin,t.originPoint=s.originPoint}function Zm(t,s,n,r){t.min=Pe(s.min,n.min,r),t.max=Pe(s.max,n.max,r)}function x_(t,s,n,r){Zm(t.x,s.x,n.x,r),Zm(t.y,s.y,n.y,r)}function g_(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const j_={duration:.45,ease:[.4,0,.1,1]},Ym=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),Jm=Ym("applewebkit/")&&!Ym("chrome/")?Math.round:Zt;function Xm(t){t.min=Jm(t.min),t.max=Jm(t.max)}function y_(t){Xm(t.x),Xm(t.y)}function Wg(t,s,n){return t==="position"||t==="preserve-aspect"&&!z4(Vm(s),Vm(n),.2)}function b_(t){return t!==t.root&&t.scroll?.wasRoot}const w_=Vg({attachResizeListener:(t,s)=>Di(t,"resize",s),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),yl={current:void 0},Kg=Vg({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!yl.current){const t=new w_({});t.mount(window),t.setOptions({layoutScroll:!0}),yl.current=t}return yl.current},resetTransform:(t,s)=>{t.style.transform=s!==void 0?s:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),v_={pan:{Feature:q4},drag:{Feature:$4,ProjectionNode:Kg,MeasureLayout:Rg}};function eh(t,s,n){const{props:r}=t;t.animationState&&r.whileHover&&t.animationState.setActive("whileHover",n==="Start");const i="onHover"+n,a=r[i];a&&Ae.postRender(()=>a(s,na(s)))}class N_ extends un{mount(){const{current:s}=this.node;s&&(this.unmount=WC(s,(n,r)=>(eh(this.node,r,"Start"),i=>eh(this.node,i,"End"))))}unmount(){}}class k_ extends un{constructor(){super(...arguments),this.isActive=!1}onFocus(){let s=!1;try{s=this.node.current.matches(":focus-visible")}catch{s=!0}!s||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=ea(Di(this.node.current,"focus",()=>this.onFocus()),Di(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function th(t,s,n){const{props:r}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&r.whileTap&&t.animationState.setActive("whileTap",n==="Start");const i="onTap"+(n==="End"?"":n),a=r[i];a&&Ae.postRender(()=>a(s,na(s)))}class z_ extends un{mount(){const{current:s}=this.node;s&&(this.unmount=HC(s,(n,r)=>(th(this.node,r,"Start"),(i,{success:a})=>th(this.node,i,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const ac=new WeakMap,bl=new WeakMap,S_=t=>{const s=ac.get(t.target);s&&s(t)},C_=t=>{t.forEach(S_)};function T_({root:t,...s}){const n=t||document;bl.has(n)||bl.set(n,{});const r=bl.get(n),i=JSON.stringify(s);return r[i]||(r[i]=new IntersectionObserver(C_,{root:t,...s})),r[i]}function __(t,s,n){const r=T_(s);return ac.set(t,n),r.observe(t),()=>{ac.delete(t),r.unobserve(t)}}const A_={some:0,all:1};class D_ extends un{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:s={}}=this.node.getProps(),{root:n,margin:r,amount:i="some",once:a}=s,o={root:n?n.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:A_[i]},l=c=>{const{isIntersecting:d}=c;if(this.isInView===d||(this.isInView=d,a&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:m,onViewportLeave:u}=this.node.getProps(),h=d?m:u;h&&h(c)};return __(this.node.current,o,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:s,prevProps:n}=this.node;["amount","margin","root"].some(P_(s,n))&&this.startObserver()}unmount(){}}function P_({viewport:t={}},{viewport:s={}}={}){return n=>t[n]!==s[n]}const M_={inView:{Feature:D_},tap:{Feature:z_},focus:{Feature:k_},hover:{Feature:N_}},I_={layout:{ProjectionNode:Kg,MeasureLayout:Rg}},E_={...y4,...M_,...v_,...I_},ke=ET(E_,QT),Ao={normal:.3,slow:.5},L_={stagger:.05},O_={default:[.4,0,.2,1]},R_={hidden:{opacity:0,y:20},visible:(t=0)=>({opacity:1,y:0,transition:{delay:t*L_.stagger,duration:Ao.normal,ease:O_.default}})},$_=(t,s=Ao.slow)=>{const[n,r]=ne.useState(0),i=ne.useRef(0);return ne.useEffect(()=>{const a=i.current,o=t,l=Date.now(),c=()=>{const d=(Date.now()-l)/1e3,m=Math.min(d/s,1),u=1-Math.pow(1-m,3),h=Math.floor(a+(o-a)*u);r(h),m<1?requestAnimationFrame(c):i.current=o};requestAnimationFrame(c)},[t,s]),n},$r=({children:t,index:s=0,className:n="",...r})=>e.jsx(ke.div,{variants:R_,initial:"hidden",animate:"visible",custom:s,className:n,...r,children:t}),_n=({value:t,className:s="bg-gray-100 rounded-full overflow-hidden",barClassName:n="h-full bg-gray-900",height:r="h-2"})=>e.jsx("div",{className:`${r} ${s}`,children:e.jsx(ke.div,{initial:{width:0},animate:{width:`${t}%`},transition:{duration:Ao.slow,ease:"easeOut"},className:n})}),nt=({value:t,className:s="",duration:n=Ao.slow,prefix:r="",suffix:i=""})=>{const a=$_(t,n);return e.jsxs("span",{className:s,children:[r,a.toLocaleString("pl-PL"),i]})},q_=()=>e.jsxs("div",{className:"rounded-2xl border bg-card p-5 shadow-soft animate-pulse",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("div",{className:"h-8 w-8 rounded-md bg-muted/70"}),e.jsx("div",{className:"h-4 w-40 rounded bg-muted/70"})]}),e.jsx("div",{className:"h-5 w-16 rounded-full bg-muted/70"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"h-2 w-full rounded-full bg-muted/60"}),e.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[e.jsx("div",{className:"h-3 w-16 rounded bg-muted/60"}),e.jsx("div",{className:"h-3 w-20 rounded bg-muted/60"})]})]}),e.jsx("div",{className:"mt-4 h-9 w-2/3 rounded-lg bg-muted/60"}),e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsx("div",{className:"h-6 w-16 rounded bg-muted/60"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"h-9 w-24 rounded-lg bg-muted/60"}),e.jsx("div",{className:"h-9 w-10 rounded-lg bg-muted/60"})]})]})]}),F_=()=>{const t=se(),{data:s}=We(),{stats:n,refetch:r}=qn(),{data:i,isLoading:a}=Xi("get_my_courses"),[o,l]=ne.useState(0),c=i||[],d=!a&&c.length===0;ne.useEffect(()=>{const u=async()=>{try{const{data:p}=await J.rpc("check_claimable_rewards");l(p?.claimable_points||0)}catch{}};u();const h=setInterval(u,3e4);return()=>clearInterval(h)},[]);const m=async()=>{try{const{data:u,error:h}=await J.rpc("claim_daily_rewards");if(h)throw h;u&&(K.success(`Odebrano ${u.total_earned} punkt贸w`),r(),l(0))}catch{K.error("Nie mo偶na odebra nagr贸d")}};return e.jsxs("div",{className:"container mx-auto px-4 py-6 sm:py-8 space-y-6 sm:space-y-8 pb-24 lg:pb-8",children:[e.jsxs(ke.section,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.45},className:"relative overflow-hidden rounded-2xl border",children:[e.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/[0.12] via-secondary/[0.10] to-accent/[0.12]"}),e.jsx("div",{className:"absolute inset-0 opacity-[0.06]",style:{backgroundImage:`
                linear-gradient(to right, hsl(var(--ring)/0.35) 1px, transparent 1px),
                linear-gradient(to bottom, hsl(var(--ring)/0.35) 1px, transparent 1px)
              `,backgroundSize:"28px 28px"}})]}),e.jsxs("div",{className:"relative z-10 p-4 sm:p-6 md:p-8",children:[e.jsxs("div",{className:"space-y-6 md:hidden",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h2",{className:"text-xl font-bold tracking-tight",children:"Twoje tempo nauki"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[n.streak>0&&e.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full border bg-background/60 px-3 py-1.5 shadow-soft",children:[e.jsx(fs,{className:"h-4 w-4 text-destructive"}),e.jsxs("span",{className:"text-sm font-medium",children:["Seria: ",e.jsx("span",{className:"tabular-nums",children:n.streak})," ","dni"]})]}),o>0&&e.jsxs("button",{onClick:m,className:"inline-flex items-center gap-2 rounded-lg bg-primary px-3 py-1.5 text-sm text-primary-foreground hover:bg-primary/90 focus-ring",children:[e.jsx(Jd,{className:"h-4 w-4"}),"Odbierz ",o," pkt"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsxs("div",{className:"rounded-xl border bg-card p-4 shadow-soft",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Punkty"}),e.jsx(Ye,{className:"h-4 w-4 text-primary"})]}),e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsx("span",{className:"text-3xl font-semibold tabular-nums text-primary leading-none",children:e.jsx(nt,{value:n.points})}),e.jsx("span",{className:"mb-1 text-sm text-muted-foreground",children:"pkt"})]}),e.jsxs("p",{className:"mt-1 text-xs text-muted-foreground",children:["+",e.jsx(nt,{value:n.idle_rate}),"/h"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"rounded-xl border bg-card p-4 shadow-soft",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Poziom"}),e.jsx(Sn,{className:"h-4 w-4 text-secondary"})]}),e.jsx("span",{className:"text-2xl font-semibold text-secondary",children:n.level}),e.jsx("div",{className:"mt-2 h-1.5 w-full rounded-full bg-muted",children:e.jsx("div",{className:"h-full rounded-full bg-secondary transition-all",style:{width:`${n.points%100}%`}})})]}),e.jsxs("div",{className:"rounded-xl border bg-card p-4 shadow-soft",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Premia"}),e.jsx(xt,{className:"h-4 w-4 text-accent"})]}),e.jsxs("span",{className:"text-2xl font-semibold text-accent",children:["+",e.jsx(nt,{value:n.idle_rate})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"pkt/h"})]})]})]})]}),e.jsxs("div",{className:"hidden md:grid gap-8 md:grid-cols-12 md:items-center",children:[e.jsxs("div",{className:"md:col-span-4 space-y-4",children:[e.jsx("h2",{className:"text-2xl md:text-3xl font-bold tracking-tight",children:"Twoje tempo nauki"}),n.streak>0&&e.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full border bg-background/60 px-3 py-1.5 shadow-soft",children:[e.jsx(fs,{className:"h-4 w-4 text-destructive"}),e.jsxs("span",{className:"text-sm font-medium",children:["Seria: ",e.jsx("span",{className:"tabular-nums",children:n.streak})," ","dni"]})]}),o>0&&e.jsxs("button",{onClick:m,className:"inline-flex items-center gap-2 rounded-lg bg-primary px-4 py-2 text-primary-foreground hover:bg-primary/90 focus-ring",children:[e.jsx(Jd,{className:"h-4 w-4"}),"Odbierz ",o," pkt"]})]}),e.jsx("div",{className:"md:col-span-8",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 md:gap-6",children:[e.jsxs("div",{className:"rounded-xl border bg-card p-5 shadow-soft",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Punkty"}),e.jsx(Ye,{className:"h-4 w-4 text-primary"})]}),e.jsxs("div",{className:"mt-2 flex items-end gap-2",children:[e.jsx("span",{className:"text-4xl md:text-5xl font-semibold tabular-nums text-primary leading-none",children:e.jsx(nt,{value:n.points})}),e.jsx("span",{className:"mb-[2px] text-sm text-muted-foreground",children:"pkt"})]}),e.jsxs("p",{className:"mt-1 text-xs text-muted-foreground",children:["+",e.jsx(nt,{value:n.idle_rate}),"/h"]})]}),e.jsxs("div",{className:"rounded-xl border bg-card p-5 shadow-soft",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Poziom"}),e.jsx(Sn,{className:"h-4 w-4 text-secondary"})]}),e.jsx("div",{className:"mt-2 flex items-center gap-2",children:e.jsx("span",{className:"text-4xl md:text-5xl font-semibold text-secondary leading-none",children:n.level})}),e.jsx("div",{className:"mt-3 h-2 w-full rounded-full bg-muted",children:e.jsx("div",{className:"h-full rounded-full bg-secondary transition-all",style:{width:`${n.points%100}%`}})}),e.jsxs("p",{className:"mt-1 text-xs text-muted-foreground",children:["Do kolejnego: ",100-n.points%100," pkt"]})]}),e.jsxs("div",{className:"rounded-xl border bg-card p-5 shadow-soft",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Premia"}),e.jsx(xt,{className:"h-4 w-4 text-accent"})]}),e.jsxs("div",{className:"mt-2 flex items-end gap-2",children:[e.jsxs("span",{className:"text-4xl md:text-5xl font-semibold text-accent leading-none",children:["+",e.jsx(nt,{value:n.idle_rate})]}),e.jsx("span",{className:"mb-[2px] text-sm text-muted-foreground",children:"pkt/h"})]}),e.jsx("button",{onClick:()=>t("/student/gamification"),className:"mt-3 w-full rounded-lg border px-3 py-2 hover:bg-primary/5 focus-ring",children:"Gamifikacja"})]})]})})]})]})]}),e.jsxs(ke.section,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.4,delay:.05},className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"text-lg sm:text-xl md:text-2xl font-semibold tracking-tight",children:"Twoje kursy"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"To jest Twoja g贸wna cie偶ka  kontynuuj nauk tam, gdzie skoczye."})]}),e.jsxs("button",{onClick:()=>t("/student/courses"),className:"inline-flex items-center gap-1 sm:gap-2 rounded-lg border px-2 sm:px-3 py-1.5 sm:py-2 text-sm hover:bg-primary/5 focus-ring whitespace-nowrap",children:[e.jsx("span",{className:"hidden sm:inline",children:"Zobacz wszystkie"}),e.jsx("span",{className:"sm:hidden",children:"Wszystkie"}),e.jsx(le,{className:"h-4 w-4"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 sm:gap-5",children:[a&&Array.from({length:6}).map((u,h)=>e.jsx(q_,{},h)),!a&&c.slice(0,9).map(u=>{const h=u.progress_percent===100;return e.jsxs("div",{className:"group relative rounded-2xl border bg-card p-4 sm:p-5 shadow-soft hover:bg-muted/40 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("span",{className:"text-2xl sm:text-3xl shrink-0 leading-none",children:u.icon_emoji||""}),e.jsx("h4",{className:"font-semibold text-sm sm:text-base text-foreground line-clamp-2",children:u.title})]}),h?e.jsx("span",{className:"inline-flex items-center gap-1 rounded-full border border-green-600/30 bg-green-500/10 text-green-700 dark:text-green-400 px-2 sm:px-2.5 py-0.5 sm:py-1 text-[10px] sm:text-[11px] font-semibold",children:"Ukoczono"}):e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border border-primary/30 text-primary px-2 sm:px-2.5 py-0.5 sm:py-1 text-[10px] sm:text-[11px] font-semibold",children:[u.progress_percent,"%"]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"h-2 w-full rounded-full bg-muted",children:e.jsx("div",{className:`h-full rounded-full transition-all ${h?"bg-green-600":"bg-primary"}`,style:{width:`${u.progress_percent||0}%`}})}),e.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:"Ukoczono"}),e.jsxs("span",{className:"font-medium text-foreground",children:[u.completed_lessons||0,"/",u.total_lessons||10," lekcji"]})]})]}),u.next_activity&&e.jsxs("div",{className:"mt-3 sm:mt-4 flex items-center gap-2 rounded-lg border bg-background/60 px-2.5 sm:px-3 py-1.5 sm:py-2",children:[e.jsx(wb,{className:"h-3.5 sm:h-4 w-3.5 sm:w-4 text-primary"}),e.jsx("p",{className:"text-xs sm:text-sm font-medium truncate",children:u.next_activity})]}),e.jsxs("div",{className:"mt-3 sm:mt-4 flex items-center justify-between",children:[u.points_available?e.jsxs("span",{className:"inline-flex rounded-md bg-orange-500/10 text-[10px] sm:text-[11px] font-semibold px-2 py-0.5 sm:py-1 text-orange-600",children:["+",u.points_available," pkt"]}):e.jsx("span",{}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>t(`/student/courses/${u.course_id}`),className:"rounded-lg bg-primary px-3 sm:px-4 py-1.5 sm:py-2 text-sm text-primary-foreground hover:bg-primary/90 focus-ring",children:"Kontynuuj"}),e.jsx("button",{onClick:()=>t(`/student/courses/${u.course_id}`),className:"rounded-lg border px-2.5 sm:px-3 py-1.5 sm:py-2 hover:bg-primary/5 focus-ring",title:"Szczeg贸y",children:e.jsx(le,{className:"h-3.5 sm:h-4 w-3.5 sm:w-4"})})]})]})]},u.course_id)}),d&&e.jsxs("div",{className:"col-span-full rounded-2xl border bg-card p-8 sm:p-10 text-center shadow-soft",children:[e.jsx("div",{className:"text-4xl sm:text-5xl",children:""}),e.jsx("h4",{className:"mt-3 sm:mt-4 text-base sm:text-lg font-semibold",children:"Zacznij swoj przygod"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mt-1",children:"Docz do kursu i odkryj nowy spos贸b nauki."}),e.jsx("button",{onClick:()=>t("/student/courses"),className:"mt-4 sm:mt-6 rounded-lg bg-secondary px-4 sm:px-5 py-2 sm:py-2.5 text-sm text-white hover:opacity-95 focus-ring",children:"Odkryj kursy"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"rounded-xl border bg-card/70 backdrop-blur-sm p-4 sm:p-5 shadow-md",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("span",{className:"text-xs sm:text-sm text-muted-foreground font-medium",children:"Punkty"}),e.jsx(Ye,{className:"h-3.5 sm:h-4 w-3.5 sm:w-4 text-primary"})]}),e.jsx("p",{className:"mt-1.5 text-xl sm:text-2xl font-semibold tabular-nums text-foreground",children:e.jsx(nt,{value:n.points})}),e.jsxs("p",{className:"text-xs sm:text-sm text-muted-foreground mt-0.5",children:["+",e.jsx(nt,{value:n.idle_rate}),"/h"]})]}),e.jsxs("div",{className:"rounded-xl border bg-card/70 backdrop-blur-sm p-4 sm:p-5 shadow-md",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("span",{className:"text-xs sm:text-sm text-muted-foreground font-medium",children:"Poziom"}),e.jsx($e,{className:"h-3.5 sm:h-4 w-3.5 sm:w-4 text-secondary"})]}),e.jsx("p",{className:"mt-1.5 text-xl sm:text-2xl font-semibold text-foreground",children:n.level}),e.jsx("div",{className:"mt-2 sm:mt-3",children:e.jsx(_n,{value:n.points%100})})]}),e.jsxs("div",{className:"rounded-xl border bg-card/70 backdrop-blur-sm p-4 sm:p-5 shadow-md",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("span",{className:"text-xs sm:text-sm text-muted-foreground font-medium",children:"Seria dni"}),e.jsx(fs,{className:"h-3.5 sm:h-4 w-3.5 sm:w-4 text-destructive"})]}),e.jsx("p",{className:"mt-1.5 text-xl sm:text-2xl font-semibold text-foreground",children:e.jsx(nt,{value:n.streak})}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mt-0.5",children:"dni z rzdu"})]}),e.jsxs("div",{className:"rounded-xl border bg-card/70 backdrop-blur-sm p-4 sm:p-5 shadow-md",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("span",{className:"text-xs sm:text-sm text-muted-foreground font-medium",children:"Tempo"}),e.jsx(xt,{className:"h-3.5 sm:h-4 w-3.5 sm:w-4 text-accent"})]}),e.jsxs("p",{className:"mt-1.5 text-xl sm:text-2xl font-semibold text-foreground",children:["+",e.jsx(nt,{value:n.idle_rate})]}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mt-0.5",children:"punkt贸w/h"})]})]})]})},U_=[e.jsx(W,{path:"dashboard",element:e.jsx(F_,{})},"dashboard")],B_=()=>{const t=se(),{data:s}=Xi("get_my_courses"),n=s||[];return e.jsxs("div",{className:"container mx-auto px-4 py-6 sm:py-8 space-y-6 sm:space-y-8 pb-24 lg:pb-8",children:[e.jsxs(ke.section,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.45},className:"relative overflow-hidden rounded-2xl border",children:[e.jsx("div",{className:"pointer-events-none absolute inset-0",children:e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/[0.12] via-secondary/[0.10] to-accent/[0.12]"})}),e.jsxs("div",{className:"relative z-10 p-4 sm:p-6 md:p-8",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight",children:"Twoje kursy"}),e.jsx("p",{className:"mt-2 text-sm md:text-base text-muted-foreground",children:"Wybierz kurs i kontynuuj nauk w swoim tempie."})]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 sm:gap-5",children:n.map((r,i)=>e.jsxs($r,{index:i,className:"group relative rounded-2xl border bg-card p-4 sm:p-5 shadow-soft hover:bg-muted/40 transition-colors cursor-pointer",onClick:()=>t(`/student/courses/${r.course_id}`),children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("span",{className:"text-2xl sm:text-3xl shrink-0 leading-none",children:r.icon_emoji||""}),e.jsx("h4",{className:"font-semibold text-sm sm:text-base text-foreground line-clamp-2",children:r.title})]}),e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border border-primary/30 text-primary px-2 sm:px-2.5 py-0.5 sm:py-1 text-[10px] sm:text-[11px] font-semibold",children:[r.progress_percent,"%"]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(_n,{value:r.progress_percent})}),e.jsxs("button",{className:"mt-4 inline-flex items-center gap-1 text-sm font-medium text-primary",children:["Kontynuuj",e.jsx(le,{className:"h-4 w-4"})]})]},r.course_id))})]})},V_=[e.jsx(W,{path:"/courses",element:e.jsx(B_,{})},"courses-list")],W_=()=>e.jsxs("div",{className:"rounded-2xl border bg-card p-5 md:p-6 shadow-soft animate-pulse",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"h-12 w-12 rounded-xl bg-muted/60"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-5 w-1/2 rounded bg-muted/60"}),e.jsx("div",{className:"h-4 w-3/4 rounded bg-muted/60"})]}),e.jsx("div",{className:"h-9 w-36 rounded-lg bg-muted/60"})]}),e.jsxs("div",{className:"mt-5",children:[e.jsx("div",{className:"h-2 w-full rounded-full bg-muted/60"}),e.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[e.jsx("div",{className:"h-3 w-16 rounded bg-muted/60"}),e.jsx("div",{className:"h-3 w-10 rounded bg-muted/60"})]})]})]}),K_=()=>e.jsxs("div",{className:"rounded-2xl border bg-card p-4 md:p-5 shadow-soft animate-pulse",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-muted/60"}),e.jsx("div",{className:"h-4 w-2/5 rounded bg-muted/60"})]}),e.jsx("div",{className:"space-y-3",children:Array.from({length:3}).map((t,s)=>e.jsx("div",{className:"h-14 rounded-xl border bg-muted/40"},s))})]}),G_=()=>{const{courseId:t}=vt(),s=se(),{data:n,isLoading:r}=Xi("get_course_structure",{p_course_id:parseInt(t)},{enabled:!!t}),{data:i}=XS("courses",{filters:[{field:"id",operator:"eq",value:parseInt(t)}],enabled:!!t}),a=ne.useMemo(()=>{if(!n)return[];const d=n.reduce((h,p)=>{const b=`${p.topic_id}-${p.topic_title}`;return h[b]||(h[b]={id:p.topic_id,title:p.topic_title,position:p.topic_position,activities:[]}),p.activity_id&&h[b].activities.push({id:p.activity_id,title:p.activity_title,type:p.activity_type,position:p.activity_position,completed:p.is_completed,score:p.score}),h},{}),m=Object.values(d).sort((h,p)=>h.position-p.position);let u=!1;return m.map((h,p)=>{const b=h.activities.length>0&&h.activities.every(y=>y.completed),f=p===0||m[p-1].activities.length>0&&m[p-1].activities.every(y=>y.completed);return h.activities.sort((y,w)=>y.position-w.position),h.activities=h.activities.map(y=>{let w=!1;return y.completed?w=!0:f&&!u&&(w=!0,u=!0),{...y,isUnlocked:w}}),{...h,isCompleted:b,isUnlocked:f}})},[n]),o=ne.useMemo(()=>{const d=a.flatMap(h=>h.activities),m=d.filter(h=>h.completed).length,u=d.length;return{totalActivities:u,completedActivities:m,progress:u>0?Math.round(m/u*100):0}},[a]),l=i?.[0],c=ne.useMemo(()=>{for(const d of a){const m=d.activities.find(u=>!u.completed&&u.isUnlocked);if(m)return{topicId:d.id,activity:m,path:m.type==="quiz"?`/student/courses/${t}/quiz/${m.id}`:`/student/courses/${t}/lesson/${m.id}`}}return null},[a,t]);return r?e.jsxs("div",{className:"container mx-auto px-4 py-6 sm:py-8 space-y-6 sm:space-y-8",children:[e.jsxs("button",{className:"inline-flex items-center gap-2 text-muted-foreground cursor-default",disabled:!0,children:[e.jsx(Ce,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Powr贸t"})]}),e.jsx(W_,{}),e.jsx("div",{className:"space-y-4",children:Array.from({length:3}).map((d,m)=>e.jsx(K_,{},m))})]}):l?e.jsxs("div",{className:"container mx-auto px-4 py-6 sm:py-8 space-y-6 sm:space-y-8 pb-24 lg:pb-8",children:[e.jsxs("button",{onClick:()=>s("/student/dashboard#courses"),className:"flex items-center gap-2 text-muted-foreground hover:text-foreground transition-colors",children:[e.jsx(Ce,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Powr贸t"})]}),e.jsxs(ke.section,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.45},className:"relative overflow-hidden rounded-2xl border",children:[e.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/[0.12] via-secondary/[0.10] to-accent/[0.12]"}),e.jsx("div",{className:"absolute inset-0 opacity-[0.06]",style:{backgroundImage:`
                linear-gradient(to right, hsl(var(--ring)/0.35) 1px, transparent 1px),
                linear-gradient(to bottom, hsl(var(--ring)/0.35) 1px, transparent 1px)
              `,backgroundSize:"28px 28px"}})]}),e.jsx("div",{className:"relative z-10 p-4 sm:p-6 md:p-8",children:e.jsxs("div",{className:"grid md:grid-cols-12 gap-6 md:items-center",children:[e.jsxs("div",{className:"md:col-span-7 flex items-start gap-4 min-w-0",children:[e.jsx("div",{className:"text-5xl md:text-6xl leading-none shrink-0",children:l.icon_emoji||""}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-xl md:text-3xl font-bold tracking-tight",children:l.title}),l.description&&e.jsx("p",{className:"mt-2 text-sm md:text-base text-muted-foreground line-clamp-3",children:l.description}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border bg-background/60 px-3 py-1.5 shadow-soft",children:[e.jsx(Te,{className:"h-4 w-4"}),e.jsxs("span",{className:"text-sm font-medium",children:["Ukoczone:"," ",e.jsx("span",{className:"tabular-nums",children:e.jsx(nt,{value:o.completedActivities})}),"/",o.totalActivities]})]}),o.progress===100&&e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border border-green-600/30 bg-green-500/10 text-green-700 dark:text-green-400 px-3 py-1.5 shadow-soft text-sm font-semibold",children:[e.jsx(Ve,{className:"h-4 w-4"}),"Kurs ukoczony"]})]})]})]}),e.jsx("div",{className:"md:col-span-5",children:e.jsxs("div",{className:"rounded-xl border bg-card p-4 md:p-5 shadow-soft",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Postp kursu"}),e.jsxs("span",{className:"text-sm font-semibold",children:[o.progress,"%"]})]}),e.jsx("div",{className:"mt-2",children:e.jsx(_n,{value:o.progress})}),e.jsxs("div",{className:"mt-3 flex gap-2",children:[c?e.jsxs("button",{onClick:()=>s(c.path),className:"flex-1 inline-flex items-center justify-center gap-2 rounded-lg bg-primary px-4 py-2 text-primary-foreground hover:bg-primary/90 focus-ring",children:["Kontynuuj",e.jsx(le,{className:"h-4 w-4"})]}):e.jsx("button",{disabled:!0,className:"flex-1 rounded-lg border px-4 py-2 text-muted-foreground cursor-default",title:"Brak kolejnej aktywnoci",children:"Wszystko ukoczone"}),e.jsx("button",{onClick:()=>s("/student/courses"),className:"rounded-lg border px-3 py-2 hover:bg-primary/5 focus-ring",title:"Wr贸 do listy",children:e.jsx(Ce,{className:"h-4 w-4"})})]})]})})]})})]}),e.jsx("div",{className:"space-y-6",children:a.map((d,m)=>e.jsxs($r,{index:m,className:q("relative rounded-2xl border bg-card p-4 md:p-5 shadow-soft",!d.isUnlocked&&"opacity-60"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-3 md:mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:q("w-10 h-10 rounded-full flex items-center justify-center",d.isCompleted?"bg-green-600 text-white":d.isUnlocked?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"),"aria-label":d.isCompleted?"Temat ukoczony":d.isUnlocked?"Temat odblokowany":"Temat zablokowany",children:d.isCompleted?e.jsx(Ve,{className:"w-5 h-5"}):d.isUnlocked?e.jsx("span",{className:"font-semibold",children:d.position}):e.jsx(vn,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-base md:text-lg font-semibold text-foreground",children:d.title}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[d.activities.filter(u=>u.completed).length," ","z ",d.activities.length," ukoczonych"]})]})]}),e.jsx("div",{className:"hidden md:block w-40",children:e.jsx(_n,{value:d.activities.length?Math.round(d.activities.filter(u=>u.completed).length/d.activities.length*100):0})})]}),e.jsx("div",{className:"mt-3 md:mt-4 space-y-3",children:d.activities.map(u=>{const h=u.type==="quiz",p=u.type==="quiz"?`/student/courses/${t}/quiz/${u.id}`:`/student/courses/${t}/lesson/${u.id}`;return e.jsxs(ke.button,{whileHover:u.isUnlocked?{x:2}:{},whileTap:u.isUnlocked?{scale:.98}:{},onClick:()=>{u.isUnlocked&&s(p)},disabled:!u.isUnlocked,className:q("w-full flex items-center justify-between p-4 rounded-xl border transition-colors focus-ring",u.isUnlocked?"bg-background/60 hover:bg-primary/5":"bg-muted/40 cursor-not-allowed"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:q("w-8 h-8 rounded-lg flex items-center justify-center shrink-0",h?u.isUnlocked?"bg-purple-100":"bg-muted":u.isUnlocked?"bg-blue-100":"bg-muted"),children:u.isUnlocked?h?e.jsx(Ye,{className:"w-4 h-4 text-purple-600"}):e.jsx(Te,{className:"w-4 h-4 text-blue-600"}):e.jsx(vn,{className:"w-4 h-4 text-muted-foreground"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:q("font-medium",u.isUnlocked?"text-foreground":"text-muted-foreground"),children:u.title}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[h?"Quiz":"Materia",u.score!==null&&`  ${u.score}%`,!u.isUnlocked&&"  Zablokowane"]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[!u.completed&&u.isUnlocked&&e.jsx("span",{className:"hidden sm:inline text-xs text-muted-foreground",children:"Przejd藕"}),u.completed?e.jsx(Ve,{className:"w-5 h-5 text-green-600"}):u.isUnlocked?e.jsx(le,{className:"w-5 h-5 text-muted-foreground"}):e.jsx(vn,{className:"w-4 h-4 text-muted-foreground"})]})]},u.id)})})]},d.id))})]}):e.jsxs("div",{className:"container mx-auto px-4 py-12 text-center",children:[e.jsx("div",{className:"text-5xl",children:"し锔"}),e.jsx("h2",{className:"mt-3 text-xl font-semibold",children:"Nie znaleziono kursu"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Spr贸buj wr贸ci do listy kurs贸w i wybra ponownie."}),e.jsx("button",{onClick:()=>s("/student/courses"),className:"mt-6 rounded-lg bg-primary px-4 py-2 text-primary-foreground hover:bg-primary/90 focus-ring",children:"Przejd藕 do kurs贸w"})]})},Q_=[e.jsx(W,{path:"/courses/:courseId",element:e.jsx(G_,{})},"course-detail")],Sd=Symbol.for("yaml.alias"),oc=Symbol.for("yaml.document"),en=Symbol.for("yaml.map"),Gg=Symbol.for("yaml.pair"),Ns=Symbol.for("yaml.scalar"),qr=Symbol.for("yaml.seq"),Jt=Symbol.for("yaml.node.type"),mn=t=>!!t&&typeof t=="object"&&t[Jt]===Sd,Fn=t=>!!t&&typeof t=="object"&&t[Jt]===oc,Fr=t=>!!t&&typeof t=="object"&&t[Jt]===en,De=t=>!!t&&typeof t=="object"&&t[Jt]===Gg,Ne=t=>!!t&&typeof t=="object"&&t[Jt]===Ns,Ur=t=>!!t&&typeof t=="object"&&t[Jt]===qr;function Me(t){if(t&&typeof t=="object")switch(t[Jt]){case en:case qr:return!0}return!1}function Ee(t){if(t&&typeof t=="object")switch(t[Jt]){case Sd:case en:case Ns:case qr:return!0}return!1}const Qg=t=>(Ne(t)||Me(t))&&!!t.anchor,kt=Symbol("break visit"),Hg=Symbol("skip children"),bs=Symbol("remove node");function Un(t,s){const n=Zg(s);Fn(t)?rr(null,t.contents,n,Object.freeze([t]))===bs&&(t.contents=null):rr(null,t,n,Object.freeze([]))}Un.BREAK=kt;Un.SKIP=Hg;Un.REMOVE=bs;function rr(t,s,n,r){const i=Yg(t,s,n,r);if(Ee(i)||De(i))return Jg(t,r,i),rr(t,i,n,r);if(typeof i!="symbol"){if(Me(s)){r=Object.freeze(r.concat(s));for(let a=0;a<s.items.length;++a){const o=rr(a,s.items[a],n,r);if(typeof o=="number")a=o-1;else{if(o===kt)return kt;o===bs&&(s.items.splice(a,1),a-=1)}}}else if(De(s)){r=Object.freeze(r.concat(s));const a=rr("key",s.key,n,r);if(a===kt)return kt;a===bs&&(s.key=null);const o=rr("value",s.value,n,r);if(o===kt)return kt;o===bs&&(s.value=null)}}return i}async function Do(t,s){const n=Zg(s);Fn(t)?await ir(null,t.contents,n,Object.freeze([t]))===bs&&(t.contents=null):await ir(null,t,n,Object.freeze([]))}Do.BREAK=kt;Do.SKIP=Hg;Do.REMOVE=bs;async function ir(t,s,n,r){const i=await Yg(t,s,n,r);if(Ee(i)||De(i))return Jg(t,r,i),ir(t,i,n,r);if(typeof i!="symbol"){if(Me(s)){r=Object.freeze(r.concat(s));for(let a=0;a<s.items.length;++a){const o=await ir(a,s.items[a],n,r);if(typeof o=="number")a=o-1;else{if(o===kt)return kt;o===bs&&(s.items.splice(a,1),a-=1)}}}else if(De(s)){r=Object.freeze(r.concat(s));const a=await ir("key",s.key,n,r);if(a===kt)return kt;a===bs&&(s.key=null);const o=await ir("value",s.value,n,r);if(o===kt)return kt;o===bs&&(s.value=null)}}return i}function Zg(t){return typeof t=="object"&&(t.Collection||t.Node||t.Value)?Object.assign({Alias:t.Node,Map:t.Node,Scalar:t.Node,Seq:t.Node},t.Value&&{Map:t.Value,Scalar:t.Value,Seq:t.Value},t.Collection&&{Map:t.Collection,Seq:t.Collection},t):t}function Yg(t,s,n,r){if(typeof n=="function")return n(t,s,r);if(Fr(s))return n.Map?.(t,s,r);if(Ur(s))return n.Seq?.(t,s,r);if(De(s))return n.Pair?.(t,s,r);if(Ne(s))return n.Scalar?.(t,s,r);if(mn(s))return n.Alias?.(t,s,r)}function Jg(t,s,n){const r=s[s.length-1];if(Me(r))r.items[t]=n;else if(De(r))t==="key"?r.key=n:r.value=n;else if(Fn(r))r.contents=n;else{const i=mn(r)?"alias":"scalar";throw new Error(`Cannot replace node with ${i} parent`)}}const H_={"!":"%21",",":"%2C","[":"%5B","]":"%5D","{":"%7B","}":"%7D"},Z_=t=>t.replace(/[!,[\]{}]/g,s=>H_[s]);class ht{constructor(s,n){this.docStart=null,this.docEnd=!1,this.yaml=Object.assign({},ht.defaultYaml,s),this.tags=Object.assign({},ht.defaultTags,n)}clone(){const s=new ht(this.yaml,this.tags);return s.docStart=this.docStart,s}atDocument(){const s=new ht(this.yaml,this.tags);switch(this.yaml.version){case"1.1":this.atNextDocument=!0;break;case"1.2":this.atNextDocument=!1,this.yaml={explicit:ht.defaultYaml.explicit,version:"1.2"},this.tags=Object.assign({},ht.defaultTags);break}return s}add(s,n){this.atNextDocument&&(this.yaml={explicit:ht.defaultYaml.explicit,version:"1.1"},this.tags=Object.assign({},ht.defaultTags),this.atNextDocument=!1);const r=s.trim().split(/[ \t]+/),i=r.shift();switch(i){case"%TAG":{if(r.length!==2&&(n(0,"%TAG directive should contain exactly two parts"),r.length<2))return!1;const[a,o]=r;return this.tags[a]=o,!0}case"%YAML":{if(this.yaml.explicit=!0,r.length!==1)return n(0,"%YAML directive should contain exactly one part"),!1;const[a]=r;if(a==="1.1"||a==="1.2")return this.yaml.version=a,!0;{const o=/^\d+\.\d+$/.test(a);return n(6,`Unsupported YAML version ${a}`,o),!1}}default:return n(0,`Unknown directive ${i}`,!0),!1}}tagName(s,n){if(s==="!")return"!";if(s[0]!=="!")return n(`Not a valid tag: ${s}`),null;if(s[1]==="<"){const o=s.slice(2,-1);return o==="!"||o==="!!"?(n(`Verbatim tags aren't resolved, so ${s} is invalid.`),null):(s[s.length-1]!==">"&&n("Verbatim tags must end with a >"),o)}const[,r,i]=s.match(/^(.*!)([^!]*)$/s);i||n(`The ${s} tag has no suffix`);const a=this.tags[r];if(a)try{return a+decodeURIComponent(i)}catch(o){return n(String(o)),null}return r==="!"?s:(n(`Could not resolve tag: ${s}`),null)}tagString(s){for(const[n,r]of Object.entries(this.tags))if(s.startsWith(r))return n+Z_(s.substring(r.length));return s[0]==="!"?s:`!<${s}>`}toString(s){const n=this.yaml.explicit?[`%YAML ${this.yaml.version||"1.2"}`]:[],r=Object.entries(this.tags);let i;if(s&&r.length>0&&Ee(s.contents)){const a={};Un(s.contents,(o,l)=>{Ee(l)&&l.tag&&(a[l.tag]=!0)}),i=Object.keys(a)}else i=[];for(const[a,o]of r)a==="!!"&&o==="tag:yaml.org,2002:"||(!s||i.some(l=>l.startsWith(o)))&&n.push(`%TAG ${a} ${o}`);return n.join(`
`)}}ht.defaultYaml={explicit:!1,version:"1.2"};ht.defaultTags={"!!":"tag:yaml.org,2002:"};function Xg(t){if(/[\x00-\x19\s,[\]{}]/.test(t)){const n=`Anchor must not contain whitespace or control characters: ${JSON.stringify(t)}`;throw new Error(n)}return!0}function ej(t){const s=new Set;return Un(t,{Value(n,r){r.anchor&&s.add(r.anchor)}}),s}function tj(t,s){for(let n=1;;++n){const r=`${t}${n}`;if(!s.has(r))return r}}function Y_(t,s){const n=[],r=new Map;let i=null;return{onAnchor:a=>{n.push(a),i??(i=ej(t));const o=tj(s,i);return i.add(o),o},setAnchors:()=>{for(const a of n){const o=r.get(a);if(typeof o=="object"&&o.anchor&&(Ne(o.node)||Me(o.node)))o.node.anchor=o.anchor;else{const l=new Error("Failed to resolve repeated object (this should not happen)");throw l.source=a,l}}},sourceObjects:r}}function ar(t,s,n,r){if(r&&typeof r=="object")if(Array.isArray(r))for(let i=0,a=r.length;i<a;++i){const o=r[i],l=ar(t,r,String(i),o);l===void 0?delete r[i]:l!==o&&(r[i]=l)}else if(r instanceof Map)for(const i of Array.from(r.keys())){const a=r.get(i),o=ar(t,r,i,a);o===void 0?r.delete(i):o!==a&&r.set(i,o)}else if(r instanceof Set)for(const i of Array.from(r)){const a=ar(t,r,i,i);a===void 0?r.delete(i):a!==i&&(r.delete(i),r.add(a))}else for(const[i,a]of Object.entries(r)){const o=ar(t,r,i,a);o===void 0?delete r[i]:o!==a&&(r[i]=o)}return t.call(s,n,r)}function Yt(t,s,n){if(Array.isArray(t))return t.map((r,i)=>Yt(r,String(i),n));if(t&&typeof t.toJSON=="function"){if(!n||!Qg(t))return t.toJSON(s,n);const r={aliasCount:0,count:1,res:void 0};n.anchors.set(t,r),n.onCreate=a=>{r.res=a,delete n.onCreate};const i=t.toJSON(s,n);return n.onCreate&&n.onCreate(i),i}return typeof t=="bigint"&&!n?.keep?Number(t):t}class Cd{constructor(s){Object.defineProperty(this,Jt,{value:s})}clone(){const s=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return this.range&&(s.range=this.range.slice()),s}toJS(s,{mapAsMap:n,maxAliasCount:r,onAnchor:i,reviver:a}={}){if(!Fn(s))throw new TypeError("A document argument is required");const o={anchors:new Map,doc:s,keep:!0,mapAsMap:n===!0,mapKeyWarned:!1,maxAliasCount:typeof r=="number"?r:100},l=Yt(this,"",o);if(typeof i=="function")for(const{count:c,res:d}of o.anchors.values())i(d,c);return typeof a=="function"?ar(a,{"":l},"",l):l}}class Po extends Cd{constructor(s){super(Sd),this.source=s,Object.defineProperty(this,"tag",{set(){throw new Error("Alias nodes cannot have tags")}})}resolve(s,n){let r;n?.aliasResolveCache?r=n.aliasResolveCache:(r=[],Un(s,{Node:(a,o)=>{(mn(o)||Qg(o))&&r.push(o)}}),n&&(n.aliasResolveCache=r));let i;for(const a of r){if(a===this)break;a.anchor===this.source&&(i=a)}return i}toJSON(s,n){if(!n)return{source:this.source};const{anchors:r,doc:i,maxAliasCount:a}=n,o=this.resolve(i,n);if(!o){const c=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new ReferenceError(c)}let l=r.get(o);if(l||(Yt(o,null,n),l=r.get(o)),!l||l.res===void 0){const c="This should not happen: Alias anchor was not resolved?";throw new ReferenceError(c)}if(a>=0&&(l.count+=1,l.aliasCount===0&&(l.aliasCount=Ta(i,o,r)),l.count*l.aliasCount>a)){const c="Excessive alias count indicates a resource exhaustion attack";throw new ReferenceError(c)}return l.res}toString(s,n,r){const i=`*${this.source}`;if(s){if(Xg(this.source),s.options.verifyAliasOrder&&!s.anchors.has(this.source)){const a=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new Error(a)}if(s.implicitKey)return`${i} `}return i}}function Ta(t,s,n){if(mn(s)){const r=s.resolve(t),i=n&&r&&n.get(r);return i?i.count*i.aliasCount:0}else if(Me(s)){let r=0;for(const i of s.items){const a=Ta(t,i,n);a>r&&(r=a)}return r}else if(De(s)){const r=Ta(t,s.key,n),i=Ta(t,s.value,n);return Math.max(r,i)}return 1}const sj=t=>!t||typeof t!="function"&&typeof t!="object";class ie extends Cd{constructor(s){super(Ns),this.value=s}toJSON(s,n){return n?.keep?this.value:Yt(this.value,s,n)}toString(){return String(this.value)}}ie.BLOCK_FOLDED="BLOCK_FOLDED";ie.BLOCK_LITERAL="BLOCK_LITERAL";ie.PLAIN="PLAIN";ie.QUOTE_DOUBLE="QUOTE_DOUBLE";ie.QUOTE_SINGLE="QUOTE_SINGLE";const J_="tag:yaml.org,2002:";function X_(t,s,n){if(s){const r=n.filter(a=>a.tag===s),i=r.find(a=>!a.format)??r[0];if(!i)throw new Error(`Tag ${s} not found`);return i}return n.find(r=>r.identify?.(t)&&!r.format)}function Pi(t,s,n){if(Fn(t)&&(t=t.contents),Ee(t))return t;if(De(t)){const u=n.schema[en].createNode?.(n.schema,null,n);return u.items.push(t),u}(t instanceof String||t instanceof Number||t instanceof Boolean||typeof BigInt<"u"&&t instanceof BigInt)&&(t=t.valueOf());const{aliasDuplicateObjects:r,onAnchor:i,onTagObj:a,schema:o,sourceObjects:l}=n;let c;if(r&&t&&typeof t=="object"){if(c=l.get(t),c)return c.anchor??(c.anchor=i(t)),new Po(c.anchor);c={anchor:null,node:null},l.set(t,c)}s?.startsWith("!!")&&(s=J_+s.slice(2));let d=X_(t,s,o.tags);if(!d){if(t&&typeof t.toJSON=="function"&&(t=t.toJSON()),!t||typeof t!="object"){const u=new ie(t);return c&&(c.node=u),u}d=t instanceof Map?o[en]:Symbol.iterator in Object(t)?o[qr]:o[en]}a&&(a(d),delete n.onTagObj);const m=d?.createNode?d.createNode(n.schema,t,n):typeof d?.nodeClass?.from=="function"?d.nodeClass.from(n.schema,t,n):new ie(t);return s?m.tag=s:d.default||(m.tag=d.tag),c&&(c.node=m),m}function Za(t,s,n){let r=n;for(let i=s.length-1;i>=0;--i){const a=s[i];if(typeof a=="number"&&Number.isInteger(a)&&a>=0){const o=[];o[a]=r,r=o}else r=new Map([[a,r]])}return Pi(r,void 0,{aliasDuplicateObjects:!1,keepUndefined:!1,onAnchor:()=>{throw new Error("This should not happen, please report a bug.")},schema:t,sourceObjects:new Map})}const ii=t=>t==null||typeof t=="object"&&!!t[Symbol.iterator]().next().done;class nj extends Cd{constructor(s,n){super(s),Object.defineProperty(this,"schema",{value:n,configurable:!0,enumerable:!1,writable:!0})}clone(s){const n=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return s&&(n.schema=s),n.items=n.items.map(r=>Ee(r)||De(r)?r.clone(s):r),this.range&&(n.range=this.range.slice()),n}addIn(s,n){if(ii(s))this.add(n);else{const[r,...i]=s,a=this.get(r,!0);if(Me(a))a.addIn(i,n);else if(a===void 0&&this.schema)this.set(r,Za(this.schema,i,n));else throw new Error(`Expected YAML collection at ${r}. Remaining path: ${i}`)}}deleteIn(s){const[n,...r]=s;if(r.length===0)return this.delete(n);const i=this.get(n,!0);if(Me(i))return i.deleteIn(r);throw new Error(`Expected YAML collection at ${n}. Remaining path: ${r}`)}getIn(s,n){const[r,...i]=s,a=this.get(r,!0);return i.length===0?!n&&Ne(a)?a.value:a:Me(a)?a.getIn(i,n):void 0}hasAllNullValues(s){return this.items.every(n=>{if(!De(n))return!1;const r=n.value;return r==null||s&&Ne(r)&&r.value==null&&!r.commentBefore&&!r.comment&&!r.tag})}hasIn(s){const[n,...r]=s;if(r.length===0)return this.has(n);const i=this.get(n,!0);return Me(i)?i.hasIn(r):!1}setIn(s,n){const[r,...i]=s;if(i.length===0)this.set(r,n);else{const a=this.get(r,!0);if(Me(a))a.setIn(i,n);else if(a===void 0&&this.schema)this.set(r,Za(this.schema,i,n));else throw new Error(`Expected YAML collection at ${r}. Remaining path: ${i}`)}}}const eA=t=>t.replace(/^(?!$)(?: $)?/gm,"#");function Is(t,s){return/^\n+$/.test(t)?t.substring(1):s?t.replace(/^(?! *$)/gm,s):t}const yn=(t,s,n)=>t.endsWith(`
`)?Is(n,s):n.includes(`
`)?`
`+Is(n,s):(t.endsWith(" ")?"":" ")+n,rj="flow",lc="block",_a="quoted";function Mo(t,s,n="flow",{indentAtStart:r,lineWidth:i=80,minContentWidth:a=20,onFold:o,onOverflow:l}={}){if(!i||i<0)return t;i<a&&(a=0);const c=Math.max(1+a,1+i-s.length);if(t.length<=c)return t;const d=[],m={};let u=i-s.length;typeof r=="number"&&(r>i-Math.max(2,a)?d.push(0):u=i-r);let h,p,b=!1,f=-1,y=-1,w=-1;n===lc&&(f=sh(t,f,s.length),f!==-1&&(u=f+c));for(let v;v=t[f+=1];){if(n===_a&&v==="\\"){switch(y=f,t[f+1]){case"x":f+=3;break;case"u":f+=5;break;case"U":f+=9;break;default:f+=1}w=f}if(v===`
`)n===lc&&(f=sh(t,f,s.length)),u=f+s.length+c,h=void 0;else{if(v===" "&&p&&p!==" "&&p!==`
`&&p!=="	"){const T=t[f+1];T&&T!==" "&&T!==`
`&&T!=="	"&&(h=f)}if(f>=u)if(h)d.push(h),u=h+c,h=void 0;else if(n===_a){for(;p===" "||p==="	";)p=v,v=t[f+=1],b=!0;const T=f>w+1?f-2:y-1;if(m[T])return t;d.push(T),m[T]=!0,u=T+c,h=void 0}else b=!0}p=v}if(b&&l&&l(),d.length===0)return t;o&&o();let j=t.slice(0,d[0]);for(let v=0;v<d.length;++v){const T=d[v],z=d[v+1]||t.length;T===0?j=`
${s}${t.slice(0,z)}`:(n===_a&&m[T]&&(j+=`${t[T]}\\`),j+=`
${s}${t.slice(T+1,z)}`)}return j}function sh(t,s,n){let r=s,i=s+1,a=t[i];for(;a===" "||a==="	";)if(s<i+n)a=t[++s];else{do a=t[++s];while(a&&a!==`
`);r=s,i=s+1,a=t[i]}return r}const Io=(t,s)=>({indentAtStart:s?t.indent.length:t.indentAtStart,lineWidth:t.options.lineWidth,minContentWidth:t.options.minContentWidth}),Eo=t=>/^(%|---|\.\.\.)/m.test(t);function tA(t,s,n){if(!s||s<0)return!1;const r=s-n,i=t.length;if(i<=r)return!1;for(let a=0,o=0;a<i;++a)if(t[a]===`
`){if(a-o>r)return!0;if(o=a+1,i-o<=r)return!1}return!0}function fi(t,s){const n=JSON.stringify(t);if(s.options.doubleQuotedAsJSON)return n;const{implicitKey:r}=s,i=s.options.doubleQuotedMinMultiLineLength,a=s.indent||(Eo(t)?"  ":"");let o="",l=0;for(let c=0,d=n[c];d;d=n[++c])if(d===" "&&n[c+1]==="\\"&&n[c+2]==="n"&&(o+=n.slice(l,c)+"\\ ",c+=1,l=c,d="\\"),d==="\\")switch(n[c+1]){case"u":{o+=n.slice(l,c);const m=n.substr(c+2,4);switch(m){case"0000":o+="\\0";break;case"0007":o+="\\a";break;case"000b":o+="\\v";break;case"001b":o+="\\e";break;case"0085":o+="\\N";break;case"00a0":o+="\\_";break;case"2028":o+="\\L";break;case"2029":o+="\\P";break;default:m.substr(0,2)==="00"?o+="\\x"+m.substr(2):o+=n.substr(c,6)}c+=5,l=c+1}break;case"n":if(r||n[c+2]==='"'||n.length<i)c+=1;else{for(o+=n.slice(l,c)+`

`;n[c+2]==="\\"&&n[c+3]==="n"&&n[c+4]!=='"';)o+=`
`,c+=2;o+=a,n[c+2]===" "&&(o+="\\"),c+=1,l=c+1}break;default:c+=1}return o=l?o+n.slice(l):n,r?o:Mo(o,a,_a,Io(s,!1))}function cc(t,s){if(s.options.singleQuote===!1||s.implicitKey&&t.includes(`
`)||/[ \t]\n|\n[ \t]/.test(t))return fi(t,s);const n=s.indent||(Eo(t)?"  ":""),r="'"+t.replace(/'/g,"''").replace(/\n+/g,`$&
${n}`)+"'";return s.implicitKey?r:Mo(r,n,rj,Io(s,!1))}function or(t,s){const{singleQuote:n}=s.options;let r;if(n===!1)r=fi;else{const i=t.includes('"'),a=t.includes("'");i&&!a?r=cc:a&&!i?r=fi:r=n?cc:fi}return r(t,s)}let dc;try{dc=new RegExp(`(^|(?<!
))
+(?!
|$)`,"g")}catch{dc=/\n+(?!\n|$)/g}function Aa({comment:t,type:s,value:n},r,i,a){const{blockQuote:o,commentString:l,lineWidth:c}=r.options;if(!o||/\n[\t ]+$/.test(n)||/^\s*$/.test(n))return or(n,r);const d=r.indent||(r.forceBlockIndent||Eo(n)?"  ":""),m=o==="literal"?!0:o==="folded"||s===ie.BLOCK_FOLDED?!1:s===ie.BLOCK_LITERAL?!0:!tA(n,c,d.length);if(!n)return m?`|
`:`>
`;let u,h;for(h=n.length;h>0;--h){const z=n[h-1];if(z!==`
`&&z!=="	"&&z!==" ")break}let p=n.substring(h);const b=p.indexOf(`
`);b===-1?u="-":n===p||b!==p.length-1?(u="+",a&&a()):u="",p&&(n=n.slice(0,-p.length),p[p.length-1]===`
`&&(p=p.slice(0,-1)),p=p.replace(dc,`$&${d}`));let f=!1,y,w=-1;for(y=0;y<n.length;++y){const z=n[y];if(z===" ")f=!0;else if(z===`
`)w=y;else break}let j=n.substring(0,w<y?w+1:y);j&&(n=n.substring(j.length),j=j.replace(/\n+/g,`$&${d}`));let T=(f?d?"2":"1":"")+u;if(t&&(T+=" "+l(t.replace(/ ?[\r\n]+/g," ")),i&&i()),!m){const z=n.replace(/\n+/g,`
$&`).replace(/(?:^|\n)([\t ].*)(?:([\n\t ]*)\n(?![\n\t ]))?/g,"$1$2").replace(/\n+/g,`$&${d}`);let k=!1;const N=Io(r,!0);o!=="folded"&&s!==ie.BLOCK_FOLDED&&(N.onOverflow=()=>{k=!0});const S=Mo(`${j}${z}${p}`,d,lc,N);if(!k)return`>${T}
${d}${S}`}return n=n.replace(/\n+/g,`$&${d}`),`|${T}
${d}${j}${n}${p}`}function sA(t,s,n,r){const{type:i,value:a}=t,{actualString:o,implicitKey:l,indent:c,indentStep:d,inFlow:m}=s;if(l&&a.includes(`
`)||m&&/[[\]{},]/.test(a))return or(a,s);if(/^[\n\t ,[\]{}#&*!|>'"%@`]|^[?-]$|^[?-][ \t]|[\n:][ \t]|[ \t]\n|[\n\t ]#|[\n\t :]$/.test(a))return l||m||!a.includes(`
`)?or(a,s):Aa(t,s,n,r);if(!l&&!m&&i!==ie.PLAIN&&a.includes(`
`))return Aa(t,s,n,r);if(Eo(a)){if(c==="")return s.forceBlockIndent=!0,Aa(t,s,n,r);if(l&&c===d)return or(a,s)}const u=a.replace(/\n+/g,`$&
${c}`);if(o){const h=f=>f.default&&f.tag!=="tag:yaml.org,2002:str"&&f.test?.test(u),{compat:p,tags:b}=s.doc.schema;if(b.some(h)||p?.some(h))return or(a,s)}return l?u:Mo(u,c,rj,Io(s,!1))}function ra(t,s,n,r){const{implicitKey:i,inFlow:a}=s,o=typeof t.value=="string"?t:Object.assign({},t,{value:String(t.value)});let{type:l}=t;l!==ie.QUOTE_DOUBLE&&/[\x00-\x08\x0b-\x1f\x7f-\x9f\u{D800}-\u{DFFF}]/u.test(o.value)&&(l=ie.QUOTE_DOUBLE);const c=m=>{switch(m){case ie.BLOCK_FOLDED:case ie.BLOCK_LITERAL:return i||a?or(o.value,s):Aa(o,s,n,r);case ie.QUOTE_DOUBLE:return fi(o.value,s);case ie.QUOTE_SINGLE:return cc(o.value,s);case ie.PLAIN:return sA(o,s,n,r);default:return null}};let d=c(l);if(d===null){const{defaultKeyType:m,defaultStringType:u}=s.options,h=i&&m||u;if(d=c(h),d===null)throw new Error(`Unsupported default string type ${h}`)}return d}function ij(t,s){const n=Object.assign({blockQuote:!0,commentString:eA,defaultKeyType:null,defaultStringType:"PLAIN",directives:null,doubleQuotedAsJSON:!1,doubleQuotedMinMultiLineLength:40,falseStr:"false",flowCollectionPadding:!0,indentSeq:!0,lineWidth:80,minContentWidth:20,nullStr:"null",simpleKeys:!1,singleQuote:null,trueStr:"true",verifyAliasOrder:!0},t.schema.toStringOptions,s);let r;switch(n.collectionStyle){case"block":r=!1;break;case"flow":r=!0;break;default:r=null}return{anchors:new Set,doc:t,flowCollectionPadding:n.flowCollectionPadding?" ":"",indent:"",indentStep:typeof n.indent=="number"?" ".repeat(n.indent):"  ",inFlow:r,options:n}}function nA(t,s){if(s.tag){const i=t.filter(a=>a.tag===s.tag);if(i.length>0)return i.find(a=>a.format===s.format)??i[0]}let n,r;if(Ne(s)){r=s.value;let i=t.filter(a=>a.identify?.(r));if(i.length>1){const a=i.filter(o=>o.test);a.length>0&&(i=a)}n=i.find(a=>a.format===s.format)??i.find(a=>!a.format)}else r=s,n=t.find(i=>i.nodeClass&&r instanceof i.nodeClass);if(!n){const i=r?.constructor?.name??(r===null?"null":typeof r);throw new Error(`Tag not resolved for ${i} value`)}return n}function rA(t,s,{anchors:n,doc:r}){if(!r.directives)return"";const i=[],a=(Ne(t)||Me(t))&&t.anchor;a&&Xg(a)&&(n.add(a),i.push(`&${a}`));const o=t.tag??(s.default?null:s.tag);return o&&i.push(r.directives.tagString(o)),i.join(" ")}function kr(t,s,n,r){if(De(t))return t.toString(s,n,r);if(mn(t)){if(s.doc.directives)return t.toString(s);if(s.resolvedAliases?.has(t))throw new TypeError("Cannot stringify circular structure without alias nodes");s.resolvedAliases?s.resolvedAliases.add(t):s.resolvedAliases=new Set([t]),t=t.resolve(s.doc)}let i;const a=Ee(t)?t:s.doc.createNode(t,{onTagObj:c=>i=c});i??(i=nA(s.doc.schema.tags,a));const o=rA(a,i,s);o.length>0&&(s.indentAtStart=(s.indentAtStart??0)+o.length+1);const l=typeof i.stringify=="function"?i.stringify(a,s,n,r):Ne(a)?ra(a,s,n,r):a.toString(s,n,r);return o?Ne(a)||l[0]==="{"||l[0]==="["?`${o} ${l}`:`${o}
${s.indent}${l}`:l}function iA({key:t,value:s},n,r,i){const{allNullValues:a,doc:o,indent:l,indentStep:c,options:{commentString:d,indentSeq:m,simpleKeys:u}}=n;let h=Ee(t)&&t.comment||null;if(u){if(h)throw new Error("With simple keys, key nodes cannot have comments");if(Me(t)||!Ee(t)&&typeof t=="object"){const N="With simple keys, collection cannot be used as a key value";throw new Error(N)}}let p=!u&&(!t||h&&s==null&&!n.inFlow||Me(t)||(Ne(t)?t.type===ie.BLOCK_FOLDED||t.type===ie.BLOCK_LITERAL:typeof t=="object"));n=Object.assign({},n,{allNullValues:!1,implicitKey:!p&&(u||!a),indent:l+c});let b=!1,f=!1,y=kr(t,n,()=>b=!0,()=>f=!0);if(!p&&!n.inFlow&&y.length>1024){if(u)throw new Error("With simple keys, single line scalar must not span more than 1024 characters");p=!0}if(n.inFlow){if(a||s==null)return b&&r&&r(),y===""?"?":p?`? ${y}`:y}else if(a&&!u||s==null&&p)return y=`? ${y}`,h&&!b?y+=yn(y,n.indent,d(h)):f&&i&&i(),y;b&&(h=null),p?(h&&(y+=yn(y,n.indent,d(h))),y=`? ${y}
${l}:`):(y=`${y}:`,h&&(y+=yn(y,n.indent,d(h))));let w,j,v;Ee(s)?(w=!!s.spaceBefore,j=s.commentBefore,v=s.comment):(w=!1,j=null,v=null,s&&typeof s=="object"&&(s=o.createNode(s))),n.implicitKey=!1,!p&&!h&&Ne(s)&&(n.indentAtStart=y.length+1),f=!1,!m&&c.length>=2&&!n.inFlow&&!p&&Ur(s)&&!s.flow&&!s.tag&&!s.anchor&&(n.indent=n.indent.substring(2));let T=!1;const z=kr(s,n,()=>T=!0,()=>f=!0);let k=" ";if(h||w||j){if(k=w?`
`:"",j){const N=d(j);k+=`
${Is(N,n.indent)}`}z===""&&!n.inFlow?k===`
`&&(k=`

`):k+=`
${n.indent}`}else if(!p&&Me(s)){const N=z[0],S=z.indexOf(`
`),_=S!==-1,g=n.inFlow??s.flow??s.items.length===0;if(_||!g){let C=!1;if(_&&(N==="&"||N==="!")){let A=z.indexOf(" ");N==="&"&&A!==-1&&A<S&&z[A+1]==="!"&&(A=z.indexOf(" ",A+1)),(A===-1||S<A)&&(C=!0)}C||(k=`
${n.indent}`)}}else(z===""||z[0]===`
`)&&(k="");return y+=k+z,n.inFlow?T&&r&&r():v&&!T?y+=yn(y,n.indent,d(v)):f&&i&&i(),y}function aj(t,s){(t==="debug"||t==="warn")&&console.warn(s)}const ga="<<",Es={identify:t=>t===ga||typeof t=="symbol"&&t.description===ga,default:"key",tag:"tag:yaml.org,2002:merge",test:/^<<$/,resolve:()=>Object.assign(new ie(Symbol(ga)),{addToJSMap:oj}),stringify:()=>ga},aA=(t,s)=>(Es.identify(s)||Ne(s)&&(!s.type||s.type===ie.PLAIN)&&Es.identify(s.value))&&t?.doc.schema.tags.some(n=>n.tag===Es.tag&&n.default);function oj(t,s,n){if(n=t&&mn(n)?n.resolve(t.doc):n,Ur(n))for(const r of n.items)wl(t,s,r);else if(Array.isArray(n))for(const r of n)wl(t,s,r);else wl(t,s,n)}function wl(t,s,n){const r=t&&mn(n)?n.resolve(t.doc):n;if(!Fr(r))throw new Error("Merge sources must be maps or map aliases");const i=r.toJSON(null,t,Map);for(const[a,o]of i)s instanceof Map?s.has(a)||s.set(a,o):s instanceof Set?s.add(a):Object.prototype.hasOwnProperty.call(s,a)||Object.defineProperty(s,a,{value:o,writable:!0,enumerable:!0,configurable:!0});return s}function lj(t,s,{key:n,value:r}){if(Ee(n)&&n.addToJSMap)n.addToJSMap(t,s,r);else if(aA(t,n))oj(t,s,r);else{const i=Yt(n,"",t);if(s instanceof Map)s.set(i,Yt(r,i,t));else if(s instanceof Set)s.add(i);else{const a=oA(n,i,t),o=Yt(r,a,t);a in s?Object.defineProperty(s,a,{value:o,writable:!0,enumerable:!0,configurable:!0}):s[a]=o}}return s}function oA(t,s,n){if(s===null)return"";if(typeof s!="object")return String(s);if(Ee(t)&&n?.doc){const r=ij(n.doc,{});r.anchors=new Set;for(const a of n.anchors.keys())r.anchors.add(a.anchor);r.inFlow=!0,r.inStringifyKey=!0;const i=t.toString(r);if(!n.mapKeyWarned){let a=JSON.stringify(i);a.length>40&&(a=a.substring(0,36)+'..."'),aj(n.doc.options.logLevel,`Keys with collection values will be stringified due to JS Object restrictions: ${a}. Set mapAsMap: true to use object keys.`),n.mapKeyWarned=!0}return i}return JSON.stringify(s)}function Td(t,s,n){const r=Pi(t,void 0,n),i=Pi(s,void 0,n);return new ct(r,i)}class ct{constructor(s,n=null){Object.defineProperty(this,Jt,{value:Gg}),this.key=s,this.value=n}clone(s){let{key:n,value:r}=this;return Ee(n)&&(n=n.clone(s)),Ee(r)&&(r=r.clone(s)),new ct(n,r)}toJSON(s,n){const r=n?.mapAsMap?new Map:{};return lj(n,r,this)}toString(s,n,r){return s?.doc?iA(this,s,n,r):JSON.stringify(this)}}function cj(t,s,n){return(s.inFlow??t.flow?cA:lA)(t,s,n)}function lA({comment:t,items:s},n,{blockItemPrefix:r,flowChars:i,itemIndent:a,onChompKeep:o,onComment:l}){const{indent:c,options:{commentString:d}}=n,m=Object.assign({},n,{indent:a,type:null});let u=!1;const h=[];for(let b=0;b<s.length;++b){const f=s[b];let y=null;if(Ee(f))!u&&f.spaceBefore&&h.push(""),Ya(n,h,f.commentBefore,u),f.comment&&(y=f.comment);else if(De(f)){const j=Ee(f.key)?f.key:null;j&&(!u&&j.spaceBefore&&h.push(""),Ya(n,h,j.commentBefore,u))}u=!1;let w=kr(f,m,()=>y=null,()=>u=!0);y&&(w+=yn(w,a,d(y))),u&&y&&(u=!1),h.push(r+w)}let p;if(h.length===0)p=i.start+i.end;else{p=h[0];for(let b=1;b<h.length;++b){const f=h[b];p+=f?`
${c}${f}`:`
`}}return t?(p+=`
`+Is(d(t),c),l&&l()):u&&o&&o(),p}function cA({items:t},s,{flowChars:n,itemIndent:r}){const{indent:i,indentStep:a,flowCollectionPadding:o,options:{commentString:l}}=s;r+=a;const c=Object.assign({},s,{indent:r,inFlow:!0,type:null});let d=!1,m=0;const u=[];for(let b=0;b<t.length;++b){const f=t[b];let y=null;if(Ee(f))f.spaceBefore&&u.push(""),Ya(s,u,f.commentBefore,!1),f.comment&&(y=f.comment);else if(De(f)){const j=Ee(f.key)?f.key:null;j&&(j.spaceBefore&&u.push(""),Ya(s,u,j.commentBefore,!1),j.comment&&(d=!0));const v=Ee(f.value)?f.value:null;v?(v.comment&&(y=v.comment),v.commentBefore&&(d=!0)):f.value==null&&j?.comment&&(y=j.comment)}y&&(d=!0);let w=kr(f,c,()=>y=null);b<t.length-1&&(w+=","),y&&(w+=yn(w,r,l(y))),!d&&(u.length>m||w.includes(`
`))&&(d=!0),u.push(w),m=u.length}const{start:h,end:p}=n;if(u.length===0)return h+p;if(!d){const b=u.reduce((f,y)=>f+y.length+2,2);d=s.options.lineWidth>0&&b>s.options.lineWidth}if(d){let b=h;for(const f of u)b+=f?`
${a}${i}${f}`:`
`;return`${b}
${i}${p}`}else return`${h}${o}${u.join(" ")}${o}${p}`}function Ya({indent:t,options:{commentString:s}},n,r,i){if(r&&i&&(r=r.replace(/^\n+/,"")),r){const a=Is(s(r),t);n.push(a.trimStart())}}function bn(t,s){const n=Ne(s)?s.value:s;for(const r of t)if(De(r)&&(r.key===s||r.key===n||Ne(r.key)&&r.key.value===n))return r}class Et extends nj{static get tagName(){return"tag:yaml.org,2002:map"}constructor(s){super(en,s),this.items=[]}static from(s,n,r){const{keepUndefined:i,replacer:a}=r,o=new this(s),l=(c,d)=>{if(typeof a=="function")d=a.call(n,c,d);else if(Array.isArray(a)&&!a.includes(c))return;(d!==void 0||i)&&o.items.push(Td(c,d,r))};if(n instanceof Map)for(const[c,d]of n)l(c,d);else if(n&&typeof n=="object")for(const c of Object.keys(n))l(c,n[c]);return typeof s.sortMapEntries=="function"&&o.items.sort(s.sortMapEntries),o}add(s,n){let r;De(s)?r=s:!s||typeof s!="object"||!("key"in s)?r=new ct(s,s?.value):r=new ct(s.key,s.value);const i=bn(this.items,r.key),a=this.schema?.sortMapEntries;if(i){if(!n)throw new Error(`Key ${r.key} already set`);Ne(i.value)&&sj(r.value)?i.value.value=r.value:i.value=r.value}else if(a){const o=this.items.findIndex(l=>a(r,l)<0);o===-1?this.items.push(r):this.items.splice(o,0,r)}else this.items.push(r)}delete(s){const n=bn(this.items,s);return n?this.items.splice(this.items.indexOf(n),1).length>0:!1}get(s,n){const i=bn(this.items,s)?.value;return(!n&&Ne(i)?i.value:i)??void 0}has(s){return!!bn(this.items,s)}set(s,n){this.add(new ct(s,n),!0)}toJSON(s,n,r){const i=r?new r:n?.mapAsMap?new Map:{};n?.onCreate&&n.onCreate(i);for(const a of this.items)lj(n,i,a);return i}toString(s,n,r){if(!s)return JSON.stringify(this);for(const i of this.items)if(!De(i))throw new Error(`Map items must all be pairs; found ${JSON.stringify(i)} instead`);return!s.allNullValues&&this.hasAllNullValues(!1)&&(s=Object.assign({},s,{allNullValues:!0})),cj(this,s,{blockItemPrefix:"",flowChars:{start:"{",end:"}"},itemIndent:s.indent||"",onChompKeep:r,onComment:n})}}const Br={collection:"map",default:!0,nodeClass:Et,tag:"tag:yaml.org,2002:map",resolve(t,s){return Fr(t)||s("Expected a mapping for this tag"),t},createNode:(t,s,n)=>Et.from(t,s,n)};class an extends nj{static get tagName(){return"tag:yaml.org,2002:seq"}constructor(s){super(qr,s),this.items=[]}add(s){this.items.push(s)}delete(s){const n=ja(s);return typeof n!="number"?!1:this.items.splice(n,1).length>0}get(s,n){const r=ja(s);if(typeof r!="number")return;const i=this.items[r];return!n&&Ne(i)?i.value:i}has(s){const n=ja(s);return typeof n=="number"&&n<this.items.length}set(s,n){const r=ja(s);if(typeof r!="number")throw new Error(`Expected a valid index, not ${s}.`);const i=this.items[r];Ne(i)&&sj(n)?i.value=n:this.items[r]=n}toJSON(s,n){const r=[];n?.onCreate&&n.onCreate(r);let i=0;for(const a of this.items)r.push(Yt(a,String(i++),n));return r}toString(s,n,r){return s?cj(this,s,{blockItemPrefix:"- ",flowChars:{start:"[",end:"]"},itemIndent:(s.indent||"")+"  ",onChompKeep:r,onComment:n}):JSON.stringify(this)}static from(s,n,r){const{replacer:i}=r,a=new this(s);if(n&&Symbol.iterator in Object(n)){let o=0;for(let l of n){if(typeof i=="function"){const c=n instanceof Set?l:String(o++);l=i.call(n,c,l)}a.items.push(Pi(l,void 0,r))}}return a}}function ja(t){let s=Ne(t)?t.value:t;return s&&typeof s=="string"&&(s=Number(s)),typeof s=="number"&&Number.isInteger(s)&&s>=0?s:null}const Vr={collection:"seq",default:!0,nodeClass:an,tag:"tag:yaml.org,2002:seq",resolve(t,s){return Ur(t)||s("Expected a sequence for this tag"),t},createNode:(t,s,n)=>an.from(t,s,n)},Lo={identify:t=>typeof t=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:t=>t,stringify(t,s,n,r){return s=Object.assign({actualString:!0},s),ra(t,s,n,r)}},Oo={identify:t=>t==null,createNode:()=>new ie(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^(?:~|[Nn]ull|NULL)?$/,resolve:()=>new ie(null),stringify:({source:t},s)=>typeof t=="string"&&Oo.test.test(t)?t:s.options.nullStr},_d={identify:t=>typeof t=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:[Tt]rue|TRUE|[Ff]alse|FALSE)$/,resolve:t=>new ie(t[0]==="t"||t[0]==="T"),stringify({source:t,value:s},n){if(t&&_d.test.test(t)){const r=t[0]==="t"||t[0]==="T";if(s===r)return t}return s?n.options.trueStr:n.options.falseStr}};function ds({format:t,minFractionDigits:s,tag:n,value:r}){if(typeof r=="bigint")return String(r);const i=typeof r=="number"?r:Number(r);if(!isFinite(i))return isNaN(i)?".nan":i<0?"-.inf":".inf";let a=JSON.stringify(r);if(!t&&s&&(!n||n==="tag:yaml.org,2002:float")&&/^\d/.test(a)){let o=a.indexOf(".");o<0&&(o=a.length,a+=".");let l=s-(a.length-o-1);for(;l-- >0;)a+="0"}return a}const dj={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:t=>t.slice(-3).toLowerCase()==="nan"?NaN:t[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:ds},uj={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:\.[0-9]+|[0-9]+(?:\.[0-9]*)?)[eE][-+]?[0-9]+$/,resolve:t=>parseFloat(t),stringify(t){const s=Number(t.value);return isFinite(s)?s.toExponential():ds(t)}},mj={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:\.[0-9]+|[0-9]+\.[0-9]*)$/,resolve(t){const s=new ie(parseFloat(t)),n=t.indexOf(".");return n!==-1&&t[t.length-1]==="0"&&(s.minFractionDigits=t.length-n-1),s},stringify:ds},Ro=t=>typeof t=="bigint"||Number.isInteger(t),Ad=(t,s,n,{intAsBigInt:r})=>r?BigInt(t):parseInt(t.substring(s),n);function hj(t,s,n){const{value:r}=t;return Ro(r)&&r>=0?n+r.toString(s):ds(t)}const pj={identify:t=>Ro(t)&&t>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^0o[0-7]+$/,resolve:(t,s,n)=>Ad(t,2,8,n),stringify:t=>hj(t,8,"0o")},fj={identify:Ro,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9]+$/,resolve:(t,s,n)=>Ad(t,0,10,n),stringify:ds},xj={identify:t=>Ro(t)&&t>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^0x[0-9a-fA-F]+$/,resolve:(t,s,n)=>Ad(t,2,16,n),stringify:t=>hj(t,16,"0x")},dA=[Br,Vr,Lo,Oo,_d,pj,fj,xj,dj,uj,mj];function nh(t){return typeof t=="bigint"||Number.isInteger(t)}const ya=({value:t})=>JSON.stringify(t),uA=[{identify:t=>typeof t=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:t=>t,stringify:ya},{identify:t=>t==null,createNode:()=>new ie(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^null$/,resolve:()=>null,stringify:ya},{identify:t=>typeof t=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^true$|^false$/,resolve:t=>t==="true",stringify:ya},{identify:nh,default:!0,tag:"tag:yaml.org,2002:int",test:/^-?(?:0|[1-9][0-9]*)$/,resolve:(t,s,{intAsBigInt:n})=>n?BigInt(t):parseInt(t,10),stringify:({value:t})=>nh(t)?t.toString():JSON.stringify(t)},{identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^-?(?:0|[1-9][0-9]*)(?:\.[0-9]*)?(?:[eE][-+]?[0-9]+)?$/,resolve:t=>parseFloat(t),stringify:ya}],mA={default:!0,tag:"",test:/^/,resolve(t,s){return s(`Unresolved plain scalar ${JSON.stringify(t)}`),t}},hA=[Br,Vr].concat(uA,mA),Dd={identify:t=>t instanceof Uint8Array,default:!1,tag:"tag:yaml.org,2002:binary",resolve(t,s){if(typeof atob=="function"){const n=atob(t.replace(/[\n\r]/g,"")),r=new Uint8Array(n.length);for(let i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}else return s("This environment does not support reading binary tags; either Buffer or atob is required"),t},stringify({comment:t,type:s,value:n},r,i,a){if(!n)return"";const o=n;let l;if(typeof btoa=="function"){let c="";for(let d=0;d<o.length;++d)c+=String.fromCharCode(o[d]);l=btoa(c)}else throw new Error("This environment does not support writing binary tags; either Buffer or btoa is required");if(s??(s=ie.BLOCK_LITERAL),s!==ie.QUOTE_DOUBLE){const c=Math.max(r.options.lineWidth-r.indent.length,r.options.minContentWidth),d=Math.ceil(l.length/c),m=new Array(d);for(let u=0,h=0;u<d;++u,h+=c)m[u]=l.substr(h,c);l=m.join(s===ie.BLOCK_LITERAL?`
`:" ")}return ra({comment:t,type:s,value:l},r,i,a)}};function gj(t,s){if(Ur(t))for(let n=0;n<t.items.length;++n){let r=t.items[n];if(!De(r)){if(Fr(r)){r.items.length>1&&s("Each pair must have its own sequence indicator");const i=r.items[0]||new ct(new ie(null));if(r.commentBefore&&(i.key.commentBefore=i.key.commentBefore?`${r.commentBefore}
${i.key.commentBefore}`:r.commentBefore),r.comment){const a=i.value??i.key;a.comment=a.comment?`${r.comment}
${a.comment}`:r.comment}r=i}t.items[n]=De(r)?r:new ct(r)}}else s("Expected a sequence for this tag");return t}function jj(t,s,n){const{replacer:r}=n,i=new an(t);i.tag="tag:yaml.org,2002:pairs";let a=0;if(s&&Symbol.iterator in Object(s))for(let o of s){typeof r=="function"&&(o=r.call(s,String(a++),o));let l,c;if(Array.isArray(o))if(o.length===2)l=o[0],c=o[1];else throw new TypeError(`Expected [key, value] tuple: ${o}`);else if(o&&o instanceof Object){const d=Object.keys(o);if(d.length===1)l=d[0],c=o[l];else throw new TypeError(`Expected tuple with one key, not ${d.length} keys`)}else l=o;i.items.push(Td(l,c,n))}return i}const Pd={collection:"seq",default:!1,tag:"tag:yaml.org,2002:pairs",resolve:gj,createNode:jj};class ur extends an{constructor(){super(),this.add=Et.prototype.add.bind(this),this.delete=Et.prototype.delete.bind(this),this.get=Et.prototype.get.bind(this),this.has=Et.prototype.has.bind(this),this.set=Et.prototype.set.bind(this),this.tag=ur.tag}toJSON(s,n){if(!n)return super.toJSON(s);const r=new Map;n?.onCreate&&n.onCreate(r);for(const i of this.items){let a,o;if(De(i)?(a=Yt(i.key,"",n),o=Yt(i.value,a,n)):a=Yt(i,"",n),r.has(a))throw new Error("Ordered maps must not include duplicate keys");r.set(a,o)}return r}static from(s,n,r){const i=jj(s,n,r),a=new this;return a.items=i.items,a}}ur.tag="tag:yaml.org,2002:omap";const Md={collection:"seq",identify:t=>t instanceof Map,nodeClass:ur,default:!1,tag:"tag:yaml.org,2002:omap",resolve(t,s){const n=gj(t,s),r=[];for(const{key:i}of n.items)Ne(i)&&(r.includes(i.value)?s(`Ordered maps must not include duplicate keys: ${i.value}`):r.push(i.value));return Object.assign(new ur,n)},createNode:(t,s,n)=>ur.from(t,s,n)};function yj({value:t,source:s},n){return s&&(t?bj:wj).test.test(s)?s:t?n.options.trueStr:n.options.falseStr}const bj={identify:t=>t===!0,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:Y|y|[Yy]es|YES|[Tt]rue|TRUE|[Oo]n|ON)$/,resolve:()=>new ie(!0),stringify:yj},wj={identify:t=>t===!1,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:N|n|[Nn]o|NO|[Ff]alse|FALSE|[Oo]ff|OFF)$/,resolve:()=>new ie(!1),stringify:yj},pA={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:t=>t.slice(-3).toLowerCase()==="nan"?NaN:t[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:ds},fA={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:[0-9][0-9_]*)?(?:\.[0-9_]*)?[eE][-+]?[0-9]+$/,resolve:t=>parseFloat(t.replace(/_/g,"")),stringify(t){const s=Number(t.value);return isFinite(s)?s.toExponential():ds(t)}},xA={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:[0-9][0-9_]*)?\.[0-9_]*$/,resolve(t){const s=new ie(parseFloat(t.replace(/_/g,""))),n=t.indexOf(".");if(n!==-1){const r=t.substring(n+1).replace(/_/g,"");r[r.length-1]==="0"&&(s.minFractionDigits=r.length)}return s},stringify:ds},ia=t=>typeof t=="bigint"||Number.isInteger(t);function $o(t,s,n,{intAsBigInt:r}){const i=t[0];if((i==="-"||i==="+")&&(s+=1),t=t.substring(s).replace(/_/g,""),r){switch(n){case 2:t=`0b${t}`;break;case 8:t=`0o${t}`;break;case 16:t=`0x${t}`;break}const o=BigInt(t);return i==="-"?BigInt(-1)*o:o}const a=parseInt(t,n);return i==="-"?-1*a:a}function Id(t,s,n){const{value:r}=t;if(ia(r)){const i=r.toString(s);return r<0?"-"+n+i.substr(1):n+i}return ds(t)}const gA={identify:ia,default:!0,tag:"tag:yaml.org,2002:int",format:"BIN",test:/^[-+]?0b[0-1_]+$/,resolve:(t,s,n)=>$o(t,2,2,n),stringify:t=>Id(t,2,"0b")},jA={identify:ia,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^[-+]?0[0-7_]+$/,resolve:(t,s,n)=>$o(t,1,8,n),stringify:t=>Id(t,8,"0")},yA={identify:ia,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9][0-9_]*$/,resolve:(t,s,n)=>$o(t,0,10,n),stringify:ds},bA={identify:ia,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^[-+]?0x[0-9a-fA-F_]+$/,resolve:(t,s,n)=>$o(t,2,16,n),stringify:t=>Id(t,16,"0x")};class mr extends Et{constructor(s){super(s),this.tag=mr.tag}add(s){let n;De(s)?n=s:s&&typeof s=="object"&&"key"in s&&"value"in s&&s.value===null?n=new ct(s.key,null):n=new ct(s,null),bn(this.items,n.key)||this.items.push(n)}get(s,n){const r=bn(this.items,s);return!n&&De(r)?Ne(r.key)?r.key.value:r.key:r}set(s,n){if(typeof n!="boolean")throw new Error(`Expected boolean value for set(key, value) in a YAML set, not ${typeof n}`);const r=bn(this.items,s);r&&!n?this.items.splice(this.items.indexOf(r),1):!r&&n&&this.items.push(new ct(s))}toJSON(s,n){return super.toJSON(s,n,Set)}toString(s,n,r){if(!s)return JSON.stringify(this);if(this.hasAllNullValues(!0))return super.toString(Object.assign({},s,{allNullValues:!0}),n,r);throw new Error("Set items must all have null values")}static from(s,n,r){const{replacer:i}=r,a=new this(s);if(n&&Symbol.iterator in Object(n))for(let o of n)typeof i=="function"&&(o=i.call(n,o,o)),a.items.push(Td(o,null,r));return a}}mr.tag="tag:yaml.org,2002:set";const Ed={collection:"map",identify:t=>t instanceof Set,nodeClass:mr,default:!1,tag:"tag:yaml.org,2002:set",createNode:(t,s,n)=>mr.from(t,s,n),resolve(t,s){if(Fr(t)){if(t.hasAllNullValues(!0))return Object.assign(new mr,t);s("Set items must all have null values")}else s("Expected a mapping for this tag");return t}};function Ld(t,s){const n=t[0],r=n==="-"||n==="+"?t.substring(1):t,i=o=>s?BigInt(o):Number(o),a=r.replace(/_/g,"").split(":").reduce((o,l)=>o*i(60)+i(l),i(0));return n==="-"?i(-1)*a:a}function vj(t){let{value:s}=t,n=o=>o;if(typeof s=="bigint")n=o=>BigInt(o);else if(isNaN(s)||!isFinite(s))return ds(t);let r="";s<0&&(r="-",s*=n(-1));const i=n(60),a=[s%i];return s<60?a.unshift(0):(s=(s-a[0])/i,a.unshift(s%i),s>=60&&(s=(s-a[0])/i,a.unshift(s))),r+a.map(o=>String(o).padStart(2,"0")).join(":").replace(/000000\d*$/,"")}const Nj={identify:t=>typeof t=="bigint"||Number.isInteger(t),default:!0,tag:"tag:yaml.org,2002:int",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+$/,resolve:(t,s,{intAsBigInt:n})=>Ld(t,n),stringify:vj},kj={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\.[0-9_]*$/,resolve:t=>Ld(t,!1),stringify:vj},qo={identify:t=>t instanceof Date,default:!0,tag:"tag:yaml.org,2002:timestamp",test:RegExp("^([0-9]{4})-([0-9]{1,2})-([0-9]{1,2})(?:(?:t|T|[ \\t]+)([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2}(\\.[0-9]+)?)(?:[ \\t]*(Z|[-+][012]?[0-9](?::[0-9]{2})?))?)?$"),resolve(t){const s=t.match(qo.test);if(!s)throw new Error("!!timestamp expects a date, starting with yyyy-mm-dd");const[,n,r,i,a,o,l]=s.map(Number),c=s[7]?Number((s[7]+"00").substr(1,3)):0;let d=Date.UTC(n,r-1,i,a||0,o||0,l||0,c);const m=s[8];if(m&&m!=="Z"){let u=Ld(m,!1);Math.abs(u)<30&&(u*=60),d-=6e4*u}return new Date(d)},stringify:({value:t})=>t?.toISOString().replace(/(T00:00:00)?\.000Z$/,"")??""},rh=[Br,Vr,Lo,Oo,bj,wj,gA,jA,yA,bA,pA,fA,xA,Dd,Es,Md,Pd,Ed,Nj,kj,qo],ih=new Map([["core",dA],["failsafe",[Br,Vr,Lo]],["json",hA],["yaml11",rh],["yaml-1.1",rh]]),ah={binary:Dd,bool:_d,float:mj,floatExp:uj,floatNaN:dj,floatTime:kj,int:fj,intHex:xj,intOct:pj,intTime:Nj,map:Br,merge:Es,null:Oo,omap:Md,pairs:Pd,seq:Vr,set:Ed,timestamp:qo},wA={"tag:yaml.org,2002:binary":Dd,"tag:yaml.org,2002:merge":Es,"tag:yaml.org,2002:omap":Md,"tag:yaml.org,2002:pairs":Pd,"tag:yaml.org,2002:set":Ed,"tag:yaml.org,2002:timestamp":qo};function vl(t,s,n){const r=ih.get(s);if(r&&!t)return n&&!r.includes(Es)?r.concat(Es):r.slice();let i=r;if(!i)if(Array.isArray(t))i=[];else{const a=Array.from(ih.keys()).filter(o=>o!=="yaml11").map(o=>JSON.stringify(o)).join(", ");throw new Error(`Unknown schema "${s}"; use one of ${a} or define customTags array`)}if(Array.isArray(t))for(const a of t)i=i.concat(a);else typeof t=="function"&&(i=t(i.slice()));return n&&(i=i.concat(Es)),i.reduce((a,o)=>{const l=typeof o=="string"?ah[o]:o;if(!l){const c=JSON.stringify(o),d=Object.keys(ah).map(m=>JSON.stringify(m)).join(", ");throw new Error(`Unknown custom tag ${c}; use one of ${d}`)}return a.includes(l)||a.push(l),a},[])}const vA=(t,s)=>t.key<s.key?-1:t.key>s.key?1:0;class Fo{constructor({compat:s,customTags:n,merge:r,resolveKnownTags:i,schema:a,sortMapEntries:o,toStringDefaults:l}){this.compat=Array.isArray(s)?vl(s,"compat"):s?vl(null,s):null,this.name=typeof a=="string"&&a||"core",this.knownTags=i?wA:{},this.tags=vl(n,this.name,r),this.toStringOptions=l??null,Object.defineProperty(this,en,{value:Br}),Object.defineProperty(this,Ns,{value:Lo}),Object.defineProperty(this,qr,{value:Vr}),this.sortMapEntries=typeof o=="function"?o:o===!0?vA:null}clone(){const s=Object.create(Fo.prototype,Object.getOwnPropertyDescriptors(this));return s.tags=this.tags.slice(),s}}function NA(t,s){const n=[];let r=s.directives===!0;if(s.directives!==!1&&t.directives){const c=t.directives.toString(t);c?(n.push(c),r=!0):t.directives.docStart&&(r=!0)}r&&n.push("---");const i=ij(t,s),{commentString:a}=i.options;if(t.commentBefore){n.length!==1&&n.unshift("");const c=a(t.commentBefore);n.unshift(Is(c,""))}let o=!1,l=null;if(t.contents){if(Ee(t.contents)){if(t.contents.spaceBefore&&r&&n.push(""),t.contents.commentBefore){const m=a(t.contents.commentBefore);n.push(Is(m,""))}i.forceBlockIndent=!!t.comment,l=t.contents.comment}const c=l?void 0:()=>o=!0;let d=kr(t.contents,i,()=>l=null,c);l&&(d+=yn(d,"",a(l))),(d[0]==="|"||d[0]===">")&&n[n.length-1]==="---"?n[n.length-1]=`--- ${d}`:n.push(d)}else n.push(kr(t.contents,i));if(t.directives?.docEnd)if(t.comment){const c=a(t.comment);c.includes(`
`)?(n.push("..."),n.push(Is(c,""))):n.push(`... ${c}`)}else n.push("...");else{let c=t.comment;c&&o&&(c=c.replace(/^\n+/,"")),c&&((!o||l)&&n[n.length-1]!==""&&n.push(""),n.push(Is(a(c),"")))}return n.join(`
`)+`
`}class Wr{constructor(s,n,r){this.commentBefore=null,this.comment=null,this.errors=[],this.warnings=[],Object.defineProperty(this,Jt,{value:oc});let i=null;typeof n=="function"||Array.isArray(n)?i=n:r===void 0&&n&&(r=n,n=void 0);const a=Object.assign({intAsBigInt:!1,keepSourceTokens:!1,logLevel:"warn",prettyErrors:!0,strict:!0,stringKeys:!1,uniqueKeys:!0,version:"1.2"},r);this.options=a;let{version:o}=a;r?._directives?(this.directives=r._directives.atDocument(),this.directives.yaml.explicit&&(o=this.directives.yaml.version)):this.directives=new ht({version:o}),this.setSchema(o,r),this.contents=s===void 0?null:this.createNode(s,i,r)}clone(){const s=Object.create(Wr.prototype,{[Jt]:{value:oc}});return s.commentBefore=this.commentBefore,s.comment=this.comment,s.errors=this.errors.slice(),s.warnings=this.warnings.slice(),s.options=Object.assign({},this.options),this.directives&&(s.directives=this.directives.clone()),s.schema=this.schema.clone(),s.contents=Ee(this.contents)?this.contents.clone(s.schema):this.contents,this.range&&(s.range=this.range.slice()),s}add(s){Hn(this.contents)&&this.contents.add(s)}addIn(s,n){Hn(this.contents)&&this.contents.addIn(s,n)}createAlias(s,n){if(!s.anchor){const r=ej(this);s.anchor=!n||r.has(n)?tj(n||"a",r):n}return new Po(s.anchor)}createNode(s,n,r){let i;if(typeof n=="function")s=n.call({"":s},"",s),i=n;else if(Array.isArray(n)){const y=j=>typeof j=="number"||j instanceof String||j instanceof Number,w=n.filter(y).map(String);w.length>0&&(n=n.concat(w)),i=n}else r===void 0&&n&&(r=n,n=void 0);const{aliasDuplicateObjects:a,anchorPrefix:o,flow:l,keepUndefined:c,onTagObj:d,tag:m}=r??{},{onAnchor:u,setAnchors:h,sourceObjects:p}=Y_(this,o||"a"),b={aliasDuplicateObjects:a??!0,keepUndefined:c??!1,onAnchor:u,onTagObj:d,replacer:i,schema:this.schema,sourceObjects:p},f=Pi(s,m,b);return l&&Me(f)&&(f.flow=!0),h(),f}createPair(s,n,r={}){const i=this.createNode(s,null,r),a=this.createNode(n,null,r);return new ct(i,a)}delete(s){return Hn(this.contents)?this.contents.delete(s):!1}deleteIn(s){return ii(s)?this.contents==null?!1:(this.contents=null,!0):Hn(this.contents)?this.contents.deleteIn(s):!1}get(s,n){return Me(this.contents)?this.contents.get(s,n):void 0}getIn(s,n){return ii(s)?!n&&Ne(this.contents)?this.contents.value:this.contents:Me(this.contents)?this.contents.getIn(s,n):void 0}has(s){return Me(this.contents)?this.contents.has(s):!1}hasIn(s){return ii(s)?this.contents!==void 0:Me(this.contents)?this.contents.hasIn(s):!1}set(s,n){this.contents==null?this.contents=Za(this.schema,[s],n):Hn(this.contents)&&this.contents.set(s,n)}setIn(s,n){ii(s)?this.contents=n:this.contents==null?this.contents=Za(this.schema,Array.from(s),n):Hn(this.contents)&&this.contents.setIn(s,n)}setSchema(s,n={}){typeof s=="number"&&(s=String(s));let r;switch(s){case"1.1":this.directives?this.directives.yaml.version="1.1":this.directives=new ht({version:"1.1"}),r={resolveKnownTags:!1,schema:"yaml-1.1"};break;case"1.2":case"next":this.directives?this.directives.yaml.version=s:this.directives=new ht({version:s}),r={resolveKnownTags:!0,schema:"core"};break;case null:this.directives&&delete this.directives,r=null;break;default:{const i=JSON.stringify(s);throw new Error(`Expected '1.1', '1.2' or null as first argument, but found: ${i}`)}}if(n.schema instanceof Object)this.schema=n.schema;else if(r)this.schema=new Fo(Object.assign(r,n));else throw new Error("With a null YAML version, the { schema: Schema } option is required")}toJS({json:s,jsonArg:n,mapAsMap:r,maxAliasCount:i,onAnchor:a,reviver:o}={}){const l={anchors:new Map,doc:this,keep:!s,mapAsMap:r===!0,mapKeyWarned:!1,maxAliasCount:typeof i=="number"?i:100},c=Yt(this.contents,n??"",l);if(typeof a=="function")for(const{count:d,res:m}of l.anchors.values())a(m,d);return typeof o=="function"?ar(o,{"":c},"",c):c}toJSON(s,n){return this.toJS({json:!0,jsonArg:s,mapAsMap:!1,onAnchor:n})}toString(s={}){if(this.errors.length>0)throw new Error("Document with errors cannot be stringified");if("indent"in s&&(!Number.isInteger(s.indent)||Number(s.indent)<=0)){const n=JSON.stringify(s.indent);throw new Error(`"indent" option must be a positive integer, not ${n}`)}return NA(this,s)}}function Hn(t){if(Me(t))return!0;throw new Error("Expected a YAML collection as document contents")}class Od extends Error{constructor(s,n,r,i){super(),this.name=s,this.code=r,this.message=i,this.pos=n}}class wn extends Od{constructor(s,n,r){super("YAMLParseError",s,n,r)}}class zj extends Od{constructor(s,n,r){super("YAMLWarning",s,n,r)}}const Ja=(t,s)=>n=>{if(n.pos[0]===-1)return;n.linePos=n.pos.map(l=>s.linePos(l));const{line:r,col:i}=n.linePos[0];n.message+=` at line ${r}, column ${i}`;let a=i-1,o=t.substring(s.lineStarts[r-1],s.lineStarts[r]).replace(/[\n\r]+$/,"");if(a>=60&&o.length>80){const l=Math.min(a-39,o.length-79);o=""+o.substring(l),a-=l-1}if(o.length>80&&(o=o.substring(0,79)+""),r>1&&/^ *$/.test(o.substring(0,a))){let l=t.substring(s.lineStarts[r-2],s.lineStarts[r-1]);l.length>80&&(l=l.substring(0,79)+`
`),o=l+o}if(/[^ ]/.test(o)){let l=1;const c=n.linePos[1];c&&c.line===r&&c.col>i&&(l=Math.max(1,Math.min(c.col-i,80-a)));const d=" ".repeat(a)+"^".repeat(l);n.message+=`:

${o}
${d}
`}};function zr(t,{flow:s,indicator:n,next:r,offset:i,onError:a,parentIndent:o,startOnNewline:l}){let c=!1,d=l,m=l,u="",h="",p=!1,b=!1,f=null,y=null,w=null,j=null,v=null,T=null,z=null;for(const S of t)switch(b&&(S.type!=="space"&&S.type!=="newline"&&S.type!=="comma"&&a(S.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),b=!1),f&&(d&&S.type!=="comment"&&S.type!=="newline"&&a(f,"TAB_AS_INDENT","Tabs are not allowed as indentation"),f=null),S.type){case"space":!s&&(n!=="doc-start"||r?.type!=="flow-collection")&&S.source.includes("	")&&(f=S),m=!0;break;case"comment":{m||a(S,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");const _=S.source.substring(1)||" ";u?u+=h+_:u=_,h="",d=!1;break}case"newline":d?u?u+=S.source:(!T||n!=="seq-item-ind")&&(c=!0):h+=S.source,d=!0,p=!0,(y||w)&&(j=S),m=!0;break;case"anchor":y&&a(S,"MULTIPLE_ANCHORS","A node can have at most one anchor"),S.source.endsWith(":")&&a(S.offset+S.source.length-1,"BAD_ALIAS","Anchor ending in : is ambiguous",!0),y=S,z??(z=S.offset),d=!1,m=!1,b=!0;break;case"tag":{w&&a(S,"MULTIPLE_TAGS","A node can have at most one tag"),w=S,z??(z=S.offset),d=!1,m=!1,b=!0;break}case n:(y||w)&&a(S,"BAD_PROP_ORDER",`Anchors and tags must be after the ${S.source} indicator`),T&&a(S,"UNEXPECTED_TOKEN",`Unexpected ${S.source} in ${s??"collection"}`),T=S,d=n==="seq-item-ind"||n==="explicit-key-ind",m=!1;break;case"comma":if(s){v&&a(S,"UNEXPECTED_TOKEN",`Unexpected , in ${s}`),v=S,d=!1,m=!1;break}default:a(S,"UNEXPECTED_TOKEN",`Unexpected ${S.type} token`),d=!1,m=!1}const k=t[t.length-1],N=k?k.offset+k.source.length:i;return b&&r&&r.type!=="space"&&r.type!=="newline"&&r.type!=="comma"&&(r.type!=="scalar"||r.source!=="")&&a(r.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),f&&(d&&f.indent<=o||r?.type==="block-map"||r?.type==="block-seq")&&a(f,"TAB_AS_INDENT","Tabs are not allowed as indentation"),{comma:v,found:T,spaceBefore:c,comment:u,hasNewline:p,anchor:y,tag:w,newlineAfterProp:j,end:N,start:z??N}}function Mi(t){if(!t)return null;switch(t.type){case"alias":case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":if(t.source.includes(`
`))return!0;if(t.end){for(const s of t.end)if(s.type==="newline")return!0}return!1;case"flow-collection":for(const s of t.items){for(const n of s.start)if(n.type==="newline")return!0;if(s.sep){for(const n of s.sep)if(n.type==="newline")return!0}if(Mi(s.key)||Mi(s.value))return!0}return!1;default:return!0}}function uc(t,s,n){if(s?.type==="flow-collection"){const r=s.end[0];r.indent===t&&(r.source==="]"||r.source==="}")&&Mi(s)&&n(r,"BAD_INDENT","Flow end indicator should be more indented than parent",!0)}}function Sj(t,s,n){const{uniqueKeys:r}=t.options;if(r===!1)return!1;const i=typeof r=="function"?r:(a,o)=>a===o||Ne(a)&&Ne(o)&&a.value===o.value;return s.some(a=>i(a.key,n))}const oh="All mapping items must start at the same column";function kA({composeNode:t,composeEmptyNode:s},n,r,i,a){const o=a?.nodeClass??Et,l=new o(n.schema);n.atRoot&&(n.atRoot=!1);let c=r.offset,d=null;for(const m of r.items){const{start:u,key:h,sep:p,value:b}=m,f=zr(u,{indicator:"explicit-key-ind",next:h??p?.[0],offset:c,onError:i,parentIndent:r.indent,startOnNewline:!0}),y=!f.found;if(y){if(h&&(h.type==="block-seq"?i(c,"BLOCK_AS_IMPLICIT_KEY","A block sequence may not be used as an implicit map key"):"indent"in h&&h.indent!==r.indent&&i(c,"BAD_INDENT",oh)),!f.anchor&&!f.tag&&!p){d=f.end,f.comment&&(l.comment?l.comment+=`
`+f.comment:l.comment=f.comment);continue}(f.newlineAfterProp||Mi(h))&&i(h??u[u.length-1],"MULTILINE_IMPLICIT_KEY","Implicit keys need to be on a single line")}else f.found?.indent!==r.indent&&i(c,"BAD_INDENT",oh);n.atKey=!0;const w=f.end,j=h?t(n,h,f,i):s(n,w,u,null,f,i);n.schema.compat&&uc(r.indent,h,i),n.atKey=!1,Sj(n,l.items,j)&&i(w,"DUPLICATE_KEY","Map keys must be unique");const v=zr(p??[],{indicator:"map-value-ind",next:b,offset:j.range[2],onError:i,parentIndent:r.indent,startOnNewline:!h||h.type==="block-scalar"});if(c=v.end,v.found){y&&(b?.type==="block-map"&&!v.hasNewline&&i(c,"BLOCK_AS_IMPLICIT_KEY","Nested mappings are not allowed in compact mappings"),n.options.strict&&f.start<v.found.offset-1024&&i(j.range,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit block mapping key"));const T=b?t(n,b,v,i):s(n,c,p,null,v,i);n.schema.compat&&uc(r.indent,b,i),c=T.range[2];const z=new ct(j,T);n.options.keepSourceTokens&&(z.srcToken=m),l.items.push(z)}else{y&&i(j.range,"MISSING_CHAR","Implicit map keys need to be followed by map values"),v.comment&&(j.comment?j.comment+=`
`+v.comment:j.comment=v.comment);const T=new ct(j);n.options.keepSourceTokens&&(T.srcToken=m),l.items.push(T)}}return d&&d<c&&i(d,"IMPOSSIBLE","Map comment with trailing content"),l.range=[r.offset,c,d??c],l}function zA({composeNode:t,composeEmptyNode:s},n,r,i,a){const o=a?.nodeClass??an,l=new o(n.schema);n.atRoot&&(n.atRoot=!1),n.atKey&&(n.atKey=!1);let c=r.offset,d=null;for(const{start:m,value:u}of r.items){const h=zr(m,{indicator:"seq-item-ind",next:u,offset:c,onError:i,parentIndent:r.indent,startOnNewline:!0});if(!h.found)if(h.anchor||h.tag||u)u&&u.type==="block-seq"?i(h.end,"BAD_INDENT","All sequence items must start at the same column"):i(c,"MISSING_CHAR","Sequence item without - indicator");else{d=h.end,h.comment&&(l.comment=h.comment);continue}const p=u?t(n,u,h,i):s(n,h.end,m,null,h,i);n.schema.compat&&uc(r.indent,u,i),c=p.range[2],l.items.push(p)}return l.range=[r.offset,c,d??c],l}function aa(t,s,n,r){let i="";if(t){let a=!1,o="";for(const l of t){const{source:c,type:d}=l;switch(d){case"space":a=!0;break;case"comment":{n&&!a&&r(l,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");const m=c.substring(1)||" ";i?i+=o+m:i=m,o="";break}case"newline":i&&(o+=c),a=!0;break;default:r(l,"UNEXPECTED_TOKEN",`Unexpected ${d} at node end`)}s+=c.length}}return{comment:i,offset:s}}const Nl="Block collections are not allowed within flow collections",kl=t=>t&&(t.type==="block-map"||t.type==="block-seq");function SA({composeNode:t,composeEmptyNode:s},n,r,i,a){const o=r.start.source==="{",l=o?"flow map":"flow sequence",c=a?.nodeClass??(o?Et:an),d=new c(n.schema);d.flow=!0;const m=n.atRoot;m&&(n.atRoot=!1),n.atKey&&(n.atKey=!1);let u=r.offset+r.start.source.length;for(let y=0;y<r.items.length;++y){const w=r.items[y],{start:j,key:v,sep:T,value:z}=w,k=zr(j,{flow:l,indicator:"explicit-key-ind",next:v??T?.[0],offset:u,onError:i,parentIndent:r.indent,startOnNewline:!1});if(!k.found){if(!k.anchor&&!k.tag&&!T&&!z){y===0&&k.comma?i(k.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${l}`):y<r.items.length-1&&i(k.start,"UNEXPECTED_TOKEN",`Unexpected empty item in ${l}`),k.comment&&(d.comment?d.comment+=`
`+k.comment:d.comment=k.comment),u=k.end;continue}!o&&n.options.strict&&Mi(v)&&i(v,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line")}if(y===0)k.comma&&i(k.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${l}`);else if(k.comma||i(k.start,"MISSING_CHAR",`Missing , between ${l} items`),k.comment){let N="";e:for(const S of j)switch(S.type){case"comma":case"space":break;case"comment":N=S.source.substring(1);break e;default:break e}if(N){let S=d.items[d.items.length-1];De(S)&&(S=S.value??S.key),S.comment?S.comment+=`
`+N:S.comment=N,k.comment=k.comment.substring(N.length+1)}}if(!o&&!T&&!k.found){const N=z?t(n,z,k,i):s(n,k.end,T,null,k,i);d.items.push(N),u=N.range[2],kl(z)&&i(N.range,"BLOCK_IN_FLOW",Nl)}else{n.atKey=!0;const N=k.end,S=v?t(n,v,k,i):s(n,N,j,null,k,i);kl(v)&&i(S.range,"BLOCK_IN_FLOW",Nl),n.atKey=!1;const _=zr(T??[],{flow:l,indicator:"map-value-ind",next:z,offset:S.range[2],onError:i,parentIndent:r.indent,startOnNewline:!1});if(_.found){if(!o&&!k.found&&n.options.strict){if(T)for(const A of T){if(A===_.found)break;if(A.type==="newline"){i(A,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line");break}}k.start<_.found.offset-1024&&i(_.found,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit flow sequence key")}}else z&&("source"in z&&z.source&&z.source[0]===":"?i(z,"MISSING_CHAR",`Missing space after : in ${l}`):i(_.start,"MISSING_CHAR",`Missing , or : between ${l} items`));const g=z?t(n,z,_,i):_.found?s(n,_.end,T,null,_,i):null;g?kl(z)&&i(g.range,"BLOCK_IN_FLOW",Nl):_.comment&&(S.comment?S.comment+=`
`+_.comment:S.comment=_.comment);const C=new ct(S,g);if(n.options.keepSourceTokens&&(C.srcToken=w),o){const A=d;Sj(n,A.items,S)&&i(N,"DUPLICATE_KEY","Map keys must be unique"),A.items.push(C)}else{const A=new Et(n.schema);A.flow=!0,A.items.push(C);const E=(g??S).range;A.range=[S.range[0],E[1],E[2]],d.items.push(A)}u=g?g.range[2]:_.end}}const h=o?"}":"]",[p,...b]=r.end;let f=u;if(p&&p.source===h)f=p.offset+p.source.length;else{const y=l[0].toUpperCase()+l.substring(1),w=m?`${y} must end with a ${h}`:`${y} in block collection must be sufficiently indented and end with a ${h}`;i(u,m?"MISSING_CHAR":"BAD_INDENT",w),p&&p.source.length!==1&&b.unshift(p)}if(b.length>0){const y=aa(b,f,n.options.strict,i);y.comment&&(d.comment?d.comment+=`
`+y.comment:d.comment=y.comment),d.range=[r.offset,f,y.offset]}else d.range=[r.offset,f,f];return d}function zl(t,s,n,r,i,a){const o=n.type==="block-map"?kA(t,s,n,r,a):n.type==="block-seq"?zA(t,s,n,r,a):SA(t,s,n,r,a),l=o.constructor;return i==="!"||i===l.tagName?(o.tag=l.tagName,o):(i&&(o.tag=i),o)}function CA(t,s,n,r,i){const a=r.tag,o=a?s.directives.tagName(a.source,h=>i(a,"TAG_RESOLVE_FAILED",h)):null;if(n.type==="block-seq"){const{anchor:h,newlineAfterProp:p}=r,b=h&&a?h.offset>a.offset?h:a:h??a;b&&(!p||p.offset<b.offset)&&i(b,"MISSING_CHAR","Missing newline after block sequence props")}const l=n.type==="block-map"?"map":n.type==="block-seq"?"seq":n.start.source==="{"?"map":"seq";if(!a||!o||o==="!"||o===Et.tagName&&l==="map"||o===an.tagName&&l==="seq")return zl(t,s,n,i,o);let c=s.schema.tags.find(h=>h.tag===o&&h.collection===l);if(!c){const h=s.schema.knownTags[o];if(h&&h.collection===l)s.schema.tags.push(Object.assign({},h,{default:!1})),c=h;else return h?i(a,"BAD_COLLECTION_TYPE",`${h.tag} used for ${l} collection, but expects ${h.collection??"scalar"}`,!0):i(a,"TAG_RESOLVE_FAILED",`Unresolved tag: ${o}`,!0),zl(t,s,n,i,o)}const d=zl(t,s,n,i,o,c),m=c.resolve?.(d,h=>i(a,"TAG_RESOLVE_FAILED",h),s.options)??d,u=Ee(m)?m:new ie(m);return u.range=d.range,u.tag=o,c?.format&&(u.format=c.format),u}function Cj(t,s,n){const r=s.offset,i=TA(s,t.options.strict,n);if(!i)return{value:"",type:null,comment:"",range:[r,r,r]};const a=i.mode===">"?ie.BLOCK_FOLDED:ie.BLOCK_LITERAL,o=s.source?_A(s.source):[];let l=o.length;for(let f=o.length-1;f>=0;--f){const y=o[f][1];if(y===""||y==="\r")l=f;else break}if(l===0){const f=i.chomp==="+"&&o.length>0?`
`.repeat(Math.max(1,o.length-1)):"";let y=r+i.length;return s.source&&(y+=s.source.length),{value:f,type:a,comment:i.comment,range:[r,y,y]}}let c=s.indent+i.indent,d=s.offset+i.length,m=0;for(let f=0;f<l;++f){const[y,w]=o[f];if(w===""||w==="\r")i.indent===0&&y.length>c&&(c=y.length);else{y.length<c&&n(d+y.length,"MISSING_CHAR","Block scalars with more-indented leading empty lines must use an explicit indentation indicator"),i.indent===0&&(c=y.length),m=f,c===0&&!t.atRoot&&n(d,"BAD_INDENT","Block scalar values in collections must be indented");break}d+=y.length+w.length+1}for(let f=o.length-1;f>=l;--f)o[f][0].length>c&&(l=f+1);let u="",h="",p=!1;for(let f=0;f<m;++f)u+=o[f][0].slice(c)+`
`;for(let f=m;f<l;++f){let[y,w]=o[f];d+=y.length+w.length+1;const j=w[w.length-1]==="\r";if(j&&(w=w.slice(0,-1)),w&&y.length<c){const T=`Block scalar lines must not be less indented than their ${i.indent?"explicit indentation indicator":"first line"}`;n(d-w.length-(j?2:1),"BAD_INDENT",T),y=""}a===ie.BLOCK_LITERAL?(u+=h+y.slice(c)+w,h=`
`):y.length>c||w[0]==="	"?(h===" "?h=`
`:!p&&h===`
`&&(h=`

`),u+=h+y.slice(c)+w,h=`
`,p=!0):w===""?h===`
`?u+=`
`:h=`
`:(u+=h+w,h=" ",p=!1)}switch(i.chomp){case"-":break;case"+":for(let f=l;f<o.length;++f)u+=`
`+o[f][0].slice(c);u[u.length-1]!==`
`&&(u+=`
`);break;default:u+=`
`}const b=r+i.length+s.source.length;return{value:u,type:a,comment:i.comment,range:[r,b,b]}}function TA({offset:t,props:s},n,r){if(s[0].type!=="block-scalar-header")return r(s[0],"IMPOSSIBLE","Block scalar header not found"),null;const{source:i}=s[0],a=i[0];let o=0,l="",c=-1;for(let h=1;h<i.length;++h){const p=i[h];if(!l&&(p==="-"||p==="+"))l=p;else{const b=Number(p);!o&&b?o=b:c===-1&&(c=t+h)}}c!==-1&&r(c,"UNEXPECTED_TOKEN",`Block scalar header includes extra characters: ${i}`);let d=!1,m="",u=i.length;for(let h=1;h<s.length;++h){const p=s[h];switch(p.type){case"space":d=!0;case"newline":u+=p.source.length;break;case"comment":n&&!d&&r(p,"MISSING_CHAR","Comments must be separated from other tokens by white space characters"),u+=p.source.length,m=p.source.substring(1);break;case"error":r(p,"UNEXPECTED_TOKEN",p.message),u+=p.source.length;break;default:{const b=`Unexpected token in block scalar header: ${p.type}`;r(p,"UNEXPECTED_TOKEN",b);const f=p.source;f&&typeof f=="string"&&(u+=f.length)}}}return{mode:a,indent:o,chomp:l,comment:m,length:u}}function _A(t){const s=t.split(/\n( *)/),n=s[0],r=n.match(/^( *)/),a=[r?.[1]?[r[1],n.slice(r[1].length)]:["",n]];for(let o=1;o<s.length;o+=2)a.push([s[o],s[o+1]]);return a}function Tj(t,s,n){const{offset:r,type:i,source:a,end:o}=t;let l,c;const d=(h,p,b)=>n(r+h,p,b);switch(i){case"scalar":l=ie.PLAIN,c=AA(a,d);break;case"single-quoted-scalar":l=ie.QUOTE_SINGLE,c=DA(a,d);break;case"double-quoted-scalar":l=ie.QUOTE_DOUBLE,c=PA(a,d);break;default:return n(t,"UNEXPECTED_TOKEN",`Expected a flow scalar value, but found: ${i}`),{value:"",type:null,comment:"",range:[r,r+a.length,r+a.length]}}const m=r+a.length,u=aa(o,m,s,n);return{value:c,type:l,comment:u.comment,range:[r,m,u.offset]}}function AA(t,s){let n="";switch(t[0]){case"	":n="a tab character";break;case",":n="flow indicator character ,";break;case"%":n="directive indicator character %";break;case"|":case">":{n=`block scalar indicator ${t[0]}`;break}case"@":case"`":{n=`reserved character ${t[0]}`;break}}return n&&s(0,"BAD_SCALAR_START",`Plain value cannot start with ${n}`),_j(t)}function DA(t,s){return(t[t.length-1]!=="'"||t.length===1)&&s(t.length,"MISSING_CHAR","Missing closing 'quote"),_j(t.slice(1,-1)).replace(/''/g,"'")}function _j(t){let s,n;try{s=new RegExp(`(.*?)(?<![ 	])[ 	]*\r?
`,"sy"),n=new RegExp(`[ 	]*(.*?)(?:(?<![ 	])[ 	]*)?\r?
`,"sy")}catch{s=/(.*?)[ \t]*\r?\n/sy,n=/[ \t]*(.*?)[ \t]*\r?\n/sy}let r=s.exec(t);if(!r)return t;let i=r[1],a=" ",o=s.lastIndex;for(n.lastIndex=o;r=n.exec(t);)r[1]===""?a===`
`?i+=a:a=`
`:(i+=a+r[1],a=" "),o=n.lastIndex;const l=/[ \t]*(.*)/sy;return l.lastIndex=o,r=l.exec(t),i+a+(r?.[1]??"")}function PA(t,s){let n="";for(let r=1;r<t.length-1;++r){const i=t[r];if(!(i==="\r"&&t[r+1]===`
`))if(i===`
`){const{fold:a,offset:o}=MA(t,r);n+=a,r=o}else if(i==="\\"){let a=t[++r];const o=IA[a];if(o)n+=o;else if(a===`
`)for(a=t[r+1];a===" "||a==="	";)a=t[++r+1];else if(a==="\r"&&t[r+1]===`
`)for(a=t[++r+1];a===" "||a==="	";)a=t[++r+1];else if(a==="x"||a==="u"||a==="U"){const l={x:2,u:4,U:8}[a];n+=EA(t,r+1,l,s),r+=l}else{const l=t.substr(r-1,2);s(r-1,"BAD_DQ_ESCAPE",`Invalid escape sequence ${l}`),n+=l}}else if(i===" "||i==="	"){const a=r;let o=t[r+1];for(;o===" "||o==="	";)o=t[++r+1];o!==`
`&&!(o==="\r"&&t[r+2]===`
`)&&(n+=r>a?t.slice(a,r+1):i)}else n+=i}return(t[t.length-1]!=='"'||t.length===1)&&s(t.length,"MISSING_CHAR",'Missing closing "quote'),n}function MA(t,s){let n="",r=t[s+1];for(;(r===" "||r==="	"||r===`
`||r==="\r")&&!(r==="\r"&&t[s+2]!==`
`);)r===`
`&&(n+=`
`),s+=1,r=t[s+1];return n||(n=" "),{fold:n,offset:s}}const IA={0:"\0",a:"\x07",b:"\b",e:"\x1B",f:"\f",n:`
`,r:"\r",t:"	",v:"\v",N:"",_:"",L:"\u2028",P:"\u2029"," ":" ",'"':'"',"/":"/","\\":"\\","	":"	"};function EA(t,s,n,r){const i=t.substr(s,n),o=i.length===n&&/^[0-9a-fA-F]+$/.test(i)?parseInt(i,16):NaN;if(isNaN(o)){const l=t.substr(s-2,n+2);return r(s-2,"BAD_DQ_ESCAPE",`Invalid escape sequence ${l}`),l}return String.fromCodePoint(o)}function Aj(t,s,n,r){const{value:i,type:a,comment:o,range:l}=s.type==="block-scalar"?Cj(t,s,r):Tj(s,t.options.strict,r),c=n?t.directives.tagName(n.source,u=>r(n,"TAG_RESOLVE_FAILED",u)):null;let d;t.options.stringKeys&&t.atKey?d=t.schema[Ns]:c?d=LA(t.schema,i,c,n,r):s.type==="scalar"?d=OA(t,i,s,r):d=t.schema[Ns];let m;try{const u=d.resolve(i,h=>r(n??s,"TAG_RESOLVE_FAILED",h),t.options);m=Ne(u)?u:new ie(u)}catch(u){const h=u instanceof Error?u.message:String(u);r(n??s,"TAG_RESOLVE_FAILED",h),m=new ie(i)}return m.range=l,m.source=i,a&&(m.type=a),c&&(m.tag=c),d.format&&(m.format=d.format),o&&(m.comment=o),m}function LA(t,s,n,r,i){if(n==="!")return t[Ns];const a=[];for(const l of t.tags)if(!l.collection&&l.tag===n)if(l.default&&l.test)a.push(l);else return l;for(const l of a)if(l.test?.test(s))return l;const o=t.knownTags[n];return o&&!o.collection?(t.tags.push(Object.assign({},o,{default:!1,test:void 0})),o):(i(r,"TAG_RESOLVE_FAILED",`Unresolved tag: ${n}`,n!=="tag:yaml.org,2002:str"),t[Ns])}function OA({atKey:t,directives:s,schema:n},r,i,a){const o=n.tags.find(l=>(l.default===!0||t&&l.default==="key")&&l.test?.test(r))||n[Ns];if(n.compat){const l=n.compat.find(c=>c.default&&c.test?.test(r))??n[Ns];if(o.tag!==l.tag){const c=s.tagString(o.tag),d=s.tagString(l.tag),m=`Value may be parsed as either ${c} or ${d}`;a(i,"TAG_RESOLVE_FAILED",m,!0)}}return o}function RA(t,s,n){if(s){n??(n=s.length);for(let r=n-1;r>=0;--r){let i=s[r];switch(i.type){case"space":case"comment":case"newline":t-=i.source.length;continue}for(i=s[++r];i?.type==="space";)t+=i.source.length,i=s[++r];break}}return t}const $A={composeNode:Dj,composeEmptyNode:Rd};function Dj(t,s,n,r){const i=t.atKey,{spaceBefore:a,comment:o,anchor:l,tag:c}=n;let d,m=!0;switch(s.type){case"alias":d=qA(t,s,r),(l||c)&&r(s,"ALIAS_PROPS","An alias node must not specify any properties");break;case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"block-scalar":d=Aj(t,s,c,r),l&&(d.anchor=l.source.substring(1));break;case"block-map":case"block-seq":case"flow-collection":d=CA($A,t,s,n,r),l&&(d.anchor=l.source.substring(1));break;default:{const u=s.type==="error"?s.message:`Unsupported token (type: ${s.type})`;r(s,"UNEXPECTED_TOKEN",u),d=Rd(t,s.offset,void 0,null,n,r),m=!1}}return l&&d.anchor===""&&r(l,"BAD_ALIAS","Anchor cannot be an empty string"),i&&t.options.stringKeys&&(!Ne(d)||typeof d.value!="string"||d.tag&&d.tag!=="tag:yaml.org,2002:str")&&r(c??s,"NON_STRING_KEY","With stringKeys, all keys must be strings"),a&&(d.spaceBefore=!0),o&&(s.type==="scalar"&&s.source===""?d.comment=o:d.commentBefore=o),t.options.keepSourceTokens&&m&&(d.srcToken=s),d}function Rd(t,s,n,r,{spaceBefore:i,comment:a,anchor:o,tag:l,end:c},d){const m={type:"scalar",offset:RA(s,n,r),indent:-1,source:""},u=Aj(t,m,l,d);return o&&(u.anchor=o.source.substring(1),u.anchor===""&&d(o,"BAD_ALIAS","Anchor cannot be an empty string")),i&&(u.spaceBefore=!0),a&&(u.comment=a,u.range[2]=c),u}function qA({options:t},{offset:s,source:n,end:r},i){const a=new Po(n.substring(1));a.source===""&&i(s,"BAD_ALIAS","Alias cannot be an empty string"),a.source.endsWith(":")&&i(s+n.length-1,"BAD_ALIAS","Alias ending in : is ambiguous",!0);const o=s+n.length,l=aa(r,o,t.strict,i);return a.range=[s,o,l.offset],l.comment&&(a.comment=l.comment),a}function FA(t,s,{offset:n,start:r,value:i,end:a},o){const l=Object.assign({_directives:s},t),c=new Wr(void 0,l),d={atKey:!1,atRoot:!0,directives:c.directives,options:c.options,schema:c.schema},m=zr(r,{indicator:"doc-start",next:i??a?.[0],offset:n,onError:o,parentIndent:0,startOnNewline:!0});m.found&&(c.directives.docStart=!0,i&&(i.type==="block-map"||i.type==="block-seq")&&!m.hasNewline&&o(m.end,"MISSING_CHAR","Block collection cannot start on same line with directives-end marker")),c.contents=i?Dj(d,i,m,o):Rd(d,m.end,r,null,m,o);const u=c.contents.range[2],h=aa(a,u,!1,o);return h.comment&&(c.comment=h.comment),c.range=[n,u,h.offset],c}function Xr(t){if(typeof t=="number")return[t,t+1];if(Array.isArray(t))return t.length===2?t:[t[0],t[1]];const{offset:s,source:n}=t;return[s,s+(typeof n=="string"?n.length:1)]}function lh(t){let s="",n=!1,r=!1;for(let i=0;i<t.length;++i){const a=t[i];switch(a[0]){case"#":s+=(s===""?"":r?`

`:`
`)+(a.substring(1)||" "),n=!0,r=!1;break;case"%":t[i+1]?.[0]!=="#"&&(i+=1),n=!1;break;default:n||(r=!0),n=!1}}return{comment:s,afterEmptyLine:r}}class $d{constructor(s={}){this.doc=null,this.atDirectives=!1,this.prelude=[],this.errors=[],this.warnings=[],this.onError=(n,r,i,a)=>{const o=Xr(n);a?this.warnings.push(new zj(o,r,i)):this.errors.push(new wn(o,r,i))},this.directives=new ht({version:s.version||"1.2"}),this.options=s}decorate(s,n){const{comment:r,afterEmptyLine:i}=lh(this.prelude);if(r){const a=s.contents;if(n)s.comment=s.comment?`${s.comment}
${r}`:r;else if(i||s.directives.docStart||!a)s.commentBefore=r;else if(Me(a)&&!a.flow&&a.items.length>0){let o=a.items[0];De(o)&&(o=o.key);const l=o.commentBefore;o.commentBefore=l?`${r}
${l}`:r}else{const o=a.commentBefore;a.commentBefore=o?`${r}
${o}`:r}}n?(Array.prototype.push.apply(s.errors,this.errors),Array.prototype.push.apply(s.warnings,this.warnings)):(s.errors=this.errors,s.warnings=this.warnings),this.prelude=[],this.errors=[],this.warnings=[]}streamInfo(){return{comment:lh(this.prelude).comment,directives:this.directives,errors:this.errors,warnings:this.warnings}}*compose(s,n=!1,r=-1){for(const i of s)yield*this.next(i);yield*this.end(n,r)}*next(s){switch(s.type){case"directive":this.directives.add(s.source,(n,r,i)=>{const a=Xr(s);a[0]+=n,this.onError(a,"BAD_DIRECTIVE",r,i)}),this.prelude.push(s.source),this.atDirectives=!0;break;case"document":{const n=FA(this.options,this.directives,s,this.onError);this.atDirectives&&!n.directives.docStart&&this.onError(s,"MISSING_CHAR","Missing directives-end/doc-start indicator line"),this.decorate(n,!1),this.doc&&(yield this.doc),this.doc=n,this.atDirectives=!1;break}case"byte-order-mark":case"space":break;case"comment":case"newline":this.prelude.push(s.source);break;case"error":{const n=s.source?`${s.message}: ${JSON.stringify(s.source)}`:s.message,r=new wn(Xr(s),"UNEXPECTED_TOKEN",n);this.atDirectives||!this.doc?this.errors.push(r):this.doc.errors.push(r);break}case"doc-end":{if(!this.doc){const r="Unexpected doc-end without preceding document";this.errors.push(new wn(Xr(s),"UNEXPECTED_TOKEN",r));break}this.doc.directives.docEnd=!0;const n=aa(s.end,s.offset+s.source.length,this.doc.options.strict,this.onError);if(this.decorate(this.doc,!0),n.comment){const r=this.doc.comment;this.doc.comment=r?`${r}
${n.comment}`:n.comment}this.doc.range[2]=n.offset;break}default:this.errors.push(new wn(Xr(s),"UNEXPECTED_TOKEN",`Unsupported token ${s.type}`))}}*end(s=!1,n=-1){if(this.doc)this.decorate(this.doc,!0),yield this.doc,this.doc=null;else if(s){const r=Object.assign({_directives:this.directives},this.options),i=new Wr(void 0,r);this.atDirectives&&this.onError(n,"MISSING_CHAR","Missing directives-end indicator line"),i.range=[0,n,n],this.decorate(i,!1),yield i}}}function UA(t,s=!0,n){if(t){const r=(i,a,o)=>{const l=typeof i=="number"?i:Array.isArray(i)?i[0]:i.offset;if(n)n(l,a,o);else throw new wn([l,l+1],a,o)};switch(t.type){case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return Tj(t,s,r);case"block-scalar":return Cj({options:{strict:s}},t,r)}}return null}function BA(t,s){const{implicitKey:n=!1,indent:r,inFlow:i=!1,offset:a=-1,type:o="PLAIN"}=s,l=ra({type:o,value:t},{implicitKey:n,indent:r>0?" ".repeat(r):"",inFlow:i,options:{blockQuote:!0,lineWidth:-1}}),c=s.end??[{type:"newline",offset:-1,indent:r,source:`
`}];switch(l[0]){case"|":case">":{const d=l.indexOf(`
`),m=l.substring(0,d),u=l.substring(d+1)+`
`,h=[{type:"block-scalar-header",offset:a,indent:r,source:m}];return Pj(h,c)||h.push({type:"newline",offset:-1,indent:r,source:`
`}),{type:"block-scalar",offset:a,indent:r,props:h,source:u}}case'"':return{type:"double-quoted-scalar",offset:a,indent:r,source:l,end:c};case"'":return{type:"single-quoted-scalar",offset:a,indent:r,source:l,end:c};default:return{type:"scalar",offset:a,indent:r,source:l,end:c}}}function VA(t,s,n={}){let{afterKey:r=!1,implicitKey:i=!1,inFlow:a=!1,type:o}=n,l="indent"in t?t.indent:null;if(r&&typeof l=="number"&&(l+=2),!o)switch(t.type){case"single-quoted-scalar":o="QUOTE_SINGLE";break;case"double-quoted-scalar":o="QUOTE_DOUBLE";break;case"block-scalar":{const d=t.props[0];if(d.type!=="block-scalar-header")throw new Error("Invalid block scalar header");o=d.source[0]===">"?"BLOCK_FOLDED":"BLOCK_LITERAL";break}default:o="PLAIN"}const c=ra({type:o,value:s},{implicitKey:i||l===null,indent:l!==null&&l>0?" ".repeat(l):"",inFlow:a,options:{blockQuote:!0,lineWidth:-1}});switch(c[0]){case"|":case">":WA(t,c);break;case'"':Sl(t,c,"double-quoted-scalar");break;case"'":Sl(t,c,"single-quoted-scalar");break;default:Sl(t,c,"scalar")}}function WA(t,s){const n=s.indexOf(`
`),r=s.substring(0,n),i=s.substring(n+1)+`
`;if(t.type==="block-scalar"){const a=t.props[0];if(a.type!=="block-scalar-header")throw new Error("Invalid block scalar header");a.source=r,t.source=i}else{const{offset:a}=t,o="indent"in t?t.indent:-1,l=[{type:"block-scalar-header",offset:a,indent:o,source:r}];Pj(l,"end"in t?t.end:void 0)||l.push({type:"newline",offset:-1,indent:o,source:`
`});for(const c of Object.keys(t))c!=="type"&&c!=="offset"&&delete t[c];Object.assign(t,{type:"block-scalar",indent:o,props:l,source:i})}}function Pj(t,s){if(s)for(const n of s)switch(n.type){case"space":case"comment":t.push(n);break;case"newline":return t.push(n),!0}return!1}function Sl(t,s,n){switch(t.type){case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":t.type=n,t.source=s;break;case"block-scalar":{const r=t.props.slice(1);let i=s.length;t.props[0].type==="block-scalar-header"&&(i-=t.props[0].source.length);for(const a of r)a.offset+=i;delete t.props,Object.assign(t,{type:n,source:s,end:r});break}case"block-map":case"block-seq":{const i={type:"newline",offset:t.offset+s.length,indent:t.indent,source:`
`};delete t.items,Object.assign(t,{type:n,source:s,end:[i]});break}default:{const r="indent"in t?t.indent:-1,i="end"in t&&Array.isArray(t.end)?t.end.filter(a=>a.type==="space"||a.type==="comment"||a.type==="newline"):[];for(const a of Object.keys(t))a!=="type"&&a!=="offset"&&delete t[a];Object.assign(t,{type:n,indent:r,source:s,end:i})}}}const KA=t=>"type"in t?Xa(t):Da(t);function Xa(t){switch(t.type){case"block-scalar":{let s="";for(const n of t.props)s+=Xa(n);return s+t.source}case"block-map":case"block-seq":{let s="";for(const n of t.items)s+=Da(n);return s}case"flow-collection":{let s=t.start.source;for(const n of t.items)s+=Da(n);for(const n of t.end)s+=n.source;return s}case"document":{let s=Da(t);if(t.end)for(const n of t.end)s+=n.source;return s}default:{let s=t.source;if("end"in t&&t.end)for(const n of t.end)s+=n.source;return s}}}function Da({start:t,key:s,sep:n,value:r}){let i="";for(const a of t)i+=a.source;if(s&&(i+=Xa(s)),n)for(const a of n)i+=a.source;return r&&(i+=Xa(r)),i}const mc=Symbol("break visit"),GA=Symbol("skip children"),Mj=Symbol("remove item");function An(t,s){"type"in t&&t.type==="document"&&(t={start:t.start,value:t.value}),Ij(Object.freeze([]),t,s)}An.BREAK=mc;An.SKIP=GA;An.REMOVE=Mj;An.itemAtPath=(t,s)=>{let n=t;for(const[r,i]of s){const a=n?.[r];if(a&&"items"in a)n=a.items[i];else return}return n};An.parentCollection=(t,s)=>{const n=An.itemAtPath(t,s.slice(0,-1)),r=s[s.length-1][0],i=n?.[r];if(i&&"items"in i)return i;throw new Error("Parent collection not found")};function Ij(t,s,n){let r=n(s,t);if(typeof r=="symbol")return r;for(const i of["key","value"]){const a=s[i];if(a&&"items"in a){for(let o=0;o<a.items.length;++o){const l=Ij(Object.freeze(t.concat([[i,o]])),a.items[o],n);if(typeof l=="number")o=l-1;else{if(l===mc)return mc;l===Mj&&(a.items.splice(o,1),o-=1)}}typeof r=="function"&&i==="key"&&(r=r(s,t))}}return typeof r=="function"?r(s,t):r}const Uo="\uFEFF",Bo="",Vo="",Ii="",QA=t=>!!t&&"items"in t,HA=t=>!!t&&(t.type==="scalar"||t.type==="single-quoted-scalar"||t.type==="double-quoted-scalar"||t.type==="block-scalar");function ZA(t){switch(t){case Uo:return"<BOM>";case Bo:return"<DOC>";case Vo:return"<FLOW_END>";case Ii:return"<SCALAR>";default:return JSON.stringify(t)}}function Ej(t){switch(t){case Uo:return"byte-order-mark";case Bo:return"doc-mode";case Vo:return"flow-error-end";case Ii:return"scalar";case"---":return"doc-start";case"...":return"doc-end";case"":case`
`:case`\r
`:return"newline";case"-":return"seq-item-ind";case"?":return"explicit-key-ind";case":":return"map-value-ind";case"{":return"flow-map-start";case"}":return"flow-map-end";case"[":return"flow-seq-start";case"]":return"flow-seq-end";case",":return"comma"}switch(t[0]){case" ":case"	":return"space";case"#":return"comment";case"%":return"directive-line";case"*":return"alias";case"&":return"anchor";case"!":return"tag";case"'":return"single-quoted-scalar";case'"':return"double-quoted-scalar";case"|":case">":return"block-scalar-header"}return null}const YA=Object.freeze(Object.defineProperty({__proto__:null,BOM:Uo,DOCUMENT:Bo,FLOW_END:Vo,SCALAR:Ii,createScalarToken:BA,isCollection:QA,isScalar:HA,prettyToken:ZA,resolveAsScalar:UA,setScalarValue:VA,stringify:KA,tokenType:Ej,visit:An},Symbol.toStringTag,{value:"Module"}));function ns(t){switch(t){case void 0:case" ":case`
`:case"\r":case"	":return!0;default:return!1}}const ch=new Set("0123456789ABCDEFabcdef"),JA=new Set("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-#;/?:@&=+$_.!~*'()"),ba=new Set(",[]{}"),XA=new Set(` ,[]{}
\r	`),Cl=t=>!t||XA.has(t);class Lj{constructor(){this.atEnd=!1,this.blockScalarIndent=-1,this.blockScalarKeep=!1,this.buffer="",this.flowKey=!1,this.flowLevel=0,this.indentNext=0,this.indentValue=0,this.lineEndPos=null,this.next=null,this.pos=0}*lex(s,n=!1){if(s){if(typeof s!="string")throw TypeError("source is not a string");this.buffer=this.buffer?this.buffer+s:s,this.lineEndPos=null}this.atEnd=!n;let r=this.next??"stream";for(;r&&(n||this.hasChars(1));)r=yield*this.parseNext(r)}atLineEnd(){let s=this.pos,n=this.buffer[s];for(;n===" "||n==="	";)n=this.buffer[++s];return!n||n==="#"||n===`
`?!0:n==="\r"?this.buffer[s+1]===`
`:!1}charAt(s){return this.buffer[this.pos+s]}continueScalar(s){let n=this.buffer[s];if(this.indentNext>0){let r=0;for(;n===" ";)n=this.buffer[++r+s];if(n==="\r"){const i=this.buffer[r+s+1];if(i===`
`||!i&&!this.atEnd)return s+r+1}return n===`
`||r>=this.indentNext||!n&&!this.atEnd?s+r:-1}if(n==="-"||n==="."){const r=this.buffer.substr(s,3);if((r==="---"||r==="...")&&ns(this.buffer[s+3]))return-1}return s}getLine(){let s=this.lineEndPos;return(typeof s!="number"||s!==-1&&s<this.pos)&&(s=this.buffer.indexOf(`
`,this.pos),this.lineEndPos=s),s===-1?this.atEnd?this.buffer.substring(this.pos):null:(this.buffer[s-1]==="\r"&&(s-=1),this.buffer.substring(this.pos,s))}hasChars(s){return this.pos+s<=this.buffer.length}setNext(s){return this.buffer=this.buffer.substring(this.pos),this.pos=0,this.lineEndPos=null,this.next=s,null}peek(s){return this.buffer.substr(this.pos,s)}*parseNext(s){switch(s){case"stream":return yield*this.parseStream();case"line-start":return yield*this.parseLineStart();case"block-start":return yield*this.parseBlockStart();case"doc":return yield*this.parseDocument();case"flow":return yield*this.parseFlowCollection();case"quoted-scalar":return yield*this.parseQuotedScalar();case"block-scalar":return yield*this.parseBlockScalar();case"plain-scalar":return yield*this.parsePlainScalar()}}*parseStream(){let s=this.getLine();if(s===null)return this.setNext("stream");if(s[0]===Uo&&(yield*this.pushCount(1),s=s.substring(1)),s[0]==="%"){let n=s.length,r=s.indexOf("#");for(;r!==-1;){const a=s[r-1];if(a===" "||a==="	"){n=r-1;break}else r=s.indexOf("#",r+1)}for(;;){const a=s[n-1];if(a===" "||a==="	")n-=1;else break}const i=(yield*this.pushCount(n))+(yield*this.pushSpaces(!0));return yield*this.pushCount(s.length-i),this.pushNewline(),"stream"}if(this.atLineEnd()){const n=yield*this.pushSpaces(!0);return yield*this.pushCount(s.length-n),yield*this.pushNewline(),"stream"}return yield Bo,yield*this.parseLineStart()}*parseLineStart(){const s=this.charAt(0);if(!s&&!this.atEnd)return this.setNext("line-start");if(s==="-"||s==="."){if(!this.atEnd&&!this.hasChars(4))return this.setNext("line-start");const n=this.peek(3);if((n==="---"||n==="...")&&ns(this.charAt(3)))return yield*this.pushCount(3),this.indentValue=0,this.indentNext=0,n==="---"?"doc":"stream"}return this.indentValue=yield*this.pushSpaces(!1),this.indentNext>this.indentValue&&!ns(this.charAt(1))&&(this.indentNext=this.indentValue),yield*this.parseBlockStart()}*parseBlockStart(){const[s,n]=this.peek(2);if(!n&&!this.atEnd)return this.setNext("block-start");if((s==="-"||s==="?"||s===":")&&ns(n)){const r=(yield*this.pushCount(1))+(yield*this.pushSpaces(!0));return this.indentNext=this.indentValue+1,this.indentValue+=r,yield*this.parseBlockStart()}return"doc"}*parseDocument(){yield*this.pushSpaces(!0);const s=this.getLine();if(s===null)return this.setNext("doc");let n=yield*this.pushIndicators();switch(s[n]){case"#":yield*this.pushCount(s.length-n);case void 0:return yield*this.pushNewline(),yield*this.parseLineStart();case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel=1,"flow";case"}":case"]":return yield*this.pushCount(1),"doc";case"*":return yield*this.pushUntil(Cl),"doc";case'"':case"'":return yield*this.parseQuotedScalar();case"|":case">":return n+=yield*this.parseBlockScalarHeader(),n+=yield*this.pushSpaces(!0),yield*this.pushCount(s.length-n),yield*this.pushNewline(),yield*this.parseBlockScalar();default:return yield*this.parsePlainScalar()}}*parseFlowCollection(){let s,n,r=-1;do s=yield*this.pushNewline(),s>0?(n=yield*this.pushSpaces(!1),this.indentValue=r=n):n=0,n+=yield*this.pushSpaces(!0);while(s+n>0);const i=this.getLine();if(i===null)return this.setNext("flow");if((r!==-1&&r<this.indentNext&&i[0]!=="#"||r===0&&(i.startsWith("---")||i.startsWith("..."))&&ns(i[3]))&&!(r===this.indentNext-1&&this.flowLevel===1&&(i[0]==="]"||i[0]==="}")))return this.flowLevel=0,yield Vo,yield*this.parseLineStart();let a=0;for(;i[a]===",";)a+=yield*this.pushCount(1),a+=yield*this.pushSpaces(!0),this.flowKey=!1;switch(a+=yield*this.pushIndicators(),i[a]){case void 0:return"flow";case"#":return yield*this.pushCount(i.length-a),"flow";case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel+=1,"flow";case"}":case"]":return yield*this.pushCount(1),this.flowKey=!0,this.flowLevel-=1,this.flowLevel?"flow":"doc";case"*":return yield*this.pushUntil(Cl),"flow";case'"':case"'":return this.flowKey=!0,yield*this.parseQuotedScalar();case":":{const o=this.charAt(1);if(this.flowKey||ns(o)||o===",")return this.flowKey=!1,yield*this.pushCount(1),yield*this.pushSpaces(!0),"flow"}default:return this.flowKey=!1,yield*this.parsePlainScalar()}}*parseQuotedScalar(){const s=this.charAt(0);let n=this.buffer.indexOf(s,this.pos+1);if(s==="'")for(;n!==-1&&this.buffer[n+1]==="'";)n=this.buffer.indexOf("'",n+2);else for(;n!==-1;){let a=0;for(;this.buffer[n-1-a]==="\\";)a+=1;if(a%2===0)break;n=this.buffer.indexOf('"',n+1)}const r=this.buffer.substring(0,n);let i=r.indexOf(`
`,this.pos);if(i!==-1){for(;i!==-1;){const a=this.continueScalar(i+1);if(a===-1)break;i=r.indexOf(`
`,a)}i!==-1&&(n=i-(r[i-1]==="\r"?2:1))}if(n===-1){if(!this.atEnd)return this.setNext("quoted-scalar");n=this.buffer.length}return yield*this.pushToIndex(n+1,!1),this.flowLevel?"flow":"doc"}*parseBlockScalarHeader(){this.blockScalarIndent=-1,this.blockScalarKeep=!1;let s=this.pos;for(;;){const n=this.buffer[++s];if(n==="+")this.blockScalarKeep=!0;else if(n>"0"&&n<="9")this.blockScalarIndent=Number(n)-1;else if(n!=="-")break}return yield*this.pushUntil(n=>ns(n)||n==="#")}*parseBlockScalar(){let s=this.pos-1,n=0,r;e:for(let a=this.pos;r=this.buffer[a];++a)switch(r){case" ":n+=1;break;case`
`:s=a,n=0;break;case"\r":{const o=this.buffer[a+1];if(!o&&!this.atEnd)return this.setNext("block-scalar");if(o===`
`)break}default:break e}if(!r&&!this.atEnd)return this.setNext("block-scalar");if(n>=this.indentNext){this.blockScalarIndent===-1?this.indentNext=n:this.indentNext=this.blockScalarIndent+(this.indentNext===0?1:this.indentNext);do{const a=this.continueScalar(s+1);if(a===-1)break;s=this.buffer.indexOf(`
`,a)}while(s!==-1);if(s===-1){if(!this.atEnd)return this.setNext("block-scalar");s=this.buffer.length}}let i=s+1;for(r=this.buffer[i];r===" ";)r=this.buffer[++i];if(r==="	"){for(;r==="	"||r===" "||r==="\r"||r===`
`;)r=this.buffer[++i];s=i-1}else if(!this.blockScalarKeep)do{let a=s-1,o=this.buffer[a];o==="\r"&&(o=this.buffer[--a]);const l=a;for(;o===" ";)o=this.buffer[--a];if(o===`
`&&a>=this.pos&&a+1+n>l)s=a;else break}while(!0);return yield Ii,yield*this.pushToIndex(s+1,!0),yield*this.parseLineStart()}*parsePlainScalar(){const s=this.flowLevel>0;let n=this.pos-1,r=this.pos-1,i;for(;i=this.buffer[++r];)if(i===":"){const a=this.buffer[r+1];if(ns(a)||s&&ba.has(a))break;n=r}else if(ns(i)){let a=this.buffer[r+1];if(i==="\r"&&(a===`
`?(r+=1,i=`
`,a=this.buffer[r+1]):n=r),a==="#"||s&&ba.has(a))break;if(i===`
`){const o=this.continueScalar(r+1);if(o===-1)break;r=Math.max(r,o-2)}}else{if(s&&ba.has(i))break;n=r}return!i&&!this.atEnd?this.setNext("plain-scalar"):(yield Ii,yield*this.pushToIndex(n+1,!0),s?"flow":"doc")}*pushCount(s){return s>0?(yield this.buffer.substr(this.pos,s),this.pos+=s,s):0}*pushToIndex(s,n){const r=this.buffer.slice(this.pos,s);return r?(yield r,this.pos+=r.length,r.length):(n&&(yield""),0)}*pushIndicators(){switch(this.charAt(0)){case"!":return(yield*this.pushTag())+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"&":return(yield*this.pushUntil(Cl))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"-":case"?":case":":{const s=this.flowLevel>0,n=this.charAt(1);if(ns(n)||s&&ba.has(n))return s?this.flowKey&&(this.flowKey=!1):this.indentNext=this.indentValue+1,(yield*this.pushCount(1))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators())}}return 0}*pushTag(){if(this.charAt(1)==="<"){let s=this.pos+2,n=this.buffer[s];for(;!ns(n)&&n!==">";)n=this.buffer[++s];return yield*this.pushToIndex(n===">"?s+1:s,!1)}else{let s=this.pos+1,n=this.buffer[s];for(;n;)if(JA.has(n))n=this.buffer[++s];else if(n==="%"&&ch.has(this.buffer[s+1])&&ch.has(this.buffer[s+2]))n=this.buffer[s+=3];else break;return yield*this.pushToIndex(s,!1)}}*pushNewline(){const s=this.buffer[this.pos];return s===`
`?yield*this.pushCount(1):s==="\r"&&this.charAt(1)===`
`?yield*this.pushCount(2):0}*pushSpaces(s){let n=this.pos-1,r;do r=this.buffer[++n];while(r===" "||s&&r==="	");const i=n-this.pos;return i>0&&(yield this.buffer.substr(this.pos,i),this.pos=n),i}*pushUntil(s){let n=this.pos,r=this.buffer[n];for(;!s(r);)r=this.buffer[++n];return yield*this.pushToIndex(n,!1)}}class Oj{constructor(){this.lineStarts=[],this.addNewLine=s=>this.lineStarts.push(s),this.linePos=s=>{let n=0,r=this.lineStarts.length;for(;n<r;){const a=n+r>>1;this.lineStarts[a]<s?n=a+1:r=a}if(this.lineStarts[n]===s)return{line:n+1,col:1};if(n===0)return{line:0,col:s};const i=this.lineStarts[n-1];return{line:n,col:s-i+1}}}}function Zs(t,s){for(let n=0;n<t.length;++n)if(t[n].type===s)return!0;return!1}function dh(t){for(let s=0;s<t.length;++s)switch(t[s].type){case"space":case"comment":case"newline":break;default:return s}return-1}function Rj(t){switch(t?.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"flow-collection":return!0;default:return!1}}function wa(t){switch(t.type){case"document":return t.start;case"block-map":{const s=t.items[t.items.length-1];return s.sep??s.start}case"block-seq":return t.items[t.items.length-1].start;default:return[]}}function Zn(t){if(t.length===0)return[];let s=t.length;e:for(;--s>=0;)switch(t[s].type){case"doc-start":case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":case"newline":break e}for(;t[++s]?.type==="space";);return t.splice(s,t.length)}function uh(t){if(t.start.type==="flow-seq-start")for(const s of t.items)s.sep&&!s.value&&!Zs(s.start,"explicit-key-ind")&&!Zs(s.sep,"map-value-ind")&&(s.key&&(s.value=s.key),delete s.key,Rj(s.value)?s.value.end?Array.prototype.push.apply(s.value.end,s.sep):s.value.end=s.sep:Array.prototype.push.apply(s.start,s.sep),delete s.sep)}class qd{constructor(s){this.atNewLine=!0,this.atScalar=!1,this.indent=0,this.offset=0,this.onKeyLine=!1,this.stack=[],this.source="",this.type="",this.lexer=new Lj,this.onNewLine=s}*parse(s,n=!1){this.onNewLine&&this.offset===0&&this.onNewLine(0);for(const r of this.lexer.lex(s,n))yield*this.next(r);n||(yield*this.end())}*next(s){if(this.source=s,this.atScalar){this.atScalar=!1,yield*this.step(),this.offset+=s.length;return}const n=Ej(s);if(n)if(n==="scalar")this.atNewLine=!1,this.atScalar=!0,this.type="scalar";else{switch(this.type=n,yield*this.step(),n){case"newline":this.atNewLine=!0,this.indent=0,this.onNewLine&&this.onNewLine(this.offset+s.length);break;case"space":this.atNewLine&&s[0]===" "&&(this.indent+=s.length);break;case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":this.atNewLine&&(this.indent+=s.length);break;case"doc-mode":case"flow-error-end":return;default:this.atNewLine=!1}this.offset+=s.length}else{const r=`Not a YAML token: ${s}`;yield*this.pop({type:"error",offset:this.offset,message:r,source:s}),this.offset+=s.length}}*end(){for(;this.stack.length>0;)yield*this.pop()}get sourceToken(){return{type:this.type,offset:this.offset,indent:this.indent,source:this.source}}*step(){const s=this.peek(1);if(this.type==="doc-end"&&(!s||s.type!=="doc-end")){for(;this.stack.length>0;)yield*this.pop();this.stack.push({type:"doc-end",offset:this.offset,source:this.source});return}if(!s)return yield*this.stream();switch(s.type){case"document":return yield*this.document(s);case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return yield*this.scalar(s);case"block-scalar":return yield*this.blockScalar(s);case"block-map":return yield*this.blockMap(s);case"block-seq":return yield*this.blockSequence(s);case"flow-collection":return yield*this.flowCollection(s);case"doc-end":return yield*this.documentEnd(s)}yield*this.pop()}peek(s){return this.stack[this.stack.length-s]}*pop(s){const n=s??this.stack.pop();if(!n)yield{type:"error",offset:this.offset,source:"",message:"Tried to pop an empty stack"};else if(this.stack.length===0)yield n;else{const r=this.peek(1);switch(n.type==="block-scalar"?n.indent="indent"in r?r.indent:0:n.type==="flow-collection"&&r.type==="document"&&(n.indent=0),n.type==="flow-collection"&&uh(n),r.type){case"document":r.value=n;break;case"block-scalar":r.props.push(n);break;case"block-map":{const i=r.items[r.items.length-1];if(i.value){r.items.push({start:[],key:n,sep:[]}),this.onKeyLine=!0;return}else if(i.sep)i.value=n;else{Object.assign(i,{key:n,sep:[]}),this.onKeyLine=!i.explicitKey;return}break}case"block-seq":{const i=r.items[r.items.length-1];i.value?r.items.push({start:[],value:n}):i.value=n;break}case"flow-collection":{const i=r.items[r.items.length-1];!i||i.value?r.items.push({start:[],key:n,sep:[]}):i.sep?i.value=n:Object.assign(i,{key:n,sep:[]});return}default:yield*this.pop(),yield*this.pop(n)}if((r.type==="document"||r.type==="block-map"||r.type==="block-seq")&&(n.type==="block-map"||n.type==="block-seq")){const i=n.items[n.items.length-1];i&&!i.sep&&!i.value&&i.start.length>0&&dh(i.start)===-1&&(n.indent===0||i.start.every(a=>a.type!=="comment"||a.indent<n.indent))&&(r.type==="document"?r.end=i.start:r.items.push({start:i.start}),n.items.splice(-1,1))}}}*stream(){switch(this.type){case"directive-line":yield{type:"directive",offset:this.offset,source:this.source};return;case"byte-order-mark":case"space":case"comment":case"newline":yield this.sourceToken;return;case"doc-mode":case"doc-start":{const s={type:"document",offset:this.offset,start:[]};this.type==="doc-start"&&s.start.push(this.sourceToken),this.stack.push(s);return}}yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML stream`,source:this.source}}*document(s){if(s.value)return yield*this.lineEnd(s);switch(this.type){case"doc-start":{dh(s.start)!==-1?(yield*this.pop(),yield*this.step()):s.start.push(this.sourceToken);return}case"anchor":case"tag":case"space":case"comment":case"newline":s.start.push(this.sourceToken);return}const n=this.startBlockValue(s);n?this.stack.push(n):yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML document`,source:this.source}}*scalar(s){if(this.type==="map-value-ind"){const n=wa(this.peek(2)),r=Zn(n);let i;s.end?(i=s.end,i.push(this.sourceToken),delete s.end):i=[this.sourceToken];const a={type:"block-map",offset:s.offset,indent:s.indent,items:[{start:r,key:s,sep:i}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=a}else yield*this.lineEnd(s)}*blockScalar(s){switch(this.type){case"space":case"comment":case"newline":s.props.push(this.sourceToken);return;case"scalar":if(s.source=this.source,this.atNewLine=!0,this.indent=0,this.onNewLine){let n=this.source.indexOf(`
`)+1;for(;n!==0;)this.onNewLine(this.offset+n),n=this.source.indexOf(`
`,n)+1}yield*this.pop();break;default:yield*this.pop(),yield*this.step()}}*blockMap(s){const n=s.items[s.items.length-1];switch(this.type){case"newline":if(this.onKeyLine=!1,n.value){const r="end"in n.value?n.value.end:void 0;(Array.isArray(r)?r[r.length-1]:void 0)?.type==="comment"?r?.push(this.sourceToken):s.items.push({start:[this.sourceToken]})}else n.sep?n.sep.push(this.sourceToken):n.start.push(this.sourceToken);return;case"space":case"comment":if(n.value)s.items.push({start:[this.sourceToken]});else if(n.sep)n.sep.push(this.sourceToken);else{if(this.atIndentedComment(n.start,s.indent)){const i=s.items[s.items.length-2]?.value?.end;if(Array.isArray(i)){Array.prototype.push.apply(i,n.start),i.push(this.sourceToken),s.items.pop();return}}n.start.push(this.sourceToken)}return}if(this.indent>=s.indent){const r=!this.onKeyLine&&this.indent===s.indent,i=r&&(n.sep||n.explicitKey)&&this.type!=="seq-item-ind";let a=[];if(i&&n.sep&&!n.value){const o=[];for(let l=0;l<n.sep.length;++l){const c=n.sep[l];switch(c.type){case"newline":o.push(l);break;case"space":break;case"comment":c.indent>s.indent&&(o.length=0);break;default:o.length=0}}o.length>=2&&(a=n.sep.splice(o[1]))}switch(this.type){case"anchor":case"tag":i||n.value?(a.push(this.sourceToken),s.items.push({start:a}),this.onKeyLine=!0):n.sep?n.sep.push(this.sourceToken):n.start.push(this.sourceToken);return;case"explicit-key-ind":!n.sep&&!n.explicitKey?(n.start.push(this.sourceToken),n.explicitKey=!0):i||n.value?(a.push(this.sourceToken),s.items.push({start:a,explicitKey:!0})):this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken],explicitKey:!0}]}),this.onKeyLine=!0;return;case"map-value-ind":if(n.explicitKey)if(n.sep)if(n.value)s.items.push({start:[],key:null,sep:[this.sourceToken]});else if(Zs(n.sep,"map-value-ind"))this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:a,key:null,sep:[this.sourceToken]}]});else if(Rj(n.key)&&!Zs(n.sep,"newline")){const o=Zn(n.start),l=n.key,c=n.sep;c.push(this.sourceToken),delete n.key,delete n.sep,this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:o,key:l,sep:c}]})}else a.length>0?n.sep=n.sep.concat(a,this.sourceToken):n.sep.push(this.sourceToken);else if(Zs(n.start,"newline"))Object.assign(n,{key:null,sep:[this.sourceToken]});else{const o=Zn(n.start);this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:o,key:null,sep:[this.sourceToken]}]})}else n.sep?n.value||i?s.items.push({start:a,key:null,sep:[this.sourceToken]}):Zs(n.sep,"map-value-ind")?this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[],key:null,sep:[this.sourceToken]}]}):n.sep.push(this.sourceToken):Object.assign(n,{key:null,sep:[this.sourceToken]});this.onKeyLine=!0;return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const o=this.flowScalar(this.type);i||n.value?(s.items.push({start:a,key:o,sep:[]}),this.onKeyLine=!0):n.sep?this.stack.push(o):(Object.assign(n,{key:o,sep:[]}),this.onKeyLine=!0);return}default:{const o=this.startBlockValue(s);if(o){if(o.type==="block-seq"){if(!n.explicitKey&&n.sep&&!Zs(n.sep,"newline")){yield*this.pop({type:"error",offset:this.offset,message:"Unexpected block-seq-ind on same line with key",source:this.source});return}}else r&&s.items.push({start:a});this.stack.push(o);return}}}}yield*this.pop(),yield*this.step()}*blockSequence(s){const n=s.items[s.items.length-1];switch(this.type){case"newline":if(n.value){const r="end"in n.value?n.value.end:void 0;(Array.isArray(r)?r[r.length-1]:void 0)?.type==="comment"?r?.push(this.sourceToken):s.items.push({start:[this.sourceToken]})}else n.start.push(this.sourceToken);return;case"space":case"comment":if(n.value)s.items.push({start:[this.sourceToken]});else{if(this.atIndentedComment(n.start,s.indent)){const i=s.items[s.items.length-2]?.value?.end;if(Array.isArray(i)){Array.prototype.push.apply(i,n.start),i.push(this.sourceToken),s.items.pop();return}}n.start.push(this.sourceToken)}return;case"anchor":case"tag":if(n.value||this.indent<=s.indent)break;n.start.push(this.sourceToken);return;case"seq-item-ind":if(this.indent!==s.indent)break;n.value||Zs(n.start,"seq-item-ind")?s.items.push({start:[this.sourceToken]}):n.start.push(this.sourceToken);return}if(this.indent>s.indent){const r=this.startBlockValue(s);if(r){this.stack.push(r);return}}yield*this.pop(),yield*this.step()}*flowCollection(s){const n=s.items[s.items.length-1];if(this.type==="flow-error-end"){let r;do yield*this.pop(),r=this.peek(1);while(r&&r.type==="flow-collection")}else if(s.end.length===0){switch(this.type){case"comma":case"explicit-key-ind":!n||n.sep?s.items.push({start:[this.sourceToken]}):n.start.push(this.sourceToken);return;case"map-value-ind":!n||n.value?s.items.push({start:[],key:null,sep:[this.sourceToken]}):n.sep?n.sep.push(this.sourceToken):Object.assign(n,{key:null,sep:[this.sourceToken]});return;case"space":case"comment":case"newline":case"anchor":case"tag":!n||n.value?s.items.push({start:[this.sourceToken]}):n.sep?n.sep.push(this.sourceToken):n.start.push(this.sourceToken);return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const i=this.flowScalar(this.type);!n||n.value?s.items.push({start:[],key:i,sep:[]}):n.sep?this.stack.push(i):Object.assign(n,{key:i,sep:[]});return}case"flow-map-end":case"flow-seq-end":s.end.push(this.sourceToken);return}const r=this.startBlockValue(s);r?this.stack.push(r):(yield*this.pop(),yield*this.step())}else{const r=this.peek(2);if(r.type==="block-map"&&(this.type==="map-value-ind"&&r.indent===s.indent||this.type==="newline"&&!r.items[r.items.length-1].sep))yield*this.pop(),yield*this.step();else if(this.type==="map-value-ind"&&r.type!=="flow-collection"){const i=wa(r),a=Zn(i);uh(s);const o=s.end.splice(1,s.end.length);o.push(this.sourceToken);const l={type:"block-map",offset:s.offset,indent:s.indent,items:[{start:a,key:s,sep:o}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=l}else yield*this.lineEnd(s)}}flowScalar(s){if(this.onNewLine){let n=this.source.indexOf(`
`)+1;for(;n!==0;)this.onNewLine(this.offset+n),n=this.source.indexOf(`
`,n)+1}return{type:s,offset:this.offset,indent:this.indent,source:this.source}}startBlockValue(s){switch(this.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return this.flowScalar(this.type);case"block-scalar-header":return{type:"block-scalar",offset:this.offset,indent:this.indent,props:[this.sourceToken],source:""};case"flow-map-start":case"flow-seq-start":return{type:"flow-collection",offset:this.offset,indent:this.indent,start:this.sourceToken,items:[],end:[]};case"seq-item-ind":return{type:"block-seq",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken]}]};case"explicit-key-ind":{this.onKeyLine=!0;const n=wa(s),r=Zn(n);return r.push(this.sourceToken),{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:r,explicitKey:!0}]}}case"map-value-ind":{this.onKeyLine=!0;const n=wa(s),r=Zn(n);return{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:r,key:null,sep:[this.sourceToken]}]}}}return null}atIndentedComment(s,n){return this.type!=="comment"||this.indent<=n?!1:s.every(r=>r.type==="newline"||r.type==="space")}*documentEnd(s){this.type!=="doc-mode"&&(s.end?s.end.push(this.sourceToken):s.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop()))}*lineEnd(s){switch(this.type){case"comma":case"doc-start":case"doc-end":case"flow-seq-end":case"flow-map-end":case"map-value-ind":yield*this.pop(),yield*this.step();break;case"newline":this.onKeyLine=!1;case"space":case"comment":default:s.end?s.end.push(this.sourceToken):s.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop())}}}function $j(t){const s=t.prettyErrors!==!1;return{lineCounter:t.lineCounter||s&&new Oj||null,prettyErrors:s}}function eD(t,s={}){const{lineCounter:n,prettyErrors:r}=$j(s),i=new qd(n?.addNewLine),a=new $d(s),o=Array.from(a.compose(i.parse(t)));if(r&&n)for(const l of o)l.errors.forEach(Ja(t,n)),l.warnings.forEach(Ja(t,n));return o.length>0?o:Object.assign([],{empty:!0},a.streamInfo())}function qj(t,s={}){const{lineCounter:n,prettyErrors:r}=$j(s),i=new qd(n?.addNewLine),a=new $d(s);let o=null;for(const l of a.compose(i.parse(t),!0,t.length))if(!o)o=l;else if(o.options.logLevel!=="silent"){o.errors.push(new wn(l.range.slice(0,2),"MULTIPLE_DOCS","Source contains multiple documents; please use YAML.parseAllDocuments()"));break}return r&&n&&(o.errors.forEach(Ja(t,n)),o.warnings.forEach(Ja(t,n))),o}function tD(t,s,n){let r;typeof s=="function"?r=s:n===void 0&&s&&typeof s=="object"&&(n=s);const i=qj(t,n);if(!i)return null;if(i.warnings.forEach(a=>aj(i.options.logLevel,a)),i.errors.length>0){if(i.options.logLevel!=="silent")throw i.errors[0];i.errors=[]}return i.toJS(Object.assign({reviver:r},n))}function sD(t,s,n){let r=null;if(typeof s=="function"||Array.isArray(s)?r=s:n===void 0&&s&&(n=s),typeof n=="string"&&(n=n.length),typeof n=="number"){const i=Math.round(n);n=i<1?void 0:i>8?{indent:8}:{indent:i}}if(t===void 0){const{keepUndefined:i}=n??s??{};if(!i)return}return Fn(t)&&!r?t.toString(n):new Wr(t,r,n).toString(n)}const nD=Object.freeze(Object.defineProperty({__proto__:null,Alias:Po,CST:YA,Composer:$d,Document:Wr,Lexer:Lj,LineCounter:Oj,Pair:ct,Parser:qd,Scalar:ie,Schema:Fo,YAMLError:Od,YAMLMap:Et,YAMLParseError:wn,YAMLSeq:an,YAMLWarning:zj,isAlias:mn,isCollection:Me,isDocument:Fn,isMap:Fr,isNode:Ee,isPair:De,isScalar:Ne,isSeq:Ur,parse:tD,parseAllDocuments:eD,parseDocument:qj,stringify:sD,visit:Un,visitAsync:Do},Symbol.toStringTag,{value:"Module"})),mh=t=>t.toLowerCase().replace(/[^\p{Letter}\p{Number}]+/gu,"-").replace(/(^-|-$)/g,"")||"sekcja",rD=(t,s)=>{const n=t.split(/\n(?=##\s+)/g);return n.length<=1&&!/^##\s+/.test(t)?[{id:mh(s||"Sekcja 1"),title:s||"Sekcja 1",content:t}]:n.map((r,i)=>{const o=(r.match(/^##\s+(.+?)\s*$/m)?.[1]||`Sekcja ${i+1}`).trim(),l=r.replace(/^##\s+.+?\n/,"").trim();return{id:mh(o),title:o,content:l}})},iD=/```quiz\s*?\n([\s\S]*?)```/g,aD=(t,s,n)=>{try{const r=nD.parse(t),i=(r?.options||[]).map(String);return!r?.question||!Array.isArray(r?.options)||typeof r?.answerIndex!="number"||r.answerIndex<0||r.answerIndex>=i.length?null:{question:r.question,options:i,answerIndex:r.answerIndex,key:`${s}:${n}`}}catch{return null}},oD=t=>new Map(t.map(s=>[s.id,[...s.content.matchAll(iD)].map((n,r)=>aD(n[1],s.id,r)).filter(Boolean)])),hh=(t,s)=>{const[n,r]=ne.useState(()=>{try{const i=localStorage.getItem(t);return i?JSON.parse(i):s}catch{return s}});return ne.useEffect(()=>{try{localStorage.setItem(t,JSON.stringify(n))}catch(i){console.error("Bd zapisu do localStorage:",i)}},[t,n]),[n,r]},lD=()=>{const t=ne.useRef(null);return{ref:t,say:n=>{t.current&&(t.current.textContent="",setTimeout(()=>t.current&&(t.current.textContent=n),30))}}},cD=()=>e.jsxs("div",{className:"container mx-auto px-4 py-6 sm:py-8 space-y-6",children:[e.jsx("div",{className:"h-5 w-24 rounded bg-muted/60"}),e.jsxs("div",{className:"rounded-2xl border bg-card p-6 shadow-soft animate-pulse",children:[e.jsx("div",{className:"h-6 w-2/3 rounded bg-muted/60 mb-2"}),e.jsx("div",{className:"h-4 w-40 rounded bg-muted/60"})]}),e.jsx("div",{className:"space-y-3",children:Array.from({length:10}).map((t,s)=>e.jsx("div",{className:"h-4 w-full rounded bg-muted/50"},s))}),e.jsx("div",{className:"h-10 w-48 rounded-lg bg-muted/60 ml-auto"})]}),ph={code:({inline:t,className:s="",children:n,...r})=>{const i=(s||"").toLowerCase();return!t&&i.includes("language-quiz")?null:e.jsx("code",{className:s,...r,children:n})},pre:t=>((Array.isArray(t.children)?t.children[0]:t.children)?.props?.className?.toLowerCase?.()||"").includes("language-quiz")?null:e.jsx("pre",{...t})},dD=({quiz:t,onClose:s,onPass:n})=>{const[r,i]=ne.useState(null),[a,o]=ne.useState(!1),l=()=>{const c=r!==null&&r===t.answerIndex;o(c),c?(K.success("Poprawna odpowied藕!"),setTimeout(n,200)):K.error("Niepoprawna odpowied藕  spr贸buj ponownie.")};return e.jsxs("div",{className:"fixed inset-0 z-[90] flex items-end sm:items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:s}),e.jsxs("div",{className:"relative z-[91] w-full sm:max-w-lg bg-background rounded-t-2xl sm:rounded-2xl border shadow-2xl p-4 sm:p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold",children:"Pytanie kontrolne"}),e.jsx("button",{onClick:s,className:"p-1 rounded hover:bg-muted","aria-label":"Zamknij",children:e.jsx(dt,{className:"h-5 w-5"})})]}),e.jsx("p",{className:"mb-3 text-sm sm:text-base",children:t.question}),e.jsx("div",{className:"space-y-2 mb-4",children:t.options.map((c,d)=>e.jsxs("label",{className:"flex items-center gap-2 rounded-md border px-3 py-2 cursor-pointer hover:bg-muted",children:[e.jsx("input",{type:"radio",name:"quiz-choice",className:"h-4 w-4",checked:r===d,onChange:()=>i(d),disabled:a}),e.jsx("span",{className:"text-sm",children:c})]},d))}),e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:s,className:"rounded-lg border px-3 py-1.5 text-sm hover:bg-muted",children:"Anuluj"}),e.jsx("button",{onClick:l,className:"rounded-lg border px-3 py-1.5 text-sm font-medium hover:bg-muted",disabled:a,children:"Zatwierd藕"})]})]})]})},uD=({lessonTitle:t,courseId:s,timeSpent:n,sectionsCount:r,quizzesCompleted:i,pointsEarned:a,nextLessonPath:o})=>{const l=se(),c=d=>{const m=Math.floor(d/60),u=d%60;return m>0?`${m} min ${u} s`:`${u} s`};return e.jsx(ke.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"fixed inset-0 z-20 flex items-center justify-center p-4 bg-black/50",children:e.jsxs("div",{className:"w-full max-w-md rounded-2xl border bg-card p-6 shadow-2xl",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-green-100 dark:bg-green-900/30 mb-4",children:e.jsx(Re,{className:"w-8 h-8 text-green-600"})}),e.jsx("h2",{className:"text-2xl font-bold",children:"Lekcja ukoczona! "}),e.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:t})]}),e.jsxs("div",{className:"rounded-xl bg-primary/10 p-4 mb-6 text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 text-3xl font-bold text-primary",children:[e.jsx(Ye,{className:"w-6 h-6"}),"+",a," punkt贸w"]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"za ukoczenie materiau"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(Te,{className:"w-5 h-5 mx-auto mb-1 text-blue-600"}),e.jsx("p",{className:"text-sm font-medium",children:c(n)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Czas nauki"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(ye,{className:"w-5 h-5 mx-auto mb-1 text-purple-600"}),e.jsx("p",{className:"text-sm font-medium",children:r}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Sekcji"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx($e,{className:"w-5 h-5 mx-auto mb-1 text-yellow-600"}),e.jsx("p",{className:"text-sm font-medium",children:i}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Pyta"})]})]}),e.jsx("div",{className:"flex gap-3",children:o?e.jsxs("button",{onClick:()=>l(o),className:"flex-1 inline-flex items-center justify-center gap-2 rounded-lg bg-primary px-4 py-2.5 text-primary-foreground hover:bg-primary/90",children:["Nastpna lekcja",e.jsx(le,{className:"w-4 h-4"})]}):e.jsx("button",{onClick:()=>l(`/student/courses/${s}`),className:"flex-1 rounded-lg bg-primary px-4 py-2.5 text-primary-foreground hover:bg-primary/90",children:"Wr贸 do kursu"})})]})})},mD=()=>{const{courseId:t,lessonId:s}=vt(),n=se(),{refetch:r}=qn(),{data:i,isLoading:a}=Xe({resource:"activities",id:s,meta:{select:"*, topics(title, course_id, courses(title, icon_emoji))"}}),o=i?.data??{},l=o?.content_md??o?.markdown??o?.content,c=ne.useMemo(()=>l?rD(l,o?.title??"Sekcja"):[],[l,o?.title]),d=ne.useMemo(()=>oD(c),[c]),m=`lesson-progress:${s}`,u=`lesson-quiz:${s}`,[h,p]=hh(m,Object.fromEntries(c.map(E=>[E.id,!1]))),[b,f]=hh(u,{}),[y,w]=ne.useState(null),[j,v]=ne.useState(!1),[T]=ne.useState(Date.now());ne.useEffect(()=>{c.length&&p(E=>{const M={};return c.forEach(O=>M[O.id]=E[O.id]??!1),M})},[c.map(E=>E.id).join("|")]);const{ref:z,say:k}=lD(),N=c.findIndex(E=>!h[E.id]),S=N===-1,_=E=>{const[M]=d.get(E)??[];M&&w(M)},g=E=>{const M=c[E];if(!M||!(N===-1||E<=N)&&!h[M.id])return;if(h[M.id]){p(L=>({...L,[M.id]:!1})),k(`Sekcja ${E+1} cofnita.`);return}(d.get(M.id)??[]).length>0?_(M.id):(p(L=>({...L,[M.id]:!0})),k(`Sekcja ${E+1} odhaczona.`))},C=()=>{const E=y;if(w(null),!E)return;f(Q=>({...Q,[E.key]:!0}));const M=E.key.split(":")[0];p(Q=>({...Q,[M]:!0}));const O=c.findIndex(Q=>Q.id===M);k(`Sekcja ${O+1} odhaczona po pytaniu kontrolnym.`)},A=async()=>{if(!S)return K.info("Najpierw odhacz wszystkie sekcje po kolei.");console.log("Starting lesson completion...");try{const{error:E}=await J.rpc("start_activity",{p_activity_id:parseInt(s)});if(E)throw console.error("Error starting activity:",E),E;console.log("Activity started, completing material...");const{data:M,error:O}=await J.rpc("complete_material",{p_activity_id:parseInt(s)});if(console.log("Complete material result:",M,"Error:",O),O)throw O;if(M){const Q=Math.floor((Date.now()-T)/1e3);console.log("Material completed successfully"),v(!0);try{localStorage.removeItem(m),localStorage.removeItem(u)}catch(L){console.error("Bd zapisu do localStorage:",L)}ci("get_course_structure"),ci("get_my_courses"),setTimeout(()=>{console.log("Forcing stats refresh..."),r()},500),setTimeout(async()=>{console.log("Manually checking updated stats...");const{data:L,error:U}=await J.rpc("get_my_stats");console.log("New stats after completion:",L,"Error:",U)},1e3)}}catch(E){console.error("Failed to complete lesson:",E),K.error("Nie udao si ukoczy lekcji")}};return e.jsxs("div",{className:"container mx-auto px-4 py-6 sm:py-8 space-y-6 sm:space-y-10 pb-28 lg:pb-16",children:[e.jsx("div",{ref:z,"aria-live":"polite",className:"sr-only"}),e.jsxs("button",{onClick:()=>n(`/student/courses/${t}`),className:"flex items-center gap-2 text-muted-foreground hover:text-foreground transition-colors",children:[e.jsx(Ce,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Powr贸t do kursu"})]}),e.jsx("section",{className:"relative overflow-hidden rounded-2xl border bg-white dark:bg-card",children:e.jsx("div",{className:"relative z-10 p-5 sm:p-7 md:p-10",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-4xl md:text-5xl leading-none",children:o?.topics?.courses?.icon_emoji||""}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"text-xs sm:text-sm text-muted-foreground flex items-center gap-2",children:[e.jsx("span",{className:"truncate",children:o?.topics?.courses?.title||""}),e.jsx("span",{children:""}),e.jsx("span",{className:"truncate",children:o?.topics?.title||""})]}),e.jsx("h1",{className:"mt-1 text-xl md:text-3xl font-bold tracking-tight",children:o?.title||"adowanie"}),o?.duration_min&&e.jsxs("div",{className:"mt-3 inline-flex items-center gap-2 rounded-full border bg-white/70 dark:bg-background/60 px-3 py-1.5 shadow-soft",children:[e.jsx(Te,{className:"h-4 w-4"}),e.jsxs("span",{className:"text-sm font-medium",children:[o?.duration_min," min czytania"]})]})]})]})})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[1fr_280px] gap-10",children:[e.jsx("main",{children:a?e.jsx(cD,{}):e.jsxs("section",{children:[e.jsx("div",{className:"prose prose-neutral dark:prose-invert max-w-[72ch] mx-auto prose-headings:font-semibold prose-p:text-muted-foreground prose-p:leading-relaxed prose-li:leading-relaxed prose-headings:tracking-tight prose-img:rounded-xl prose-blockquote:rounded-xl md:prose-lg",children:c.length?c.map((E,M)=>{const O=!!h[E.id],Q=!O&&M===N,U=!(N===-1||M<=N)&&!O,F=(d.get(E.id)??[])[0],ae="rounded-[20px] border p-6 sm:p-7 md:p-8 shadow-sm transition-colors duration-200",B=O?"bg-emerald-50 dark:bg-emerald-950/25 border-emerald-300":Q?"bg-white dark:bg-background border-neutral-200 shadow-md":U?"bg-white dark:bg-card border-dashed border-muted-foreground/40":"bg-white dark:bg-card border-neutral-200",ee=!O&&U?"filter blur-[2px] select-none pointer-events-none":"";return e.jsxs("div",{id:E.id,className:"mb-12 scroll-mt-28",children:[e.jsxs("div",{className:`${ae} ${B}`,children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-3",children:[U&&e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border px-2.5 py-0.5 text-[11px] text-muted-foreground bg-white",children:[e.jsx(vn,{className:"h-3.5 w-3.5"}),"Zablokowana"]}),O&&e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border border-emerald-300/60 bg-emerald-50/60 px-2.5 py-0.5 text-[11px] text-emerald-700 dark:text-emerald-300",children:[e.jsx(Ve,{className:"h-3.5 w-3.5"}),"Ukoczona"]}),Q&&!O&&e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border bg-white px-2.5 py-0.5 text-[11px]",children:[e.jsx(va,{className:"h-3.5 w-3.5"}),"W trakcie"]}),F&&e.jsxs("button",{type:"button",onClick:()=>!O&&!U&&_(E.id),disabled:O||U,className:["inline-flex items-center gap-1 rounded-full border px-2.5 py-0.5 text-[11px]",O?"text-emerald-700 border-emerald-300/60 bg-emerald-50/60 dark:bg-emerald-950/25":U?"text-muted-foreground cursor-not-allowed bg-white dark:bg-background/40":"bg-white hover:bg-muted"].join(" "),title:O?"Pytanie rozwizane":U?"Najpierw odblokuj sekcj":"Kliknij, aby odpowiedzie","aria-label":"Pytanie kontrolne",children:[e.jsx(at,{className:"h-3.5 w-3.5"}),F.question.length>72?F.question.slice(0,69)+"":F.question]})]}),e.jsxs("div",{className:ee,children:[e.jsx("h2",{className:"text-[22px] md:text-[26px] font-semibold tracking-tight m-0 mb-4",children:E.title||`Sekcja ${M+1}`}),e.jsx(Ma,{remarkPlugins:[$l],components:ph,children:E.content})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsxs("label",{className:["inline-flex items-center gap-3",U?"cursor-not-allowed opacity-60":"cursor-pointer"].join(" "),title:U?"Najpierw ukocz poprzednie sekcje":O?"Sekcja odhaczona  klik, aby cofn":F?"Kliknij, aby odpowiedzie na pytanie":"Odhacz sekcj",children:[e.jsx("input",{type:"checkbox",className:"sr-only",checked:O,onChange:()=>!U&&g(M),disabled:U&&!O,"aria-label":`Odhacz sekcj: ${E.title||`Sekcja ${M+1}`}`}),e.jsx("span",{className:["inline-flex items-center gap-2 rounded-lg border px-3 py-2 text-sm font-medium shadow-soft transition-all",O?"bg-emerald-50/70 dark:bg-emerald-950/30 border-emerald-300/60 text-emerald-700 dark:text-emerald-300":"bg-white hover:bg-muted border-neutral-200"].join(" "),children:F&&!O?e.jsx("span",{className:"truncate max-w-[56ch]",children:F.question}):e.jsxs(e.Fragment,{children:[O?e.jsx(Ve,{className:"h-4 w-4"}):e.jsx(va,{className:"h-4 w-4"}),e.jsxs("span",{className:"whitespace-nowrap",children:[String(M+1).padStart(2,"0"),"  ",O?"Odhaczono":F?"Odhacz (pytanie)":"Odhacz sekcj"]})]})})]})})]}),e.jsx("div",{className:"h-8"})]},E.id)}):l?e.jsx(Ma,{remarkPlugins:[$l],components:ph,children:l}):e.jsx("div",{dangerouslySetInnerHTML:{__html:o?.content||""}})}),!!c.length&&e.jsx("div",{className:"mt-10 flex justify-end",children:e.jsx("button",{onClick:A,className:"inline-flex items-center gap-2 rounded-lg border bg-white px-4 py-2 text-sm font-medium shadow-soft hover:bg-muted transition-colors disabled:opacity-60",disabled:!S,title:S?void 0:"Najpierw odhacz wszystkie sekcje",children:"Zakocz lekcj"})})]})}),e.jsx("aside",{children:e.jsxs("nav",{className:"border rounded-[14px] p-4 bg-white dark:bg-background/60 lg:sticky lg:top-28",children:[e.jsx("h2",{className:"text-sm font-semibold mb-3",children:"Spis treci"}),a?e.jsx("div",{className:"h-4 w-40 rounded bg-muted/60 animate-pulse"}):c.length?e.jsx("ol",{className:"space-y-1.5 text-sm",children:c.map((E,M)=>{const O=!!h[E.id],Q=!O&&M===N,U=!(N===-1||M<=N)&&!O,F=()=>{U||document.getElementById(E.id)?.scrollIntoView({behavior:"smooth"})};return e.jsxs("li",{className:"flex items-center gap-1.5",children:[U?e.jsx(vn,{className:"h-3.5 w-3.5 text-muted-foreground"}):O?e.jsx(Ve,{className:"h-3.5 w-3.5 text-emerald-600"}):e.jsx(va,{className:"h-3.5 w-3.5"}),e.jsxs("button",{onClick:F,className:["flex-1 text-left px-2 py-1 rounded transition-colors",U?"text-muted-foreground cursor-not-allowed":"hover:bg-muted",O?"text-emerald-700":"",Q?"font-semibold underline":""].join(" "),disabled:U,children:[String(M+1).padStart(2,"0"),". ",E.title||`Sekcja ${M+1}`]})]},E.id)})}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"Brak sekcji."})]})})]}),y&&e.jsx(dD,{quiz:y,onClose:()=>w(null),onPass:C}),j&&e.jsx(uD,{lessonTitle:o?.title||"Lekcja",courseId:t,timeSpent:Math.floor((Date.now()-T)/1e3),sectionsCount:c.length,quizzesCompleted:Object.keys(b).length,pointsEarned:5,nextLessonPath:void 0})]})},hD=[e.jsx(W,{path:"/courses/:courseId/lesson/:lessonId",element:e.jsx(mD,{})},"lesson-view")],pD=()=>{const{courseId:t,quizId:s}=vt(),n=se(),{refetch:r}=qn(),[i,a]=ne.useState(0),[o,l]=ne.useState({}),[c,d]=ne.useState(null),[m,u]=ne.useState(!1),[h,p]=ne.useState([]),[b,f]=ne.useState(!0),{data:y,isLoading:w}=Xe({resource:"activities",id:s,meta:{select:"*, topics(title, course_id, courses(title, icon_emoji))"}});ne.useEffect(()=>{(async()=>{if(s)try{await J.rpc("start_activity",{p_activity_id:parseInt(s)}),f(!0);const{data:O,error:Q}=await J.rpc("get_quiz_questions",{p_activity_id:parseInt(s)});if(Q)throw Q;const L=typeof O=="string"?JSON.parse(O):O;p(Array.isArray(L)?L:[])}catch(O){console.error("Quiz init error:",O),K.error("Bd podczas adowania quizu")}finally{f(!1)}})()},[s]),ne.useEffect(()=>{y?.data?.time_limit&&c===null&&d(y.data.time_limit*60)},[y]),ne.useEffect(()=>{if(c!==null&&c>0){const M=setTimeout(()=>d(c-1),1e3);return()=>clearTimeout(M)}else c===0&&S()},[c]);const j=y?.data,v=h[i],T=h.length>0?(i+1)/h.length*100:0,z=M=>{if(M.type)switch(M.type){case"single_choice":return"single";case"multiple_choice":return"multiple";case"true_false":return"true_false"}return"single"},k=M=>{switch(M){case"single":return{label:"Jednokrotny wyb贸r",icon:Re};case"multiple":return{label:"Wielokrotny wyb贸r",icon:Xs};case"true_false":return{label:"Prawda/Fasz",icon:yt}}},N=(M,O,Q)=>{if(Q){const L=o[M]||[],U=L.includes(O)?L.filter(F=>F!==O):[...L,O];l(F=>({...F,[M]:U}))}else l(L=>({...L,[M]:O}))},S=async()=>{u(!0);try{const M=Object.entries(o).flatMap(([L,U])=>Array.isArray(U)?U.map(F=>({question_id:parseInt(L),option_id:F})):[{question_id:parseInt(L),option_id:U}]);console.log("Submitting quiz answers:",M);const{data:O,error:Q}=await J.rpc("finish_quiz",{p_activity_id:parseInt(s),p_answers:M});if(Q)throw Q;O&&(console.log("Quiz finished successfully:",O),ci("get_course_structure"),ci("get_my_courses"),ci("get_my_stats"),setTimeout(()=>{console.log("Forcing stats refresh..."),r()},500),n(`/student/courses/${t}/quiz/${s}/result`,{state:{courseId:t,quizId:s,result:{...O,passing_score:j?.passing_score||70,max_attempts:j?.max_attempts,attempts_used:j?.attempts||1}}}))}catch(M){console.error("Failed to submit quiz:",M),K.error("Nie udao si przesa odpowiedzi")}finally{u(!1)}};if(w||b)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})});if(!v)return null;const _=z(v),g=k(_),C=_==="multiple",A=o[v.id],E=C?Array.isArray(A)&&A.length>0:A!==void 0;return e.jsxs("div",{className:"container mx-auto px-4 py-6 sm:py-8 max-w-3xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("button",{onClick:()=>n(`/student/courses/${t}`),className:"flex items-center gap-2 text-muted-foreground hover:text-foreground transition-colors",children:[e.jsx(Ce,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Zakocz quiz"})]}),c!==null&&e.jsxs("div",{className:q("flex items-center gap-2 px-3 py-1.5 rounded-full text-sm font-medium",c<60?"bg-red-100 text-red-700":"bg-muted text-foreground"),children:[e.jsx(Te,{className:"w-4 h-4"}),Math.floor(c/60),":",String(c%60).padStart(2,"0")]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold mb-2",children:j?.title}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("span",{children:["Pytanie ",i+1," z ",h.length]}),e.jsx("span",{children:""}),e.jsxs("span",{children:[v.points," pkt"]}),e.jsx("span",{children:""}),e.jsxs(H,{variant:"outline",className:"text-xs",children:[e.jsx(g.icon,{className:"w-3 h-3 mr-1"}),g.label]})]})]}),e.jsx("div",{className:"h-1 bg-muted rounded-full overflow-hidden mb-8",children:e.jsx(ke.div,{initial:{width:0},animate:{width:`${T}%`},className:"h-full bg-primary"})}),e.jsx(nT,{mode:"wait",children:e.jsx(ke.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:-10},transition:{duration:.2},children:e.jsxs("div",{className:"bg-card rounded-2xl border p-8 mb-8",children:[e.jsx("h2",{className:"text-lg font-medium mb-6",children:v.question}),C&&e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"锔 Zaznacz wszystkie poprawne odpowiedzi"}),e.jsx("div",{className:"space-y-3",children:v.options.map(M=>{const O=C?Array.isArray(A)&&A.includes(M.id):A===M.id;return e.jsx("label",{className:q("block p-4 rounded-xl border-2 cursor-pointer transition-all",O?"border-primary bg-primary/5":"border-border hover:border-muted-foreground"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:C?"checkbox":"radio",name:`question-${v.id}`,value:M.id,checked:O,onChange:()=>N(v.id,M.id,C),className:"sr-only"}),e.jsxs("div",{className:q("flex items-center justify-center flex-shrink-0",C?q("w-5 h-5 rounded border-2",O?"border-primary bg-primary text-primary-foreground":"border-muted-foreground"):q("w-5 h-5 rounded-full border-2",O?"border-primary":"border-muted-foreground")),children:[C&&O&&e.jsx(Ve,{className:"w-3 h-3"}),!C&&O&&e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-primary"})]}),e.jsx("span",{className:"flex-1",children:M.text})]})},M.id)})})]})},v.id)}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("button",{onClick:()=>a(Math.max(0,i-1)),disabled:i===0,className:q("flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-all",i===0?"text-muted-foreground cursor-not-allowed":"text-foreground hover:bg-muted"),children:[e.jsx(Ce,{className:"w-4 h-4"}),"Poprzednie"]}),e.jsx("div",{className:"flex gap-2",children:h.map((M,O)=>{const Q=o[h[O]?.id],L=Array.isArray(Q)?Q.length>0:Q!==void 0;return e.jsx("button",{onClick:()=>a(O),className:q("w-2 h-2 rounded-full transition-all",O===i?"bg-primary w-8":L?"bg-muted-foreground":"bg-muted")},O)})}),i<h.length-1?e.jsxs("button",{onClick:()=>a(i+1),disabled:!E,className:q("flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-all",E?"bg-primary text-primary-foreground hover:bg-primary/90":"bg-muted text-muted-foreground cursor-not-allowed"),children:["Nastpne",e.jsx(le,{className:"w-4 h-4"})]}):e.jsxs("button",{onClick:S,disabled:m||Object.keys(o).length<h.length,className:q("flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-all",m||Object.keys(o).length<h.length?"bg-muted text-muted-foreground cursor-not-allowed":"bg-green-500 text-white hover:bg-green-600"),children:[m?"Przesyanie...":"Zakocz quiz",e.jsx(Ve,{className:"w-4 h-4"})]})]})]})},fD=()=>{const t=se(),s=Ei(),{courseId:n,quizId:r,result:i}=s.state,a=j=>{const v=Math.floor(j/60),T=j%60;return`${v}:${String(T).padStart(2,"0")}`},o=j=>j>=90?"text-green-600":j>=70?"text-yellow-600":"text-red-600",l=j=>j<30?1:j<50?2:j<70?5:10+Math.floor((j-70)/3),c=i.max_attempts&&(i.attempts_used??0)<i.max_attempts,d=i.score===100,m=i.user_points||0,u=i.next_level_points||((i.user_level||1)+1)*100,h=m%100,p=u-m,b=h/100*100,f=i.question_results?.filter(j=>j.is_correct).length||0,y=i.question_results?.length||0,w=y-f;return e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-3xl",children:[e.jsxs(ke.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.3},className:"space-y-6",children:[e.jsx(D,{children:e.jsxs(P,{className:"pt-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:q("inline-flex items-center justify-center w-16 h-16 rounded-full mb-4",i.passed?"bg-green-100":"bg-orange-100"),children:e.jsx($e,{className:q("w-8 h-8",i.passed?"text-green-600":"text-orange-600")})}),e.jsx("h1",{className:"text-2xl font-bold mb-2",children:i.passed?"Quiz zaliczony!":"Niezaliczone, ale zdobywasz punkty!"}),e.jsx("p",{className:"text-muted-foreground",children:i.passed?d?"Perfekcyjny wynik! Jeste mistrzem!":"Gratulacje! wietnie Ci poszo.":`Zdobywasz ${i.points_earned} punkt贸w za swoj pr贸b!`})]}),e.jsx("div",{className:"bg-muted/50 rounded-xl p-6 mb-6",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:q("text-5xl font-bold mb-2",o(i.score)),children:[i.score,"%"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Tw贸j wynik"})]})}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-1",children:[e.jsx(Ye,{className:"w-4 h-4 text-yellow-600"}),e.jsx("span",{className:"font-semibold text-lg",children:i.points_earned})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Punkt贸w zdobytych"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-1",children:[e.jsx(Te,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"font-semibold",children:a(i.time_spent)})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Czas"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-1",children:[e.jsx(Se,{className:"w-4 h-4 text-purple-600"}),e.jsxs("span",{className:"font-semibold",children:[i.passing_score,"%"]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Pr贸g zaliczenia"})]})]})]})}),e.jsxs(D,{children:[e.jsx($,{children:e.jsxs(R,{className:"text-lg flex items-center gap-2",children:[e.jsx(gr,{className:"w-5 h-5"}),"Postp poziomu"]})}),e.jsx(P,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsxs("span",{className:"font-medium",children:["Poziom ",i.user_level||1]}),e.jsxs("span",{className:"text-muted-foreground",children:[m," / ",u," punkt贸w"]}),e.jsxs("span",{className:"font-medium",children:["Poziom ",(i.user_level||1)+1]})]}),e.jsx(Qt,{value:b,className:"h-3"}),e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Do nastpnego poziomu pozostao:",e.jsxs("span",{className:"font-semibold text-foreground ml-1",children:[p," punkt贸w"]})]}),i.points_earned>0&&e.jsxs("p",{className:"text-xs text-green-600 dark:text-green-400 mt-1",children:["+",i.points_earned," punkt贸w z tego quizu!"]})]})]})})]}),i.question_results&&i.question_results.length>0&&e.jsxs(D,{children:[e.jsx($,{children:e.jsxs(R,{className:"text-lg flex items-center justify-between",children:[e.jsx("span",{children:"Analiza odpowiedzi"}),e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("span",{className:"flex items-center gap-1 text-green-600",children:[e.jsx(Re,{className:"w-4 h-4"}),f]}),e.jsxs("span",{className:"flex items-center gap-1 text-red-600",children:[e.jsx(Tl,{className:"w-4 h-4"}),w]})]})]})}),e.jsxs(P,{children:[e.jsx("div",{className:"space-y-3",children:i.question_results.map((j,v)=>e.jsx(ke.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:v*.05},className:q("p-4 rounded-lg border transition-all",j.is_correct?"bg-green-50 dark:bg-green-950/30 border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-950/30 border-red-200 dark:border-red-800"),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:j.is_correct?e.jsx(Re,{className:"w-5 h-5 text-green-600"}):e.jsx(Tl,{className:"w-5 h-5 text-red-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h4",{className:"font-medium text-sm",children:["Pytanie ",v+1]}),e.jsxs("span",{className:q("text-sm font-semibold",j.is_correct?"text-green-600":"text-red-600"),children:[j.is_correct?`+${j.points}`:"0"," pkt"]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:j.question_text}),e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-muted-foreground min-w-[120px]",children:"Twoja odpowied藕:"}),e.jsx("span",{className:q("font-medium flex-1",j.is_correct?"text-green-700 dark:text-green-400":"text-red-700 dark:text-red-400"),children:Array.isArray(j.your_answer)?j.your_answer.join(", "):j.your_answer||"Brak odpowiedzi"})]}),!j.is_correct&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-muted-foreground min-w-[120px]",children:"Poprawna odpowied藕:"}),e.jsx("span",{className:"font-medium text-green-700 dark:text-green-400 flex-1",children:Array.isArray(j.correct_answer)?j.correct_answer.join(", "):j.correct_answer})]})]})]})]})},j.question_id))}),e.jsxs("div",{className:"mt-6 p-4 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Skuteczno:"}),e.jsx("span",{className:"font-semibold",children:y>0?`${Math.round(f/y*100)}%`:"0%"})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm mt-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"Zdobyte punkty:"}),e.jsxs("span",{className:"font-semibold",children:[i.question_results.filter(j=>j.is_correct).reduce((j,v)=>j+v.points,0)," / ",i.question_results.reduce((j,v)=>j+v.points,0)]})]})]})]})]}),e.jsxs(D,{className:q(i.points_earned>0?"border-primary/50":""),children:[e.jsx($,{children:e.jsxs(R,{className:"text-lg flex items-center gap-2",children:[e.jsx(xt,{className:"w-5 h-5"}),"Jak obliczylimy Twoje punkty"]})}),e.jsxs(P,{children:[e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-muted-foreground",children:["Punkty bazowe za wynik ",i.score,"%:"]}),e.jsxs("span",{className:"font-medium tabular-nums",children:[i.base_points||l(i.score)," pkt"]})]}),i.multipliers?.quiz_multiplier&&i.multipliers.quiz_multiplier>1&&e.jsxs("div",{className:"flex justify-between items-center text-green-600 dark:text-green-400",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Os,{className:"w-3 h-3"}),'Ulepszenie "Szybki umys":']}),e.jsxs("span",{className:"font-medium",children:["",i.multipliers.quiz_multiplier]})]}),i.streak_days&&i.streak_days>0&&i.multipliers?.streak_multiplier&&e.jsxs("div",{className:"flex justify-between items-center text-orange-600 dark:text-orange-400",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(fs,{className:"w-3 h-3"}),"Streak ",i.streak_days," dni:"]}),e.jsxs("span",{className:"font-medium",children:["",i.multipliers.streak_multiplier.toFixed(1)]})]}),d&&i.perfect_bonus&&i.perfect_bonus>0&&e.jsxs("div",{className:"flex justify-between items-center text-purple-600 dark:text-purple-400",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(vb,{className:"w-3 h-3"}),"Bonus perfekcjonisty:"]}),e.jsxs("span",{className:"font-medium",children:["+",i.perfect_bonus," pkt"]})]}),i.multipliers?.min_points&&i.score<30&&e.jsxs("div",{className:"flex justify-between items-center text-blue-600 dark:text-blue-400",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(xr,{className:"w-3 h-3"}),'Gwarancja "Druga szansa":']}),e.jsxs("span",{className:"font-medium",children:["min. ",i.multipliers.min_points," pkt"]})]}),e.jsx("div",{className:"pt-2 mt-2 border-t border-border/50",children:e.jsxs("div",{className:"flex justify-between items-center font-semibold",children:[e.jsx("span",{children:"cznie zdobywasz:"}),e.jsxs("span",{className:"text-lg text-primary",children:[i.points_earned," punkt贸w"]})]})})]}),(!i.multipliers?.quiz_multiplier||i.multipliers.quiz_multiplier===1)&&e.jsx("div",{className:"mt-3 p-2 bg-amber-50 dark:bg-amber-900/20 rounded-md",children:e.jsxs("p",{className:"text-xs text-amber-700 dark:text-amber-400 flex items-center gap-1",children:[e.jsx(yt,{className:"w-3 h-3 flex-shrink-0"}),"Wskaz贸wka: Kup ulepszenia w zakadce Idle aby zwikszy punkty z quiz贸w!"]})})]})]}),!i.passed&&e.jsx(D,{className:"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800",children:e.jsxs(P,{className:"pt-6",children:[e.jsx("h4",{className:"font-medium text-sm mb-1 text-blue-700 dark:text-blue-400",children:"Nie poddawaj si! "}),e.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-300",children:i.score>=60?`wietnie Ci idzie! Brakuje tylko ${i.passing_score-i.score}% do zaliczenia.`:i.score>=40?"Ju偶 prawie poowa! Przejrzyj materiay i spr贸buj ponownie.":"Ka偶da pr贸ba to krok naprz贸d. Wr贸 do materia贸w i pr贸buj dalej!"})]})}),e.jsxs("div",{className:"flex gap-3",children:[i.passed?e.jsxs("button",{onClick:()=>t(`/student/courses/${n}`),className:"flex-1 inline-flex items-center justify-center gap-2 rounded-lg bg-primary px-4 py-2.5 text-primary-foreground hover:bg-primary/90 focus-ring",children:["Kontynuuj kurs",e.jsx(le,{className:"w-4 h-4"})]}):e.jsx(e.Fragment,{children:c?e.jsxs("button",{onClick:()=>t(`/student/courses/${n}/quiz/${r}`),className:"flex-1 inline-flex items-center justify-center gap-2 rounded-lg bg-primary px-4 py-2.5 text-primary-foreground hover:bg-primary/90 focus-ring",children:[e.jsx(xr,{className:"w-4 h-4"}),"Spr贸buj ponownie"]}):e.jsx("button",{onClick:()=>t(`/student/courses/${n}`),className:"flex-1 rounded-lg border px-4 py-2.5 hover:bg-muted/50 focus-ring",children:"Wr贸 do kursu"})}),e.jsx("button",{onClick:()=>t("/student/dashboard"),className:"px-4 py-2.5 rounded-lg border hover:bg-muted/50 focus-ring",children:"Dashboard"})]}),i.max_attempts&&e.jsxs("p",{className:"text-center text-xs text-muted-foreground",children:["Wykorzystane pr贸by: ",i.attempts_used," z ",i.max_attempts]})]}),d&&e.jsx(ke.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5},className:"mt-4 text-center",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:" Mistrzostwo! Twoja wiedza jest imponujca!"})})]})},xD=[e.jsx(W,{path:"/courses/:courseId/quiz/:quizId",element:e.jsx(pD,{})},"quiz-take"),e.jsx(W,{path:"/courses/:courseId/quiz/:quizId/result",element:e.jsx(fD,{})},"quiz-result")],gD={"":Ye,"":Tr,"":Os,"":kb,"":Nb},jD=()=>e.jsxs("div",{className:"rounded-2xl border bg-card p-6 shadow-soft animate-pulse",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-muted/70"}),e.jsxs("div",{children:[e.jsx("div",{className:"h-4 w-40 rounded bg-muted/70"}),e.jsx("div",{className:"mt-2 h-3 w-24 rounded bg-muted/60"})]})]}),e.jsx("div",{className:"h-5 w-16 rounded-full bg-muted/60"})]}),e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsx("div",{className:"h-3 w-full rounded bg-muted/60"}),e.jsx("div",{className:"h-3 w-2/3 rounded bg-muted/60"})]}),e.jsx("div",{className:"h-10 w-full rounded-lg bg-muted/60"})]}),yD=()=>{const{stats:t,refetch:s}=qn(),{data:n,isLoading:r,refetch:i}=Xi("get_idle_upgrades"),a=async l=>{try{const{data:c,error:d}=await J.rpc("buy_idle_upgrade",{p_upgrade_id:l});if(d)throw d;c&&(K.success(`Ulepszenie zakupione! Poziom ${c.new_level}`),s(),i())}catch{K.error("Niewystarczajca ilo punkt贸w")}},o=n||[];return e.jsxs("div",{className:"container mx-auto px-4 py-6 sm:py-8 space-y-6 sm:space-y-8 pb-24 lg:pb-8",children:[e.jsxs(ke.section,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.45},className:"relative overflow-hidden rounded-2xl border",children:[e.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/[0.12] via-secondary/[0.10] to-accent/[0.12]"}),e.jsx("div",{className:"absolute inset-0 opacity-[0.06]",style:{backgroundImage:`
                linear-gradient(to right, hsl(var(--ring)/0.35) 1px, transparent 1px),
                linear-gradient(to bottom, hsl(var(--ring)/0.35) 1px, transparent 1px)
              `,backgroundSize:"28px 28px"}})]}),e.jsx("div",{className:"relative z-10 p-4 sm:p-6 md:p-8",children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-12 md:items-center",children:[e.jsxs("div",{className:"md:col-span-4 space-y-2",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight",children:"Ulepszenia"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Inwestuj punkty, aby zwikszy tempo zdobywania kolejnych."})]}),e.jsxs("div",{className:"md:col-span-8 grid grid-cols-3 gap-4 md:gap-6",children:[e.jsxs("div",{className:"rounded-xl border bg-card p-5 shadow-soft",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Punkty / h"}),e.jsx(xt,{className:"h-4 w-4 text-accent"})]}),e.jsx("div",{className:"mt-2 flex items-end gap-2",children:e.jsx("span",{className:"text-4xl md:text-5xl font-semibold text-accent leading-none tabular-nums",children:e.jsx(nt,{value:t.idle_rate})})}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:"Premia za obecno."})]}),e.jsxs("div",{className:"rounded-xl border bg-card p-5 shadow-soft",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Twoje punkty"}),e.jsx(Ye,{className:"h-4 w-4 text-primary"})]}),e.jsxs("div",{className:"mt-2 flex items-end gap-2",children:[e.jsx("span",{className:"text-4xl md:text-5xl font-semibold text-primary leading-none tabular-nums",children:e.jsx(nt,{value:t.points})}),e.jsx("span",{className:"mb-[2px] text-sm text-muted-foreground",children:"pkt"})]}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:"Wydaj je na ulepszenia poni偶ej."})]}),e.jsxs("div",{className:"rounded-xl border bg-card p-5 shadow-soft",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Do kolejnego poziomu"}),e.jsx(Tr,{className:"h-4 w-4 text-secondary"})]}),e.jsx("div",{className:"mt-3",children:e.jsx(_n,{value:t.points%100})}),e.jsxs("p",{className:"mt-1 text-xs text-muted-foreground",children:["Pozostao ",100-t.points%100," pkt"]})]})]})]})})]}),e.jsxs(ke.section,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.4,delay:.05},className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between gap-4",children:e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"text-lg sm:text-xl md:text-2xl font-semibold tracking-tight",children:"Dostpne ulepszenia"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"Wybierz i zwiksz swoje tempo zdobywania punkt贸w."})]})}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 sm:gap-5",children:[r&&Array.from({length:6}).map((l,c)=>e.jsx(jD,{},c)),!r&&o.map((l,c)=>{const d=t.points>=l.next_cost,m=gD[l.icon]||Ye;return e.jsxs($r,{index:c,className:q("group relative rounded-2xl border bg-card p-5 shadow-soft hover:bg-muted/40 transition-colors"),children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-muted flex items-center justify-center shrink-0",children:e.jsx(m,{className:"w-6 h-6 text-muted-foreground"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h4",{className:"font-semibold text-sm sm:text-base text-foreground line-clamp-2",children:l.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Poziom ",l.current_level]})]})]}),e.jsx("span",{className:q("inline-flex items-center gap-1 rounded-full px-2.5 py-1 text-[11px] font-semibold border",d?"border-primary/30 text-primary":"border-muted-foreground/25 text-muted-foreground"),children:d?"Dostpne":"Za drogie"})]}),e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-xs sm:text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Aktualny bonus"}),e.jsxs("span",{className:"font-medium text-green-600 dark:text-green-400",children:["+",e.jsx(nt,{value:l.total_bonus})," pkt/h"]})]}),e.jsxs("div",{className:"flex justify-between text-xs sm:text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Nastpny poziom"}),e.jsxs("span",{className:"font-medium",children:["+",l.bonus_per_level," pkt/h"]})]})]}),e.jsxs(ke.button,{whileHover:d?{scale:1.02}:{},whileTap:d?{scale:.98}:{},onClick:()=>a(l.id),disabled:!d,className:q("mt-4 w-full py-2.5 sm:py-3 rounded-lg font-medium focus-ring transition-colors",d?"bg-primary text-primary-foreground hover:bg-primary/90":"bg-muted text-muted-foreground cursor-not-allowed"),title:d?"Kup ulepszenie":"Brakuje punkt贸w",children:["Ulepsz za ",e.jsx(nt,{value:l.next_cost})," pkt"]})]},l.id)})]})]})]})},bD=[e.jsx(W,{path:"/gamification",element:e.jsx(yD,{})},"gamification")],wD=()=>e.jsx("div",{className:"rounded-2xl border bg-card p-4 shadow-soft animate-pulse",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-8 h-5 rounded bg-muted/60"}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-muted/70"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-4 w-40 rounded bg-muted/60"}),e.jsx("div",{className:"mt-2 h-3 w-28 rounded bg-muted/50"})]}),e.jsx("div",{className:"h-5 w-16 rounded bg-muted/60"})]})}),vD=()=>{const{data:t}=We(),[s,n]=ne.useState("all"),{data:r,isLoading:i,refetch:a,error:o}=Xi("get_leaderboard",{p_limit:20,p_filter:s});ne.useEffect(()=>{let d=!1,m=!1;return(async()=>{if(!(d||m)){m=!0;try{await a()}finally{m=!1}}})(),()=>{d=!0}},[s]);const l=r||[],c=d=>{switch(d){case 1:return e.jsx($e,{className:"w-5 h-5 text-yellow-500"});case 2:return e.jsx(tp,{className:"w-5 h-5 text-gray-400"});case 3:return e.jsx(Rs,{className:"w-5 h-5 text-orange-500"});default:return e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:d})}};return e.jsxs("div",{className:"container mx-auto px-4 py-6 sm:py-8 space-y-6 sm:space-y-8 pb-24 lg:pb-8",children:[e.jsxs(ke.section,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.45},className:"relative overflow-hidden rounded-2xl border",children:[e.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/[0.12] via-secondary/[0.10] to-accent/[0.12]"}),e.jsx("div",{className:"absolute inset-0 opacity-[0.06]",style:{backgroundImage:`
                linear-gradient(to right, hsl(var(--ring)/0.35) 1px, transparent 1px),
                linear-gradient(to bottom, hsl(var(--ring)/0.35) 1px, transparent 1px)
              `,backgroundSize:"28px 28px"}})]}),e.jsx("div",{className:"relative z-10 p-4 sm:p-6 md:p-8",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-end md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight",children:"Ranking"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Top 20 u偶ytkownik贸w wedug punkt贸w."})]}),e.jsx("div",{className:"bg-muted rounded-lg p-1 inline-flex gap-1",children:[{value:"all",label:"Wszyscy"},{value:"students",label:"Uczniowie"},{value:"teachers",label:"Nauczyciele"}].map(d=>e.jsx("button",{onClick:()=>n(d.value),className:q("px-3 sm:px-4 py-1.5 rounded-md text-sm font-medium transition-colors",s===d.value?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:d.label},d.value))})]})})]}),e.jsxs(ke.section,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.4,delay:.05},className:"space-y-2",children:[i&&Array.from({length:4}).map((d,m)=>e.jsx(wD,{},m)),!i&&(o||l.length===0)&&e.jsxs("div",{className:"rounded-2xl border bg-card p-8 text-center shadow-soft",children:[e.jsx("div",{className:"text-4xl",children:"ゲ"}),e.jsx("h4",{className:"mt-3 text-base sm:text-lg font-semibold",children:"Brak wynik贸w"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:o?"Nie udao si pobra rankingu.":"Brak danych dla wybranego filtra."}),e.jsxs("button",{onClick:()=>a(),className:"mt-4 inline-flex items-center gap-2 rounded-lg border px-3 py-2 text-sm hover:bg-primary/5 focus-ring",children:[e.jsx(zb,{className:"w-4 h-4"}),"Spr贸buj ponownie"]})]}),!i&&l.length>0&&l.map((d,m)=>{const u=d.user_id===t?.id,h=d.rank<=3;return e.jsxs($r,{index:m,className:q("flex items-center gap-4 p-4 rounded-2xl border shadow-soft transition-colors",u?"bg-primary text-primary-foreground border-primary/40":h?"bg-muted/50 border-border":"bg-card hover:bg-muted/40 border-border"),children:[e.jsx("div",{className:"w-8 flex justify-center",children:c(d.rank)}),e.jsx("div",{className:q("w-10 h-10 rounded-full flex items-center justify-center font-semibold shrink-0",u?"bg-primary-foreground text-primary":h?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"),"aria-label":`Avatar u偶ytkownika ${d.full_name||"U偶ytkownik"}`,title:d.full_name||"U偶ytkownik",children:d.full_name?.charAt(0)??"U"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"font-medium truncate",children:[d.full_name||"U偶ytkownik",u&&e.jsx("span",{className:"ml-2 text-sm opacity-80",children:"(Ty)"})]}),e.jsxs("div",{className:q("text-sm",u?"text-primary-foreground/80":"text-muted-foreground"),children:["Poziom ",d.level,"  Seria ",d.streak," dni"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-semibold tabular-nums",children:e.jsx(nt,{value:d.points})}),e.jsx("div",{className:q("text-xs",u?"text-primary-foreground/80":"text-muted-foreground"),children:"punkt贸w"})]})]},d.user_id||`${d.rank}-${m}`)})]})]})},ND=[e.jsx(W,{path:"/leaderboard",element:e.jsx(vD,{})},"leaderboard")],ei=[{id:1,icon:fs,title:"Pierwszy Krok",description:"Ukocz pierwsz lekcj",unlocked:!0,rarity:"common",unlockedAt:"2024-01-15",progress:100},{id:2,icon:Sn,title:"Perfekcjonista",description:"Zdobd藕 100% w 10 quizach",unlocked:!0,rarity:"rare",unlockedAt:"2024-02-20",progress:100},{id:3,icon:Ye,title:"Byskawica",description:"Ukocz 5 lekcji w jeden dzie",unlocked:!1,rarity:"epic",progress:60},{id:4,icon:$e,title:"Mistrz",description:"Osignij poziom 50",unlocked:!1,rarity:"legendary",progress:24},{id:5,icon:Se,title:"Snajper",description:"Odpowiedz poprawnie na 100 pyta z rzdu",unlocked:!1,rarity:"epic",progress:45},{id:6,icon:Tr,title:"Rakieta",description:"Ukocz kurs w mniej ni偶 tydzie",unlocked:!1,rarity:"rare",progress:0}],fh={common:{bg:"bg-muted",ring:"ring-1 ring-border",label:"Pospolite",badge:"border border-muted-foreground/20 text-muted-foreground bg-background/60"},rare:{bg:"bg-blue-500/10",ring:"ring-1 ring-blue-500/30",label:"Rzadkie",badge:"border border-blue-500/30 text-blue-600 dark:text-blue-400"},epic:{bg:"bg-purple-500/10",ring:"ring-1 ring-purple-500/30",label:"Epiczne",badge:"border border-purple-500/30 text-purple-600 dark:text-purple-400"},legendary:{bg:"bg-orange-500/10",ring:"ring-1 ring-orange-500/30",label:"Legendarne",badge:"border border-orange-500/30 text-orange-600 dark:text-orange-400"}},kD=()=>{const t=ei.filter(r=>r.unlocked).length,s=ei.length,n=Math.round(t/s*100);return e.jsxs("div",{className:"container mx-auto px-4 py-6 sm:py-8 space-y-6 sm:space-y-8 pb-24 lg:pb-8",children:[e.jsxs(ke.section,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.45},className:"relative overflow-hidden rounded-2xl border",children:[e.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/[0.12] via-secondary/[0.10] to-accent/[0.12]"}),e.jsx("div",{className:"absolute inset-0 opacity-[0.06]",style:{backgroundImage:`
                linear-gradient(to right, hsl(var(--ring)/0.35) 1px, transparent 1px),
                linear-gradient(to bottom, hsl(var(--ring)/0.35) 1px, transparent 1px)
              `,backgroundSize:"28px 28px"}})]}),e.jsxs("div",{className:"relative z-10 p-4 sm:p-6 md:p-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-end md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight",children:"Osignicia"}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Odblokowano"," ",e.jsx("span",{className:"font-semibold tabular-nums",children:t})," ","z"," ",e.jsx("span",{className:"font-semibold tabular-nums",children:s})," ","(",n,"%)"]})]}),e.jsxs("div",{className:"w-full md:w-96",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs mb-1.5",children:[e.jsx("span",{className:"text-muted-foreground",children:"Postp osigni"}),e.jsxs("span",{className:"font-medium tabular-nums",children:[n,"%"]})]}),e.jsx(_n,{value:n})]})]}),e.jsx("div",{className:"mt-4 grid grid-cols-2 sm:grid-cols-4 gap-2",children:Object.entries(fh).map(([r,i])=>{const a=ei.filter(l=>l.rarity===r&&l.unlocked).length,o=ei.filter(l=>l.rarity===r).length;return e.jsxs("div",{className:q("rounded-xl border bg-card/70 backdrop-blur-sm p-3 shadow-soft"),children:[e.jsxs("p",{className:"text-lg font-semibold tabular-nums",children:[a,"/",o]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:i.label})]},r)})})]})]}),e.jsx(ke.section,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.4,delay:.05},className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-5",children:ei.map((r,i)=>{const a=fh[r.rarity],o=r.icon,l=r.unlocked?e.jsx("span",{className:q("inline-flex items-center gap-1 rounded-full px-2.5 py-1 text-[11px] font-semibold",a.badge),children:"Odblokowane"}):e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border border-primary/30 text-primary px-2.5 py-1 text-[11px] font-semibold",children:[r.progress,"%"]});return e.jsxs($r,{index:i,className:q("group relative rounded-2xl border bg-card p-5 shadow-soft hover:bg-muted/40 transition-colors",!r.unlocked&&"opacity-95"),children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("div",{className:q("w-12 h-12 rounded-xl flex items-center justify-center shrink-0",a.bg,a.ring),children:e.jsx(o,{className:"w-6 h-6"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"font-semibold text-sm sm:text-base text-foreground line-clamp-2",children:r.title}),e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2",children:r.description})]})]}),l]}),e.jsx("div",{className:"mt-4",children:r.unlocked?e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Odblokowano:"," ",e.jsx("span",{className:"font-medium",children:new Date(r.unlockedAt).toLocaleDateString("pl-PL")})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between text-xs mb-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"Postp"}),e.jsxs("span",{className:"font-medium tabular-nums",children:[r.progress,"%"]})]}),e.jsx(_n,{value:r.progress})]})})]},r.id)})})]})},zD=[e.jsx(W,{path:"/achievements",element:e.jsx(kD,{})},"achievements")],SD=()=>{const{data:t}=We(),{stats:s}=qn(),n=t?.full_name||t?.name||t?.email||"U偶ytkownik",r=(t?.full_name||t?.name||"U").split(" ").map(o=>o[0]).slice(0,2).join("").toUpperCase()||"U",i=(()=>{const o=t?.created_at;return(o?new Date(o):new Date).toLocaleDateString("pl-PL")})(),a=[{icon:$e,label:"Punkty",value:s.points,iconColor:"text-primary",highlight:"primary",counter:!0},{icon:Se,label:"Ukoczone quizy",value:s.quizzes_completed??0,iconColor:"text-green-600 dark:text-green-400",counter:!1},{icon:Sn,label:"Perfekcyjne wyniki",value:s.perfect_scores??0,iconColor:"text-yellow-600 dark:text-yellow-400",counter:!1},{icon:fs,label:"Najdu偶sza seria",value:`${s.streak??0} dni`,iconColor:"text-destructive",counter:!1},{icon:Te,label:"Czas nauki",value:`${Math.max(0,Math.floor((s.total_time??0)/60))}h`,iconColor:"text-blue-600 dark:text-blue-400",counter:!1},{icon:$e,label:"Poziom",value:`Poziom ${s.level??1}`,iconColor:"text-secondary",counter:!1}];return e.jsxs("div",{className:"container mx-auto px-4 py-6 sm:py-8 space-y-6 sm:space-y-8 pb-24 lg:pb-8",children:[e.jsxs(ke.section,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.45},className:"relative overflow-hidden rounded-2xl border",children:[e.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/[0.12] via-secondary/[0.10] to-accent/[0.12]"}),e.jsx("div",{className:"absolute inset-0 opacity-[0.06]",style:{backgroundImage:`
                linear-gradient(to right, hsl(var(--ring)/0.35) 1px, transparent 1px),
                linear-gradient(to bottom, hsl(var(--ring)/0.35) 1px, transparent 1px)
              `,backgroundSize:"28px 28px"}})]}),e.jsx("div",{className:"relative z-10 p-4 sm:p-6 md:p-8",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-6",children:[e.jsxs("div",{className:"flex items-start gap-4 sm:gap-6",children:[e.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 rounded-2xl bg-primary text-primary-foreground flex items-center justify-center text-xl sm:text-2xl font-semibold shadow-soft",children:r}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight",children:n}),e.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-x-4 gap-y-1 text-sm text-muted-foreground",children:[t?.email&&e.jsxs("div",{className:"flex items-center gap-1.5 min-w-0",children:[e.jsx(io,{className:"w-4 h-4 shrink-0"}),e.jsx("span",{className:"truncate",children:t.email})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(Tt,{className:"w-4 h-4"}),e.jsxs("span",{children:["Doczy ",i]})]})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("button",{className:"inline-flex items-center gap-2 rounded-lg border px-3 py-2 text-sm hover:bg-primary/5 focus-ring",children:[e.jsx(Sb,{className:"w-4 h-4"}),"Edytuj profil"]}),e.jsx("button",{className:"inline-flex items-center gap-2 rounded-lg bg-primary px-3 py-2 text-sm text-primary-foreground hover:bg-primary/90 focus-ring",children:"Ustawienia"})]})]})})]}),e.jsxs(ke.section,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.4,delay:.05},children:[e.jsx("h2",{className:"text-lg sm:text-xl md:text-2xl font-semibold tracking-tight mb-4",children:"Statystyki"}),e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-5",children:a.map((o,l)=>{const c=o.icon;return e.jsx($r,{index:l,className:"group relative rounded-2xl border bg-card p-5 shadow-soft hover:bg-muted/40 transition-colors",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-muted flex items-center justify-center shrink-0",children:e.jsx(c,{className:`w-6 h-6 ${o.iconColor}`})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:`text-2xl font-semibold leading-none tabular-nums ${o.highlight==="primary"?"text-primary":o.highlight==="secondary"?"text-secondary":o.highlight==="accent"?"text-accent":"text-foreground"}`,children:o.counter?e.jsx(nt,{value:Number(o.value)}):o.value}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:o.label})]})]})},o.label)})})]}),e.jsxs(ke.section,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.4,delay:.08},className:"space-y-4",children:[e.jsx("h2",{className:"text-lg sm:text-xl font-semibold tracking-tight",children:"Ustawienia"}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:flex-wrap gap-3",children:[e.jsx(ke.button,{whileHover:{x:2},whileTap:{scale:.98},className:"w-full sm:w-auto sm:min-w-[220px] inline-flex items-center justify-center rounded-xl bg-primary text-primary-foreground px-4 py-3 shadow-soft hover:bg-primary/90 focus-ring",children:e.jsxs("span",{className:"inline-flex items-center gap-2 font-medium",children:[e.jsx(vn,{className:"w-4 h-4"}),"Zmie haso"]})}),e.jsx(ke.button,{whileHover:{x:2},whileTap:{scale:.98},className:"w-full sm:w-auto sm:min-w-[220px] inline-flex items-center justify-center rounded-xl bg-secondary text-white px-4 py-3 shadow-soft hover:opacity-95 focus-ring",children:e.jsxs("span",{className:"inline-flex items-center gap-2 font-medium",children:[e.jsx(sp,{className:"w-4 h-4"}),"Ustawienia powiadomie"]})}),e.jsx(ke.button,{whileHover:{x:2},whileTap:{scale:.98},className:"w-full sm:w-auto sm:min-w-[220px] inline-flex items-center justify-center rounded-xl bg-destructive text-white px-4 py-3 shadow-soft hover:bg-destructive/90 focus-ring",children:e.jsxs("span",{className:"inline-flex items-center gap-2 font-medium",children:[e.jsx(ls,{className:"w-4 h-4"}),"Usu konto"]})})]})]})]})},CD=[e.jsx(W,{path:"/profile",element:e.jsx(SD,{})},"profile")],TD=[...U_,...V_,...Q_,...hD,...xD,...bD,...ND,...zD,...CD],_D=()=>e.jsx(to,{children:e.jsxs(W,{element:e.jsx(s2,{children:e.jsx(fc,{})}),children:[e.jsx(W,{index:!0,element:e.jsx(as,{to:"dashboard",replace:!0})}),TD]})}),AD=x.lazy(()=>Promise.resolve({default:_D})),Fj=({text:t,colorClass:s})=>e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-background",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`inline-block h-12 w-12 animate-spin rounded-full border-4 border-current border-r-transparent ${s}`}),e.jsx("p",{className:"mt-4 text-muted-foreground",children:t})]})}),DD=({children:t})=>{const{data:s,isLoading:n}=We();return n||!s?e.jsx(Fj,{text:"Sprawdzanie uprawnie...",colorClass:"border-blue-600"}):s.role!=="student"?e.jsx(as,{to:"/teacher/dashboard/overview",replace:!0}):e.jsx(e.Fragment,{children:t})},PD=e.jsx(W,{path:"/student/*",element:e.jsx(yc,{fallback:e.jsx(bc,{to:"/login"}),children:e.jsx(DD,{children:e.jsx(x.Suspense,{fallback:e.jsx(Fj,{text:"adowanie panelu ucznia...",colorClass:"border-blue-600"}),children:e.jsx(AD,{})})})},"student-auth")}),MD=Zo.includes(ru)?Zo:[{name:"dashboard",list:"/admin/dashboard/overview",meta:{label:"Dashboard",icon:e.jsx(Cb,{className:"h-4 w-4"})}},ru,...Zo],ID={name:"dashboard",list:"/teacher/dashboard/overview",meta:{label:"Zasoby edukacyjne",icon:e.jsx(ye,{className:"h-4 w-4"})}},ED={name:"ai-tools",list:"/teacher/ai-tools",meta:{label:"Narzdzia AI",icon:e.jsx(rt,{className:"h-4 w-4"})}},LD=[ID,{...vu,meta:{...vu.meta,parent:"dashboard",label:"Kursy"}},{...Nu,meta:{...Nu.meta,parent:"dashboard",label:"Tematy"}},{...Du,meta:{...Du.meta,parent:"dashboard",hide:!0}},{...Pu,meta:{...Pu.meta,parent:"dashboard",label:"Grupy"}},ED,{...$u,list:"/teacher/course-structure",meta:{...$u.meta,parent:"ai-tools"}},{...qu,list:"/teacher/educational-material",meta:{...qu.meta,parent:"ai-tools"}},{...Fu,list:"/teacher/quiz-wizard",meta:{...Fu.meta,parent:"ai-tools"}},Y1,aS,{...Iu,meta:{...Iu.meta,parent:"reports"}},{...Eu,meta:{...Eu.meta,parent:"reports"}},{...Lu,meta:{...Lu.meta,parent:"reports"}},{...Ou,meta:{...Ou.meta,parent:"reports"}},{...Ru,meta:{...Ru.meta,parent:"reports"}}],OD={name:"student-root",meta:{label:"Panel ucznia",route:"/student/dashboard/overview"}},RD=[OD],$D=()=>{const t=se(),[s,n]=x.useState(0),[r,i]=x.useState("");x.useEffect(()=>{const o=()=>n(window.scrollY);return window.addEventListener("scroll",o),()=>window.removeEventListener("scroll",o)},[]);const a=[{name:"Sty",value:65},{name:"Lut",value:72},{name:"Mar",value:78},{name:"Kwi",value:85},{name:"Maj",value:88},{name:"Cze",value:94}];return e.jsxs("div",{className:"min-h-screen bg-white text-foreground",children:[e.jsx("nav",{className:"fixed top-0 w-full z-50 bg-white/80 backdrop-blur-xl border-b border-gray-100",children:e.jsx("div",{className:"container mx-auto px-6 py-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-pink-600 to-purple-700 rounded-xl flex items-center justify-center",children:e.jsx($e,{className:"w-5 h-5 text-white"})}),e.jsx("span",{className:"text-xl font-bold",children:"Smart Up"})]}),e.jsxs("div",{className:"hidden md:flex items-center gap-8",children:[e.jsx("a",{href:"#funkcje",className:"text-sm font-medium text-gray-600 hover:text-gray-900 transition-colors",children:"Funkcje"}),e.jsx("a",{href:"#kursy",className:"text-sm font-medium text-gray-600 hover:text-gray-900 transition-colors",children:"Kursy"}),e.jsx("a",{href:"#firma",className:"text-sm font-medium text-gray-600 hover:text-gray-900 transition-colors",children:"Dla firm"}),e.jsx("a",{href:"#cennik",className:"text-sm font-medium text-gray-600 hover:text-gray-900 transition-colors",children:"Cennik"}),e.jsx(I,{className:"bg-gray-900 hover:bg-gray-800 text-white text-sm px-6",onClick:()=>t("/login"),children:"Rozpocznij"})]})]})})}),e.jsx("section",{className:"pt-32 pb-20 overflow-hidden",children:e.jsx("div",{className:"container mx-auto px-6",children:e.jsxs("div",{className:"grid lg:grid-cols-12 gap-8 items-center",children:[e.jsxs("div",{className:"lg:col-span-5",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-purple-50 rounded-full mb-8",children:[e.jsx(Ye,{className:"w-4 h-4 text-purple-700"}),e.jsx("span",{className:"text-sm font-medium text-purple-700",children:"Gamifikacja w edukacji"})]}),e.jsxs("h1",{className:"text-5xl md:text-6xl font-bold leading-tight mb-6",children:["Nauka, kt贸ra",e.jsx("span",{className:"block text-transparent bg-clip-text bg-gradient-to-r from-pink-600 to-purple-700",children:"motywuje"})]}),e.jsx("p",{className:"text-lg text-gray-600 mb-8 leading-relaxed",children:"Przekszta edukacj w anga偶ujc przygod. System poziom贸w, punkt贸w i nagr贸d sprawia, 偶e nauka staje si uzale偶niajca."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-12",children:[e.jsxs(I,{size:"lg",className:"bg-gray-900 hover:bg-gray-800 text-white px-8",onClick:()=>t("/login"),children:["Zacznij za darmo",e.jsx(le,{className:"ml-2 h-4 w-4"})]}),e.jsx(I,{size:"lg",variant:"outline",className:"border-gray-300",children:"Zobacz demo"})]}),e.jsxs("div",{className:"flex items-center gap-8",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:"15k+"}),e.jsx("div",{className:"text-sm text-gray-500",children:"aktywnych uczni贸w"})]}),e.jsx("div",{className:"w-px h-12 bg-gray-200"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:"92%"}),e.jsx("div",{className:"text-sm text-gray-500",children:"ukoczalno"})]}),e.jsx("div",{className:"w-px h-12 bg-gray-200"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:"4.9"}),e.jsx("div",{className:"text-sm text-gray-500",children:"ocena"})]})]})]}),e.jsx("div",{className:"lg:col-span-7",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute -inset-4 bg-gradient-to-r from-pink-600/5 to-purple-700/5 rounded-3xl blur-2xl"}),e.jsxs("div",{className:"relative bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-pink-600 to-purple-700 rounded-lg flex items-center justify-center",children:e.jsx($e,{className:"w-4 h-4 text-white"})}),e.jsx("span",{className:"font-semibold",children:"Dashboard ucznia"})]}),e.jsx(H,{className:"bg-green-50 text-green-700 border-green-200",children:"Online"})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-pink-50 to-pink-100 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(Xd,{className:"w-5 h-5 text-pink-600"}),e.jsx("span",{className:"text-xs text-gray-500",children:"+125"})]}),e.jsx("div",{className:"text-2xl font-bold",children:"1,842"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Punkty XP"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(Se,{className:"w-5 h-5 text-purple-700"}),e.jsx("span",{className:"text-xs text-gray-500",children:"75%"})]}),e.jsx("div",{className:"text-2xl font-bold",children:"Lvl 12"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Poziom"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-teal-50 to-teal-100 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(Rs,{className:"w-5 h-5 text-teal-600"}),e.jsx("span",{className:"text-xs text-gray-500",children:"New!"})]}),e.jsx("div",{className:"text-2xl font-bold",children:"24"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Odznaki"})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("span",{className:"text-sm font-medium",children:"Postp nauki"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Ostatnie 6 miesicy"})]}),e.jsx(Fe,{width:"100%",height:120,children:e.jsxs(mo,{data:a,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorProgress",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#db2777",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#db2777",stopOpacity:0})]})}),e.jsx(sn,{type:"monotone",dataKey:"value",stroke:"#db2777",strokeWidth:2,fill:"url(#colorProgress)"}),e.jsx(St,{dataKey:"name",axisLine:!1,tickLine:!1,tick:{fontSize:11}}),e.jsx(gt,{hide:!0})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"font-medium",children:"Aktywne kursy"}),e.jsx("a",{href:"#",className:"text-purple-700 hover:underline",children:"Zobacz wszystkie"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-pink-600 to-purple-700 rounded-lg flex items-center justify-center",children:e.jsx(_l,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm",children:"JavaScript: Gra w kodowanie"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Rozdzia 4 z 12"})]})]}),e.jsx(is,{className:"w-4 h-4 text-gray-400"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-teal-500 to-blue-600 rounded-lg flex items-center justify-center",children:e.jsx(gr,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm",children:"Analiza danych: Quest"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Rozdzia 7 z 10"})]})]}),e.jsx(is,{className:"w-4 h-4 text-gray-400"})]})]})]})]})]})]})})]})})}),e.jsx("section",{id:"funkcje",className:"py-20 bg-gray-50",children:e.jsxs("div",{className:"container mx-auto px-6",children:[e.jsxs("div",{className:"text-center mb-16",children:[e.jsxs("h2",{className:"text-4xl font-bold mb-4",children:["Funkcje, kt贸re"," ",e.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-pink-600 to-purple-700",children:"anga偶uj"})]}),e.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"System zaprojektowany, aby uczyni nauk uzale偶niajc jak najlepsza gra"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"group relative bg-white rounded-2xl p-8 hover:shadow-lg transition-all duration-300 cursor-pointer border border-gray-100",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-pink-600/5 to-transparent rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-pink-600 to-purple-700 rounded-2xl flex items-center justify-center mb-6",children:e.jsx($e,{className:"w-7 h-7 text-white"})}),e.jsx("h3",{className:"text-xl font-bold mb-3",children:"System poziom贸w"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"99 poziom贸w do zdobycia. Ka偶dy poziom odblokowuje nowe mo偶liwoci i nagrody."}),e.jsxs("div",{className:"flex items-center text-sm text-pink-600 font-medium",children:["Dowiedz si wicej",e.jsx(le,{className:"w-4 h-4 ml-2 transform group-hover:translate-x-1 transition-transform"})]})]})]}),e.jsxs("div",{className:"group relative bg-white rounded-2xl p-8 hover:shadow-lg transition-all duration-300 cursor-pointer border border-gray-100",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-700/5 to-transparent rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-purple-700 to-teal-500 rounded-2xl flex items-center justify-center mb-6",children:e.jsx(Xd,{className:"w-7 h-7 text-white"})}),e.jsx("h3",{className:"text-xl font-bold mb-3",children:"Idle Points"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Zdobywaj punkty nawet gdy nie uczysz si aktywnie. System pasywnego rozwoju."}),e.jsxs("div",{className:"flex items-center text-sm text-purple-700 font-medium",children:["Dowiedz si wicej",e.jsx(le,{className:"w-4 h-4 ml-2 transform group-hover:translate-x-1 transition-transform"})]})]})]}),e.jsxs("div",{className:"group relative bg-white rounded-2xl p-8 hover:shadow-lg transition-all duration-300 cursor-pointer border border-gray-100",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-teal-500/5 to-transparent rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-teal-500 to-blue-600 rounded-2xl flex items-center justify-center mb-6",children:e.jsx(Se,{className:"w-7 h-7 text-white"})}),e.jsx("h3",{className:"text-xl font-bold mb-3",children:"Wyzwania"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Codzienne i tygodniowe wyzwania z dodatkowymi nagrodami za ukoczenie."}),e.jsxs("div",{className:"flex items-center text-sm text-teal-600 font-medium",children:["Dowiedz si wicej",e.jsx(le,{className:"w-4 h-4 ml-2 transform group-hover:translate-x-1 transition-transform"})]})]})]}),e.jsxs("div",{className:"group relative bg-white rounded-2xl p-8 hover:shadow-lg transition-all duration-300 cursor-pointer border border-gray-100",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-orange-500/5 to-transparent rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-orange-500 to-yellow-500 rounded-2xl flex items-center justify-center mb-6",children:e.jsx(pe,{className:"w-7 h-7 text-white"})}),e.jsx("h3",{className:"text-xl font-bold mb-3",children:"Rankingi"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Rywalizuj z innymi uczniami. Rankingi globalne, lokalne i grupowe."}),e.jsxs("div",{className:"flex items-center text-sm text-orange-600 font-medium",children:["Dowiedz si wicej",e.jsx(le,{className:"w-4 h-4 ml-2 transform group-hover:translate-x-1 transition-transform"})]})]})]}),e.jsxs("div",{className:"group relative bg-white rounded-2xl p-8 hover:shadow-lg transition-all duration-300 cursor-pointer border border-gray-100",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-700/5 to-transparent rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-purple-700 to-pink-600 rounded-2xl flex items-center justify-center mb-6",children:e.jsx(Rs,{className:"w-7 h-7 text-white"})}),e.jsx("h3",{className:"text-xl font-bold mb-3",children:"Odznaki"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Kolekcjonuj unikalne odznaki za osignicia i kamienie milowe."}),e.jsxs("div",{className:"flex items-center text-sm text-purple-700 font-medium",children:["Dowiedz si wicej",e.jsx(le,{className:"w-4 h-4 ml-2 transform group-hover:translate-x-1 transition-transform"})]})]})]}),e.jsxs("div",{className:"group relative bg-white rounded-2xl p-8 hover:shadow-lg transition-all duration-300 cursor-pointer border border-gray-100",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-teal-500/5 to-transparent rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-teal-500 to-purple-700 rounded-2xl flex items-center justify-center mb-6",children:e.jsx(gr,{className:"w-7 h-7 text-white"})}),e.jsx("h3",{className:"text-xl font-bold mb-3",children:"Analityka"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Szczeg贸owe statystyki postp贸w i personalizowane rekomendacje."}),e.jsxs("div",{className:"flex items-center text-sm text-teal-600 font-medium",children:["Dowiedz si wicej",e.jsx(le,{className:"w-4 h-4 ml-2 transform group-hover:translate-x-1 transition-transform"})]})]})]})]})]})}),e.jsx("section",{className:"py-20 bg-white",children:e.jsxs("div",{className:"container mx-auto px-6",children:[e.jsxs("div",{className:"max-w-3xl mx-auto text-center mb-16",children:[e.jsxs("h2",{className:"text-4xl font-bold mb-4",children:["Jak to"," ",e.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-pink-600 to-purple-700",children:"dziaa"})]}),e.jsx("p",{className:"text-lg text-gray-600",children:"Cztery proste kroki do rozpoczcia nauki z gamifikacj"})]}),e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2 top-0 bottom-0 w-0.5 bg-gray-200"}),e.jsx("div",{className:"space-y-12",children:[{number:"01",title:"Stw贸rz profil",description:"Wybierz swoj rol i spersonalizuj dowiadczenie nauki",icon:pe,color:"from-pink-600 to-purple-700"},{number:"02",title:"Wybierz kursy",description:"Przegldaj bibliotek kurs贸w i wybierz te, kt贸re Ci interesuj",icon:tn,color:"from-purple-700 to-teal-500"},{number:"03",title:"Ucz si i graj",description:"Rozwizuj quizy, zdobywaj punkty i awansuj na kolejne poziomy",icon:_l,color:"from-teal-500 to-blue-600"},{number:"04",title:"led藕 postpy",description:"Monitoruj swoje osignicia i rywalizuj z innymi",icon:xt,color:"from-orange-500 to-yellow-500"}].map((o,l)=>e.jsx("div",{className:"relative",children:e.jsxs("div",{className:`flex items-center ${l%2===0?"flex-row":"flex-row-reverse"}`,children:[e.jsxs("div",{className:`w-5/12 ${l%2===0?"text-right pr-8":"text-left pl-8"}`,children:[e.jsxs("div",{className:`inline-flex items-center gap-4 mb-2 ${l%2===0?"flex-row-reverse":""}`,children:[e.jsx("h3",{className:"text-2xl font-bold",children:o.title}),e.jsx("span",{className:"text-4xl font-bold text-gray-200",children:o.number})]}),e.jsx("p",{className:"text-gray-600 text-lg",children:o.description})]}),e.jsx("div",{className:"w-2/12 flex justify-center",children:e.jsx("div",{className:`relative z-10 w-16 h-16 bg-gradient-to-br ${o.color} rounded-2xl flex items-center justify-center shadow-lg`,children:e.jsx(o.icon,{className:"w-8 h-8 text-white"})})}),e.jsx("div",{className:"w-5/12"})]})},l))})]})})]})}),e.jsx("section",{className:"py-20 bg-gradient-to-br from-gray-900 to-gray-800",children:e.jsx("div",{className:"container mx-auto px-6",children:e.jsx("div",{className:"grid md:grid-cols-4 gap-8",children:[{value:"15k+",label:"Aktywnych uczni贸w",icon:pe},{value:"200+",label:"Kurs贸w",icon:tn},{value:"92%",label:"Ukoczalno",icon:Se},{value:"4.9/5",label:"Ocena",icon:Sn}].map((o,l)=>e.jsxs("div",{className:"text-center",children:[e.jsx(o.icon,{className:"w-8 h-8 mx-auto mb-4 text-white/60"}),e.jsx("div",{className:"text-4xl font-bold text-white mb-2",children:o.value}),e.jsx("div",{className:"text-sm text-white/60",children:o.label})]},l))})})}),e.jsx("section",{className:"py-20 bg-white",children:e.jsx("div",{className:"container mx-auto px-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[e.jsxs("h2",{className:"text-4xl font-bold mb-6",children:["Gotowy na nauk, kt贸ra"," ",e.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-pink-600 to-purple-700",children:"wciga"}),"?"]}),e.jsx("p",{className:"text-lg text-gray-600 mb-8 max-w-2xl mx-auto",children:"Docz do tysicy uczni贸w, kt贸rzy odkryli rado z nauki dziki gamifikacji. Pierwsze 30 dni gratis."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mb-8",children:[e.jsx(Z,{type:"email",placeholder:"twoj@email.pl",value:r,onChange:o=>i(o.target.value),className:"max-w-xs h-12"}),e.jsxs(I,{size:"lg",className:"bg-gradient-to-r from-pink-600 to-purple-700 hover:opacity-90 text-white px-8 h-12",onClick:()=>t("/login"),children:["Rozpocznij za darmo",e.jsx(le,{className:"ml-2 h-4 w-4"})]})]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Bez karty kredytowej  Anuluj w ka偶dej chwili  Peny dostp"})]})})}),e.jsx("footer",{className:"bg-gray-900 text-white py-12",children:e.jsx("div",{className:"container mx-auto px-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-white/10 rounded-lg flex items-center justify-center",children:e.jsx($e,{className:"w-4 h-4"})}),e.jsx("span",{className:"text-lg font-bold",children:"Smart Up"})]}),e.jsx("div",{className:"text-sm text-white/60",children:"漏 2025 Smart Up. Wszystkie prawa zastrze偶one."})]})})})]})},qD=new Hy({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:!1,staleTime:300*1e3}}});function FD({children:t}){const{pathname:s}=Ei(),n=s.split("/")[1],r=n==="admin"?MD:n==="teacher"?LD:n==="student"?RD:[];return e.jsx(Yy,{dataProvider:eb(J),authProvider:Hb,routerProvider:Jy,resources:r,options:{syncWithLocation:!0,warnWhenUnsavedChanges:!1,useNewQueryKeys:!0,disableTelemetry:!0},children:t})}function UD(){return e.jsx(Zy,{client:qD,children:e.jsx(Ry,{children:e.jsx(FD,{children:e.jsxs(to,{children:[e.jsx(W,{path:"/",element:e.jsx($D,{})}),up,r0,o0,d0,rw,YS,PD,e.jsx(W,{path:"*",element:e.jsx(as,{to:"/",replace:!0})})]})})})})}const BD=document.getElementById("root"),VD=qb.createRoot(BD);VD.render(e.jsxs(ne.StrictMode,{children:[e.jsx(UD,{}),e.jsx(Gy,{position:"top-right",richColors:!0,closeButton:!0,duration:4e3,toastOptions:{style:{width:"500px",fontSize:"20px"},className:"sonner-toast"}})]}));export{ge as A,I as B,D as C,cn as F,Z as I,_e as L,je as a,$ as b,R as c,Oe as d,P as e,oe as f,dn as g,re as h,cp as i,op as l,lp as r,J as s,dp as u};
