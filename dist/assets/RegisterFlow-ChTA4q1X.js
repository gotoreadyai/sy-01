import{j as e}from"./radix-ui-BdNglvg2.js";import{R as c,e as b,o as E,l as p,N as F}from"./react-vendor-nLIND2rL.js";import{L as g,C as N,b as y,c as v,d as k,e as z,I as w,A as x,a as j,B as m,r as I}from"./index-BVuyqb0h.js";import{h as B,ai as f,a7 as S,aD as A,R as P,ah as K,e as R,M as D,U,aC as H,a6 as L,O as M,a5 as W}from"./ui-utils-CHvRCCKz.js";import{N as Z}from"./NarrowCol-DUq-L8Qp.js";import"./refine-core-BpFEoGih.js";import"./utils-C8X7R3D6.js";import"./refine-ui-D3vAG_bA.js";import"./forms-aDucxvuO.js";import"./tables-B_D9J81n.js";const $=({store:s,logic:a})=>{const[r,t]=c.useState(s.data.email||""),[n,i]=c.useState(s.data.name||""),u=async o=>{o.preventDefault(),await a.submitStep1({email:r,name:n})};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-start gap-5 mb-6",children:[e.jsx(B,{className:"mt-2 bg-white rounded-full p-2 w-12 h-12"}),e.jsx(g,{title:"Rejestracja",description:"Krok 1 z 4 - Podaj podstawowe informacje"})]}),e.jsxs(N,{children:[e.jsxs(y,{children:[e.jsx(v,{children:"Dane podstawowe"}),e.jsx(k,{children:"Potrzebujemy kilku podstawowych informacji do założenia konta"})]}),e.jsxs(z,{children:[e.jsxs("form",{onSubmit:u,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium mb-2",children:"Email"}),e.jsx(w,{id:"email",type:"email",placeholder:"przykład@email.com",value:r,onChange:o=>t(o.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium mb-2",children:"Imię i nazwisko"}),e.jsx(w,{id:"name",type:"text",placeholder:"Jan Kowalski",value:n,onChange:o=>i(o.target.value),required:!0})]}),a.error&&e.jsxs(x,{variant:"destructive",children:[e.jsx(f,{className:"h-4 w-4"}),e.jsx(j,{children:a.error})]}),e.jsxs(m,{type:"submit",className:"w-full",children:["Dalej",e.jsx(S,{className:"ml-2 h-4 w-4"})]})]}),e.jsx("div",{className:"mt-6 text-center text-sm",children:e.jsx("a",{href:"/login",className:"text-blue-600 hover:text-blue-500",children:"Masz już konto? Zaloguj się"})})]})]})]})},q=s=>s?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s)?null:"Nieprawidłowy format email":"Email jest wymagany",T=s=>s?s.trim().length<3?"Imię i nazwisko muszą mieć co najmniej 3 znaki":s.includes(" ")?null:"Podaj zarówno imię jak i nazwisko":"Imię i nazwisko są wymagane",J=s=>s?s.length<6?"Hasło musi mieć co najmniej 6 znaków":s.length>72?"Hasło nie może być dłuższe niż 72 znaki":null:"Hasło jest wymagane",O=s=>{if(!s)return{score:0,label:"Brak hasła",color:"gray"};let a=0;return s.length>=6&&a++,s.length>=10&&a++,s.length>=14&&a++,/[a-z]/.test(s)&&a++,/[A-Z]/.test(s)&&a++,/[0-9]/.test(s)&&a++,/[^a-zA-Z0-9]/.test(s)&&a++,a<=2?{score:a,label:"Słabe",color:"red"}:a<=4?{score:a,label:"Średnie",color:"yellow"}:a<=6?{score:a,label:"Dobre",color:"green"}:{score:a,label:"Bardzo dobre",color:"green"}},G=({password:s})=>{const a=O(s);if(!s)return null;const r=()=>{switch(a.color){case"red":return"bg-red-500";case"yellow":return"bg-yellow-500";case"green":return"bg-green-500";default:return"bg-gray-300"}};return e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Siła hasła:"}),e.jsx("span",{className:`text-xs font-medium ${a.color==="red"?"text-red-600":a.color==="yellow"?"text-yellow-600":a.color==="green"?"text-green-600":"text-gray-600"}`,children:a.label})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:`h-full transition-all duration-300 ${r()}`,style:{width:`${a.score/7*100}%`}})})]})},Q=({store:s,logic:a})=>{const r=b(),[t,n]=c.useState(s.data.password||""),[i,u]=c.useState(s.data.confirmPassword||""),o=async d=>{d.preventDefault(),await a.submitStep2({password:t,confirmPassword:i})};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-start gap-5 mb-6",children:[e.jsx(A,{className:"mt-2 bg-white rounded-full p-2 w-12 h-12"}),e.jsx(g,{title:"Rejestracja",description:"Krok 2 z 4 - Ustaw hasło do konta"})]}),e.jsxs(N,{children:[e.jsxs(y,{children:[e.jsx(v,{children:"Utwórz hasło"}),e.jsx(k,{children:"Wybierz bezpieczne hasło do swojego konta"})]}),e.jsx(z,{children:e.jsxs("form",{onSubmit:o,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium mb-2",children:"Hasło"}),e.jsx(w,{id:"password",type:"password",placeholder:"Minimum 6 znaków",value:t,onChange:d=>n(d.target.value),required:!0}),e.jsx(G,{password:t})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium mb-2",children:"Potwierdź hasło"}),e.jsx(w,{id:"confirmPassword",type:"password",placeholder:"Powtórz hasło",value:i,onChange:d=>u(d.target.value),required:!0})]}),a.error&&e.jsxs(x,{variant:"destructive",children:[e.jsx(f,{className:"h-4 w-4"}),e.jsx(j,{children:a.error})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(m,{type:"button",variant:"outline",onClick:()=>r("/register/step1"),children:[e.jsx(P,{className:"mr-2 h-4 w-4"}),"Wstecz"]}),e.jsxs(m,{type:"submit",className:"flex-1",children:["Dalej",e.jsx(S,{className:"ml-2 h-4 w-4"})]})]})]})})]})]})},V=({store:s,logic:a})=>{const r=b(),[t,n]=c.useState(!1),i=async()=>{await a.submitRegistration()&&n(!0)};return s.data.email?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-start gap-5 mb-6",children:[e.jsx(K,{className:"mt-2 bg-white rounded-full p-2 w-12 h-12"}),e.jsx(g,{title:"Rejestracja",description:"Krok 3 z 4 - Potwierdzenie danych"})]}),t&&e.jsxs(x,{className:"mb-4 border-green-200 bg-green-50",children:[e.jsx(R,{className:"h-4 w-4 text-green-600"}),e.jsxs(j,{className:"text-green-800",children:[e.jsx("strong",{children:"Rejestracja udana!"})," Za chwilę zostaniesz przekierowany..."]})]}),e.jsxs(N,{children:[e.jsxs(y,{children:[e.jsxs(v,{className:"flex items-center",children:[e.jsx(R,{className:"mr-2 h-5 w-5 text-blue-600"}),"Podsumowanie"]}),e.jsx(k,{children:"Sprawdź czy wszystkie dane są poprawne"})]}),e.jsxs(z,{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx(D,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Email"}),e.jsx("p",{className:"text-sm text-gray-600",children:s.data.email})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx(U,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Imię i nazwisko"}),e.jsx("p",{className:"text-sm text-gray-600",children:s.data.name})]})]})]}),a.error&&!t&&e.jsxs(x,{variant:"destructive",children:[e.jsx(f,{className:"h-4 w-4"}),e.jsxs(j,{children:[e.jsx("strong",{children:"Rejestracja nieudana:"})," ",a.error]})]}),e.jsxs("div",{className:"flex justify-between pt-4",children:[e.jsxs(m,{variant:"outline",onClick:()=>r("/register/step2"),disabled:a.isSubmitting||t,children:[e.jsx(P,{className:"mr-2 h-4 w-4"}),"Wstecz"]}),e.jsxs(m,{onClick:i,disabled:a.isSubmitting||t,children:[a.isSubmitting&&e.jsx(H,{className:"mr-2 h-4 w-4 animate-spin"}),a.isSubmitting?"Rejestruję...":t?"Udane!":a.error?"Spróbuj ponownie":"Zarejestruj się"]})]})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(g,{title:"Rejestracja",description:"Błąd - brak danych"}),e.jsxs(x,{variant:"destructive",children:[e.jsx(f,{className:"h-4 w-4"}),e.jsx(j,{children:"Brak danych rejestracji. Rozpocznij proces od początku."})]}),e.jsx(m,{onClick:()=>r("/register/step1"),className:"mt-4",children:"Wróć do kroku 1"})]})},X=({store:s})=>{const a=b();return c.useEffect(()=>{const r=setTimeout(()=>{s.reset()},3e4);return()=>clearTimeout(r)},[s]),e.jsxs(e.Fragment,{children:[e.jsx(g,{title:"Rejestracja zakończona!",description:"Krok 4 z 4 - Sprawdź swoją skrzynkę mailową"}),e.jsxs(N,{className:"border-green-200 bg-green-50",children:[e.jsx(y,{children:e.jsxs(v,{className:"flex items-center text-green-800",children:[e.jsx(L,{className:"mr-2 h-6 w-6 text-green-600"}),"Konto zostało utworzone!"]})}),e.jsxs(z,{children:[e.jsxs("p",{className:"text-green-700 mb-4",children:["Wysłaliśmy email z potwierdzeniem na adres"," ",e.jsx("strong",{children:s.data.email})]}),e.jsxs(x,{className:"bg-white border-green-200",children:[e.jsx(D,{className:"h-4 w-4 text-green-600"}),e.jsxs(j,{children:[e.jsx("strong",{className:"block mb-2",children:"Co dalej?"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-sm",children:[e.jsx("li",{children:"Sprawdź swoją skrzynkę email (także folder spam)"}),e.jsx("li",{children:"Kliknij link aktywacyjny w emailu"}),e.jsx("li",{children:"Po aktywacji będziesz mógł się zalogować"})]})]})]}),e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsxs(m,{onClick:()=>{s.reset(),a("/login")},className:"w-full",size:"lg",children:["Przejdź do logowania",e.jsx(S,{className:"ml-2 h-4 w-4"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[e.jsx(M,{className:"inline h-3 w-3 mr-1"}),"Nie otrzymałeś emaila?"]}),e.jsxs(m,{variant:"outline",size:"sm",onClick:()=>a("/resend-confirmation"),children:[e.jsx(W,{className:"mr-2 h-4 w-4"}),"Wyślij ponownie"]})]})]})]})]})]})},Y=({children:s,currentStep:a})=>e.jsxs(Z,{children:[a&&e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"flex justify-between items-center",children:[1,2,3,4].map(r=>e.jsx("div",{className:`flex-1 h-2 mx-1 rounded-full transition-colors ${r<=a?"bg-blue-600":"bg-gray-200"}`},r))})}),s]}),_=()=>{const[s,a]=c.useState({}),[r,t]=c.useState(1);return{data:s,currentStep:r,setData:n=>a(i=>({...i,...n})),nextStep:()=>t(n=>Math.min(n+1,4)),prevStep:()=>t(n=>Math.max(n-1,1)),reset:()=>{a({}),t(1)}}},ee=s=>{const a=b(),[r,t]=c.useState(!1),[n,i]=c.useState(null);return{isSubmitting:r,error:n,submitStep1:async l=>{i(null);const h=q(l.email);if(h)return i(h),!1;const C=T(l.name);return C?(i(C),!1):(s.setData(l),s.nextStep(),a("/register/step2"),!0)},submitStep2:async l=>{i(null);const h=J(l.password);return h?(i(h),!1):l.password!==l.confirmPassword?(i("Hasła nie są identyczne"),!1):(s.setData(l),s.nextStep(),a("/register/step3"),!0)},submitRegistration:async()=>{if(i(null),t(!0),!s.data.email||!s.data.password||!s.data.name)return i("Brak wymaganych danych. Rozpocznij proces od początku."),t(!1),!1;const l=await I.register(s.data.email,s.data.password,s.data.name);return t(!1),l.success?(s.setData({registrationComplete:!0}),s.nextStep(),a("/register/step4"),!0):(i(l.error),!1)}}},de=()=>{const s=_(),a=ee(s);return e.jsx(Y,{currentStep:s.currentStep,children:e.jsxs(E,{children:[e.jsx(p,{path:"step1",element:e.jsx($,{store:s,logic:a})}),e.jsx(p,{path:"step2",element:e.jsx(Q,{store:s,logic:a})}),e.jsx(p,{path:"step3",element:e.jsx(V,{store:s,logic:a})}),e.jsx(p,{path:"step4",element:e.jsx(X,{store:s})}),e.jsx(p,{path:"*",element:e.jsx(F,{to:"step1"})})]})})};export{de as default};
